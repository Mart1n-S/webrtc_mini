var ep=Object.defineProperty;var rp=(r,t,e)=>t in r?ep(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var np=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var ct=(r,t,e)=>rp(r,typeof t!="symbol"?t+"":t,e);var gE=np((Ue,He)=>{var Bf=typeof window=="object"&&window&&window.Object===Object&&window,ip=typeof self=="object"&&self&&self.Object===Object&&self,Tr=Bf||ip||Function("return this")(),Xr=Tr.Symbol,Ff=Object.prototype,sp=Ff.hasOwnProperty,op=Ff.toString,Vn=Xr?Xr.toStringTag:void 0;function ap(r){var t=sp.call(r,Vn),e=r[Vn];try{r[Vn]=void 0;var n=!0}catch{}var i=op.call(r);return n&&(t?r[Vn]=e:delete r[Vn]),i}var lp=Object.prototype,up=lp.toString;function cp(r){return up.call(r)}var fp="[object Null]",hp="[object Undefined]",Hl=Xr?Xr.toStringTag:void 0;function kn(r){return r==null?r===void 0?hp:fp:Hl&&Hl in Object(r)?ap(r):cp(r)}function xr(r){return r!=null&&typeof r=="object"}var nn=Array.isArray;function Zr(r){var t=typeof r;return r!=null&&(t=="object"||t=="function")}function $f(r){return r}var dp="[object AsyncFunction]",pp="[object Function]",gp="[object GeneratorFunction]",vp="[object Proxy]";function ul(r){if(!Zr(r))return!1;var t=kn(r);return t==pp||t==gp||t==dp||t==vp}var zs=Tr["__core-js_shared__"],zl=(function(){var r=/[^.]+$/.exec(zs&&zs.keys&&zs.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""})();function mp(r){return!!zl&&zl in r}var yp=Function.prototype,bp=yp.toString;function an(r){if(r!=null){try{return bp.call(r)}catch{}try{return r+""}catch{}}return""}var _p=/[\\^$.*+?()[\]{}|]/g,Ep=/^\[object .+?Constructor\]$/,Ap=Function.prototype,Op=Object.prototype,Sp=Ap.toString,wp=Op.hasOwnProperty,Tp=RegExp("^"+Sp.call(wp).replace(_p,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Rp(r){if(!Zr(r)||mp(r))return!1;var t=ul(r)?Tp:Ep;return t.test(an(r))}function Np(r,t){return r==null?void 0:r[t]}function ln(r,t){var e=Np(r,t);return Rp(e)?e:void 0}var Ba=ln(Tr,"WeakMap"),Vl=Object.create,Lp=(function(){function r(){}return function(t){if(!Zr(t))return{};if(Vl)return Vl(t);r.prototype=t;var e=new r;return r.prototype=void 0,e}})();function Cp(r,t,e){switch(e.length){case 0:return r.call(t);case 1:return r.call(t,e[0]);case 2:return r.call(t,e[0],e[1]);case 3:return r.call(t,e[0],e[1],e[2])}return r.apply(t,e)}function xp(r,t){var e=-1,n=r.length;for(t||(t=Array(n));++e<n;)t[e]=r[e];return t}var Ip=800,qp=16,Pp=Date.now;function Dp(r){var t=0,e=0;return function(){var n=Pp(),i=qp-(n-e);if(e=n,i>0){if(++t>=Ip)return arguments[0]}else t=0;return r.apply(void 0,arguments)}}function Mp(r){return function(){return r}}var Qi=(function(){try{var r=ln(Object,"defineProperty");return r({},"",{}),r}catch{}})(),jp=Qi?function(r,t){return Qi(r,"toString",{configurable:!0,enumerable:!1,value:Mp(t),writable:!0})}:$f,kp=Dp(jp);function Bp(r,t){for(var e=-1,n=r==null?0:r.length;++e<n&&t(r[e],e,r)!==!1;);return r}var Fp=9007199254740991,$p=/^(?:0|[1-9]\d*)$/;function Uf(r,t){var e=typeof r;return t=t==null?Fp:t,!!t&&(e=="number"||e!="symbol"&&$p.test(r))&&r>-1&&r%1==0&&r<t}function cl(r,t,e){t=="__proto__"&&Qi?Qi(r,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):r[t]=e}function gi(r,t){return r===t||r!==r&&t!==t}var Up=Object.prototype,Hp=Up.hasOwnProperty;function Hf(r,t,e){var n=r[t];(!(Hp.call(r,t)&&gi(n,e))||e===void 0&&!(t in r))&&cl(r,t,e)}function zp(r,t,e,n){var i=!e;e||(e={});for(var s=-1,l=t.length;++s<l;){var u=t[s],a=void 0;a===void 0&&(a=r[u]),i?cl(e,u,a):Hf(e,u,a)}return e}var Gl=Math.max;function Vp(r,t,e){return t=Gl(t===void 0?r.length-1:t,0),function(){for(var n=arguments,i=-1,s=Gl(n.length-t,0),l=Array(s);++i<s;)l[i]=n[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=n[i];return u[t]=e(l),Cp(r,this,u)}}function Gp(r,t){return kp(Vp(r,t,$f),r+"")}var Wp=9007199254740991;function zf(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Wp}function Es(r){return r!=null&&zf(r.length)&&!ul(r)}function Kp(r,t,e){if(!Zr(e))return!1;var n=typeof t;return(n=="number"?Es(e)&&Uf(t,e.length):n=="string"&&t in e)?gi(e[t],r):!1}function Yp(r){return Gp(function(t,e){var n=-1,i=e.length,s=i>1?e[i-1]:void 0,l=i>2?e[2]:void 0;for(s=r.length>3&&typeof s=="function"?(i--,s):void 0,l&&Kp(e[0],e[1],l)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var u=e[n];u&&r(t,u,n,s)}return t})}var Xp=Object.prototype;function fl(r){var t=r&&r.constructor,e=typeof t=="function"&&t.prototype||Xp;return r===e}function Zp(r,t){for(var e=-1,n=Array(r);++e<r;)n[e]=t(e);return n}var Jp="[object Arguments]";function Wl(r){return xr(r)&&kn(r)==Jp}var Vf=Object.prototype,Qp=Vf.hasOwnProperty,tg=Vf.propertyIsEnumerable,Fa=Wl((function(){return arguments})())?Wl:function(r){return xr(r)&&Qp.call(r,"callee")&&!tg.call(r,"callee")};function eg(){return!1}var Gf=typeof Ue=="object"&&Ue&&!Ue.nodeType&&Ue,Kl=Gf&&typeof He=="object"&&He&&!He.nodeType&&He,rg=Kl&&Kl.exports===Gf,Yl=rg?Tr.Buffer:void 0,ng=Yl?Yl.isBuffer:void 0,ni=ng||eg,ig="[object Arguments]",sg="[object Array]",og="[object Boolean]",ag="[object Date]",lg="[object Error]",ug="[object Function]",cg="[object Map]",fg="[object Number]",hg="[object Object]",dg="[object RegExp]",pg="[object Set]",gg="[object String]",vg="[object WeakMap]",mg="[object ArrayBuffer]",yg="[object DataView]",bg="[object Float32Array]",_g="[object Float64Array]",Eg="[object Int8Array]",Ag="[object Int16Array]",Og="[object Int32Array]",Sg="[object Uint8Array]",wg="[object Uint8ClampedArray]",Tg="[object Uint16Array]",Rg="[object Uint32Array]",ee={};ee[bg]=ee[_g]=ee[Eg]=ee[Ag]=ee[Og]=ee[Sg]=ee[wg]=ee[Tg]=ee[Rg]=!0;ee[ig]=ee[sg]=ee[mg]=ee[og]=ee[yg]=ee[ag]=ee[lg]=ee[ug]=ee[cg]=ee[fg]=ee[hg]=ee[dg]=ee[pg]=ee[gg]=ee[vg]=!1;function Ng(r){return xr(r)&&zf(r.length)&&!!ee[kn(r)]}function hl(r){return function(t){return r(t)}}var Wf=typeof Ue=="object"&&Ue&&!Ue.nodeType&&Ue,Qn=Wf&&typeof He=="object"&&He&&!He.nodeType&&He,Lg=Qn&&Qn.exports===Wf,Vs=Lg&&Bf.process,Cn=(function(){try{var r=Qn&&Qn.require&&Qn.require("util").types;return r||Vs&&Vs.binding&&Vs.binding("util")}catch{}})(),Xl=Cn&&Cn.isTypedArray,dl=Xl?hl(Xl):Ng,Cg=Object.prototype,xg=Cg.hasOwnProperty;function Kf(r,t){var e=nn(r),n=!e&&Fa(r),i=!e&&!n&&ni(r),s=!e&&!n&&!i&&dl(r),l=e||n||i||s,u=l?Zp(r.length,String):[],a=u.length;for(var o in r)(t||xg.call(r,o))&&!(l&&(o=="length"||i&&(o=="offset"||o=="parent")||s&&(o=="buffer"||o=="byteLength"||o=="byteOffset")||Uf(o,a)))&&u.push(o);return u}function Yf(r,t){return function(e){return r(t(e))}}var Ig=Yf(Object.keys,Object),qg=Object.prototype,Pg=qg.hasOwnProperty;function Dg(r){if(!fl(r))return Ig(r);var t=[];for(var e in Object(r))Pg.call(r,e)&&e!="constructor"&&t.push(e);return t}function Mg(r){return Es(r)?Kf(r):Dg(r)}function jg(r){var t=[];if(r!=null)for(var e in Object(r))t.push(e);return t}var kg=Object.prototype,Bg=kg.hasOwnProperty;function Fg(r){if(!Zr(r))return jg(r);var t=fl(r),e=[];for(var n in r)n=="constructor"&&(t||!Bg.call(r,n))||e.push(n);return e}function Xf(r){return Es(r)?Kf(r,!0):Fg(r)}var ii=ln(Object,"create");function $g(){this.__data__=ii?ii(null):{},this.size=0}function Ug(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t}var Hg="__lodash_hash_undefined__",zg=Object.prototype,Vg=zg.hasOwnProperty;function Gg(r){var t=this.__data__;if(ii){var e=t[r];return e===Hg?void 0:e}return Vg.call(t,r)?t[r]:void 0}var Wg=Object.prototype,Kg=Wg.hasOwnProperty;function Yg(r){var t=this.__data__;return ii?t[r]!==void 0:Kg.call(t,r)}var Xg="__lodash_hash_undefined__";function Zg(r,t){var e=this.__data__;return this.size+=this.has(r)?0:1,e[r]=ii&&t===void 0?Xg:t,this}function sn(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}sn.prototype.clear=$g;sn.prototype.delete=Ug;sn.prototype.get=Gg;sn.prototype.has=Yg;sn.prototype.set=Zg;function Jg(){this.__data__=[],this.size=0}function As(r,t){for(var e=r.length;e--;)if(gi(r[e][0],t))return e;return-1}var Qg=Array.prototype,tv=Qg.splice;function ev(r){var t=this.__data__,e=As(t,r);if(e<0)return!1;var n=t.length-1;return e==n?t.pop():tv.call(t,e,1),--this.size,!0}function rv(r){var t=this.__data__,e=As(t,r);return e<0?void 0:t[e][1]}function nv(r){return As(this.__data__,r)>-1}function iv(r,t){var e=this.__data__,n=As(e,r);return n<0?(++this.size,e.push([r,t])):e[n][1]=t,this}function Pr(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}Pr.prototype.clear=Jg;Pr.prototype.delete=ev;Pr.prototype.get=rv;Pr.prototype.has=nv;Pr.prototype.set=iv;var si=ln(Tr,"Map");function sv(){this.size=0,this.__data__={hash:new sn,map:new(si||Pr),string:new sn}}function ov(r){var t=typeof r;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?r!=="__proto__":r===null}function Os(r,t){var e=r.__data__;return ov(t)?e[typeof t=="string"?"string":"hash"]:e.map}function av(r){var t=Os(this,r).delete(r);return this.size-=t?1:0,t}function lv(r){return Os(this,r).get(r)}function uv(r){return Os(this,r).has(r)}function cv(r,t){var e=Os(this,r),n=e.size;return e.set(r,t),this.size+=e.size==n?0:1,this}function un(r){var t=-1,e=r==null?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}un.prototype.clear=sv;un.prototype.delete=av;un.prototype.get=lv;un.prototype.has=uv;un.prototype.set=cv;function fv(r,t){for(var e=-1,n=t.length,i=r.length;++e<n;)r[i+e]=t[e];return r}var Zf=Yf(Object.getPrototypeOf,Object),hv="[object Object]",dv=Function.prototype,pv=Object.prototype,Jf=dv.toString,gv=pv.hasOwnProperty,vv=Jf.call(Object);function mv(r){if(!xr(r)||kn(r)!=hv)return!1;var t=Zf(r);if(t===null)return!0;var e=gv.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&Jf.call(e)==vv}function yv(){this.__data__=new Pr,this.size=0}function bv(r){var t=this.__data__,e=t.delete(r);return this.size=t.size,e}function _v(r){return this.__data__.get(r)}function Ev(r){return this.__data__.has(r)}var Av=200;function Ov(r,t){var e=this.__data__;if(e instanceof Pr){var n=e.__data__;if(!si||n.length<Av-1)return n.push([r,t]),this.size=++e.size,this;e=this.__data__=new un(n)}return e.set(r,t),this.size=e.size,this}function Ar(r){var t=this.__data__=new Pr(r);this.size=t.size}Ar.prototype.clear=yv;Ar.prototype.delete=bv;Ar.prototype.get=_v;Ar.prototype.has=Ev;Ar.prototype.set=Ov;var Qf=typeof Ue=="object"&&Ue&&!Ue.nodeType&&Ue,Zl=Qf&&typeof He=="object"&&He&&!He.nodeType&&He,Sv=Zl&&Zl.exports===Qf,Jl=Sv?Tr.Buffer:void 0,Ql=Jl?Jl.allocUnsafe:void 0;function th(r,t){if(t)return r.slice();var e=r.length,n=Ql?Ql(e):new r.constructor(e);return r.copy(n),n}function wv(r,t){for(var e=-1,n=r==null?0:r.length,i=0,s=[];++e<n;){var l=r[e];t(l,e,r)&&(s[i++]=l)}return s}function Tv(){return[]}var Rv=Object.prototype,Nv=Rv.propertyIsEnumerable,tu=Object.getOwnPropertySymbols,Lv=tu?function(r){return r==null?[]:(r=Object(r),wv(tu(r),function(t){return Nv.call(r,t)}))}:Tv;function Cv(r,t,e){var n=t(r);return nn(r)?n:fv(n,e(r))}function $a(r){return Cv(r,Mg,Lv)}var Ua=ln(Tr,"DataView"),Ha=ln(Tr,"Promise"),za=ln(Tr,"Set"),eu="[object Map]",xv="[object Object]",ru="[object Promise]",nu="[object Set]",iu="[object WeakMap]",su="[object DataView]",Iv=an(Ua),qv=an(si),Pv=an(Ha),Dv=an(za),Mv=an(Ba),or=kn;(Ua&&or(new Ua(new ArrayBuffer(1)))!=su||si&&or(new si)!=eu||Ha&&or(Ha.resolve())!=ru||za&&or(new za)!=nu||Ba&&or(new Ba)!=iu)&&(or=function(r){var t=kn(r),e=t==xv?r.constructor:void 0,n=e?an(e):"";if(n)switch(n){case Iv:return su;case qv:return eu;case Pv:return ru;case Dv:return nu;case Mv:return iu}return t});var jv=Object.prototype,kv=jv.hasOwnProperty;function Bv(r){var t=r.length,e=new r.constructor(t);return t&&typeof r[0]=="string"&&kv.call(r,"index")&&(e.index=r.index,e.input=r.input),e}var ts=Tr.Uint8Array;function pl(r){var t=new r.constructor(r.byteLength);return new ts(t).set(new ts(r)),t}function Fv(r,t){var e=pl(r.buffer);return new r.constructor(e,r.byteOffset,r.byteLength)}var $v=/\w*$/;function Uv(r){var t=new r.constructor(r.source,$v.exec(r));return t.lastIndex=r.lastIndex,t}var ou=Xr?Xr.prototype:void 0,au=ou?ou.valueOf:void 0;function Hv(r){return au?Object(au.call(r)):{}}function eh(r,t){var e=t?pl(r.buffer):r.buffer;return new r.constructor(e,r.byteOffset,r.length)}var zv="[object Boolean]",Vv="[object Date]",Gv="[object Map]",Wv="[object Number]",Kv="[object RegExp]",Yv="[object Set]",Xv="[object String]",Zv="[object Symbol]",Jv="[object ArrayBuffer]",Qv="[object DataView]",tm="[object Float32Array]",em="[object Float64Array]",rm="[object Int8Array]",nm="[object Int16Array]",im="[object Int32Array]",sm="[object Uint8Array]",om="[object Uint8ClampedArray]",am="[object Uint16Array]",lm="[object Uint32Array]";function um(r,t,e){var n=r.constructor;switch(t){case Jv:return pl(r);case zv:case Vv:return new n(+r);case Qv:return Fv(r);case tm:case em:case rm:case nm:case im:case sm:case om:case am:case lm:return eh(r,e);case Gv:return new n;case Wv:case Xv:return new n(r);case Kv:return Uv(r);case Yv:return new n;case Zv:return Hv(r)}}function rh(r){return typeof r.constructor=="function"&&!fl(r)?Lp(Zf(r)):{}}var cm="[object Map]";function fm(r){return xr(r)&&or(r)==cm}var lu=Cn&&Cn.isMap,hm=lu?hl(lu):fm,dm="[object Set]";function pm(r){return xr(r)&&or(r)==dm}var uu=Cn&&Cn.isSet,gm=uu?hl(uu):pm,vm=1,nh="[object Arguments]",mm="[object Array]",ym="[object Boolean]",bm="[object Date]",_m="[object Error]",ih="[object Function]",Em="[object GeneratorFunction]",Am="[object Map]",Om="[object Number]",sh="[object Object]",Sm="[object RegExp]",wm="[object Set]",Tm="[object String]",Rm="[object Symbol]",Nm="[object WeakMap]",Lm="[object ArrayBuffer]",Cm="[object DataView]",xm="[object Float32Array]",Im="[object Float64Array]",qm="[object Int8Array]",Pm="[object Int16Array]",Dm="[object Int32Array]",Mm="[object Uint8Array]",jm="[object Uint8ClampedArray]",km="[object Uint16Array]",Bm="[object Uint32Array]",Qt={};Qt[nh]=Qt[mm]=Qt[Lm]=Qt[Cm]=Qt[ym]=Qt[bm]=Qt[xm]=Qt[Im]=Qt[qm]=Qt[Pm]=Qt[Dm]=Qt[Am]=Qt[Om]=Qt[sh]=Qt[Sm]=Qt[wm]=Qt[Tm]=Qt[Rm]=Qt[Mm]=Qt[jm]=Qt[km]=Qt[Bm]=!0;Qt[_m]=Qt[ih]=Qt[Nm]=!1;function Yi(r,t,e,n,i,s){var l,u=t&vm;if(l!==void 0)return l;if(!Zr(r))return r;var a=nn(r);if(a)l=Bv(r);else{var o=or(r),c=o==ih||o==Em;if(ni(r))return th(r,u);if(o==sh||o==nh||c&&!i)l=c?{}:rh(r);else{if(!Qt[o])return i?r:{};l=um(r,o,u)}}s||(s=new Ar);var v=s.get(r);if(v)return v;s.set(r,l),gm(r)?r.forEach(function(y){l.add(Yi(y,t,e,y,r,s))}):hm(r)&&r.forEach(function(y,A){l.set(A,Yi(y,t,e,A,r,s))});var p=$a,d=a?void 0:p(r);return Bp(d||r,function(y,A){d&&(A=y,y=r[A]),Hf(l,A,Yi(y,t,e,A,r,s))}),l}var Fm=1,$m=4;function Rn(r){return Yi(r,Fm|$m)}var Um="__lodash_hash_undefined__";function Hm(r){return this.__data__.set(r,Um),this}function zm(r){return this.__data__.has(r)}function es(r){var t=-1,e=r==null?0:r.length;for(this.__data__=new un;++t<e;)this.add(r[t])}es.prototype.add=es.prototype.push=Hm;es.prototype.has=zm;function Vm(r,t){for(var e=-1,n=r==null?0:r.length;++e<n;)if(t(r[e],e,r))return!0;return!1}function Gm(r,t){return r.has(t)}var Wm=1,Km=2;function oh(r,t,e,n,i,s){var l=e&Wm,u=r.length,a=t.length;if(u!=a&&!(l&&a>u))return!1;var o=s.get(r),c=s.get(t);if(o&&c)return o==t&&c==r;var v=-1,p=!0,d=e&Km?new es:void 0;for(s.set(r,t),s.set(t,r);++v<u;){var y=r[v],A=t[v];if(n)var O=l?n(A,y,v,t,r,s):n(y,A,v,r,t,s);if(O!==void 0){if(O)continue;p=!1;break}if(d){if(!Vm(t,function(E,_){if(!Gm(d,_)&&(y===E||i(y,E,e,n,s)))return d.push(_)})){p=!1;break}}else if(!(y===A||i(y,A,e,n,s))){p=!1;break}}return s.delete(r),s.delete(t),p}function Ym(r){var t=-1,e=Array(r.size);return r.forEach(function(n,i){e[++t]=[i,n]}),e}function Xm(r){var t=-1,e=Array(r.size);return r.forEach(function(n){e[++t]=n}),e}var Zm=1,Jm=2,Qm="[object Boolean]",ty="[object Date]",ey="[object Error]",ry="[object Map]",ny="[object Number]",iy="[object RegExp]",sy="[object Set]",oy="[object String]",ay="[object Symbol]",ly="[object ArrayBuffer]",uy="[object DataView]",cu=Xr?Xr.prototype:void 0,Gs=cu?cu.valueOf:void 0;function cy(r,t,e,n,i,s,l){switch(e){case uy:if(r.byteLength!=t.byteLength||r.byteOffset!=t.byteOffset)return!1;r=r.buffer,t=t.buffer;case ly:return!(r.byteLength!=t.byteLength||!s(new ts(r),new ts(t)));case Qm:case ty:case ny:return gi(+r,+t);case ey:return r.name==t.name&&r.message==t.message;case iy:case oy:return r==t+"";case ry:var u=Ym;case sy:var a=n&Zm;if(u||(u=Xm),r.size!=t.size&&!a)return!1;var o=l.get(r);if(o)return o==t;n|=Jm,l.set(r,t);var c=oh(u(r),u(t),n,i,s,l);return l.delete(r),c;case ay:if(Gs)return Gs.call(r)==Gs.call(t)}return!1}var fy=1,hy=Object.prototype,dy=hy.hasOwnProperty;function py(r,t,e,n,i,s){var l=e&fy,u=$a(r),a=u.length,o=$a(t),c=o.length;if(a!=c&&!l)return!1;for(var v=a;v--;){var p=u[v];if(!(l?p in t:dy.call(t,p)))return!1}var d=s.get(r),y=s.get(t);if(d&&y)return d==t&&y==r;var A=!0;s.set(r,t),s.set(t,r);for(var O=l;++v<a;){p=u[v];var E=r[p],_=t[p];if(n)var h=l?n(_,E,p,t,r,s):n(E,_,p,r,t,s);if(!(h===void 0?E===_||i(E,_,e,n,s):h)){A=!1;break}O||(O=p=="constructor")}if(A&&!O){var f=r.constructor,g=t.constructor;f!=g&&"constructor"in r&&"constructor"in t&&!(typeof f=="function"&&f instanceof f&&typeof g=="function"&&g instanceof g)&&(A=!1)}return s.delete(r),s.delete(t),A}var gy=1,fu="[object Arguments]",hu="[object Array]",Di="[object Object]",vy=Object.prototype,du=vy.hasOwnProperty;function my(r,t,e,n,i,s){var l=nn(r),u=nn(t),a=l?hu:or(r),o=u?hu:or(t);a=a==fu?Di:a,o=o==fu?Di:o;var c=a==Di,v=o==Di,p=a==o;if(p&&ni(r)){if(!ni(t))return!1;l=!0,c=!1}if(p&&!c)return s||(s=new Ar),l||dl(r)?oh(r,t,e,n,i,s):cy(r,t,a,e,n,i,s);if(!(e&gy)){var d=c&&du.call(r,"__wrapped__"),y=v&&du.call(t,"__wrapped__");if(d||y){var A=d?r.value():r,O=y?t.value():t;return s||(s=new Ar),i(A,O,e,n,s)}}return p?(s||(s=new Ar),py(r,t,e,n,i,s)):!1}function ah(r,t,e,n,i){return r===t?!0:r==null||t==null||!xr(r)&&!xr(t)?r!==r&&t!==t:my(r,t,e,n,ah,i)}function yy(r){return function(t,e,n){for(var i=-1,s=Object(t),l=n(t),u=l.length;u--;){var a=l[++i];if(e(s[a],a,s)===!1)break}return t}}var by=yy();function Va(r,t,e){(e!==void 0&&!gi(r[t],e)||e===void 0&&!(t in r))&&cl(r,t,e)}function _y(r){return xr(r)&&Es(r)}function Ga(r,t){if(!(t==="constructor"&&typeof r[t]=="function")&&t!="__proto__")return r[t]}function Ey(r){return zp(r,Xf(r))}function Ay(r,t,e,n,i,s,l){var u=Ga(r,e),a=Ga(t,e),o=l.get(a);if(o){Va(r,e,o);return}var c=s?s(u,a,e+"",r,t,l):void 0,v=c===void 0;if(v){var p=nn(a),d=!p&&ni(a),y=!p&&!d&&dl(a);c=a,p||d||y?nn(u)?c=u:_y(u)?c=xp(u):d?(v=!1,c=th(a,!0)):y?(v=!1,c=eh(a,!0)):c=[]:mv(a)||Fa(a)?(c=u,Fa(u)?c=Ey(u):(!Zr(u)||ul(u))&&(c=rh(a))):v=!1}v&&(l.set(a,c),i(c,a,n,s,l),l.delete(a)),Va(r,e,c)}function lh(r,t,e,n,i){r!==t&&by(t,function(s,l){if(i||(i=new Ar),Zr(s))Ay(r,t,l,e,lh,n,i);else{var u=n?n(Ga(r,l),s,l+"",r,t,i):void 0;u===void 0&&(u=s),Va(r,l,u)}},Xf)}function gl(r,t){return ah(r,t)}var Wr=Yp(function(r,t,e){lh(r,t,e)}),gt=(r=>(r[r.TYPE=3]="TYPE",r[r.LEVEL=12]="LEVEL",r[r.ATTRIBUTE=13]="ATTRIBUTE",r[r.BLOT=14]="BLOT",r[r.INLINE=7]="INLINE",r[r.BLOCK=11]="BLOCK",r[r.BLOCK_BLOT=10]="BLOCK_BLOT",r[r.INLINE_BLOT=6]="INLINE_BLOT",r[r.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",r[r.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",r[r.ANY=15]="ANY",r))(gt||{});class Sr{constructor(t,e,n={}){this.attrName=t,this.keyName=e;const i=gt.TYPE&gt.ATTRIBUTE;this.scope=n.scope!=null?n.scope&gt.LEVEL|i:gt.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(t){return Array.from(t.attributes).map(e=>e.name)}add(t,e){return this.canAdd(t,e)?(t.setAttribute(this.keyName,e),!0):!1}canAdd(t,e){return this.whitelist==null?!0:typeof e=="string"?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class Nn extends Error{constructor(t){t="[Parchment] "+t,super(t),this.message=t,this.name=this.constructor.name}}const uh=class Wa{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(t==null)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let n=null;try{n=t.parentNode}catch{return null}return this.find(n,e)}return null}create(t,e,n){const i=this.query(e);if(i==null)throw new Nn(`Unable to create ${e} blot`);const s=i,l=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:s.create(n),u=new s(t,l,n);return Wa.blots.set(u.domNode,u),u}find(t,e=!1){return Wa.find(t,e)}query(t,e=gt.ANY){let n;return typeof t=="string"?n=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?n=this.types.text:typeof t=="number"?t&gt.LEVEL&gt.BLOCK?n=this.types.block:t&gt.LEVEL&gt.INLINE&&(n=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some(i=>(n=this.classes[i],!!n)),n=n||this.tags[t.tagName]),n==null?null:"scope"in n&&e&gt.LEVEL&n.scope&&e&gt.TYPE&n.scope?n:null}register(...t){return t.map(e=>{const n="blotName"in e,i="attrName"in e;if(!n&&!i)throw new Nn("Invalid definition");if(n&&e.blotName==="abstract")throw new Nn("Cannot register abstract class");const s=n?e.blotName:i?e.attrName:void 0;return this.types[s]=e,i?typeof e.keyName=="string"&&(this.attributes[e.keyName]=e):n&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(l=>l.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(l=>{(this.tags[l]==null||e.className==null)&&(this.tags[l]=e)}))),e})}};uh.blots=new WeakMap;let xn=uh;function pu(r,t){return(r.getAttribute("class")||"").split(/\s+/).filter(e=>e.indexOf(`${t}-`)===0)}class Oy extends Sr{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(t,e){return this.canAdd(t,e)?(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0):!1}remove(t){pu(t,this.keyName).forEach(e=>{t.classList.remove(e)}),t.classList.length===0&&t.removeAttribute("class")}value(t){const e=(pu(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}}const fr=Oy;function Ws(r){const t=r.split("-"),e=t.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return t[0]+e}class Sy extends Sr{static keys(t){return(t.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(t,e){return this.canAdd(t,e)?(t.style[Ws(this.keyName)]=e,!0):!1}remove(t){t.style[Ws(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[Ws(this.keyName)];return this.canAdd(t,e)?e:""}}const Jr=Sy;class wy{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(t.value(this.domNode)!=null?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=xn.find(this.domNode);if(t==null)return;const e=Sr.keys(this.domNode),n=fr.keys(this.domNode),i=Jr.keys(this.domNode);e.concat(n).concat(i).forEach(s=>{const l=t.scroll.query(s,gt.ATTRIBUTE);l instanceof Sr&&(this.attributes[l.attrName]=l)})}copy(t){Object.keys(this.attributes).forEach(e=>{const n=this.attributes[e].value(this.domNode);t.format(e,n)})}move(t){this.copy(t),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t),{})}}const Ss=wy,ch=class{constructor(t,e){this.scroll=t,this.domNode=e,xn.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(this.tagName==null)throw new Nn("Blot definition missing tagName");let e,n;return Array.isArray(this.tagName)?(typeof t=="string"?(n=t.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof t=="number"&&(n=t),typeof n=="number"?e=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?e=document.createElement(n):e=document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){this.parent!=null&&this.parent.removeChild(this),xn.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,n,i){const s=this.isolate(t,e);if(this.scroll.query(n,gt.BLOT)!=null&&i)s.wrap(n,i);else if(this.scroll.query(n,gt.ATTRIBUTE)!=null){const l=this.scroll.create(this.statics.scope);s.wrap(l),l.format(n,i)}}insertAt(t,e,n){const i=n==null?this.scroll.create("text",e):this.scroll.create(e,n),s=this.split(t);this.parent.insertBefore(i,s||void 0)}isolate(t,e){const n=this.split(t);if(n==null)throw new Error("Attempt to isolate at end");return n.split(e),n}length(){return 1}offset(t=this.parent){return this.parent==null||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const n=typeof t=="string"?this.scroll.create(t,e):t;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(t,e){return t===0?this:this.next}update(t,e){}wrap(t,e){const n=typeof t=="string"?this.scroll.create(t,e):t;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new Nn(`Cannot wrap ${t}`);return n.appendChild(this),n}};ch.blotName="abstract";let fh=ch;const hh=class extends fh{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};hh.scope=gt.INLINE_BLOT;let Ty=hh;const Re=Ty;class Ry{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let n=e();for(;n&&t>0;)t-=1,n=e();return n}contains(t){const e=this.iterator();let n=e();for(;n;){if(n===t)return!0;n=e()}return!1}indexOf(t){const e=this.iterator();let n=e(),i=0;for(;n;){if(n===t)return i;i+=1,n=e()}return-1}insertBefore(t,e){t!=null&&(this.remove(t),t.next=e,e!=null?(t.prev=e.prev,e.prev!=null&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,n=this.head;for(;n!=null;){if(n===t)return e;e+=n.length(),n=n.next}return-1}remove(t){this.contains(t)&&(t.prev!=null&&(t.prev.next=t.next),t.next!=null&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return t!=null&&(t=t.next),e}}find(t,e=!1){const n=this.iterator();let i=n();for(;i;){const s=i.length();if(t<s||e&&t===s&&(i.next==null||i.next.length()!==0))return[i,t];t-=s,i=n()}return[null,0]}forEach(t){const e=this.iterator();let n=e();for(;n;)t(n),n=e()}forEachAt(t,e,n){if(e<=0)return;const[i,s]=this.find(t);let l=t-s;const u=this.iterator(i);let a=u();for(;a&&l<t+e;){const o=a.length();t>l?n(a,t-l,Math.min(e,l+o-t)):n(a,0,Math.min(o,t+e-l)),l+=o,a=u()}}map(t){return this.reduce((e,n)=>(e.push(t(n)),e),[])}reduce(t,e){const n=this.iterator();let i=n();for(;i;)e=t(e,i),i=n();return e}}function gu(r,t){const e=t.find(r);if(e)return e;try{return t.create(r)}catch{const n=t.create(gt.INLINE);return Array.from(r.childNodes).forEach(i=>{n.domNode.appendChild(i)}),r.parentNode&&r.parentNode.replaceChild(n.domNode,r),n.attach(),n}}const dh=class zr extends fh{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach(t=>{t.attach()})}attachUI(t){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=t,zr.uiClass&&this.uiNode.classList.add(zr.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Ry,Array.from(this.domNode.childNodes).filter(t=>t!==this.uiNode).reverse().forEach(t=>{try{const e=gu(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(e){if(e instanceof Nn)return;throw e}})}deleteAt(t,e){if(t===0&&e===this.length())return this.remove();this.children.forEachAt(t,e,(n,i,s)=>{n.deleteAt(i,s)})}descendant(t,e=0){const[n,i]=this.children.find(e);return t.blotName==null&&t(n)||t.blotName!=null&&n instanceof t?[n,i]:n instanceof zr?n.descendant(t,i):[null,-1]}descendants(t,e=0,n=Number.MAX_VALUE){let i=[],s=n;return this.children.forEachAt(e,n,(l,u,a)=>{(t.blotName==null&&t(l)||t.blotName!=null&&l instanceof t)&&i.push(l),l instanceof zr&&(i=i.concat(l.descendants(t,u,s))),s-=a}),i}detach(){this.children.forEach(t=>{t.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(e=>{t||this.statics.allowedChildren.some(n=>e instanceof n)||(e.statics.scope===gt.BLOCK_BLOT?(e.next!=null&&this.splitAfter(e),e.prev!=null&&this.splitAfter(e.prev),e.parent.unwrap(),t=!0):e instanceof zr?e.unwrap():e.remove())})}formatAt(t,e,n,i){this.children.forEachAt(t,e,(s,l,u)=>{s.formatAt(l,u,n,i)})}insertAt(t,e,n){const[i,s]=this.children.find(t);if(i)i.insertAt(s,e,n);else{const l=n==null?this.scroll.create("text",e):this.scroll.create(e,n);this.appendChild(l)}}insertBefore(t,e){t.parent!=null&&t.parent.children.remove(t);let n=null;this.children.insertBefore(t,e||null),t.parent=this,e!=null&&(n=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(t.domNode,n),t.attach()}length(){return this.children.reduce((t,e)=>t+e.length(),0)}moveChildren(t,e){this.children.forEach(n=>{t.insertBefore(n,e)})}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(t,e=!1){const[n,i]=this.children.find(t,e),s=[[this,t]];return n instanceof zr?s.concat(n.path(i,e)):(n!=null&&s.push([n,i]),s)}removeChild(t){this.children.remove(t)}replaceWith(t,e){const n=typeof t=="string"?this.scroll.create(t,e):t;return n instanceof zr&&this.moveChildren(n),super.replaceWith(n)}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(t,this.length(),(i,s,l)=>{const u=i.split(s,e);u!=null&&n.appendChild(u)}),n}splitAfter(t){const e=this.clone();for(;t.next!=null;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const n=[],i=[];t.forEach(s=>{s.target===this.domNode&&s.type==="childList"&&(n.push(...s.addedNodes),i.push(...s.removedNodes))}),i.forEach(s=>{if(s.parentNode!=null&&s.tagName!=="IFRAME"&&document.body.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const l=this.scroll.find(s);l!=null&&(l.domNode.parentNode==null||l.domNode.parentNode===this.domNode)&&l.detach()}),n.filter(s=>s.parentNode===this.domNode&&s!==this.uiNode).sort((s,l)=>s===l?0:s.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(s=>{let l=null;s.nextSibling!=null&&(l=this.scroll.find(s.nextSibling));const u=gu(s,this.scroll);(u.next!==l||u.next==null)&&(u.parent!=null&&u.parent.removeChild(this),this.insertBefore(u,l||void 0))}),this.enforceAllowedChildren()}};dh.uiClass="";let Ny=dh;const lr=Ny;function Ly(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}const En=class An extends lr{static create(t){return super.create(t)}static formats(t,e){const n=e.query(An.blotName);if(!(n!=null&&t.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new Ss(this.domNode)}format(t,e){if(t===this.statics.blotName&&!e)this.children.forEach(n=>{n instanceof An||(n=n.wrap(An.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{const n=this.scroll.query(t,gt.INLINE);if(n==null)return;n instanceof Sr?this.attributes.attribute(n,e):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e)}}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,n,i){this.formats()[n]!=null||this.scroll.query(n,gt.ATTRIBUTE)?this.isolate(t,e).format(n,i):super.formatAt(t,e,n,i)}optimize(t){super.optimize(t);const e=this.formats();if(Object.keys(e).length===0)return this.unwrap();const n=this.next;n instanceof An&&n.prev===this&&Ly(e,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(t,e){const n=super.replaceWith(t,e);return this.attributes.copy(n),n}update(t,e){super.update(t,e),t.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(t,e){const n=super.wrap(t,e);return n instanceof An&&this.attributes.move(n),n}};En.allowedChildren=[En,Re],En.blotName="inline",En.scope=gt.INLINE_BLOT,En.tagName="SPAN";let Cy=En;const vl=Cy,On=class Ka extends lr{static create(t){return super.create(t)}static formats(t,e){const n=e.query(Ka.blotName);if(!(n!=null&&t.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new Ss(this.domNode)}format(t,e){const n=this.scroll.query(t,gt.BLOCK);n!=null&&(n instanceof Sr?this.attributes.attribute(n,e):t===this.statics.blotName&&!e?this.replaceWith(Ka.blotName):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,n,i){this.scroll.query(n,gt.BLOCK)!=null?this.format(n,i):super.formatAt(t,e,n,i)}insertAt(t,e,n){if(n==null||this.scroll.query(e,gt.INLINE)!=null)super.insertAt(t,e,n);else{const i=this.split(t);if(i!=null){const s=this.scroll.create(e,n);i.parent.insertBefore(s,i)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(t,e){const n=super.replaceWith(t,e);return this.attributes.copy(n),n}update(t,e){super.update(t,e),t.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};On.blotName="block",On.scope=gt.BLOCK_BLOT,On.tagName="P",On.allowedChildren=[vl,On,Re];let xy=On;const oi=xy,Ya=class extends lr{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,n,i){super.formatAt(t,e,n,i),this.enforceAllowedChildren()}insertAt(t,e,n){super.insertAt(t,e,n),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Ya.blotName="container",Ya.scope=gt.BLOCK_BLOT;let Iy=Ya;const ws=Iy;class qy extends Re{static formats(t,e){}format(t,e){super.formatAt(0,this.length(),t,e)}formatAt(t,e,n,i){t===0&&e===this.length()?this.format(n,i):super.formatAt(t,e,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Ve=qy,Py={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Dy=100,Sn=class extends lr{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,Py),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const n=this.registry.find(t,e);return n?n.scroll===this?n:e?this.find(n.scroll.domNode.parentNode,!0):null:null}query(t,e=gt.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),t===0&&e===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(t,e)}formatAt(t,e,n,i){this.update(),super.formatAt(t,e,n,i)}insertAt(t,e,n){this.update(),super.insertAt(t,e,n)}optimize(t=[],e={}){super.optimize(e);const n=e.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)t.push(i.pop());const s=(a,o=!0)=>{a==null||a===this||a.domNode.parentNode!=null&&(n.has(a.domNode)||n.set(a.domNode,[]),o&&s(a.parent))},l=a=>{n.has(a.domNode)&&(a instanceof lr&&a.children.forEach(l),n.delete(a.domNode),a.optimize(e))};let u=t;for(let a=0;u.length>0;a+=1){if(a>=Dy)throw new Error("[Parchment] Maximum optimize iterations reached");for(u.forEach(o=>{const c=this.find(o.target,!0);c!=null&&(c.domNode===o.target&&(o.type==="childList"?(s(this.find(o.previousSibling,!1)),Array.from(o.addedNodes).forEach(v=>{const p=this.find(v,!1);s(p,!1),p instanceof lr&&p.children.forEach(d=>{s(d,!1)})})):o.type==="attributes"&&s(c.prev)),s(c))}),this.children.forEach(l),u=Array.from(this.observer.takeRecords()),i=u.slice();i.length>0;)t.push(i.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const n=new WeakMap;t.map(i=>{const s=this.find(i.target,!0);return s==null?null:n.has(s.domNode)?(n.get(s.domNode).push(i),null):(n.set(s.domNode,[i]),s)}).forEach(i=>{i!=null&&i!==this&&n.has(i.domNode)&&i.update(n.get(i.domNode)||[],e)}),e.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),e),this.optimize(t,e)}};Sn.blotName="scroll",Sn.defaultChild=oi,Sn.allowedChildren=[oi,ws],Sn.scope=gt.BLOCK_BLOT,Sn.tagName="DIV";let My=Sn;const ml=My,Xa=class ph extends Re{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,n){n==null?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,n)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof ph&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(t,e){t.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Xa.blotName="text",Xa.scope=gt.INLINE_BLOT;let jy=Xa;const rs=jy,ky=Object.freeze(Object.defineProperty({__proto__:null,Attributor:Sr,AttributorStore:Ss,BlockBlot:oi,ClassAttributor:fr,ContainerBlot:ws,EmbedBlot:Ve,InlineBlot:vl,LeafBlot:Re,ParentBlot:lr,Registry:xn,Scope:gt,ScrollBlot:ml,StyleAttributor:Jr,TextBlot:rs},Symbol.toStringTag,{value:"Module"}));function vi(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function By(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var t=r.default;if(typeof t=="function"){var e=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),e}var Mi={exports:{}},Ks,vu;function Fy(){if(vu)return Ks;vu=1;var r=-1,t=1,e=0;function n(w,M,R,I,D){if(w===M)return w?[[e,w]]:[];if(R!=null){var x=C(w,M,R);if(x)return x}var $=u(w,M),V=w.substring(0,$);w=w.substring($),M=M.substring($),$=o(w,M);var Q=w.substring(w.length-$);w=w.substring(0,w.length-$),M=M.substring(0,M.length-$);var Y=i(w,M);return V&&Y.unshift([e,V]),Q&&Y.push([e,Q]),_(Y,D),I&&v(Y),Y}function i(w,M){var R;if(!w)return[[t,M]];if(!M)return[[r,w]];var I=w.length>M.length?w:M,D=w.length>M.length?M:w,x=I.indexOf(D);if(x!==-1)return R=[[t,I.substring(0,x)],[e,D],[t,I.substring(x+D.length)]],w.length>M.length&&(R[0][0]=R[2][0]=r),R;if(D.length===1)return[[r,w],[t,M]];var $=c(w,M);if($){var V=$[0],Q=$[1],Y=$[2],st=$[3],rt=$[4],L=n(V,Y),B=n(Q,st);return L.concat([[e,rt]],B)}return s(w,M)}function s(w,M){for(var R=w.length,I=M.length,D=Math.ceil((R+I)/2),x=D,$=2*D,V=new Array($),Q=new Array($),Y=0;Y<$;Y++)V[Y]=-1,Q[Y]=-1;V[x+1]=0,Q[x+1]=0;for(var st=R-I,rt=st%2!==0,L=0,B=0,F=0,tt=0,it=0;it<D;it++){for(var H=-it+L;H<=it-B;H+=2){var k=x+H,z;H===-it||H!==it&&V[k-1]<V[k+1]?z=V[k+1]:z=V[k-1]+1;for(var X=z-H;z<R&&X<I&&w.charAt(z)===M.charAt(X);)z++,X++;if(V[k]=z,z>R)B+=2;else if(X>I)L+=2;else if(rt){var J=x+st-H;if(J>=0&&J<$&&Q[J]!==-1){var nt=R-Q[J];if(z>=nt)return l(w,M,z,X)}}}for(var lt=-it+F;lt<=it-tt;lt+=2){var J=x+lt,nt;lt===-it||lt!==it&&Q[J-1]<Q[J+1]?nt=Q[J+1]:nt=Q[J-1]+1;for(var dt=nt-lt;nt<R&&dt<I&&w.charAt(R-nt-1)===M.charAt(I-dt-1);)nt++,dt++;if(Q[J]=nt,nt>R)tt+=2;else if(dt>I)F+=2;else if(!rt){var k=x+st-lt;if(k>=0&&k<$&&V[k]!==-1){var z=V[k],X=x+z-k;if(nt=R-nt,z>=nt)return l(w,M,z,X)}}}}return[[r,w],[t,M]]}function l(w,M,R,I){var D=w.substring(0,R),x=M.substring(0,I),$=w.substring(R),V=M.substring(I),Q=n(D,x),Y=n($,V);return Q.concat(Y)}function u(w,M){if(!w||!M||w.charAt(0)!==M.charAt(0))return 0;for(var R=0,I=Math.min(w.length,M.length),D=I,x=0;R<D;)w.substring(x,D)==M.substring(x,D)?(R=D,x=R):I=D,D=Math.floor((I-R)/2+R);return h(w.charCodeAt(D-1))&&D--,D}function a(w,M){var R=w.length,I=M.length;if(R==0||I==0)return 0;R>I?w=w.substring(R-I):R<I&&(M=M.substring(0,R));var D=Math.min(R,I);if(w==M)return D;for(var x=0,$=1;;){var V=w.substring(D-$),Q=M.indexOf(V);if(Q==-1)return x;$+=Q,(Q==0||w.substring(D-$)==M.substring(0,$))&&(x=$,$++)}}function o(w,M){if(!w||!M||w.slice(-1)!==M.slice(-1))return 0;for(var R=0,I=Math.min(w.length,M.length),D=I,x=0;R<D;)w.substring(w.length-D,w.length-x)==M.substring(M.length-D,M.length-x)?(R=D,x=R):I=D,D=Math.floor((I-R)/2+R);return f(w.charCodeAt(w.length-D))&&D--,D}function c(w,M){var R=w.length>M.length?w:M,I=w.length>M.length?M:w;if(R.length<4||I.length*2<R.length)return null;function D(B,F,tt){for(var it=B.substring(tt,tt+Math.floor(B.length/4)),H=-1,k="",z,X,J,nt;(H=F.indexOf(it,H+1))!==-1;){var lt=u(B.substring(tt),F.substring(H)),dt=o(B.substring(0,tt),F.substring(0,H));k.length<dt+lt&&(k=F.substring(H-dt,H)+F.substring(H,H+lt),z=B.substring(0,tt-dt),X=B.substring(tt+lt),J=F.substring(0,H-dt),nt=F.substring(H+lt))}return k.length*2>=B.length?[z,X,J,nt,k]:null}var x=D(R,I,Math.ceil(R.length/4)),$=D(R,I,Math.ceil(R.length/2)),V;if(!x&&!$)return null;$?x?V=x[4].length>$[4].length?x:$:V=$:V=x;var Q,Y,st,rt;w.length>M.length?(Q=V[0],Y=V[1],st=V[2],rt=V[3]):(st=V[0],rt=V[1],Q=V[2],Y=V[3]);var L=V[4];return[Q,Y,st,rt,L]}function v(w){for(var M=!1,R=[],I=0,D=null,x=0,$=0,V=0,Q=0,Y=0;x<w.length;)w[x][0]==e?(R[I++]=x,$=Q,V=Y,Q=0,Y=0,D=w[x][1]):(w[x][0]==t?Q+=w[x][1].length:Y+=w[x][1].length,D&&D.length<=Math.max($,V)&&D.length<=Math.max(Q,Y)&&(w.splice(R[I-1],0,[r,D]),w[R[I-1]+1][0]=t,I--,I--,x=I>0?R[I-1]:-1,$=0,V=0,Q=0,Y=0,D=null,M=!0)),x++;for(M&&_(w),E(w),x=1;x<w.length;){if(w[x-1][0]==r&&w[x][0]==t){var st=w[x-1][1],rt=w[x][1],L=a(st,rt),B=a(rt,st);L>=B?(L>=st.length/2||L>=rt.length/2)&&(w.splice(x,0,[e,rt.substring(0,L)]),w[x-1][1]=st.substring(0,st.length-L),w[x+1][1]=rt.substring(L),x++):(B>=st.length/2||B>=rt.length/2)&&(w.splice(x,0,[e,st.substring(0,B)]),w[x-1][0]=t,w[x-1][1]=rt.substring(0,rt.length-B),w[x+1][0]=r,w[x+1][1]=st.substring(B),x++),x++}x++}}var p=/[^a-zA-Z0-9]/,d=/\s/,y=/[\r\n]/,A=/\n\r?\n$/,O=/^\r?\n\r?\n/;function E(w){function M(B,F){if(!B||!F)return 6;var tt=B.charAt(B.length-1),it=F.charAt(0),H=tt.match(p),k=it.match(p),z=H&&tt.match(d),X=k&&it.match(d),J=z&&tt.match(y),nt=X&&it.match(y),lt=J&&B.match(A),dt=nt&&F.match(O);return lt||dt?5:J||nt?4:H&&!z&&X?3:z||X?2:H||k?1:0}for(var R=1;R<w.length-1;){if(w[R-1][0]==e&&w[R+1][0]==e){var I=w[R-1][1],D=w[R][1],x=w[R+1][1],$=o(I,D);if($){var V=D.substring(D.length-$);I=I.substring(0,I.length-$),D=V+D.substring(0,D.length-$),x=V+x}for(var Q=I,Y=D,st=x,rt=M(I,D)+M(D,x);D.charAt(0)===x.charAt(0);){I+=D.charAt(0),D=D.substring(1)+x.charAt(0),x=x.substring(1);var L=M(I,D)+M(D,x);L>=rt&&(rt=L,Q=I,Y=D,st=x)}w[R-1][1]!=Q&&(Q?w[R-1][1]=Q:(w.splice(R-1,1),R--),w[R][1]=Y,st?w[R+1][1]=st:(w.splice(R+1,1),R--))}R++}}function _(w,M){w.push([e,""]);for(var R=0,I=0,D=0,x="",$="",V;R<w.length;){if(R<w.length-1&&!w[R][1]){w.splice(R,1);continue}switch(w[R][0]){case t:D++,$+=w[R][1],R++;break;case r:I++,x+=w[R][1],R++;break;case e:var Q=R-D-I-1;if(M){if(Q>=0&&b(w[Q][1])){var Y=w[Q][1].slice(-1);if(w[Q][1]=w[Q][1].slice(0,-1),x=Y+x,$=Y+$,!w[Q][1]){w.splice(Q,1),R--;var st=Q-1;w[st]&&w[st][0]===t&&(D++,$=w[st][1]+$,st--),w[st]&&w[st][0]===r&&(I++,x=w[st][1]+x,st--),Q=st}}if(g(w[R][1])){var Y=w[R][1].charAt(0);w[R][1]=w[R][1].slice(1),x+=Y,$+=Y}}if(R<w.length-1&&!w[R][1]){w.splice(R,1);break}if(x.length>0||$.length>0){x.length>0&&$.length>0&&(V=u($,x),V!==0&&(Q>=0?w[Q][1]+=$.substring(0,V):(w.splice(0,0,[e,$.substring(0,V)]),R++),$=$.substring(V),x=x.substring(V)),V=o($,x),V!==0&&(w[R][1]=$.substring($.length-V)+w[R][1],$=$.substring(0,$.length-V),x=x.substring(0,x.length-V)));var rt=D+I;x.length===0&&$.length===0?(w.splice(R-rt,rt),R=R-rt):x.length===0?(w.splice(R-rt,rt,[t,$]),R=R-rt+1):$.length===0?(w.splice(R-rt,rt,[r,x]),R=R-rt+1):(w.splice(R-rt,rt,[r,x],[t,$]),R=R-rt+2)}R!==0&&w[R-1][0]===e?(w[R-1][1]+=w[R][1],w.splice(R,1)):R++,D=0,I=0,x="",$="";break}}w[w.length-1][1]===""&&w.pop();var L=!1;for(R=1;R<w.length-1;)w[R-1][0]===e&&w[R+1][0]===e&&(w[R][1].substring(w[R][1].length-w[R-1][1].length)===w[R-1][1]?(w[R][1]=w[R-1][1]+w[R][1].substring(0,w[R][1].length-w[R-1][1].length),w[R+1][1]=w[R-1][1]+w[R+1][1],w.splice(R-1,1),L=!0):w[R][1].substring(0,w[R+1][1].length)==w[R+1][1]&&(w[R-1][1]+=w[R+1][1],w[R][1]=w[R][1].substring(w[R+1][1].length)+w[R+1][1],w.splice(R+1,1),L=!0)),R++;L&&_(w,M)}function h(w){return w>=55296&&w<=56319}function f(w){return w>=56320&&w<=57343}function g(w){return f(w.charCodeAt(0))}function b(w){return h(w.charCodeAt(w.length-1))}function S(w){for(var M=[],R=0;R<w.length;R++)w[R][1].length>0&&M.push(w[R]);return M}function N(w,M,R,I){return b(w)||g(I)?null:S([[e,w],[r,M],[t,R],[e,I]])}function C(w,M,R){var I=typeof R=="number"?{index:R,length:0}:R.oldRange,D=typeof R=="number"?null:R.newRange,x=w.length,$=M.length;if(I.length===0&&(D===null||D.length===0)){var V=I.index,Q=w.slice(0,V),Y=w.slice(V),st=D?D.index:null;t:{var rt=V+$-x;if(st!==null&&st!==rt||rt<0||rt>$)break t;var L=M.slice(0,rt),B=M.slice(rt);if(B!==Y)break t;var F=Math.min(V,rt),tt=Q.slice(0,F),it=L.slice(0,F);if(tt!==it)break t;var H=Q.slice(F),k=L.slice(F);return N(tt,H,k,Y)}t:{if(st!==null&&st!==V)break t;var z=V,L=M.slice(0,z),B=M.slice(z);if(L!==Q)break t;var X=Math.min(x-z,$-z),J=Y.slice(Y.length-X),nt=B.slice(B.length-X);if(J!==nt)break t;var H=Y.slice(0,Y.length-X),k=B.slice(0,B.length-X);return N(Q,H,k,J)}}if(I.length>0&&D&&D.length===0)t:{var tt=w.slice(0,I.index),J=w.slice(I.index+I.length),F=tt.length,X=J.length;if($<F+X)break t;var it=M.slice(0,F),nt=M.slice($-X);if(tt!==it||J!==nt)break t;var H=w.slice(F,x-X),k=M.slice(F,$-X);return N(tt,H,k,J)}return null}function P(w,M,R,I){return n(w,M,R,I,!0)}return P.INSERT=t,P.DELETE=r,P.EQUAL=e,Ks=P,Ks}var Yn={exports:{}};Yn.exports;var mu;function Ts(){return mu||(mu=1,(function(r,t){var e=200,n="__lodash_hash_undefined__",i=9007199254740991,s="[object Arguments]",l="[object Array]",u="[object Boolean]",a="[object Date]",o="[object Error]",c="[object Function]",v="[object GeneratorFunction]",p="[object Map]",d="[object Number]",y="[object Object]",A="[object Promise]",O="[object RegExp]",E="[object Set]",_="[object String]",h="[object Symbol]",f="[object WeakMap]",g="[object ArrayBuffer]",b="[object DataView]",S="[object Float32Array]",N="[object Float64Array]",C="[object Int8Array]",P="[object Int16Array]",w="[object Int32Array]",M="[object Uint8Array]",R="[object Uint8ClampedArray]",I="[object Uint16Array]",D="[object Uint32Array]",x=/[\\^$.*+?()[\]{}|]/g,$=/\w*$/,V=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[s]=Y[l]=Y[g]=Y[b]=Y[u]=Y[a]=Y[S]=Y[N]=Y[C]=Y[P]=Y[w]=Y[p]=Y[d]=Y[y]=Y[O]=Y[E]=Y[_]=Y[h]=Y[M]=Y[R]=Y[I]=Y[D]=!0,Y[o]=Y[c]=Y[f]=!1;var st=typeof window=="object"&&window&&window.Object===Object&&window,rt=typeof self=="object"&&self&&self.Object===Object&&self,L=st||rt||Function("return this")(),B=t&&!t.nodeType&&t,F=B&&!0&&r&&!r.nodeType&&r,tt=F&&F.exports===B;function it(m,T){return m.set(T[0],T[1]),m}function H(m,T){return m.add(T),m}function k(m,T){for(var q=-1,Z=m?m.length:0;++q<Z&&T(m[q],q,m)!==!1;);return m}function z(m,T){for(var q=-1,Z=T.length,wt=m.length;++q<Z;)m[wt+q]=T[q];return m}function X(m,T,q,Z){for(var wt=-1,yt=m?m.length:0;++wt<yt;)q=T(q,m[wt],wt,m);return q}function J(m,T){for(var q=-1,Z=Array(m);++q<m;)Z[q]=T(q);return Z}function nt(m,T){return m==null?void 0:m[T]}function lt(m){var T=!1;if(m!=null&&typeof m.toString!="function")try{T=!!(m+"")}catch{}return T}function dt(m){var T=-1,q=Array(m.size);return m.forEach(function(Z,wt){q[++T]=[wt,Z]}),q}function vt(m,T){return function(q){return m(T(q))}}function Ut(m){var T=-1,q=Array(m.size);return m.forEach(function(Z){q[++T]=Z}),q}var kt=Array.prototype,G=Function.prototype,Ot=Object.prototype,Nt=L["__core-js_shared__"],bt=(function(){var m=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""})(),Tt=G.toString,Et=Ot.hasOwnProperty,Vt=Ot.toString,Bt=RegExp("^"+Tt.call(Et).replace(x,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ct=tt?L.Buffer:void 0,Ft=L.Symbol,$t=L.Uint8Array,Dt=vt(Object.getPrototypeOf,Object),ge=Object.create,fe=Ot.propertyIsEnumerable,Ge=kt.splice,Ie=Object.getOwnPropertySymbols,Be=Ct?Ct.isBuffer:void 0,vr=vt(Object.keys,Object),We=me(L,"DataView"),Ee=me(L,"Map"),ae=me(L,"Promise"),he=me(L,"Set"),le=me(L,"WeakMap"),ne=me(Object,"create"),Ke=se(We),de=se(Ee),Ye=se(ae),Fe=se(he),mr=se(le),qe=Ft?Ft.prototype:void 0,yr=qe?qe.valueOf:void 0;function ie(m){var T=-1,q=m?m.length:0;for(this.clear();++T<q;){var Z=m[T];this.set(Z[0],Z[1])}}function pe(){this.__data__=ne?ne(null):{}}function ve(m){return this.has(m)&&delete this.__data__[m]}function Xe(m){var T=this.__data__;if(ne){var q=T[m];return q===n?void 0:q}return Et.call(T,m)?T[m]:void 0}function Ae(m){var T=this.__data__;return ne?T[m]!==void 0:Et.call(T,m)}function Ze(m,T){var q=this.__data__;return q[m]=ne&&T===void 0?n:T,this}ie.prototype.clear=pe,ie.prototype.delete=ve,ie.prototype.get=Xe,ie.prototype.has=Ae,ie.prototype.set=Ze;function Wt(m){var T=-1,q=m?m.length:0;for(this.clear();++T<q;){var Z=m[T];this.set(Z[0],Z[1])}}function br(){this.__data__=[]}function jr(m){var T=this.__data__,q=ut(T,m);if(q<0)return!1;var Z=T.length-1;return q==Z?T.pop():Ge.call(T,q,1),!0}function $e(m){var T=this.__data__,q=ut(T,m);return q<0?void 0:T[q][1]}function Pe(m){return ut(this.__data__,m)>-1}function Rr(m,T){var q=this.__data__,Z=ut(q,m);return Z<0?q.push([m,T]):q[Z][1]=T,this}Wt.prototype.clear=br,Wt.prototype.delete=jr,Wt.prototype.get=$e,Wt.prototype.has=Pe,Wt.prototype.set=Rr;function Kt(m){var T=-1,q=m?m.length:0;for(this.clear();++T<q;){var Z=m[T];this.set(Z[0],Z[1])}}function kr(){this.__data__={hash:new ie,map:new(Ee||Wt),string:new ie}}function Je(m){return Se(this,m).delete(m)}function De(m){return Se(this,m).get(m)}function Br(m){return Se(this,m).has(m)}function U(m,T){return Se(this,m).set(m,T),this}Kt.prototype.clear=kr,Kt.prototype.delete=Je,Kt.prototype.get=De,Kt.prototype.has=Br,Kt.prototype.set=U;function W(m){this.__data__=new Wt(m)}function ot(){this.__data__=new Wt}function ft(m){return this.__data__.delete(m)}function qt(m){return this.__data__.get(m)}function At(m){return this.__data__.has(m)}function j(m,T){var q=this.__data__;if(q instanceof Wt){var Z=q.__data__;if(!Ee||Z.length<e-1)return Z.push([m,T]),this;q=this.__data__=new Kt(Z)}return q.set(m,T),this}W.prototype.clear=ot,W.prototype.delete=ft,W.prototype.get=qt,W.prototype.has=At,W.prototype.set=j;function K(m,T){var q=Un(m)||vn(m)?J(m.length,String):[],Z=q.length,wt=!!Z;for(var yt in m)Et.call(m,yt)&&!(wt&&(yt=="length"||Fr(yt,Z)))&&q.push(yt);return q}function at(m,T,q){var Z=m[T];(!(Et.call(m,T)&&Li(Z,q))||q===void 0&&!(T in m))&&(m[T]=q)}function ut(m,T){for(var q=m.length;q--;)if(Li(m[q][0],T))return q;return-1}function _t(m,T){return m&&re(T,zn(T),m)}function Mt(m,T,q,Z,wt,yt,zt){var Ht;if(Z&&(Ht=yt?Z(m,wt,yt,zt):Z(m)),Ht!==void 0)return Ht;if(!_r(m))return m;var oe=Un(m);if(oe){if(Ht=pn(m),!T)return Lt(m,Ht)}else{var Gt=ue(m),we=Gt==c||Gt==v;if(Ci(m))return Oe(m,T);if(Gt==y||Gt==s||we&&!yt){if(lt(m))return yt?m:{};if(Ht=xe(we?{}:m),!T)return Jt(m,_t(Ht,m))}else{if(!Y[Gt])return yt?m:{};Ht=en(m,Gt,Mt,T)}}zt||(zt=new W);var ke=zt.get(m);if(ke)return ke;if(zt.set(m,Ht),!oe)var ce=q?Ce(m):zn(m);return k(ce||m,function(Te,be){ce&&(be=Te,Te=m[be]),at(Ht,be,Mt(Te,T,q,Z,be,m,zt))}),Ht}function Yt(m){return _r(m)?ge(m):{}}function Rt(m,T,q){var Z=T(m);return Un(m)?Z:z(Z,q(m))}function te(m){return Vt.call(m)}function Xt(m){if(!_r(m)||gn(m))return!1;var T=Hn(m)||lt(m)?Bt:V;return T.test(se(m))}function Me(m){if(!Nr(m))return vr(m);var T=[];for(var q in Object(m))Et.call(m,q)&&q!="constructor"&&T.push(q);return T}function Oe(m,T){if(T)return m.slice();var q=new m.constructor(m.length);return m.copy(q),q}function je(m){var T=new m.constructor(m.byteLength);return new $t(T).set(new $t(m)),T}function mt(m,T){var q=T?je(m.buffer):m.buffer;return new m.constructor(q,m.byteOffset,m.byteLength)}function jt(m,T,q){var Z=T?q(dt(m),!0):dt(m);return X(Z,it,new m.constructor)}function Zt(m){var T=new m.constructor(m.source,$.exec(m));return T.lastIndex=m.lastIndex,T}function St(m,T,q){var Z=T?q(Ut(m),!0):Ut(m);return X(Z,H,new m.constructor)}function xt(m){return yr?Object(yr.call(m)):{}}function Le(m,T){var q=T?je(m.buffer):m.buffer;return new m.constructor(q,m.byteOffset,m.length)}function Lt(m,T){var q=-1,Z=m.length;for(T||(T=Array(Z));++q<Z;)T[q]=m[q];return T}function re(m,T,q,Z){q||(q={});for(var wt=-1,yt=T.length;++wt<yt;){var zt=T[wt],Ht=void 0;at(q,zt,Ht===void 0?m[zt]:Ht)}return q}function Jt(m,T){return re(m,ye(m),T)}function Ce(m){return Rt(m,zn,ye)}function Se(m,T){var q=m.__data__;return $r(T)?q[typeof T=="string"?"string":"hash"]:q.map}function me(m,T){var q=nt(m,T);return Xt(q)?q:void 0}var ye=Ie?vt(Ie,Object):Us,ue=te;(We&&ue(new We(new ArrayBuffer(1)))!=b||Ee&&ue(new Ee)!=p||ae&&ue(ae.resolve())!=A||he&&ue(new he)!=E||le&&ue(new le)!=f)&&(ue=function(m){var T=Vt.call(m),q=T==y?m.constructor:void 0,Z=q?se(q):void 0;if(Z)switch(Z){case Ke:return b;case de:return p;case Ye:return A;case Fe:return E;case mr:return f}return T});function pn(m){var T=m.length,q=m.constructor(T);return T&&typeof m[0]=="string"&&Et.call(m,"index")&&(q.index=m.index,q.input=m.input),q}function xe(m){return typeof m.constructor=="function"&&!Nr(m)?Yt(Dt(m)):{}}function en(m,T,q,Z){var wt=m.constructor;switch(T){case g:return je(m);case u:case a:return new wt(+m);case b:return mt(m,Z);case S:case N:case C:case P:case w:case M:case R:case I:case D:return Le(m,Z);case p:return jt(m,Z,q);case d:case _:return new wt(m);case O:return Zt(m);case E:return St(m,Z,q);case h:return xt(m)}}function Fr(m,T){return T=T==null?i:T,!!T&&(typeof m=="number"||Q.test(m))&&m>-1&&m%1==0&&m<T}function $r(m){var T=typeof m;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?m!=="__proto__":m===null}function gn(m){return!!bt&&bt in m}function Nr(m){var T=m&&m.constructor,q=typeof T=="function"&&T.prototype||Ot;return m===q}function se(m){if(m!=null){try{return Tt.call(m)}catch{}try{return m+""}catch{}}return""}function Ni(m){return Mt(m,!0,!0)}function Li(m,T){return m===T||m!==m&&T!==T}function vn(m){return $s(m)&&Et.call(m,"callee")&&(!fe.call(m,"callee")||Vt.call(m)==s)}var Un=Array.isArray;function mn(m){return m!=null&&xi(m.length)&&!Hn(m)}function $s(m){return Ii(m)&&mn(m)}var Ci=Be||Hs;function Hn(m){var T=_r(m)?Vt.call(m):"";return T==c||T==v}function xi(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=i}function _r(m){var T=typeof m;return!!m&&(T=="object"||T=="function")}function Ii(m){return!!m&&typeof m=="object"}function zn(m){return mn(m)?K(m):Me(m)}function Us(){return[]}function Hs(){return!1}r.exports=Ni})(Yn,Yn.exports)),Yn.exports}var Xn={exports:{}};Xn.exports;var yu;function Rs(){return yu||(yu=1,(function(r,t){var e=200,n="__lodash_hash_undefined__",i=1,s=2,l=9007199254740991,u="[object Arguments]",a="[object Array]",o="[object AsyncFunction]",c="[object Boolean]",v="[object Date]",p="[object Error]",d="[object Function]",y="[object GeneratorFunction]",A="[object Map]",O="[object Number]",E="[object Null]",_="[object Object]",h="[object Promise]",f="[object Proxy]",g="[object RegExp]",b="[object Set]",S="[object String]",N="[object Symbol]",C="[object Undefined]",P="[object WeakMap]",w="[object ArrayBuffer]",M="[object DataView]",R="[object Float32Array]",I="[object Float64Array]",D="[object Int8Array]",x="[object Int16Array]",$="[object Int32Array]",V="[object Uint8Array]",Q="[object Uint8ClampedArray]",Y="[object Uint16Array]",st="[object Uint32Array]",rt=/[\\^$.*+?()[\]{}|]/g,L=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,F={};F[R]=F[I]=F[D]=F[x]=F[$]=F[V]=F[Q]=F[Y]=F[st]=!0,F[u]=F[a]=F[w]=F[c]=F[M]=F[v]=F[p]=F[d]=F[A]=F[O]=F[_]=F[g]=F[b]=F[S]=F[P]=!1;var tt=typeof window=="object"&&window&&window.Object===Object&&window,it=typeof self=="object"&&self&&self.Object===Object&&self,H=tt||it||Function("return this")(),k=t&&!t.nodeType&&t,z=k&&!0&&r&&!r.nodeType&&r,X=z&&z.exports===k,J=X&&tt.process,nt=(function(){try{return J&&J.binding&&J.binding("util")}catch{}})(),lt=nt&&nt.isTypedArray;function dt(m,T){for(var q=-1,Z=m==null?0:m.length,wt=0,yt=[];++q<Z;){var zt=m[q];T(zt,q,m)&&(yt[wt++]=zt)}return yt}function vt(m,T){for(var q=-1,Z=T.length,wt=m.length;++q<Z;)m[wt+q]=T[q];return m}function Ut(m,T){for(var q=-1,Z=m==null?0:m.length;++q<Z;)if(T(m[q],q,m))return!0;return!1}function kt(m,T){for(var q=-1,Z=Array(m);++q<m;)Z[q]=T(q);return Z}function G(m){return function(T){return m(T)}}function Ot(m,T){return m.has(T)}function Nt(m,T){return m==null?void 0:m[T]}function bt(m){var T=-1,q=Array(m.size);return m.forEach(function(Z,wt){q[++T]=[wt,Z]}),q}function Tt(m,T){return function(q){return m(T(q))}}function Et(m){var T=-1,q=Array(m.size);return m.forEach(function(Z){q[++T]=Z}),q}var Vt=Array.prototype,Bt=Function.prototype,Ct=Object.prototype,Ft=H["__core-js_shared__"],$t=Bt.toString,Dt=Ct.hasOwnProperty,ge=(function(){var m=/[^.]+$/.exec(Ft&&Ft.keys&&Ft.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""})(),fe=Ct.toString,Ge=RegExp("^"+$t.call(Dt).replace(rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ie=X?H.Buffer:void 0,Be=H.Symbol,vr=H.Uint8Array,We=Ct.propertyIsEnumerable,Ee=Vt.splice,ae=Be?Be.toStringTag:void 0,he=Object.getOwnPropertySymbols,le=Ie?Ie.isBuffer:void 0,ne=Tt(Object.keys,Object),Ke=ye(H,"DataView"),de=ye(H,"Map"),Ye=ye(H,"Promise"),Fe=ye(H,"Set"),mr=ye(H,"WeakMap"),qe=ye(Object,"create"),yr=se(Ke),ie=se(de),pe=se(Ye),ve=se(Fe),Xe=se(mr),Ae=Be?Be.prototype:void 0,Ze=Ae?Ae.valueOf:void 0;function Wt(m){var T=-1,q=m==null?0:m.length;for(this.clear();++T<q;){var Z=m[T];this.set(Z[0],Z[1])}}function br(){this.__data__=qe?qe(null):{},this.size=0}function jr(m){var T=this.has(m)&&delete this.__data__[m];return this.size-=T?1:0,T}function $e(m){var T=this.__data__;if(qe){var q=T[m];return q===n?void 0:q}return Dt.call(T,m)?T[m]:void 0}function Pe(m){var T=this.__data__;return qe?T[m]!==void 0:Dt.call(T,m)}function Rr(m,T){var q=this.__data__;return this.size+=this.has(m)?0:1,q[m]=qe&&T===void 0?n:T,this}Wt.prototype.clear=br,Wt.prototype.delete=jr,Wt.prototype.get=$e,Wt.prototype.has=Pe,Wt.prototype.set=Rr;function Kt(m){var T=-1,q=m==null?0:m.length;for(this.clear();++T<q;){var Z=m[T];this.set(Z[0],Z[1])}}function kr(){this.__data__=[],this.size=0}function Je(m){var T=this.__data__,q=Oe(T,m);if(q<0)return!1;var Z=T.length-1;return q==Z?T.pop():Ee.call(T,q,1),--this.size,!0}function De(m){var T=this.__data__,q=Oe(T,m);return q<0?void 0:T[q][1]}function Br(m){return Oe(this.__data__,m)>-1}function U(m,T){var q=this.__data__,Z=Oe(q,m);return Z<0?(++this.size,q.push([m,T])):q[Z][1]=T,this}Kt.prototype.clear=kr,Kt.prototype.delete=Je,Kt.prototype.get=De,Kt.prototype.has=Br,Kt.prototype.set=U;function W(m){var T=-1,q=m==null?0:m.length;for(this.clear();++T<q;){var Z=m[T];this.set(Z[0],Z[1])}}function ot(){this.size=0,this.__data__={hash:new Wt,map:new(de||Kt),string:new Wt}}function ft(m){var T=me(this,m).delete(m);return this.size-=T?1:0,T}function qt(m){return me(this,m).get(m)}function At(m){return me(this,m).has(m)}function j(m,T){var q=me(this,m),Z=q.size;return q.set(m,T),this.size+=q.size==Z?0:1,this}W.prototype.clear=ot,W.prototype.delete=ft,W.prototype.get=qt,W.prototype.has=At,W.prototype.set=j;function K(m){var T=-1,q=m==null?0:m.length;for(this.__data__=new W;++T<q;)this.add(m[T])}function at(m){return this.__data__.set(m,n),this}function ut(m){return this.__data__.has(m)}K.prototype.add=K.prototype.push=at,K.prototype.has=ut;function _t(m){var T=this.__data__=new Kt(m);this.size=T.size}function Mt(){this.__data__=new Kt,this.size=0}function Yt(m){var T=this.__data__,q=T.delete(m);return this.size=T.size,q}function Rt(m){return this.__data__.get(m)}function te(m){return this.__data__.has(m)}function Xt(m,T){var q=this.__data__;if(q instanceof Kt){var Z=q.__data__;if(!de||Z.length<e-1)return Z.push([m,T]),this.size=++q.size,this;q=this.__data__=new W(Z)}return q.set(m,T),this.size=q.size,this}_t.prototype.clear=Mt,_t.prototype.delete=Yt,_t.prototype.get=Rt,_t.prototype.has=te,_t.prototype.set=Xt;function Me(m,T){var q=vn(m),Z=!q&&Li(m),wt=!q&&!Z&&mn(m),yt=!q&&!Z&&!wt&&Ii(m),zt=q||Z||wt||yt,Ht=zt?kt(m.length,String):[],oe=Ht.length;for(var Gt in m)Dt.call(m,Gt)&&!(zt&&(Gt=="length"||wt&&(Gt=="offset"||Gt=="parent")||yt&&(Gt=="buffer"||Gt=="byteLength"||Gt=="byteOffset")||en(Gt,oe)))&&Ht.push(Gt);return Ht}function Oe(m,T){for(var q=m.length;q--;)if(Ni(m[q][0],T))return q;return-1}function je(m,T,q){var Z=T(m);return vn(m)?Z:vt(Z,q(m))}function mt(m){return m==null?m===void 0?C:E:ae&&ae in Object(m)?ue(m):Nr(m)}function jt(m){return _r(m)&&mt(m)==u}function Zt(m,T,q,Z,wt){return m===T?!0:m==null||T==null||!_r(m)&&!_r(T)?m!==m&&T!==T:St(m,T,q,Z,Zt,wt)}function St(m,T,q,Z,wt,yt){var zt=vn(m),Ht=vn(T),oe=zt?a:xe(m),Gt=Ht?a:xe(T);oe=oe==u?_:oe,Gt=Gt==u?_:Gt;var we=oe==_,ke=Gt==_,ce=oe==Gt;if(ce&&mn(m)){if(!mn(T))return!1;zt=!0,we=!1}if(ce&&!we)return yt||(yt=new _t),zt||Ii(m)?re(m,T,q,Z,wt,yt):Jt(m,T,oe,q,Z,wt,yt);if(!(q&i)){var Te=we&&Dt.call(m,"__wrapped__"),be=ke&&Dt.call(T,"__wrapped__");if(Te||be){var Ur=Te?m.value():m,Lr=be?T.value():T;return yt||(yt=new _t),wt(Ur,Lr,q,Z,yt)}}return ce?(yt||(yt=new _t),Ce(m,T,q,Z,wt,yt)):!1}function xt(m){if(!xi(m)||$r(m))return!1;var T=Ci(m)?Ge:L;return T.test(se(m))}function Le(m){return _r(m)&&Hn(m.length)&&!!F[mt(m)]}function Lt(m){if(!gn(m))return ne(m);var T=[];for(var q in Object(m))Dt.call(m,q)&&q!="constructor"&&T.push(q);return T}function re(m,T,q,Z,wt,yt){var zt=q&i,Ht=m.length,oe=T.length;if(Ht!=oe&&!(zt&&oe>Ht))return!1;var Gt=yt.get(m);if(Gt&&yt.get(T))return Gt==T;var we=-1,ke=!0,ce=q&s?new K:void 0;for(yt.set(m,T),yt.set(T,m);++we<Ht;){var Te=m[we],be=T[we];if(Z)var Ur=zt?Z(be,Te,we,T,m,yt):Z(Te,be,we,m,T,yt);if(Ur!==void 0){if(Ur)continue;ke=!1;break}if(ce){if(!Ut(T,function(Lr,rn){if(!Ot(ce,rn)&&(Te===Lr||wt(Te,Lr,q,Z,yt)))return ce.push(rn)})){ke=!1;break}}else if(!(Te===be||wt(Te,be,q,Z,yt))){ke=!1;break}}return yt.delete(m),yt.delete(T),ke}function Jt(m,T,q,Z,wt,yt,zt){switch(q){case M:if(m.byteLength!=T.byteLength||m.byteOffset!=T.byteOffset)return!1;m=m.buffer,T=T.buffer;case w:return!(m.byteLength!=T.byteLength||!yt(new vr(m),new vr(T)));case c:case v:case O:return Ni(+m,+T);case p:return m.name==T.name&&m.message==T.message;case g:case S:return m==T+"";case A:var Ht=bt;case b:var oe=Z&i;if(Ht||(Ht=Et),m.size!=T.size&&!oe)return!1;var Gt=zt.get(m);if(Gt)return Gt==T;Z|=s,zt.set(m,T);var we=re(Ht(m),Ht(T),Z,wt,yt,zt);return zt.delete(m),we;case N:if(Ze)return Ze.call(m)==Ze.call(T)}return!1}function Ce(m,T,q,Z,wt,yt){var zt=q&i,Ht=Se(m),oe=Ht.length,Gt=Se(T),we=Gt.length;if(oe!=we&&!zt)return!1;for(var ke=oe;ke--;){var ce=Ht[ke];if(!(zt?ce in T:Dt.call(T,ce)))return!1}var Te=yt.get(m);if(Te&&yt.get(T))return Te==T;var be=!0;yt.set(m,T),yt.set(T,m);for(var Ur=zt;++ke<oe;){ce=Ht[ke];var Lr=m[ce],rn=T[ce];if(Z)var Ul=zt?Z(rn,Lr,ce,T,m,yt):Z(Lr,rn,ce,m,T,yt);if(!(Ul===void 0?Lr===rn||wt(Lr,rn,q,Z,yt):Ul)){be=!1;break}Ur||(Ur=ce=="constructor")}if(be&&!Ur){var qi=m.constructor,Pi=T.constructor;qi!=Pi&&"constructor"in m&&"constructor"in T&&!(typeof qi=="function"&&qi instanceof qi&&typeof Pi=="function"&&Pi instanceof Pi)&&(be=!1)}return yt.delete(m),yt.delete(T),be}function Se(m){return je(m,zn,pn)}function me(m,T){var q=m.__data__;return Fr(T)?q[typeof T=="string"?"string":"hash"]:q.map}function ye(m,T){var q=Nt(m,T);return xt(q)?q:void 0}function ue(m){var T=Dt.call(m,ae),q=m[ae];try{m[ae]=void 0;var Z=!0}catch{}var wt=fe.call(m);return Z&&(T?m[ae]=q:delete m[ae]),wt}var pn=he?function(m){return m==null?[]:(m=Object(m),dt(he(m),function(T){return We.call(m,T)}))}:Us,xe=mt;(Ke&&xe(new Ke(new ArrayBuffer(1)))!=M||de&&xe(new de)!=A||Ye&&xe(Ye.resolve())!=h||Fe&&xe(new Fe)!=b||mr&&xe(new mr)!=P)&&(xe=function(m){var T=mt(m),q=T==_?m.constructor:void 0,Z=q?se(q):"";if(Z)switch(Z){case yr:return M;case ie:return A;case pe:return h;case ve:return b;case Xe:return P}return T});function en(m,T){return T=T==null?l:T,!!T&&(typeof m=="number"||B.test(m))&&m>-1&&m%1==0&&m<T}function Fr(m){var T=typeof m;return T=="string"||T=="number"||T=="symbol"||T=="boolean"?m!=="__proto__":m===null}function $r(m){return!!ge&&ge in m}function gn(m){var T=m&&m.constructor,q=typeof T=="function"&&T.prototype||Ct;return m===q}function Nr(m){return fe.call(m)}function se(m){if(m!=null){try{return $t.call(m)}catch{}try{return m+""}catch{}}return""}function Ni(m,T){return m===T||m!==m&&T!==T}var Li=jt((function(){return arguments})())?jt:function(m){return _r(m)&&Dt.call(m,"callee")&&!We.call(m,"callee")},vn=Array.isArray;function Un(m){return m!=null&&Hn(m.length)&&!Ci(m)}var mn=le||Hs;function $s(m,T){return Zt(m,T)}function Ci(m){if(!xi(m))return!1;var T=mt(m);return T==d||T==y||T==o||T==f}function Hn(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=l}function xi(m){var T=typeof m;return m!=null&&(T=="object"||T=="function")}function _r(m){return m!=null&&typeof m=="object"}var Ii=lt?G(lt):Le;function zn(m){return Un(m)?Me(m):Lt(m)}function Us(){return[]}function Hs(){return!1}r.exports=$s})(Xn,Xn.exports)),Xn.exports}var ji={},bu;function $y(){if(bu)return ji;bu=1,Object.defineProperty(ji,"__esModule",{value:!0});const r=Ts(),t=Rs();var e;return(function(n){function i(a={},o={},c=!1){typeof a!="object"&&(a={}),typeof o!="object"&&(o={});let v=r(o);c||(v=Object.keys(v).reduce((p,d)=>(v[d]!=null&&(p[d]=v[d]),p),{}));for(const p in a)a[p]!==void 0&&o[p]===void 0&&(v[p]=a[p]);return Object.keys(v).length>0?v:void 0}n.compose=i;function s(a={},o={}){typeof a!="object"&&(a={}),typeof o!="object"&&(o={});const c=Object.keys(a).concat(Object.keys(o)).reduce((v,p)=>(t(a[p],o[p])||(v[p]=o[p]===void 0?null:o[p]),v),{});return Object.keys(c).length>0?c:void 0}n.diff=s;function l(a={},o={}){a=a||{};const c=Object.keys(o).reduce((v,p)=>(o[p]!==a[p]&&a[p]!==void 0&&(v[p]=o[p]),v),{});return Object.keys(a).reduce((v,p)=>(a[p]!==o[p]&&o[p]===void 0&&(v[p]=null),v),c)}n.invert=l;function u(a,o,c=!1){if(typeof a!="object")return o;if(typeof o!="object")return;if(!c)return o;const v=Object.keys(o).reduce((p,d)=>(a[d]===void 0&&(p[d]=o[d]),p),{});return Object.keys(v).length>0?v:void 0}n.transform=u})(e||(e={})),ji.default=e,ji}var ki={},_u;function gh(){if(_u)return ki;_u=1,Object.defineProperty(ki,"__esModule",{value:!0});var r;return(function(t){function e(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}t.length=e})(r||(r={})),ki.default=r,ki}var Bi={},Eu;function Uy(){if(Eu)return Bi;Eu=1,Object.defineProperty(Bi,"__esModule",{value:!0});const r=gh();class t{constructor(n){this.ops=n,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(n){n||(n=1/0);const i=this.ops[this.index];if(i){const s=this.offset,l=r.default.length(i);if(n>=l-s?(n=l-s,this.index+=1,this.offset=0):this.offset+=n,typeof i.delete=="number")return{delete:n};{const u={};return i.attributes&&(u.attributes=i.attributes),typeof i.retain=="number"?u.retain=n:typeof i.retain=="object"&&i.retain!==null?u.retain=i.retain:typeof i.insert=="string"?u.insert=i.insert.substr(s,n):u.insert=i.insert,u}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?r.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const n=this.ops[this.index];return n?typeof n.delete=="number"?"delete":typeof n.retain=="number"||typeof n.retain=="object"&&n.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const n=this.offset,i=this.index,s=this.next(),l=this.ops.slice(this.index);return this.offset=n,this.index=i,[s].concat(l)}}else return[]}}return Bi.default=t,Bi}var Au;function Hy(){return Au||(Au=1,(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMap=t.OpIterator=t.Op=void 0;const e=Fy(),n=Ts(),i=Rs(),s=$y();t.AttributeMap=s.default;const l=gh();t.Op=l.default;const u=Uy();t.OpIterator=u.default;const a="\0",o=(v,p)=>{if(typeof v!="object"||v===null)throw new Error(`cannot retain a ${typeof v}`);if(typeof p!="object"||p===null)throw new Error(`cannot retain a ${typeof p}`);const d=Object.keys(v)[0];if(!d||d!==Object.keys(p)[0])throw new Error(`embed types not matched: ${d} != ${Object.keys(p)[0]}`);return[d,v[d],p[d]]};class c{constructor(p){Array.isArray(p)?this.ops=p:p!=null&&Array.isArray(p.ops)?this.ops=p.ops:this.ops=[]}static registerEmbed(p,d){this.handlers[p]=d}static unregisterEmbed(p){delete this.handlers[p]}static getHandler(p){const d=this.handlers[p];if(!d)throw new Error(`no handlers for embed type "${p}"`);return d}insert(p,d){const y={};return typeof p=="string"&&p.length===0?this:(y.insert=p,d!=null&&typeof d=="object"&&Object.keys(d).length>0&&(y.attributes=d),this.push(y))}delete(p){return p<=0?this:this.push({delete:p})}retain(p,d){if(typeof p=="number"&&p<=0)return this;const y={retain:p};return d!=null&&typeof d=="object"&&Object.keys(d).length>0&&(y.attributes=d),this.push(y)}push(p){let d=this.ops.length,y=this.ops[d-1];if(p=n(p),typeof y=="object"){if(typeof p.delete=="number"&&typeof y.delete=="number")return this.ops[d-1]={delete:y.delete+p.delete},this;if(typeof y.delete=="number"&&p.insert!=null&&(d-=1,y=this.ops[d-1],typeof y!="object"))return this.ops.unshift(p),this;if(i(p.attributes,y.attributes)){if(typeof p.insert=="string"&&typeof y.insert=="string")return this.ops[d-1]={insert:y.insert+p.insert},typeof p.attributes=="object"&&(this.ops[d-1].attributes=p.attributes),this;if(typeof p.retain=="number"&&typeof y.retain=="number")return this.ops[d-1]={retain:y.retain+p.retain},typeof p.attributes=="object"&&(this.ops[d-1].attributes=p.attributes),this}}return d===this.ops.length?this.ops.push(p):this.ops.splice(d,0,p),this}chop(){const p=this.ops[this.ops.length-1];return p&&typeof p.retain=="number"&&!p.attributes&&this.ops.pop(),this}filter(p){return this.ops.filter(p)}forEach(p){this.ops.forEach(p)}map(p){return this.ops.map(p)}partition(p){const d=[],y=[];return this.forEach(A=>{(p(A)?d:y).push(A)}),[d,y]}reduce(p,d){return this.ops.reduce(p,d)}changeLength(){return this.reduce((p,d)=>d.insert?p+l.default.length(d):d.delete?p-d.delete:p,0)}length(){return this.reduce((p,d)=>p+l.default.length(d),0)}slice(p=0,d=1/0){const y=[],A=new u.default(this.ops);let O=0;for(;O<d&&A.hasNext();){let E;O<p?E=A.next(p-O):(E=A.next(d-O),y.push(E)),O+=l.default.length(E)}return new c(y)}compose(p){const d=new u.default(this.ops),y=new u.default(p.ops),A=[],O=y.peek();if(O!=null&&typeof O.retain=="number"&&O.attributes==null){let _=O.retain;for(;d.peekType()==="insert"&&d.peekLength()<=_;)_-=d.peekLength(),A.push(d.next());O.retain-_>0&&y.next(O.retain-_)}const E=new c(A);for(;d.hasNext()||y.hasNext();)if(y.peekType()==="insert")E.push(y.next());else if(d.peekType()==="delete")E.push(d.next());else{const _=Math.min(d.peekLength(),y.peekLength()),h=d.next(_),f=y.next(_);if(f.retain){const g={};if(typeof h.retain=="number")g.retain=typeof f.retain=="number"?_:f.retain;else if(typeof f.retain=="number")h.retain==null?g.insert=h.insert:g.retain=h.retain;else{const S=h.retain==null?"insert":"retain",[N,C,P]=o(h[S],f.retain),w=c.getHandler(N);g[S]={[N]:w.compose(C,P,S==="retain")}}const b=s.default.compose(h.attributes,f.attributes,typeof h.retain=="number");if(b&&(g.attributes=b),E.push(g),!y.hasNext()&&i(E.ops[E.ops.length-1],g)){const S=new c(d.rest());return E.concat(S).chop()}}else typeof f.delete=="number"&&(typeof h.retain=="number"||typeof h.retain=="object"&&h.retain!==null)&&E.push(f)}return E.chop()}concat(p){const d=new c(this.ops.slice());return p.ops.length>0&&(d.push(p.ops[0]),d.ops=d.ops.concat(p.ops.slice(1))),d}diff(p,d){if(this.ops===p.ops)return new c;const y=[this,p].map(h=>h.map(f=>{if(f.insert!=null)return typeof f.insert=="string"?f.insert:a;const g=h===p?"on":"with";throw new Error("diff() called "+g+" non-document")}).join("")),A=new c,O=e(y[0],y[1],d,!0),E=new u.default(this.ops),_=new u.default(p.ops);return O.forEach(h=>{let f=h[1].length;for(;f>0;){let g=0;switch(h[0]){case e.INSERT:g=Math.min(_.peekLength(),f),A.push(_.next(g));break;case e.DELETE:g=Math.min(f,E.peekLength()),E.next(g),A.delete(g);break;case e.EQUAL:g=Math.min(E.peekLength(),_.peekLength(),f);const b=E.next(g),S=_.next(g);i(b.insert,S.insert)?A.retain(g,s.default.diff(b.attributes,S.attributes)):A.push(S).delete(g);break}f-=g}}),A.chop()}eachLine(p,d=`
`){const y=new u.default(this.ops);let A=new c,O=0;for(;y.hasNext();){if(y.peekType()!=="insert")return;const E=y.peek(),_=l.default.length(E)-y.peekLength(),h=typeof E.insert=="string"?E.insert.indexOf(d,_)-_:-1;if(h<0)A.push(y.next());else if(h>0)A.push(y.next(h));else{if(p(A,y.next(1).attributes||{},O)===!1)return;O+=1,A=new c}}A.length()>0&&p(A,{},O)}invert(p){const d=new c;return this.reduce((y,A)=>{if(A.insert)d.delete(l.default.length(A));else{if(typeof A.retain=="number"&&A.attributes==null)return d.retain(A.retain),y+A.retain;if(A.delete||typeof A.retain=="number"){const O=A.delete||A.retain;return p.slice(y,y+O).forEach(_=>{A.delete?d.push(_):A.retain&&A.attributes&&d.retain(l.default.length(_),s.default.invert(A.attributes,_.attributes))}),y+O}else if(typeof A.retain=="object"&&A.retain!==null){const O=p.slice(y,y+1),E=new u.default(O.ops).next(),[_,h,f]=o(A.retain,E.insert),g=c.getHandler(_);return d.retain({[_]:g.invert(h,f)},s.default.invert(A.attributes,E.attributes)),y+1}}return y},0),d.chop()}transform(p,d=!1){if(d=!!d,typeof p=="number")return this.transformPosition(p,d);const y=p,A=new u.default(this.ops),O=new u.default(y.ops),E=new c;for(;A.hasNext()||O.hasNext();)if(A.peekType()==="insert"&&(d||O.peekType()!=="insert"))E.retain(l.default.length(A.next()));else if(O.peekType()==="insert")E.push(O.next());else{const _=Math.min(A.peekLength(),O.peekLength()),h=A.next(_),f=O.next(_);if(h.delete)continue;if(f.delete)E.push(f);else{const g=h.retain,b=f.retain;let S=typeof b=="object"&&b!==null?b:_;if(typeof g=="object"&&g!==null&&typeof b=="object"&&b!==null){const N=Object.keys(g)[0];if(N===Object.keys(b)[0]){const C=c.getHandler(N);C&&(S={[N]:C.transform(g[N],b[N],d)})}}E.retain(S,s.default.transform(h.attributes,f.attributes,d))}}return E.chop()}transformPosition(p,d=!1){d=!!d;const y=new u.default(this.ops);let A=0;for(;y.hasNext()&&A<=p;){const O=y.peekLength(),E=y.peekType();if(y.next(),E==="delete"){p-=Math.min(O,p-A);continue}else E==="insert"&&(A<p||!d)&&(p+=O);A+=O}return p}}c.Op=l.default,c.OpIterator=u.default,c.AttributeMap=s.default,c.handlers={},t.default=c,r.exports=c,r.exports.default=c})(Mi,Mi.exports)),Mi.exports}var nr=Hy();const pt=vi(nr);class hr extends Ve{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}hr.blotName="break";hr.tagName="BR";let ur=class extends rs{};const zy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ns(r){return r.replace(/[&<>"']/g,t=>zy[t])}const Er=class Er extends vl{static compare(t,e){const n=Er.order.indexOf(t),i=Er.order.indexOf(e);return n>=0||i>=0?n-i:t===e?0:t<e?-1:1}formatAt(t,e,n,i){if(Er.compare(this.statics.blotName,n)<0&&this.scroll.query(n,gt.BLOT)){const s=this.isolate(t,e);i&&s.wrap(n,i)}else super.formatAt(t,e,n,i)}optimize(t){if(super.optimize(t),this.parent instanceof Er&&Er.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}};ct(Er,"allowedChildren",[Er,hr,Ve,ur]),ct(Er,"order",["cursor","inline","link","underline","strike","italic","bold","script","code"]);let wr=Er;const Ou=1;class _e extends oi{constructor(){super(...arguments);ct(this,"cache",{})}delta(){return this.cache.delta==null&&(this.cache.delta=vh(this)),this.cache.delta}deleteAt(e,n){super.deleteAt(e,n),this.cache={}}formatAt(e,n,i,s){n<=0||(this.scroll.query(i,gt.BLOCK)?e+n===this.length()&&this.format(i,s):super.formatAt(e,Math.min(n,this.length()-e-1),i,s),this.cache={})}insertAt(e,n,i){if(i!=null){super.insertAt(e,n,i),this.cache={};return}if(n.length===0)return;const s=n.split(`
`),l=s.shift();l.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),l):this.children.tail.insertAt(this.children.tail.length(),l),this.cache={});let u=this;s.reduce((a,o)=>(u=u.split(a,!0),u.insertAt(0,o),o.length),e+l.length)}insertBefore(e,n){const{head:i}=this.children;super.insertBefore(e,n),i instanceof hr&&i.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Ou),this.cache.length}moveChildren(e,n){super.moveChildren(e,n),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n&&(e===0||e>=this.length()-Ou)){const s=this.clone();return e===0?(this.parent.insertBefore(s,this),this):(this.parent.insertBefore(s,this.next),s)}const i=super.split(e,n);return this.cache={},i}}_e.blotName="block";_e.tagName="P";_e.defaultChild=hr;_e.allowedChildren=[hr,wr,Ve,ur];class rr extends Ve{attach(){super.attach(),this.attributes=new Ss(this.domNode)}delta(){return new pt().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,e){const n=this.scroll.query(t,gt.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,e)}formatAt(t,e,n,i){this.format(n,i)}insertAt(t,e,n){if(n!=null){super.insertAt(t,e,n);return}const i=e.split(`
`),s=i.pop(),l=i.map(a=>{const o=this.scroll.create(_e.blotName);return o.insertAt(0,a),o}),u=this.split(t);l.forEach(a=>{this.parent.insertBefore(a,u)}),s&&this.parent.insertBefore(this.scroll.create("text",s),u)}}rr.scope=gt.BLOCK_BLOT;function vh(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r.descendants(Re).reduce((e,n)=>n.length()===0?e:e.insert(n.value(),tr(n,{},t)),new pt).insert(`
`,tr(r))}function tr(r){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return r==null||("formats"in r&&typeof r.formats=="function"&&(t={...t,...r.formats()},e&&delete t["code-token"]),r.parent==null||r.parent.statics.blotName==="scroll"||r.parent.statics.scope!==r.statics.scope)?t:tr(r.parent,t,e)}const Qe=class Qe extends Ve{static value(){}constructor(t,e,n){super(t,e),this.selection=n,this.textNode=document.createTextNode(Qe.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(t,e){if(this.savedLength!==0){super.format(t,e);return}let n=this,i=0;for(;n!=null&&n.statics.scope!==gt.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=Qe.CONTENTS.length,n.optimize(),n.formatAt(i,Qe.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const t=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof ur?this.prev:null,n=e?e.length():0,i=this.next instanceof ur?this.next:null,s=i?i.text:"",{textNode:l}=this,u=l.data.split(Qe.CONTENTS).join("");l.data=Qe.CONTENTS;let a;if(e)a=e,(u||i)&&(e.insertAt(e.length(),u+s),i&&i.remove());else if(i)a=i,i.insertAt(0,u);else{const o=document.createTextNode(u);a=this.scroll.create(o),this.parent.insertBefore(a,this)}if(this.remove(),t){const o=(p,d)=>e&&p===e.domNode?d:p===l?n+d-1:i&&p===i.domNode?n+u.length+d:null,c=o(t.start.node,t.start.offset),v=o(t.end.node,t.end.offset);if(c!==null&&v!==null)return{startNode:a.domNode,startOffset:c,endNode:a.domNode,endOffset:v}}return null}update(t,e){if(t.some(n=>n.type==="characterData"&&n.target===this.textNode)){const n=this.restore();n&&(e.range=n)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if(e.domNode.tagName==="A"){this.savedLength=Qe.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}};ct(Qe,"blotName","cursor"),ct(Qe,"className","ql-cursor"),ct(Qe,"tagName","span"),ct(Qe,"CONTENTS","\uFEFF");let In=Qe;var Ys={exports:{}},Su;function Vy(){return Su||(Su=1,(function(r){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function i(a,o,c){this.fn=a,this.context=o,this.once=c||!1}function s(a,o,c,v,p){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new i(c,v||a,p),y=e?e+o:o;return a._events[y]?a._events[y].fn?a._events[y]=[a._events[y],d]:a._events[y].push(d):(a._events[y]=d,a._eventsCount++),a}function l(a,o){--a._eventsCount===0?a._events=new n:delete a._events[o]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var o=[],c,v;if(this._eventsCount===0)return o;for(v in c=this._events)t.call(c,v)&&o.push(e?v.slice(1):v);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(c)):o},u.prototype.listeners=function(o){var c=e?e+o:o,v=this._events[c];if(!v)return[];if(v.fn)return[v.fn];for(var p=0,d=v.length,y=new Array(d);p<d;p++)y[p]=v[p].fn;return y},u.prototype.listenerCount=function(o){var c=e?e+o:o,v=this._events[c];return v?v.fn?1:v.length:0},u.prototype.emit=function(o,c,v,p,d,y){var A=e?e+o:o;if(!this._events[A])return!1;var O=this._events[A],E=arguments.length,_,h;if(O.fn){switch(O.once&&this.removeListener(o,O.fn,void 0,!0),E){case 1:return O.fn.call(O.context),!0;case 2:return O.fn.call(O.context,c),!0;case 3:return O.fn.call(O.context,c,v),!0;case 4:return O.fn.call(O.context,c,v,p),!0;case 5:return O.fn.call(O.context,c,v,p,d),!0;case 6:return O.fn.call(O.context,c,v,p,d,y),!0}for(h=1,_=new Array(E-1);h<E;h++)_[h-1]=arguments[h];O.fn.apply(O.context,_)}else{var f=O.length,g;for(h=0;h<f;h++)switch(O[h].once&&this.removeListener(o,O[h].fn,void 0,!0),E){case 1:O[h].fn.call(O[h].context);break;case 2:O[h].fn.call(O[h].context,c);break;case 3:O[h].fn.call(O[h].context,c,v);break;case 4:O[h].fn.call(O[h].context,c,v,p);break;default:if(!_)for(g=1,_=new Array(E-1);g<E;g++)_[g-1]=arguments[g];O[h].fn.apply(O[h].context,_)}}return!0},u.prototype.on=function(o,c,v){return s(this,o,c,v,!1)},u.prototype.once=function(o,c,v){return s(this,o,c,v,!0)},u.prototype.removeListener=function(o,c,v,p){var d=e?e+o:o;if(!this._events[d])return this;if(!c)return l(this,d),this;var y=this._events[d];if(y.fn)y.fn===c&&(!p||y.once)&&(!v||y.context===v)&&l(this,d);else{for(var A=0,O=[],E=y.length;A<E;A++)(y[A].fn!==c||p&&!y[A].once||v&&y[A].context!==v)&&O.push(y[A]);O.length?this._events[d]=O.length===1?O[0]:O:l(this,d)}return this},u.prototype.removeAllListeners=function(o){var c;return o?(c=e?e+o:o,this._events[c]&&l(this,c)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=e,u.EventEmitter=u,r.exports=u})(Ys)),Ys.exports}var Gy=Vy();const Wy=vi(Gy),Za=new WeakMap,Ja=["error","warn","log","info"];let Qa="warn";function mh(r){if(Qa&&Ja.indexOf(r)<=Ja.indexOf(Qa)){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];console[r](...e)}}function Dr(r){return Ja.reduce((t,e)=>(t[e]=mh.bind(console,e,r),t),{})}Dr.level=r=>{Qa=r};mh.level=Dr.level;const Xs=Dr("quill:events"),Ky=["selectionchange","mousedown","mouseup","click"];Ky.forEach(r=>{document.addEventListener(r,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(i=>{const s=Za.get(i);s&&s.emitter&&s.emitter.handleDOM(...e)})})});class ht extends Wy{constructor(){super(),this.domListeners={},this.on("error",Xs.error)}emit(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Xs.log.call(Xs,...e),super.emit(...e)}handleDOM(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(this.domListeners[t.type]||[]).forEach(s=>{let{node:l,handler:u}=s;(t.target===l||l.contains(t.target))&&u(t,...n)})}listenDOM(t,e,n){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:e,handler:n})}}ct(ht,"events",{EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"}),ct(ht,"sources",{API:"api",SILENT:"silent",USER:"user"});const Zs=Dr("quill:selection");class on{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=t,this.length=e}}class Yy{constructor(t,e){this.emitter=e,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new on(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,ht.sources.USER),1)}),this.emitter.on(ht.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(ht.events.SCROLL_UPDATE,(i,s)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);const l=s.some(u=>u.type==="characterData"||u.type==="childList"||u.type==="attributes"&&u.target===this.root);this.update(l?ht.sources.SILENT:i)}catch{}})}),this.emitter.on(ht.events.SCROLL_OPTIMIZE,(n,i)=>{if(i.range){const{startNode:s,startOffset:l,endNode:u,endOffset:a}=i.range;this.setNativeRange(s,l,u,a),this.update(ht.sources.SILENT)}}),this.update(ht.sources.SILENT)}handleComposition(){this.emitter.on(ht.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(ht.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const t=this.cursor.restore();if(!t)return;setTimeout(()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(ht.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,e){this.scroll.update();const n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(t,gt.BLOCK))){if(n.start.node!==this.cursor.textNode){const i=this.scroll.find(n.start.node,!1);if(i==null)return;if(i instanceof Re){const s=i.split(n.start.offset);i.parent.insertBefore(this.cursor,s)}else i.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.scroll.length();t=Math.min(t,n-1),e=Math.min(t+e,n-1)-t;let i,[s,l]=this.scroll.leaf(t);if(s==null)return null;if(e>0&&l===s.length()){const[c]=this.scroll.leaf(t+1);if(c){const[v]=this.scroll.line(t),[p]=this.scroll.line(t+1);v===p&&(s=c,l=0)}}[i,l]=s.position(l,!0);const u=document.createRange();if(e>0)return u.setStart(i,l),[s,l]=this.scroll.leaf(t+e),s==null?null:([i,l]=s.position(l,!0),u.setEnd(i,l),u.getBoundingClientRect());let a="left",o;if(i instanceof Text){if(!i.data.length)return null;l<i.data.length?(u.setStart(i,l),u.setEnd(i,l+1)):(u.setStart(i,l-1),u.setEnd(i,l),a="right"),o=u.getBoundingClientRect()}else{if(!(s.domNode instanceof Element))return null;o=s.domNode.getBoundingClientRect(),l>0&&(a="right")}return{bottom:o.top+o.height,height:o.height,left:o[a],right:o[a],top:o.top,width:0}}getNativeRange(){const t=document.getSelection();if(t==null||t.rangeCount<=0)return null;const e=t.getRangeAt(0);if(e==null)return null;const n=this.normalizeNative(e);return Zs.info("getNativeRange",n),n}getRange(){const t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];const e=this.getNativeRange();return e==null?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Js(this.root,document.activeElement)}normalizedToRange(t){const e=[[t.start.node,t.start.offset]];t.native.collapsed||e.push([t.end.node,t.end.offset]);const n=e.map(l=>{const[u,a]=l,o=this.scroll.find(u,!0),c=o.offset(this.scroll);return a===0?c:o instanceof Re?c+o.index(u,a):c+o.length()}),i=Math.min(Math.max(...n),this.scroll.length()-1),s=Math.min(i,...n);return new on(s,i-s)}normalizeNative(t){if(!Js(this.root,t.startContainer)||!t.collapsed&&!Js(this.root,t.endContainer))return null;const e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach(n=>{let{node:i,offset:s}=n;for(;!(i instanceof Text)&&i.childNodes.length>0;)if(i.childNodes.length>s)i=i.childNodes[s],s=0;else if(i.childNodes.length===s)i=i.lastChild,i instanceof Text?s=i.data.length:i.childNodes.length>0?s=i.childNodes.length:s=i.childNodes.length+1;else break;n.node=i,n.offset=s}),e}rangeToNative(t){const e=this.scroll.length(),n=(i,s)=>{i=Math.min(e-1,i);const[l,u]=this.scroll.leaf(i);return l?l.position(u,s):[null,-1]};return[...n(t.index,!1),...n(t.index+t.length,!0)]}setNativeRange(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Zs.info("setNativeRange",t,e,n,i),t!=null&&(this.root.parentNode==null||t.parentNode==null||n.parentNode==null))return;const l=document.getSelection();if(l!=null)if(t!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:u}=this.getNativeRange()||{};if(u==null||s||t!==u.startContainer||e!==u.startOffset||n!==u.endContainer||i!==u.endOffset){t instanceof Element&&t.tagName==="BR"&&(e=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),n instanceof Element&&n.tagName==="BR"&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const a=document.createRange();a.setStart(t,e),a.setEnd(n,i),l.removeAllRanges(),l.addRange(a)}}else l.removeAllRanges(),this.root.blur()}setRange(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ht.sources.API;if(typeof e=="string"&&(n=e,e=!1),Zs.info("setRange",t),t!=null){const i=this.rangeToNative(t);this.setNativeRange(...i,e)}else this.setNativeRange(null);this.update(n)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ht.sources.USER;const e=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,this.lastRange!=null&&(this.savedRange=this.lastRange),!gl(e,this.lastRange)){if(!this.composing&&i!=null&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const l=this.cursor.restore();l&&this.setNativeRange(l.startNode,l.startOffset,l.endNode,l.endOffset)}const s=[ht.events.SELECTION_CHANGE,Rn(this.lastRange),Rn(e),t];this.emitter.emit(ht.events.EDITOR_CHANGE,...s),t!==ht.sources.SILENT&&this.emitter.emit(...s)}}}function Js(r,t){try{t.parentNode}catch{return!1}return r.contains(t)}const Xy=/^[ -~]*$/;class Zy{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const n=wu(t),i=new pt;return Qy(n.ops.slice()).reduce((l,u)=>{const a=nr.Op.length(u);let o=u.attributes||{},c=!1,v=!1;if(u.insert!=null){if(i.retain(a),typeof u.insert=="string"){const y=u.insert;v=!y.endsWith(`
`)&&(e<=l||!!this.scroll.descendant(rr,l)[0]),this.scroll.insertAt(l,y);const[A,O]=this.scroll.line(l);let E=Wr({},tr(A));if(A instanceof _e){const[_]=A.descendant(Re,O);_&&(E=Wr(E,tr(_)))}o=nr.AttributeMap.diff(E,o)||{}}else if(typeof u.insert=="object"){const y=Object.keys(u.insert)[0];if(y==null)return l;const A=this.scroll.query(y,gt.INLINE)!=null;if(A)(e<=l||this.scroll.descendant(rr,l)[0])&&(v=!0);else if(l>0){const[O,E]=this.scroll.descendant(Re,l-1);O instanceof ur?O.value()[E]!==`
`&&(c=!0):O instanceof Ve&&O.statics.scope===gt.INLINE_BLOT&&(c=!0)}if(this.scroll.insertAt(l,y,u.insert[y]),A){const[O]=this.scroll.descendant(Re,l);if(O){const E=Wr({},tr(O));o=nr.AttributeMap.diff(E,o)||{}}}}e+=a}else if(i.push(u),u.retain!==null&&typeof u.retain=="object"){const y=Object.keys(u.retain)[0];if(y==null)return l;this.scroll.updateEmbedAt(l,y,u.retain[y])}Object.keys(o).forEach(y=>{this.scroll.formatAt(l,a,y,o[y])});const p=c?1:0,d=v?1:0;return e+=p+d,i.retain(p),i.delete(d),l+a+p+d},0),i.reduce((l,u)=>typeof u.delete=="number"?(this.scroll.deleteAt(l,u.delete),l):l+nr.Op.length(u),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(t,e){return this.scroll.deleteAt(t,e),this.update(new pt().retain(t).delete(e))}formatLine(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(s=>{this.scroll.lines(t,Math.max(e,1)).forEach(l=>{l.format(s,n[s])})}),this.scroll.optimize();const i=new pt().retain(t).retain(e,Rn(n));return this.update(i)}formatText(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(s=>{this.scroll.formatAt(t,e,s,n[s])});const i=new pt().retain(t).retain(e,Rn(n));return this.update(i)}getContents(t,e){return this.delta.slice(t,t+e)}getDelta(){return this.scroll.lines().reduce((t,e)=>t.concat(e.delta()),new pt)}getFormat(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],i=[];e===0?this.scroll.path(t).forEach(u=>{const[a]=u;a instanceof _e?n.push(a):a instanceof Re&&i.push(a)}):(n=this.scroll.lines(t,e),i=this.scroll.descendants(Re,t,e));const[s,l]=[n,i].map(u=>{const a=u.shift();if(a==null)return{};let o=tr(a);for(;Object.keys(o).length>0;){const c=u.shift();if(c==null)return o;o=Jy(tr(c),o)}return o});return{...s,...l}}getHTML(t,e){const[n,i]=this.scroll.line(t);if(n){const s=n.length();return n.length()>=i+e&&!(i===0&&e===s)?ai(n,i,e,!0):ai(this.scroll,t,e,!0)}return""}getText(t,e){return this.getContents(t,e).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(t,e){const n=wu(e),i=new pt().retain(t).concat(n);return this.scroll.insertContents(t,n),this.update(i)}insertEmbed(t,e,n){return this.scroll.insertAt(t,e,n),this.update(new pt().retain(t).insert({[e]:n}))}insertText(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(t,e),Object.keys(n).forEach(i=>{this.scroll.formatAt(t,e.length,i,n[i])}),this.update(new pt().retain(t).insert(e,Rn(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const t=this.scroll.children.head;if((t==null?void 0:t.statics.blotName)!==_e.blotName)return!1;const e=t;return e.children.length>1?!1:e.children.head instanceof hr}removeFormat(t,e){const n=this.getText(t,e),[i,s]=this.scroll.line(t+e);let l=0,u=new pt;i!=null&&(l=i.length()-s,u=i.delta().slice(s,s+l-1).insert(`
`));const o=this.getContents(t,e+l).diff(new pt().insert(n).concat(u)),c=new pt().retain(t).concat(o);return this.applyDelta(c)}update(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const i=this.delta;if(e.length===1&&e[0].type==="characterData"&&e[0].target.data.match(Xy)&&this.scroll.find(e[0].target)){const s=this.scroll.find(e[0].target),l=tr(s),u=s.offset(this.scroll),a=e[0].oldValue.replace(In.CONTENTS,""),o=new pt().insert(a),c=new pt().insert(s.value()),v=n&&{oldRange:Tu(n.oldRange,-u),newRange:Tu(n.newRange,-u)};t=new pt().retain(u).concat(o.diff(c,v)).reduce((d,y)=>y.insert?d.insert(y.insert,l):d.push(y),new pt),this.delta=i.compose(t)}else this.delta=this.getDelta(),(!t||!gl(i.compose(t),this.delta))&&(t=i.diff(this.delta,n));return t}}function wn(r,t,e){if(r.length===0){const[d]=Qs(e.pop());return t<=0?`</li></${d}>`:`</li></${d}>${wn([],t-1,e)}`}const[{child:n,offset:i,length:s,indent:l,type:u},...a]=r,[o,c]=Qs(u);if(l>t)return e.push(u),l===t+1?`<${o}><li${c}>${ai(n,i,s)}${wn(a,l,e)}`:`<${o}><li>${wn(r,t+1,e)}`;const v=e[e.length-1];if(l===t&&u===v)return`</li><li${c}>${ai(n,i,s)}${wn(a,l,e)}`;const[p]=Qs(e.pop());return`</li></${p}>${wn(r,t-1,e)}`}function ai(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in r&&typeof r.html=="function")return r.html(t,e);if(r instanceof ur)return Ns(r.value().slice(t,t+e)).replaceAll(" ","&nbsp;");if(r instanceof lr){if(r.statics.blotName==="list-container"){const o=[];return r.children.forEachAt(t,e,(c,v,p)=>{const d="formats"in c&&typeof c.formats=="function"?c.formats():{};o.push({child:c,offset:v,length:p,indent:d.indent||0,type:d.list})}),wn(o,-1,[])}const i=[];if(r.children.forEachAt(t,e,(o,c,v)=>{i.push(ai(o,c,v))}),n||r.statics.blotName==="list")return i.join("");const{outerHTML:s,innerHTML:l}=r.domNode,[u,a]=s.split(`>${l}<`);return u==="<table"?`<table style="border: 1px solid #000;">${i.join("")}<${a}`:`${u}>${i.join("")}<${a}`}return r.domNode instanceof Element?r.domNode.outerHTML:""}function Jy(r,t){return Object.keys(t).reduce((e,n)=>{if(r[n]==null)return e;const i=t[n];return i===r[n]?e[n]=i:Array.isArray(i)?i.indexOf(r[n])<0?e[n]=i.concat([r[n]]):e[n]=i:e[n]=[i,r[n]],e},{})}function Qs(r){const t=r==="ordered"?"ol":"ul";switch(r){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function wu(r){return r.reduce((t,e)=>{if(typeof e.insert=="string"){const n=e.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return t.insert(n,e.attributes)}return t.push(e)},new pt)}function Tu(r,t){let{index:e,length:n}=r;return new on(e+t,n)}function Qy(r){const t=[];return r.forEach(e=>{typeof e.insert=="string"?e.insert.split(`
`).forEach((i,s)=>{s&&t.push({insert:`
`,attributes:e.attributes}),i&&t.push({insert:i,attributes:e.attributes})}):t.push(e)}),t}class dr{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=t,this.options=e}}ct(dr,"DEFAULTS",{});const Fi="\uFEFF";class yl extends Ve{constructor(t,e){super(t,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(Fi),this.rightGuard=document.createTextNode(Fi),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,e){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,e)}restore(t){let e=null,n;const i=t.data.split(Fi).join("");if(t===this.leftGuard)if(this.prev instanceof ur){const s=this.prev.length();this.prev.insertAt(s,i),e={startNode:this.prev.domNode,startOffset:s+i.length}}else n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this),e={startNode:n,startOffset:i.length};else t===this.rightGuard&&(this.next instanceof ur?(this.next.insertAt(0,i),e={startNode:this.next.domNode,startOffset:i.length}):(n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this.next),e={startNode:n,startOffset:i.length}));return t.data=Fi,e}update(t,e){t.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){const i=this.restore(n.target);i&&(e.range=i)}})}}class tb{constructor(t,e){ct(this,"isComposing",!1);this.scroll=t,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",t=>{this.isComposing||this.handleCompositionStart(t)}),this.scroll.domNode.addEventListener("compositionend",t=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(t)})})}handleCompositionStart(t){const e=t.target instanceof Node?this.scroll.find(t.target,!0):null;e&&!(e instanceof yl)&&(this.emitter.emit(ht.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit(ht.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit(ht.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit(ht.events.COMPOSITION_END,t),this.isComposing=!1}}const ei=class ei{constructor(t,e){ct(this,"modules",{});this.quill=t,this.options=e}init(){Object.keys(this.options.modules).forEach(t=>{this.modules[t]==null&&this.addModule(t)})}addModule(t){const e=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}};ct(ei,"DEFAULTS",{modules:{}}),ct(ei,"themes",{default:ei});let qn=ei;const eb=r=>r.parentElement||r.getRootNode().host||null,rb=r=>{const t=r.getBoundingClientRect(),e="offsetWidth"in r&&Math.abs(t.width)/r.offsetWidth||1,n="offsetHeight"in r&&Math.abs(t.height)/r.offsetHeight||1;return{top:t.top,right:t.left+r.clientWidth*e,bottom:t.top+r.clientHeight*n,left:t.left}},$i=r=>{const t=parseInt(r,10);return Number.isNaN(t)?0:t},Ru=(r,t,e,n,i,s)=>r<e&&t>n?0:r<e?-(e-r+i):t>n?t-r>n-e?r+i-e:t-n+s:0,nb=(r,t)=>{var s,l,u,a,o;const e=r.ownerDocument;let n=t,i=r;for(;i;){const c=i===e.body,v=c?{top:0,right:(l=(s=window.visualViewport)==null?void 0:s.width)!=null?l:e.documentElement.clientWidth,bottom:(a=(u=window.visualViewport)==null?void 0:u.height)!=null?a:e.documentElement.clientHeight,left:0}:rb(i),p=getComputedStyle(i),d=Ru(n.left,n.right,v.left,v.right,$i(p.scrollPaddingLeft),$i(p.scrollPaddingRight)),y=Ru(n.top,n.bottom,v.top,v.bottom,$i(p.scrollPaddingTop),$i(p.scrollPaddingBottom));if(d||y)if(c)(o=e.defaultView)==null||o.scrollBy(d,y);else{const{scrollLeft:A,scrollTop:O}=i;y&&(i.scrollTop+=y),d&&(i.scrollLeft+=d);const E=i.scrollLeft-A,_=i.scrollTop-O;n={left:n.left-E,top:n.top-_,right:n.right-E,bottom:n.bottom-_}}i=c||p.position==="fixed"?null:eb(i)}},ib=100,sb=["block","break","cursor","inline","scroll","text"],ob=(r,t,e)=>{const n=new xn;return sb.forEach(i=>{const s=t.query(i);s&&n.register(s)}),r.forEach(i=>{var u;let s=t.query(i);s||e.error(`Cannot register "${i}" specified in "formats" config. Are you sure it was registered?`);let l=0;for(;s;)if(n.register(s),s="blotName"in s&&(u=s.requiredContainer)!=null?u:null,l+=1,l>ib){e.error(`Cycle detected in registering blot requiredContainer: "${i}"`);break}}),n},Ln=Dr("quill"),Ui=new xn;lr.uiClass="ql-ui";const sr=class sr{static debug(t){t===!0&&(t="log"),Dr.level(t)}static find(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Za.get(t)||Ui.find(t,e)}static import(t){return this.imports[t]==null&&Ln.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const t=arguments.length<=0?void 0:arguments[0],e=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in t?t.attrName:t.blotName;typeof n=="string"?this.register(`formats/${n}`,t,e):Object.keys(t).forEach(i=>{this.register(i,t[i],e)})}else{const t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[t]!=null&&!n&&Ln.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&e&&typeof e!="boolean"&&e.blotName!=="abstract"&&Ui.register(e),typeof e.register=="function"&&e.register(Ui)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=ab(t,e),this.container=this.options.container,this.container==null){Ln.error("Invalid Quill container",t);return}this.options.debug&&sr.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Za.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new ht;const i=ml.blotName,s=this.options.registry.query(i);if(!s||!("blotName"in s))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new s(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Zy(this.scroll),this.selection=new Yy(this.scroll,this.emitter),this.composition=new tb(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(ht.events.EDITOR_CHANGE,l=>{l===ht.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(ht.events.SCROLL_UPDATE,(l,u)=>{const a=this.selection.lastRange,[o]=this.selection.getRange(),c=a&&o?{oldRange:a,newRange:o}:void 0;ir.call(this,()=>this.editor.update(null,u,c),l)}),this.emitter.on(ht.events.SCROLL_EMBED_UPDATE,(l,u)=>{const a=this.selection.lastRange,[o]=this.selection.getRange(),c=a&&o?{oldRange:a,newRange:o}:void 0;ir.call(this,()=>{const v=new pt().retain(l.offset(this)).retain({[l.statics.blotName]:u});return this.editor.update(v,[],c)},sr.sources.USER)}),n){const l=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(l)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof t=="string"){const n=t;t=document.createElement("div"),t.classList.add(n)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,n){return[t,e,,n]=Cr(t,e,n),ir.call(this,()=>this.editor.deleteText(t,e),n,t,-1*e)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;const e=t();return this.allowReadOnlyEdits=!1,e}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ht.sources.API;return ir.call(this,()=>{const i=this.getSelection(!0);let s=new pt;if(i==null)return s;if(this.scroll.query(t,gt.BLOCK))s=this.editor.formatLine(i.index,i.length,{[t]:e});else{if(i.length===0)return this.selection.format(t,e),s;s=this.editor.formatText(i.index,i.length,{[t]:e})}return this.setSelection(i,ht.sources.SILENT),s},n)}formatLine(t,e,n,i,s){let l;return[t,e,l,s]=Cr(t,e,n,i,s),ir.call(this,()=>this.editor.formatLine(t,e,l),s,t,0)}formatText(t,e,n,i,s){let l;return[t,e,l,s]=Cr(t,e,n,i,s),ir.call(this,()=>this.editor.formatText(t,e,l),s,t,0)}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof t=="number"?n=this.selection.getBounds(t,e):n=this.selection.getBounds(t.index,t.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-t;return[t,e]=Cr(t,e),this.editor.getContents(t,e)}getFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof t=="number"?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof t!="number"?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e!=null?e:this.getLength()-t),[t,e]=Cr(t,e),this.editor.getHTML(t,e)}getText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e!=null?e:this.getLength()-t),[t,e]=Cr(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:sr.sources.API;return ir.call(this,()=>this.editor.insertEmbed(t,e,n),i,t)}insertText(t,e,n,i,s){let l;return[t,,l,s]=Cr(t,0,n,i,s),ir.call(this,()=>this.editor.insertText(t,e,l),s,t,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(t,e,n){return[t,e,,n]=Cr(t,e,n),ir.call(this,()=>this.editor.removeFormat(t,e),n,t)}scrollRectIntoView(t){nb(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const t=this.selection.lastRange,e=t&&this.selection.getBounds(t.index,t.length);e&&this.scrollRectIntoView(e)}setContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht.sources.API;return ir.call(this,()=>{t=new pt(t);const n=this.getLength(),i=this.editor.deleteText(0,n),s=this.editor.insertContents(0,t),l=this.editor.deleteText(this.getLength()-1,1);return i.compose(s).compose(l)},e)}setSelection(t,e,n){t==null?this.selection.setRange(null,e||sr.sources.API):([t,e,,n]=Cr(t,e,n),this.selection.setRange(new on(Math.max(0,t),e),n),n!==ht.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht.sources.API;const n=new pt().insert(t);return this.setContents(n,e)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ht.sources.USER;const e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ht.sources.API;return ir.call(this,()=>(t=new pt(t),this.editor.applyDelta(t)),e,!0)}};ct(sr,"DEFAULTS",{bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:Ui,theme:"default"}),ct(sr,"events",ht.events),ct(sr,"sources",ht.sources),ct(sr,"version","2.0.3"),ct(sr,"imports",{delta:pt,parchment:ky,"core/module":dr,"core/theme":qn});let et=sr;function Nu(r){return typeof r=="string"?document.querySelector(r):r}function to(r){return Object.entries(r!=null?r:{}).reduce((t,e)=>{let[n,i]=e;return{...t,[n]:i===!0?{}:i}},{})}function Lu(r){return Object.fromEntries(Object.entries(r).filter(t=>t[1]!==void 0))}function ab(r,t){const e=Nu(r);if(!e)throw new Error("Invalid Quill container");const i=!t.theme||t.theme===et.DEFAULTS.theme?qn:et.import(`themes/${t.theme}`);if(!i)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);const{modules:s,...l}=et.DEFAULTS,{modules:u,...a}=i.DEFAULTS;let o=to(t.modules);o!=null&&o.toolbar&&o.toolbar.constructor!==Object&&(o={...o,toolbar:{container:o.toolbar}});const c=Wr({},to(s),to(u),o),v={...l,...Lu(a),...Lu(t)};let p=t.registry;return p?t.formats&&Ln.warn('Ignoring "formats" option because "registry" is specified'):p=t.formats?ob(t.formats,v.registry,Ln):v.registry,{...v,registry:p,container:e,theme:i,modules:Object.entries(c).reduce((d,y)=>{let[A,O]=y;if(!O)return d;const E=et.import(`modules/${A}`);return E==null?(Ln.error(`Cannot load ${A} module. Are you sure you registered it?`),d):{...d,[A]:Wr({},E.DEFAULTS||{},O)}},{}),bounds:Nu(v.bounds)}}function ir(r,t,e,n){if(!this.isEnabled()&&t===ht.sources.USER&&!this.allowReadOnlyEdits)return new pt;let i=e==null?null:this.getSelection();const s=this.editor.delta,l=r();if(i!=null&&(e===!0&&(e=i.index),n==null?i=Cu(i,l,t):n!==0&&(i=Cu(i,e,n,t)),this.setSelection(i,ht.sources.SILENT)),l.length()>0){const u=[ht.events.TEXT_CHANGE,l,s,t];this.emitter.emit(ht.events.EDITOR_CHANGE,...u),t!==ht.sources.SILENT&&this.emitter.emit(...u)}return l}function Cr(r,t,e,n,i){let s={};return typeof r.index=="number"&&typeof r.length=="number"?typeof t!="number"?(i=n,n=e,e=t,t=r.length,r=r.index):(t=r.length,r=r.index):typeof t!="number"&&(i=n,n=e,e=t,t=0),typeof e=="object"?(s=e,i=n):typeof e=="string"&&(n!=null?s[e]=n:i=e),i=i||ht.sources.API,[r,t,s,i]}function Cu(r,t,e,n){const i=typeof e=="number"?e:0;if(r==null)return null;let s,l;return t&&typeof t.transformPosition=="function"?[s,l]=[r.index,r.index+r.length].map(u=>t.transformPosition(u,n!==ht.sources.USER)):[s,l]=[r.index,r.index+r.length].map(u=>u<t||u===t&&n===ht.sources.USER?u:i>=0?u+i:Math.max(t,u+i)),new on(s,l-s)}class cn extends ws{}function xu(r){return r instanceof _e||r instanceof rr}function Iu(r){return typeof r.updateContent=="function"}class Tn extends ml{constructor(t,e,n){let{emitter:i}=n;super(t,e),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",s=>this.handleDragStart(s))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit(ht.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit(ht.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,e){this.emitter.emit(ht.events.SCROLL_EMBED_UPDATE,t,e)}deleteAt(t,e){const[n,i]=this.line(t),[s]=this.line(t+e);if(super.deleteAt(t,e),s!=null&&n!==s&&i>0){if(n instanceof rr||s instanceof rr){this.optimize();return}const l=s.children.head instanceof hr?null:s.children.head;n.moveChildren(s,l),n.remove()}this.optimize()}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,e,n,i){super.formatAt(t,e,n,i),this.optimize()}insertAt(t,e,n){if(t>=this.length())if(n==null||this.scroll.query(e,gt.BLOCK)==null){const i=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(i),n==null&&e.endsWith(`
`)?i.insertAt(0,e.slice(0,-1),n):i.insertAt(0,e,n)}else{const i=this.scroll.create(e,n);this.appendChild(i)}else super.insertAt(t,e,n);this.optimize()}insertBefore(t,e){if(t.statics.scope===gt.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(t),super.insertBefore(n,e)}else super.insertBefore(t,e)}insertContents(t,e){const n=this.deltaToRenderBlocks(e.concat(new pt().insert(`
`))),i=n.pop();if(i==null)return;this.batchStart();const s=n.shift();if(s){const a=s.type==="block"&&(s.delta.length()===0||!this.descendant(rr,t)[0]&&t<this.length()),o=s.type==="block"?s.delta:new pt().insert({[s.key]:s.value});eo(this,t,o);const c=s.type==="block"?1:0,v=t+o.length()+c;a&&this.insertAt(v-1,`
`);const p=tr(this.line(t)[0]),d=nr.AttributeMap.diff(p,s.attributes)||{};Object.keys(d).forEach(y=>{this.formatAt(v-1,1,y,d[y])}),t=v}let[l,u]=this.children.find(t);if(n.length&&(l&&(l=l.split(u),u=0),n.forEach(a=>{if(a.type==="block"){const o=this.createBlock(a.attributes,l||void 0);eo(o,0,a.delta)}else{const o=this.create(a.key,a.value);this.insertBefore(o,l||void 0),Object.keys(a.attributes).forEach(c=>{o.format(c,a.attributes[c])})}})),i.type==="block"&&i.delta.length()){const a=l?l.offset(l.scroll)+u:this.length();eo(this,a,i.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(t){const e=this.path(t).pop();if(!e)return[null,-1];const[n,i]=e;return n instanceof Re?[n,i]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(xu,t)}lines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const n=(i,s,l)=>{let u=[],a=l;return i.children.forEachAt(s,l,(o,c,v)=>{xu(o)?u.push(o):o instanceof ws&&(u=u.concat(n(o,c,a))),a-=v}),u};return n(this,t,e)}optimize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(t,e),t.length>0&&this.emitter.emit(ht.events.SCROLL_OPTIMIZE,t,e))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch){Array.isArray(t)&&(this.batch=this.batch.concat(t));return}let e=ht.sources.USER;typeof t=="string"&&(e=t),Array.isArray(t)||(t=this.observer.takeRecords()),t=t.filter(n=>{let{target:i}=n;const s=this.find(i,!0);return s&&!Iu(s)}),t.length>0&&this.emitter.emit(ht.events.SCROLL_BEFORE_UPDATE,e,t),super.update(t.concat([])),t.length>0&&this.emitter.emit(ht.events.SCROLL_UPDATE,e,t)}updateEmbedAt(t,e,n){const[i]=this.descendant(s=>s instanceof rr,t);i&&i.statics.blotName===e&&Iu(i)&&i.updateContent(n)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){const e=[];let n=new pt;return t.forEach(i=>{var l;const s=i==null?void 0:i.insert;if(s)if(typeof s=="string"){const u=s.split(`
`);u.slice(0,-1).forEach(o=>{var c;n.insert(o,i.attributes),e.push({type:"block",delta:n,attributes:(c=i.attributes)!=null?c:{}}),n=new pt});const a=u[u.length-1];a&&n.insert(a,i.attributes)}else{const u=Object.keys(s)[0];if(!u)return;this.query(u,gt.INLINE)?n.push(i):(n.length()&&e.push({type:"block",delta:n,attributes:{}}),n=new pt,e.push({type:"blockEmbed",key:u,value:s[u],attributes:(l=i.attributes)!=null?l:{}}))}}),n.length()&&e.push({type:"block",delta:n,attributes:{}}),e}createBlock(t,e){let n;const i={};Object.entries(t).forEach(u=>{let[a,o]=u;this.query(a,gt.BLOCK&gt.BLOT)!=null?n=a:i[a]=o});const s=this.create(n||this.statics.defaultChild.blotName,n?t[n]:void 0);this.insertBefore(s,e||void 0);const l=s.length();return Object.entries(i).forEach(u=>{let[a,o]=u;s.formatAt(0,l,a,o)}),s}}ct(Tn,"blotName","scroll"),ct(Tn,"className","ql-editor"),ct(Tn,"tagName","DIV"),ct(Tn,"defaultChild",_e),ct(Tn,"allowedChildren",[_e,rr,cn]);function eo(r,t,e){e.reduce((n,i)=>{const s=nr.Op.length(i);let l=i.attributes||{};if(i.insert!=null){if(typeof i.insert=="string"){const u=i.insert;r.insertAt(n,u);const[a]=r.descendant(Re,n),o=tr(a);l=nr.AttributeMap.diff(o,l)||{}}else if(typeof i.insert=="object"){const u=Object.keys(i.insert)[0];if(u==null)return n;if(r.insertAt(n,u,i.insert[u]),r.scroll.query(u,gt.INLINE)!=null){const[o]=r.descendant(Re,n),c=tr(o);l=nr.AttributeMap.diff(c,l)||{}}}}return Object.keys(l).forEach(u=>{r.formatAt(n,s,u,l[u])}),n+s},t)}const bl={scope:gt.BLOCK,whitelist:["right","center","justify"]},lb=new Sr("align","align",bl),yh=new fr("align","ql-align",bl),bh=new Jr("align","text-align",bl);class _h extends Jr{value(t){let e=super.value(t);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map(i=>`00${parseInt(i,10).toString(16)}`.slice(-2)).join("")}`):e}}const ub=new fr("color","ql-color",{scope:gt.INLINE}),_l=new _h("color","color",{scope:gt.INLINE}),cb=new fr("background","ql-bg",{scope:gt.INLINE}),El=new _h("background","background-color",{scope:gt.INLINE});class fn extends cn{static create(t){const e=super.create(t);return e.setAttribute("spellcheck","false"),e}code(t,e){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(t,t+e)}html(t,e){return`<pre>
${Ns(this.code(t,e))}
</pre>`}}class Ne extends _e{static register(){et.register(fn)}}ct(Ne,"TAB","  ");class Al extends wr{}Al.blotName="code";Al.tagName="CODE";Ne.blotName="code-block";Ne.className="ql-code-block";Ne.tagName="DIV";fn.blotName="code-block-container";fn.className="ql-code-block-container";fn.tagName="DIV";fn.allowedChildren=[Ne];Ne.allowedChildren=[ur,hr,In];Ne.requiredContainer=fn;const Ol={scope:gt.BLOCK,whitelist:["rtl"]},Eh=new Sr("direction","dir",Ol),Ah=new fr("direction","ql-direction",Ol),Oh=new Jr("direction","direction",Ol),Sh={scope:gt.INLINE,whitelist:["serif","monospace"]},wh=new fr("font","ql-font",Sh);class fb extends Jr{value(t){return super.value(t).replace(/["']/g,"")}}const Th=new fb("font","font-family",Sh),Rh=new fr("size","ql-size",{scope:gt.INLINE,whitelist:["small","large","huge"]}),Nh=new Jr("size","font-size",{scope:gt.INLINE,whitelist:["10px","18px","32px"]}),hb=Dr("quill:keyboard"),db=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Ls extends dr{static match(t,e){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!e[n]!==t[n]&&e[n]!==null)?!1:e.key===t.key||e.key===t.which}constructor(t,e){super(t,e),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=gb(t);if(i==null){hb.warn("Attempted to add invalid keyboard binding",i);return}typeof e=="function"&&(e={handler:e}),typeof n=="function"&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach(l=>{const u={...i,key:l,...e,...n};this.bindings[u.key]=this.bindings[u.key]||[],this.bindings[u.key].push(u)})}listen(){this.quill.root.addEventListener("keydown",t=>{if(t.defaultPrevented||t.isComposing||t.keyCode===229&&(t.key==="Enter"||t.key==="Backspace"))return;const i=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter(E=>Ls.match(t,E));if(i.length===0)return;const s=et.find(t.target,!0);if(s&&s.scroll!==this.quill.scroll)return;const l=this.quill.getSelection();if(l==null||!this.quill.hasFocus())return;const[u,a]=this.quill.getLine(l.index),[o,c]=this.quill.getLeaf(l.index),[v,p]=l.length===0?[o,c]:this.quill.getLeaf(l.index+l.length),d=o instanceof rs?o.value().slice(0,c):"",y=v instanceof rs?v.value().slice(p):"",A={collapsed:l.length===0,empty:l.length===0&&u.length()<=1,format:this.quill.getFormat(l),line:u,offset:a,prefix:d,suffix:y,event:t};i.some(E=>{if(E.collapsed!=null&&E.collapsed!==A.collapsed||E.empty!=null&&E.empty!==A.empty||E.offset!=null&&E.offset!==A.offset)return!1;if(Array.isArray(E.format)){if(E.format.every(_=>A.format[_]==null))return!1}else if(typeof E.format=="object"&&!Object.keys(E.format).every(_=>E.format[_]===!0?A.format[_]!=null:E.format[_]===!1?A.format[_]==null:gl(E.format[_],A.format[_])))return!1;return E.prefix!=null&&!E.prefix.test(A.prefix)||E.suffix!=null&&!E.suffix.test(A.suffix)?!1:E.handler.call(this,l,A,E)!==!0})&&t.preventDefault()})}handleBackspace(t,e){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(t.index===0||this.quill.getLength()<=1)return;let i={};const[s]=this.quill.getLine(t.index);let l=new pt().retain(t.index-n).delete(n);if(e.offset===0){const[u]=this.quill.getLine(t.index-1);if(u&&!(u.statics.blotName==="block"&&u.length()<=1)){const o=s.formats(),c=this.quill.getFormat(t.index-1,1);if(i=nr.AttributeMap.diff(o,c)||{},Object.keys(i).length>0){const v=new pt().retain(t.index+s.length()-2).retain(1,i);l=l.compose(v)}}}this.quill.updateContents(l,et.sources.USER),this.quill.focus()}handleDelete(t,e){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(t.index>=this.quill.getLength()-n)return;let i={};const[s]=this.quill.getLine(t.index);let l=new pt().retain(t.index).delete(n);if(e.offset>=s.length()-1){const[u]=this.quill.getLine(t.index+1);if(u){const a=s.formats(),o=this.quill.getFormat(t.index,1);i=nr.AttributeMap.diff(a,o)||{},Object.keys(i).length>0&&(l=l.retain(u.length()-1).retain(1,i))}}this.quill.updateContents(l,et.sources.USER),this.quill.focus()}handleDeleteRange(t){Sl({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,e){const n=Object.keys(e.format).reduce((s,l)=>(this.quill.scroll.query(l,gt.BLOCK)&&!Array.isArray(e.format[l])&&(s[l]=e.format[l]),s),{}),i=new pt().retain(t.index).delete(t.length).insert(`
`,n);this.quill.updateContents(i,et.sources.USER),this.quill.setSelection(t.index+1,et.sources.SILENT),this.quill.focus()}}const pb={bindings:{bold:ro("bold"),italic:ro("italic"),underline:ro("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(r,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","+1",et.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(r,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","-1",et.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(r,t){t.format.indent!=null?this.quill.format("indent","-1",et.sources.USER):t.format.list!=null&&this.quill.format("list",!1,et.sources.USER)}},"indent code-block":qu(!0),"outdent code-block":qu(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(r){this.quill.deleteText(r.index-1,1,et.sources.USER)}},tab:{key:"Tab",handler(r,t){if(t.format.table)return!0;this.quill.history.cutoff();const e=new pt().retain(r.index).delete(r.length).insert("	");return this.quill.updateContents(e,et.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(r.index+1,et.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,et.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(r,t){const e={list:!1};t.format.indent&&(e.indent=!1),this.quill.formatLine(r.index,r.length,e,et.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(r){const[t,e]=this.quill.getLine(r.index),n={...t.formats(),list:"checked"},i=new pt().retain(r.index).insert(`
`,n).retain(t.length()-e-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,et.sources.USER),this.quill.setSelection(r.index+1,et.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(r,t){const[e,n]=this.quill.getLine(r.index),i=new pt().retain(r.index).insert(`
`,t.format).retain(e.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,et.sources.USER),this.quill.setSelection(r.index+1,et.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(r){const t=this.quill.getModule("table");if(t){const[e,n,i,s]=t.getTable(r),l=vb(e,n,i,s);if(l==null)return;let u=e.offset();if(l<0){const a=new pt().retain(u).insert(`
`);this.quill.updateContents(a,et.sources.USER),this.quill.setSelection(r.index+1,r.length,et.sources.SILENT)}else if(l>0){u+=e.length();const a=new pt().retain(u).insert(`
`);this.quill.updateContents(a,et.sources.USER),this.quill.setSelection(u,et.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(r,t){const{event:e,line:n}=t,i=n.offset(this.quill.scroll);e.shiftKey?this.quill.setSelection(i-1,et.sources.USER):this.quill.setSelection(i+n.length(),et.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(r,t){if(this.quill.scroll.query("list")==null)return!0;const{length:e}=t.prefix,[n,i]=this.quill.getLine(r.index);if(i>e)return!0;let s;switch(t.prefix.trim()){case"[]":case"[ ]":s="unchecked";break;case"[x]":s="checked";break;case"-":case"*":s="bullet";break;default:s="ordered"}this.quill.insertText(r.index," ",et.sources.USER),this.quill.history.cutoff();const l=new pt().retain(r.index-i).delete(e+1).retain(n.length()-2-i).retain(1,{list:s});return this.quill.updateContents(l,et.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(r.index-e,et.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(r){const[t,e]=this.quill.getLine(r.index);let n=2,i=t;for(;i!=null&&i.length()<=1&&i.formats()["code-block"];)if(i=i.prev,n-=1,n<=0){const s=new pt().retain(r.index+t.length()-e-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(s,et.sources.USER),this.quill.setSelection(r.index-1,et.sources.SILENT),!1}return!0}},"embed left":Hi("ArrowLeft",!1),"embed left shift":Hi("ArrowLeft",!0),"embed right":Hi("ArrowRight",!1),"embed right shift":Hi("ArrowRight",!0),"table down":Pu(!1),"table up":Pu(!0)}};Ls.DEFAULTS=pb;function qu(r){return{key:"Tab",shiftKey:!r,format:{"code-block":!0},handler(t,e){let{event:n}=e;const i=this.quill.scroll.query("code-block"),{TAB:s}=i;if(t.length===0&&!n.shiftKey){this.quill.insertText(t.index,s,et.sources.USER),this.quill.setSelection(t.index+s.length,et.sources.SILENT);return}const l=t.length===0?this.quill.getLines(t.index,1):this.quill.getLines(t);let{index:u,length:a}=t;l.forEach((o,c)=>{r?(o.insertAt(0,s),c===0?u+=s.length:a+=s.length):o.domNode.textContent.startsWith(s)&&(o.deleteAt(0,s.length),c===0?u-=s.length:a-=s.length)}),this.quill.update(et.sources.USER),this.quill.setSelection(u,a,et.sources.SILENT)}}}function Hi(r,t){return{key:r,shiftKey:t,altKey:null,[r==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;r==="ArrowRight"&&(i+=n.length+1);const[s]=this.quill.getLeaf(i);return s instanceof Ve?(r==="ArrowLeft"?t?this.quill.setSelection(n.index-1,n.length+1,et.sources.USER):this.quill.setSelection(n.index-1,et.sources.USER):t?this.quill.setSelection(n.index,n.length+1,et.sources.USER):this.quill.setSelection(n.index+n.length+1,et.sources.USER),!1):!0}}}function ro(r){return{key:r[0],shortKey:!0,handler(t,e){this.quill.format(r,!e.format[r],et.sources.USER)}}}function Pu(r){return{key:r?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,e){const n=r?"prev":"next",i=e.line,s=i.parent[n];if(s!=null){if(s.statics.blotName==="table-row"){let l=s.children.head,u=i;for(;u.prev!=null;)u=u.prev,l=l.next;const a=l.offset(this.quill.scroll)+Math.min(e.offset,l.length()-1);this.quill.setSelection(a,0,et.sources.USER)}}else{const l=i.table()[n];l!=null&&(r?this.quill.setSelection(l.offset(this.quill.scroll)+l.length()-1,0,et.sources.USER):this.quill.setSelection(l.offset(this.quill.scroll),0,et.sources.USER))}return!1}}}function gb(r){if(typeof r=="string"||typeof r=="number")r={key:r};else if(typeof r=="object")r=Rn(r);else return null;return r.shortKey&&(r[db]=r.shortKey,delete r.shortKey),r}function Sl(r){let{quill:t,range:e}=r;const n=t.getLines(e);let i={};if(n.length>1){const s=n[0].formats(),l=n[n.length-1].formats();i=nr.AttributeMap.diff(l,s)||{}}t.deleteText(e,et.sources.USER),Object.keys(i).length>0&&t.formatLine(e.index,1,i,et.sources.USER),t.setSelection(e.index,et.sources.SILENT)}function vb(r,t,e,n){return t.prev==null&&t.next==null?e.prev==null&&e.next==null?n===0?-1:1:e.prev==null?-1:1:t.prev==null?-1:t.next==null?1:null}const mb=/font-weight:\s*normal/,yb=["P","OL","UL"],Du=r=>r&&yb.includes(r.tagName),bb=r=>{Array.from(r.querySelectorAll("br")).filter(t=>Du(t.previousElementSibling)&&Du(t.nextElementSibling)).forEach(t=>{var e;(e=t.parentNode)==null||e.removeChild(t)})},_b=r=>{Array.from(r.querySelectorAll('b[style*="font-weight"]')).filter(t=>{var e;return(e=t.getAttribute("style"))==null?void 0:e.match(mb)}).forEach(t=>{var n;const e=r.createDocumentFragment();e.append(...t.childNodes),(n=t.parentNode)==null||n.replaceChild(e,t)})};function Eb(r){r.querySelector('[id^="docs-internal-guid-"]')&&(_b(r),bb(r))}const Ab=/\bmso-list:[^;]*ignore/i,Ob=/\bmso-list:[^;]*\bl(\d+)/i,Sb=/\bmso-list:[^;]*\blevel(\d+)/i,wb=(r,t)=>{const e=r.getAttribute("style"),n=e==null?void 0:e.match(Ob);if(!n)return null;const i=Number(n[1]),s=e==null?void 0:e.match(Sb),l=s?Number(s[1]):1,u=new RegExp(`@list l${i}:level${l}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),a=t.match(u),o=a&&a[1]==="bullet"?"bullet":"ordered";return{id:i,indent:l,type:o,element:r}},Tb=r=>{var l,u;const t=Array.from(r.querySelectorAll("[style*=mso-list]")),e=[],n=[];t.forEach(a=>{(a.getAttribute("style")||"").match(Ab)?e.push(a):n.push(a)}),e.forEach(a=>{var o;return(o=a.parentNode)==null?void 0:o.removeChild(a)});const i=r.documentElement.innerHTML,s=n.map(a=>wb(a,i)).filter(a=>a);for(;s.length;){const a=[];let o=s.shift();for(;o;)a.push(o),o=s.length&&((l=s[0])==null?void 0:l.element)===o.element.nextElementSibling&&s[0].id===o.id?s.shift():null;const c=document.createElement("ul");a.forEach(d=>{const y=document.createElement("li");y.setAttribute("data-list",d.type),d.indent>1&&y.setAttribute("class",`ql-indent-${d.indent-1}`),y.innerHTML=d.element.innerHTML,c.appendChild(y)});const v=(u=a[0])==null?void 0:u.element,{parentNode:p}=v!=null?v:{};v&&(p==null||p.replaceChild(c,v)),a.slice(1).forEach(d=>{let{element:y}=d;p==null||p.removeChild(y)})}};function Rb(r){r.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&Tb(r)}const Nb=[Rb,Eb],Lb=r=>{r.documentElement&&Nb.forEach(t=>{t(r)})},Cb=Dr("quill:clipboard"),xb=[[Node.TEXT_NODE,Hb],[Node.TEXT_NODE,ju],["br",Mb],[Node.ELEMENT_NODE,ju],[Node.ELEMENT_NODE,Db],[Node.ELEMENT_NODE,Pb],[Node.ELEMENT_NODE,$b],["li",Bb],["ol, ul",Fb],["pre",jb],["tr",Ub],["b",no("bold")],["i",no("italic")],["strike",no("strike")],["style",kb]],Ib=[lb,Eh].reduce((r,t)=>(r[t.keyName]=t,r),{}),Mu=[bh,El,_l,Oh,Th,Nh].reduce((r,t)=>(r[t.keyName]=t,r),{});class Lh extends dr{constructor(t,e){var n;super(t,e),this.quill.root.addEventListener("copy",i=>this.onCaptureCopy(i,!1)),this.quill.root.addEventListener("cut",i=>this.onCaptureCopy(i,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],xb.concat((n=this.options.matchers)!=null?n:[]).forEach(i=>{let[s,l]=i;this.addMatcher(s,l)})}addMatcher(t,e){this.matchers.push([t,e])}convert(t){let{html:e,text:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i[Ne.blotName])return new pt().insert(n||"",{[Ne.blotName]:i[Ne.blotName]});if(!e)return new pt().insert(n||"",i);const s=this.convertHTML(e);return mi(s,`
`)&&(s.ops[s.ops.length-1].attributes==null||i.table)?s.compose(new pt().retain(s.length()-1).delete(1)):s}normalizeHTML(t){Lb(t)}convertHTML(t){const e=new DOMParser().parseFromString(t,"text/html");this.normalizeHTML(e);const n=e.body,i=new WeakMap,[s,l]=this.prepareMatching(n,i);return wl(this.quill.scroll,n,s,l,i)}dangerouslyPasteHTML(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:et.sources.API;if(typeof t=="string"){const i=this.convert({html:t,text:""});this.quill.setContents(i,e),this.quill.setSelection(0,et.sources.SILENT)}else{const i=this.convert({html:e,text:""});this.quill.updateContents(new pt().retain(t).concat(i),n),this.quill.setSelection(t+i.length(),et.sources.SILENT)}}onCaptureCopy(t){var l,u;let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.defaultPrevented)return;t.preventDefault();const[n]=this.quill.selection.getRange();if(n==null)return;const{html:i,text:s}=this.onCopy(n,e);(l=t.clipboardData)==null||l.setData("text/plain",s),(u=t.clipboardData)==null||u.setData("text/html",i),e&&Sl({range:n,quill:this.quill})}normalizeURIList(t){return t.split(/\r?\n/).filter(e=>e[0]!=="#").join(`
`)}onCapturePaste(t){var l,u,a,o,c;if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();const e=this.quill.getSelection(!0);if(e==null)return;const n=(l=t.clipboardData)==null?void 0:l.getData("text/html");let i=(u=t.clipboardData)==null?void 0:u.getData("text/plain");if(!n&&!i){const v=(a=t.clipboardData)==null?void 0:a.getData("text/uri-list");v&&(i=this.normalizeURIList(v))}const s=Array.from(((o=t.clipboardData)==null?void 0:o.files)||[]);if(!n&&s.length>0){this.quill.uploader.upload(e,s);return}if(n&&s.length>0){const v=new DOMParser().parseFromString(n,"text/html");if(v.body.childElementCount===1&&((c=v.body.firstElementChild)==null?void 0:c.tagName)==="IMG"){this.quill.uploader.upload(e,s);return}}this.onPaste(e,{html:n,text:i})}onCopy(t){const e=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:e}}onPaste(t,e){let{text:n,html:i}=e;const s=this.quill.getFormat(t.index),l=this.convert({text:n,html:i},s);Cb.log("onPaste",l,{text:n,html:i});const u=new pt().retain(t.index).delete(t.length).concat(l);this.quill.updateContents(u,et.sources.USER),this.quill.setSelection(u.length()-t.length,et.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,e){const n=[],i=[];return this.matchers.forEach(s=>{const[l,u]=s;switch(l){case Node.TEXT_NODE:i.push(u);break;case Node.ELEMENT_NODE:n.push(u);break;default:Array.from(t.querySelectorAll(l)).forEach(a=>{if(e.has(a)){const o=e.get(a);o==null||o.push(u)}else e.set(a,[u])});break}}),[n,i]}}ct(Lh,"DEFAULTS",{matchers:[]});function hn(r,t,e,n){return n.query(t)?r.reduce((i,s)=>{if(!s.insert)return i;if(s.attributes&&s.attributes[t])return i.push(s);const l=e?{[t]:e}:{};return i.insert(s.insert,{...l,...s.attributes})},new pt):r}function mi(r,t){let e="";for(let n=r.ops.length-1;n>=0&&e.length<t.length;--n){const i=r.ops[n];if(typeof i.insert!="string")break;e=i.insert+e}return e.slice(-1*t.length)===t}function Vr(r,t){if(!(r instanceof Element))return!1;const e=t.query(r);return e&&e.prototype instanceof Ve?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(r.tagName.toLowerCase())}function qb(r,t){return r.previousElementSibling&&r.nextElementSibling&&!Vr(r.previousElementSibling,t)&&!Vr(r.nextElementSibling,t)}const zi=new WeakMap;function Ch(r){return r==null?!1:(zi.has(r)||(r.tagName==="PRE"?zi.set(r,!0):zi.set(r,Ch(r.parentNode))),zi.get(r))}function wl(r,t,e,n,i){return t.nodeType===t.TEXT_NODE?n.reduce((s,l)=>l(t,s,r),new pt):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((s,l)=>{let u=wl(r,l,e,n,i);return l.nodeType===t.ELEMENT_NODE&&(u=e.reduce((a,o)=>o(l,a,r),u),u=(i.get(l)||[]).reduce((a,o)=>o(l,a,r),u)),s.concat(u)},new pt):new pt}function no(r){return(t,e,n)=>hn(e,r,!0,n)}function Pb(r,t,e){const n=Sr.keys(r),i=fr.keys(r),s=Jr.keys(r),l={};return n.concat(i).concat(s).forEach(u=>{let a=e.query(u,gt.ATTRIBUTE);a!=null&&(l[a.attrName]=a.value(r),l[a.attrName])||(a=Ib[u],a!=null&&(a.attrName===u||a.keyName===u)&&(l[a.attrName]=a.value(r)||void 0),a=Mu[u],a!=null&&(a.attrName===u||a.keyName===u)&&(a=Mu[u],l[a.attrName]=a.value(r)||void 0))}),Object.entries(l).reduce((u,a)=>{let[o,c]=a;return hn(u,o,c,e)},t)}function Db(r,t,e){const n=e.query(r);if(n==null)return t;if(n.prototype instanceof Ve){const i={},s=n.value(r);if(s!=null)return i[n.blotName]=s,new pt().insert(i,n.formats(r,e))}else if(n.prototype instanceof oi&&!mi(t,`
`)&&t.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return hn(t,n.blotName,n.formats(r,e),e);return t}function Mb(r,t){return mi(t,`
`)||t.insert(`
`),t}function jb(r,t,e){const n=e.query("code-block"),i=n&&"formats"in n&&typeof n.formats=="function"?n.formats(r,e):!0;return hn(t,"code-block",i,e)}function kb(){return new pt}function Bb(r,t,e){const n=e.query(r);if(n==null||n.blotName!=="list"||!mi(t,`
`))return t;let i=-1,s=r.parentNode;for(;s!=null;)["OL","UL"].includes(s.tagName)&&(i+=1),s=s.parentNode;return i<=0?t:t.reduce((l,u)=>u.insert?u.attributes&&typeof u.attributes.indent=="number"?l.push(u):l.insert(u.insert,{indent:i,...u.attributes||{}}):l,new pt)}function Fb(r,t,e){const n=r;let i=n.tagName==="OL"?"ordered":"bullet";const s=n.getAttribute("data-checked");return s&&(i=s==="true"?"checked":"unchecked"),hn(t,"list",i,e)}function ju(r,t,e){if(!mi(t,`
`)){if(Vr(r,e)&&(r.childNodes.length>0||r instanceof HTMLParagraphElement))return t.insert(`
`);if(t.length()>0&&r.nextSibling){let n=r.nextSibling;for(;n!=null;){if(Vr(n,e))return t.insert(`
`);const i=e.query(n);if(i&&i.prototype instanceof rr)return t.insert(`
`);n=n.firstChild}}}return t}function $b(r,t,e){var s;const n={},i=r.style||{};return i.fontStyle==="italic"&&(n.italic=!0),i.textDecoration==="underline"&&(n.underline=!0),i.textDecoration==="line-through"&&(n.strike=!0),((s=i.fontWeight)!=null&&s.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),t=Object.entries(n).reduce((l,u)=>{let[a,o]=u;return hn(l,a,o,e)},t),parseFloat(i.textIndent||0)>0?new pt().insert("	").concat(t):t}function Ub(r,t,e){var i,s;const n=((i=r.parentElement)==null?void 0:i.tagName)==="TABLE"?r.parentElement:(s=r.parentElement)==null?void 0:s.parentElement;if(n!=null){const u=Array.from(n.querySelectorAll("tr")).indexOf(r)+1;return hn(t,"table",u,e)}return t}function Hb(r,t,e){var i;let n=r.data;if(((i=r.parentElement)==null?void 0:i.tagName)==="O:P")return t.insert(n.trim());if(!Ch(r)){if(n.trim().length===0&&n.includes(`
`)&&!qb(r,e))return t;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(r.previousSibling==null&&r.parentElement!=null&&Vr(r.parentElement,e)||r.previousSibling instanceof Element&&Vr(r.previousSibling,e))&&(n=n.replace(/^ /,"")),(r.nextSibling==null&&r.parentElement!=null&&Vr(r.parentElement,e)||r.nextSibling instanceof Element&&Vr(r.nextSibling,e))&&(n=n.replace(/ $/,"")),n=n.replaceAll(" "," ")}return t.insert(n)}class xh extends dr{constructor(e,n){super(e,n);ct(this,"lastRecorded",0);ct(this,"ignoreChange",!1);ct(this,"stack",{undo:[],redo:[]});ct(this,"currentRange",null);this.quill.on(et.events.EDITOR_CHANGE,(i,s,l,u)=>{i===et.events.SELECTION_CHANGE?s&&u!==et.sources.SILENT&&(this.currentRange=s):i===et.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||u===et.sources.USER?this.record(s,l):this.transform(s)),this.currentRange=tl(this.currentRange,s))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",i=>{i.inputType==="historyUndo"?(this.undo(),i.preventDefault()):i.inputType==="historyRedo"&&(this.redo(),i.preventDefault())})}change(e,n){if(this.stack[e].length===0)return;const i=this.stack[e].pop();if(!i)return;const s=this.quill.getContents(),l=i.delta.invert(s);this.stack[n].push({delta:l,range:tl(i.range,l)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(i.delta,et.sources.USER),this.ignoreChange=!1,this.restoreSelection(i)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,n){if(e.ops.length===0)return;this.stack.redo=[];let i=e.invert(n),s=this.currentRange;const l=Date.now();if(this.lastRecorded+this.options.delay>l&&this.stack.undo.length>0){const u=this.stack.undo.pop();u&&(i=i.compose(u.delta),s=u.range)}else this.lastRecorded=l;i.length()!==0&&(this.stack.undo.push({delta:i,range:s}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){ku(this.stack.undo,e),ku(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,et.sources.USER);else{const n=Vb(this.quill.scroll,e.delta);this.quill.setSelection(n,et.sources.USER)}}}ct(xh,"DEFAULTS",{delay:1e3,maxStack:100,userOnly:!1});function ku(r,t){let e=t;for(let n=r.length-1;n>=0;n-=1){const i=r[n];r[n]={delta:e.transform(i.delta,!0),range:i.range&&tl(i.range,e)},e=i.delta.transform(e),r[n].delta.length()===0&&r.splice(n,1)}}function zb(r,t){const e=t.ops[t.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(n=>r.query(n,gt.BLOCK)!=null):!1}function Vb(r,t){const e=t.reduce((i,s)=>i+(s.delete||0),0);let n=t.length()-e;return zb(r,t)&&(n-=1),n}function tl(r,t){if(!r)return r;const e=t.transformPosition(r.index),n=t.transformPosition(r.index+r.length);return{index:e,length:n-e}}class Ih extends dr{constructor(t,e){super(t,e),t.root.addEventListener("drop",n=>{var l;n.preventDefault();let i=null;if(document.caretRangeFromPoint)i=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){const u=document.caretPositionFromPoint(n.clientX,n.clientY);i=document.createRange(),i.setStart(u.offsetNode,u.offset),i.setEnd(u.offsetNode,u.offset)}const s=i&&t.selection.normalizeNative(i);if(s){const u=t.selection.normalizedToRange(s);(l=n.dataTransfer)!=null&&l.files&&this.upload(u,n.dataTransfer.files)}})}upload(t,e){const n=[];Array.from(e).forEach(i=>{var s;i&&((s=this.options.mimetypes)!=null&&s.includes(i.type))&&n.push(i)}),n.length>0&&this.options.handler.call(this,t,n)}}Ih.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(r,t){if(!this.quill.scroll.query("image"))return;const e=t.map(n=>new Promise(i=>{const s=new FileReader;s.onload=()=>{i(s.result)},s.readAsDataURL(n)}));Promise.all(e).then(n=>{const i=n.reduce((s,l)=>s.insert({image:l}),new pt().retain(r.index).delete(r.length));this.quill.updateContents(i,ht.sources.USER),this.quill.setSelection(r.index+n.length,ht.sources.SILENT)})}};const Gb=["insertText","insertReplacementText"];class Wb extends dr{constructor(t,e){super(t,e),t.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||t.on(et.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(t){Sl({range:t,quill:this.quill})}replaceText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t.length===0)return!1;if(e){const n=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents(new pt().retain(t.index).insert(e,n),et.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+e.length,0,et.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!Gb.includes(t.inputType))return;const e=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!e||e.collapsed===!0)return;const n=Kb(t);if(n==null)return;const i=this.quill.selection.normalizeNative(e),s=i?this.quill.selection.normalizedToRange(i):null;s&&this.replaceText(s,n)&&t.preventDefault()}handleCompositionStart(){const t=this.quill.getSelection();t&&this.replaceText(t)}}function Kb(r){var t;return typeof r.data=="string"?r.data:(t=r.dataTransfer)!=null&&t.types.includes("text/plain")?r.dataTransfer.getData("text/plain"):null}const Yb=/Mac/i.test(navigator.platform),Xb=100,Zb=r=>!!(r.key==="ArrowLeft"||r.key==="ArrowRight"||r.key==="ArrowUp"||r.key==="ArrowDown"||r.key==="Home"||Yb&&r.key==="a"&&r.ctrlKey===!0);class Jb extends dr{constructor(e,n){super(e,n);ct(this,"isListening",!1);ct(this,"selectionChangeDeadline",0);this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,n){let{line:i,event:s}=n;if(!(i instanceof lr)||!i.uiNode)return!0;const l=getComputedStyle(i.domNode).direction==="rtl";return l&&s.key!=="ArrowRight"||!l&&s.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(s.shiftKey?1:0),et.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&Zb(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+Xb,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const n=e.getRangeAt(0);if(n.collapsed!==!0||n.startOffset!==0)return;const i=this.quill.scroll.find(n.startContainer);if(!(i instanceof lr)||!i.uiNode)return;const s=document.createRange();s.setStartAfter(i.uiNode),s.setEndAfter(i.uiNode),e.removeAllRanges(),e.addRange(s)}}et.register({"blots/block":_e,"blots/block/embed":rr,"blots/break":hr,"blots/container":cn,"blots/cursor":In,"blots/embed":yl,"blots/inline":wr,"blots/scroll":Tn,"blots/text":ur,"modules/clipboard":Lh,"modules/history":xh,"modules/keyboard":Ls,"modules/uploader":Ih,"modules/input":Wb,"modules/uiNode":Jb});class Qb extends fr{add(t,e){let n=0;if(e==="+1"||e==="-1"){const i=this.value(t)||0;n=e==="+1"?i+1:i-1}else typeof e=="number"&&(n=e);return n===0?(this.remove(t),!0):super.add(t,n.toString())}canAdd(t,e){return super.canAdd(t,e)||super.canAdd(t,parseInt(e,10))}value(t){return parseInt(super.value(t),10)||void 0}}const t1=new Qb("indent","ql-indent",{scope:gt.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class el extends _e{}ct(el,"blotName","blockquote"),ct(el,"tagName","blockquote");class rl extends _e{static formats(t){return this.tagName.indexOf(t.tagName)+1}}ct(rl,"blotName","header"),ct(rl,"tagName",["H1","H2","H3","H4","H5","H6"]);class yi extends cn{}yi.blotName="list-container";yi.tagName="OL";class bi extends _e{static create(t){const e=super.create();return e.setAttribute("data-list",t),e}static formats(t){return t.getAttribute("data-list")||void 0}static register(){et.register(yi)}constructor(t,e){super(t,e);const n=e.ownerDocument.createElement("span"),i=s=>{if(!t.isEnabled())return;const l=this.statics.formats(e,t);l==="checked"?(this.format("list","unchecked"),s.preventDefault()):l==="unchecked"&&(this.format("list","checked"),s.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(t,e)}}bi.blotName="list";bi.tagName="LI";yi.allowedChildren=[bi];bi.requiredContainer=yi;class li extends wr{static create(){return super.create()}static formats(){return!0}optimize(t){super.optimize(t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}ct(li,"blotName","bold"),ct(li,"tagName",["STRONG","B"]);class nl extends li{}ct(nl,"blotName","italic"),ct(nl,"tagName",["EM","I"]);class Gr extends wr{static create(t){const e=super.create(t);return e.setAttribute("href",this.sanitize(t)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){return qh(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,e){t!==this.statics.blotName||!e?super.format(t,e):this.domNode.setAttribute("href",this.constructor.sanitize(e))}}ct(Gr,"blotName","link"),ct(Gr,"tagName","A"),ct(Gr,"SANITIZED_URL","about:blank"),ct(Gr,"PROTOCOL_WHITELIST",["http","https","mailto","tel","sms"]);function qh(r,t){const e=document.createElement("a");e.href=r;const n=e.href.slice(0,e.href.indexOf(":"));return t.indexOf(n)>-1}class il extends wr{static create(t){return t==="super"?document.createElement("sup"):t==="sub"?document.createElement("sub"):super.create(t)}static formats(t){if(t.tagName==="SUB")return"sub";if(t.tagName==="SUP")return"super"}}ct(il,"blotName","script"),ct(il,"tagName",["SUB","SUP"]);class sl extends li{}ct(sl,"blotName","strike"),ct(sl,"tagName",["S","STRIKE"]);class ol extends wr{}ct(ol,"blotName","underline"),ct(ol,"tagName","U");class Xi extends yl{static create(t){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const e=super.create(t);return typeof t=="string"&&(window.katex.render(t,e,{throwOnError:!1,errorColor:"#f00"}),e.setAttribute("data-value",t)),e}static value(t){return t.getAttribute("data-value")}html(){const{formula:t}=this.value();return`<span>${t}</span>`}}ct(Xi,"blotName","formula"),ct(Xi,"className","ql-formula"),ct(Xi,"tagName","SPAN");const Bu=["alt","height","width"];class al extends Ve{static create(t){const e=super.create(t);return typeof t=="string"&&e.setAttribute("src",this.sanitize(t)),e}static formats(t){return Bu.reduce((e,n)=>(t.hasAttribute(n)&&(e[n]=t.getAttribute(n)),e),{})}static match(t){return/\.(jpe?g|gif|png)$/.test(t)||/^data:image\/.+;base64/.test(t)}static sanitize(t){return qh(t,["http","https","data"])?t:"//:0"}static value(t){return t.getAttribute("src")}format(t,e){Bu.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}}ct(al,"blotName","image"),ct(al,"tagName","IMG");const Fu=["height","width"];class Zi extends rr{static create(t){const e=super.create(t);return e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","true"),e.setAttribute("src",this.sanitize(t)),e}static formats(t){return Fu.reduce((e,n)=>(t.hasAttribute(n)&&(e[n]=t.getAttribute(n)),e),{})}static sanitize(t){return Gr.sanitize(t)}static value(t){return t.getAttribute("src")}format(t,e){Fu.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}html(){const{video:t}=this.value();return`<a href="${t}">${t}</a>`}}ct(Zi,"blotName","video"),ct(Zi,"className","ql-video"),ct(Zi,"tagName","IFRAME");const Zn=new fr("code-token","hljs",{scope:gt.INLINE});class Ir extends wr{static formats(t,e){for(;t!=null&&t!==e.domNode;){if(t.classList&&t.classList.contains(Ne.className))return super.formats(t,e);t=t.parentNode}}constructor(t,e,n){super(t,e,n),Zn.add(this.domNode,n)}format(t,e){t!==Ir.blotName?super.format(t,e):e?Zn.add(this.domNode,e):(Zn.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Zn.value(this.domNode)||this.unwrap()}}Ir.blotName="code-token";Ir.className="ql-token";class er extends Ne{static create(t){const e=super.create(t);return typeof t=="string"&&e.setAttribute("data-language",t),e}static formats(t){return t.getAttribute("data-language")||"plain"}static register(){}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-language",e):super.format(t,e)}replaceWith(t,e){return this.formatAt(0,this.length(),Ir.blotName,!1),super.replaceWith(t,e)}}class ti extends fn{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(t,e){t===er.blotName&&(this.forceNext=!0,this.children.forEach(n=>{n.format(t,e)}))}formatAt(t,e,n,i){n===er.blotName&&(this.forceNext=!0),super.formatAt(t,e,n,i)}highlight(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const i=`${Array.from(this.domNode.childNodes).filter(l=>l!==this.uiNode).map(l=>l.textContent).join(`
`)}
`,s=er.formats(this.children.head.domNode);if(e||this.forceNext||this.cachedText!==i){if(i.trim().length>0||this.cachedText==null){const l=this.children.reduce((a,o)=>a.concat(vh(o,!1)),new pt),u=t(i,s);l.diff(u).reduce((a,o)=>{let{retain:c,attributes:v}=o;return c?(v&&Object.keys(v).forEach(p=>{[er.blotName,Ir.blotName].includes(p)&&this.formatAt(a,c,p,v[p])}),a+c):a},0)}this.cachedText=i,this.forceNext=!1}}html(t,e){const[n]=this.children.find(t);return`<pre data-language="${n?er.formats(n.domNode):"plain"}">
${Ns(this.code(t,e))}
</pre>`}optimize(t){if(super.optimize(t),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const e=er.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}ti.allowedChildren=[er];er.requiredContainer=ti;er.allowedChildren=[Ir,In,ur,hr];const e1=(r,t,e)=>{if(typeof r.versionString=="string"){const n=r.versionString.split(".")[0];if(parseInt(n,10)>=11)return r.highlight(e,{language:t}).value}return r.highlight(t,e).value};class Ph extends dr{static register(){et.register(Ir,!0),et.register(er,!0),et.register(ti,!0)}constructor(t,e){if(super(t,e),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((n,i)=>{let{key:s}=i;return n[s]=!0,n},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(et.events.SCROLL_BLOT_MOUNT,t=>{if(!(t instanceof ti))return;const e=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(n=>{let{key:i,label:s}=n;const l=e.ownerDocument.createElement("option");l.textContent=s,l.setAttribute("value",i),e.appendChild(l)}),e.addEventListener("change",()=>{t.format(er.blotName,e.value),this.quill.root.focus(),this.highlight(t,!0)}),t.uiNode==null&&(t.attachUI(e),t.children.head&&(e.value=er.formats(t.children.head.domNode)))})}initTimer(){let t=null;this.quill.on(et.events.SCROLL_OPTIMIZE,()=>{t&&clearTimeout(t),t=setTimeout(()=>{this.highlight(),t=null},this.options.interval)})}highlight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(et.sources.USER);const n=this.quill.getSelection();(t==null?this.quill.scroll.descendants(ti):[t]).forEach(s=>{s.highlight(this.highlightBlot,e)}),this.quill.update(et.sources.SILENT),n!=null&&this.quill.setSelection(n,et.sources.SILENT)}highlightBlot(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(e=this.languages[e]?e:"plain",e==="plain")return Ns(t).split(`
`).reduce((i,s,l)=>(l!==0&&i.insert(`
`,{[Ne.blotName]:e}),i.insert(s)),new pt);const n=this.quill.root.ownerDocument.createElement("div");return n.classList.add(Ne.className),n.innerHTML=e1(this.options.hljs,e,t),wl(this.quill.scroll,n,[(i,s)=>{const l=Zn.value(i);return l?s.compose(new pt().retain(s.length(),{[Ir.blotName]:l})):s}],[(i,s)=>i.data.split(`
`).reduce((l,u,a)=>(a!==0&&l.insert(`
`,{[Ne.blotName]:e}),l.insert(u)),s)],new WeakMap)}}Ph.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};const ri=class ri extends _e{static create(t){const e=super.create();return t?e.setAttribute("data-row",t):e.setAttribute("data-row",Tl()),e}static formats(t){if(t.hasAttribute("data-row"))return t.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(t,e){t===ri.blotName&&e?this.domNode.setAttribute("data-row",e):super.format(t,e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}};ct(ri,"blotName","table"),ct(ri,"tagName","TD");let ar=ri;class qr extends cn{checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const t=this.children.head.formats(),e=this.children.tail.formats(),n=this.next.children.head.formats(),i=this.next.children.tail.formats();return t.table===e.table&&t.table===n.table&&t.table===i.table}return!1}optimize(t){super.optimize(t),this.children.forEach(e=>{if(e.next==null)return;const n=e.formats(),i=e.next.formats();if(n.table!==i.table){const s=this.splitAfter(e);s&&s.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}ct(qr,"blotName","table-row"),ct(qr,"tagName","TR");class Or extends cn{}ct(Or,"blotName","table-body"),ct(Or,"tagName","TBODY");class Pn extends cn{balanceCells(){const t=this.descendants(qr),e=t.reduce((n,i)=>Math.max(i.children.length,n),0);t.forEach(n=>{new Array(e-n.children.length).fill(0).forEach(()=>{let i;n.children.head!=null&&(i=ar.formats(n.children.head.domNode));const s=this.scroll.create(ar.blotName,i);n.appendChild(s),s.optimize()})})}cells(t){return this.rows().map(e=>e.children.at(t))}deleteColumn(t){const[e]=this.descendant(Or);e==null||e.children.head==null||e.children.forEach(n=>{const i=n.children.at(t);i!=null&&i.remove()})}insertColumn(t){const[e]=this.descendant(Or);e==null||e.children.head==null||e.children.forEach(n=>{const i=n.children.at(t),s=ar.formats(n.children.head.domNode),l=this.scroll.create(ar.blotName,s);n.insertBefore(l,i)})}insertRow(t){const[e]=this.descendant(Or);if(e==null||e.children.head==null)return;const n=Tl(),i=this.scroll.create(qr.blotName);e.children.head.children.forEach(()=>{const l=this.scroll.create(ar.blotName,n);i.appendChild(l)});const s=e.children.at(t);e.insertBefore(i,s)}rows(){const t=this.children.head;return t==null?[]:t.children.map(e=>e)}}ct(Pn,"blotName","table-container"),ct(Pn,"tagName","TABLE");Pn.allowedChildren=[Or];Or.requiredContainer=Pn;Or.allowedChildren=[qr];qr.requiredContainer=Or;qr.allowedChildren=[ar];ar.requiredContainer=qr;function Tl(){return`row-${Math.random().toString(36).slice(2,6)}`}class r1 extends dr{static register(){et.register(ar),et.register(qr),et.register(Or),et.register(Pn)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(Pn).forEach(t=>{t.balanceCells()})}deleteColumn(){const[t,,e]=this.getTable();e!=null&&(t.deleteColumn(e.cellOffset()),this.quill.update(et.sources.USER))}deleteRow(){const[,t]=this.getTable();t!=null&&(t.remove(),this.quill.update(et.sources.USER))}deleteTable(){const[t]=this.getTable();if(t==null)return;const e=t.offset();t.remove(),this.quill.update(et.sources.USER),this.quill.setSelection(e,et.sources.SILENT)}getTable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(t==null)return[null,null,null,-1];const[e,n]=this.quill.getLine(t.index);if(e==null||e.statics.blotName!==ar.blotName)return[null,null,null,-1];const i=e.parent;return[i.parent.parent,i,e,n]}insertColumn(t){const e=this.quill.getSelection();if(!e)return;const[n,i,s]=this.getTable(e);if(s==null)return;const l=s.cellOffset();n.insertColumn(l+t),this.quill.update(et.sources.USER);let u=i.rowOffset();t===0&&(u+=1),this.quill.setSelection(e.index+u,e.length,et.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(t){const e=this.quill.getSelection();if(!e)return;const[n,i,s]=this.getTable(e);if(s==null)return;const l=i.rowOffset();n.insertRow(l+t),this.quill.update(et.sources.USER),t>0?this.quill.setSelection(e,et.sources.SILENT):this.quill.setSelection(e.index+i.children.length,e.length,et.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(t,e){const n=this.quill.getSelection();if(n==null)return;const i=new Array(t).fill(0).reduce(s=>{const l=new Array(e).fill(`
`).join("");return s.insert(l,{table:Tl()})},new pt().retain(n.index));this.quill.updateContents(i,et.sources.USER),this.quill.setSelection(n.index,et.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(et.events.SCROLL_OPTIMIZE,t=>{t.some(e=>["TD","TR","TBODY","TABLE"].includes(e.target.tagName)?(this.quill.once(et.events.TEXT_CHANGE,(n,i,s)=>{s===et.sources.USER&&this.balanceTables()}),!0):!1)})}}const $u=Dr("quill:toolbar");class Rl extends dr{constructor(t,e){var n,i;if(super(t,e),Array.isArray(this.options.container)){const s=document.createElement("div");s.setAttribute("role","toolbar"),n1(s,this.options.container),(i=(n=t.container)==null?void 0:n.parentNode)==null||i.insertBefore(s,t.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){$u.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{var u;const l=(u=this.options.handlers)==null?void 0:u[s];l&&this.addHandler(s,l)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(et.events.EDITOR_CHANGE,()=>{const[s]=this.quill.selection.getRange();this.update(s)})}addHandler(t,e){this.handlers[t]=e}attach(t){let e=Array.from(t.classList).find(i=>i.indexOf("ql-")===0);if(!e)return;if(e=e.slice(3),t.tagName==="BUTTON"&&t.setAttribute("type","button"),this.handlers[e]==null&&this.quill.scroll.query(e)==null){$u.warn("ignoring attaching to nonexistent format",e,t);return}const n=t.tagName==="SELECT"?"change":"click";t.addEventListener(n,i=>{let s;if(t.tagName==="SELECT"){if(t.selectedIndex<0)return;const u=t.options[t.selectedIndex];u.hasAttribute("selected")?s=!1:s=u.value||!1}else t.classList.contains("ql-active")?s=!1:s=t.value||!t.hasAttribute("value"),i.preventDefault();this.quill.focus();const[l]=this.quill.selection.getRange();if(this.handlers[e]!=null)this.handlers[e].call(this,s);else if(this.quill.scroll.query(e).prototype instanceof Ve){if(s=prompt(`Enter ${e}`),!s)return;this.quill.updateContents(new pt().retain(l.index).delete(l.length).insert({[e]:s}),et.sources.USER)}else this.quill.format(e,s,et.sources.USER);this.update(l)}),this.controls.push([e,t])}update(t){const e=t==null?{}:this.quill.getFormat(t);this.controls.forEach(n=>{const[i,s]=n;if(s.tagName==="SELECT"){let l=null;if(t==null)l=null;else if(e[i]==null)l=s.querySelector("option[selected]");else if(!Array.isArray(e[i])){let u=e[i];typeof u=="string"&&(u=u.replace(/"/g,'\\"')),l=s.querySelector(`option[value="${u}"]`)}l==null?(s.value="",s.selectedIndex=-1):l.selected=!0}else if(t==null)s.classList.remove("ql-active"),s.setAttribute("aria-pressed","false");else if(s.hasAttribute("value")){const l=e[i],u=l===s.getAttribute("value")||l!=null&&l.toString()===s.getAttribute("value")||l==null&&!s.getAttribute("value");s.classList.toggle("ql-active",u),s.setAttribute("aria-pressed",u.toString())}else{const l=e[i]!=null;s.classList.toggle("ql-active",l),s.setAttribute("aria-pressed",l.toString())}})}}Rl.DEFAULTS={};function Uu(r,t,e){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${t}`),n.setAttribute("aria-pressed","false"),e!=null?(n.value=e,n.setAttribute("aria-label",`${t}: ${e}`)):n.setAttribute("aria-label",t),r.appendChild(n)}function n1(r,t){Array.isArray(t[0])||(t=[t]),t.forEach(e=>{const n=document.createElement("span");n.classList.add("ql-formats"),e.forEach(i=>{if(typeof i=="string")Uu(n,i);else{const s=Object.keys(i)[0],l=i[s];Array.isArray(l)?i1(n,s,l):Uu(n,s,l)}}),r.appendChild(n)})}function i1(r,t,e){const n=document.createElement("select");n.classList.add(`ql-${t}`),e.forEach(i=>{const s=document.createElement("option");i!==!1?s.setAttribute("value",String(i)):s.setAttribute("selected","selected"),n.appendChild(s)}),r.appendChild(n)}Rl.DEFAULTS={container:null,handlers:{clean(){const r=this.quill.getSelection();if(r!=null)if(r.length===0){const t=this.quill.getFormat();Object.keys(t).forEach(e=>{this.quill.scroll.query(e,gt.INLINE)!=null&&this.quill.format(e,!1,et.sources.USER)})}else this.quill.removeFormat(r.index,r.length,et.sources.USER)},direction(r){const{align:t}=this.quill.getFormat();r==="rtl"&&t==null?this.quill.format("align","right",et.sources.USER):!r&&t==="right"&&this.quill.format("align",!1,et.sources.USER),this.quill.format("direction",r,et.sources.USER)},indent(r){const t=this.quill.getSelection(),e=this.quill.getFormat(t),n=parseInt(e.indent||0,10);if(r==="+1"||r==="-1"){let i=r==="+1"?1:-1;e.direction==="rtl"&&(i*=-1),this.quill.format("indent",n+i,et.sources.USER)}},link(r){r===!0&&(r=prompt("Enter link URL:")),this.quill.format("link",r,et.sources.USER)},list(r){const t=this.quill.getSelection(),e=this.quill.getFormat(t);r==="check"?e.list==="checked"||e.list==="unchecked"?this.quill.format("list",!1,et.sources.USER):this.quill.format("list","unchecked",et.sources.USER):this.quill.format("list",r,et.sources.USER)}}};const s1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',o1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',a1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',l1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',u1='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',c1='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',f1='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',h1='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',Hu='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',d1='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',p1='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',g1='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',v1='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',m1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',y1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',b1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',_1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',E1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',A1='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',O1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',S1='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',w1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',T1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',R1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',N1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',L1='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',C1='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',x1='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',I1='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',q1='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',P1='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',D1='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',M1='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',ui={align:{"":s1,center:o1,right:a1,justify:l1},background:u1,blockquote:c1,bold:f1,clean:h1,code:Hu,"code-block":Hu,color:d1,direction:{"":p1,rtl:g1},formula:v1,header:{1:m1,2:y1,3:b1,4:_1,5:E1,6:A1},italic:O1,image:S1,indent:{"+1":w1,"-1":T1},link:R1,list:{bullet:N1,check:L1,ordered:C1},script:{sub:x1,super:I1},strike:q1,table:P1,underline:D1,video:M1},j1='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let zu=0;function Vu(r,t){r.setAttribute(t,`${r.getAttribute(t)!=="true"}`)}class Cs{constructor(t){this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),Vu(this.label,"aria-expanded"),Vu(this.options,"aria-hidden")}buildItem(t){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const n=t.getAttribute("value");return n&&e.setAttribute("data-value",n),t.textContent&&e.setAttribute("data-label",t.textContent),e.addEventListener("click",()=>{this.selectItem(e,!0)}),e.addEventListener("keydown",i=>{switch(i.key){case"Enter":this.selectItem(e,!0),i.preventDefault();break;case"Escape":this.escape(),i.preventDefault();break}}),e}buildLabel(){const t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML=j1,t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}buildOptions(){const t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id=`ql-picker-options-${zu}`,zu+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,Array.from(this.select.options).forEach(e=>{const n=this.buildItem(e);t.appendChild(n),e.selected===!0&&this.selectItem(n)}),this.container.appendChild(t)}buildPicker(){Array.from(this.select.attributes).forEach(t=>{this.container.setAttribute(t.name,t.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.container.querySelector(".ql-selected");t!==n&&(n!=null&&n.classList.remove("ql-selected"),t!=null&&(t.classList.add("ql-selected"),this.select.selectedIndex=Array.from(t.parentNode.children).indexOf(t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let t;if(this.select.selectedIndex>-1){const n=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(n)}else this.selectItem(null);const e=t!=null&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}}class Dh extends Cs{constructor(t,e){super(t),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(n=>{n.classList.add("ql-primary")})}buildItem(t){const e=super.buildItem(t);return e.style.backgroundColor=t.getAttribute("value")||"",e}selectItem(t,e){super.selectItem(t,e);const n=this.label.querySelector(".ql-color-label"),i=t&&t.getAttribute("data-value")||"";n&&(n.tagName==="line"?n.style.stroke=i:n.style.fill=i)}}class Mh extends Cs{constructor(t,e){super(t),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(n=>{n.innerHTML=e[n.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(t,e){super.selectItem(t,e);const n=t||this.defaultItem;if(n!=null){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}}const k1=r=>{const{overflowY:t}=getComputedStyle(r,null);return t!=="visible"&&t!=="clip"};class jh{constructor(t,e){this.quill=t,this.boundsContainer=e||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,k1(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(t){const e=t.left+t.width/2-this.root.offsetWidth/2,n=t.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),s=this.root.getBoundingClientRect();let l=0;if(s.right>i.right&&(l=i.right-s.right,this.root.style.left=`${e+l}px`),s.left<i.left&&(l=i.left-s.left,this.root.style.left=`${e+l}px`),s.bottom>i.bottom){const u=s.bottom-s.top,a=t.bottom-t.top+u;this.root.style.top=`${n-a}px`,this.root.classList.add("ql-flip")}return l}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const B1=[!1,"center","right","justify"],F1=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],$1=[!1,"serif","monospace"],U1=["1","2","3",!1],H1=["small",!1,"large","huge"];class _i extends qn{constructor(t,e){super(t,e);const n=i=>{if(!document.body.contains(t.root)){document.body.removeEventListener("click",n);return}this.tooltip!=null&&!this.tooltip.root.contains(i.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(s=>{s.container.contains(i.target)||s.close()})};t.emitter.listenDOM("click",document.body,n)}addModule(t){const e=super.addModule(t);return t==="toolbar"&&this.extendToolbar(e),e}buildButtons(t,e){Array.from(t).forEach(n=>{(n.getAttribute("class")||"").split(/\s+/).forEach(s=>{if(s.startsWith("ql-")&&(s=s.slice(3),e[s]!=null))if(s==="direction")n.innerHTML=e[s][""]+e[s].rtl;else if(typeof e[s]=="string")n.innerHTML=e[s];else{const l=n.value||"";l!=null&&e[s][l]&&(n.innerHTML=e[s][l])}})})}buildPickers(t,e){this.pickers=Array.from(t).map(i=>{if(i.classList.contains("ql-align")&&(i.querySelector("option")==null&&Gn(i,B1),typeof e.align=="object"))return new Mh(i,e.align);if(i.classList.contains("ql-background")||i.classList.contains("ql-color")){const s=i.classList.contains("ql-background")?"background":"color";return i.querySelector("option")==null&&Gn(i,F1,s==="background"?"#ffffff":"#000000"),new Dh(i,e[s])}return i.querySelector("option")==null&&(i.classList.contains("ql-font")?Gn(i,$1):i.classList.contains("ql-header")?Gn(i,U1):i.classList.contains("ql-size")&&Gn(i,H1)),new Cs(i)});const n=()=>{this.pickers.forEach(i=>{i.update()})};this.quill.on(ht.events.EDITOR_CHANGE,n)}}_i.DEFAULTS=Wr({},qn.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let r=this.container.querySelector("input.ql-image[type=file]");r==null&&(r=document.createElement("input"),r.setAttribute("type","file"),r.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),r.classList.add("ql-image"),r.addEventListener("change",()=>{const t=this.quill.getSelection(!0);this.quill.uploader.upload(t,r.files),r.value=""}),this.container.appendChild(r)),r.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class kh extends jh{constructor(t,e){super(t,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",t=>{t.key==="Enter"?(this.save(),t.preventDefault()):t.key==="Escape"&&(this.cancel(),t.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;e!=null?this.textbox.value=e:t!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);n!=null&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${t}`)||""),this.root.setAttribute("data-mode",t)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:t}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",t,ht.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",t,ht.sources.USER)),this.quill.root.scrollTop=e;break}case"video":t=z1(t);case"formula":{if(!t)break;const e=this.quill.getSelection(!0);if(e!=null){const n=e.index+e.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),t,ht.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(n+1," ",ht.sources.USER),this.quill.setSelection(n+2,ht.sources.USER)}break}}this.textbox.value="",this.hide()}}function z1(r){let t=r.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||r.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return t?`${t[1]||"https"}://www.youtube.com/embed/${t[2]}?showinfo=0`:(t=r.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${t[1]||"https"}://player.vimeo.com/video/${t[2]}/`:r}function Gn(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t.forEach(n=>{const i=document.createElement("option");n===e?i.setAttribute("selected","selected"):i.setAttribute("value",String(n)),r.appendChild(i)})}const V1=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class Bh extends kh{constructor(t,e){super(t,e),this.quill.on(ht.events.EDITOR_CHANGE,(n,i,s,l)=>{if(n===ht.events.SELECTION_CHANGE)if(i!=null&&i.length>0&&l===ht.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const u=this.quill.getLines(i.index,i.length);if(u.length===1){const a=this.quill.getBounds(i);a!=null&&this.position(a)}else{const a=u[u.length-1],o=this.quill.getIndex(a),c=Math.min(a.length()-1,i.index+i.length-o),v=this.quill.getBounds(new on(o,c));v!=null&&this.position(v)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(ht.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const t=this.quill.getSelection();if(t!=null){const e=this.quill.getBounds(t);e!=null&&this.position(e)}},1)})}cancel(){this.show()}position(t){const e=super.position(t),n=this.root.querySelector(".ql-tooltip-arrow");return n.style.marginLeft="",e!==0&&(n.style.marginLeft=`${-1*e-n.offsetWidth/2}px`),e}}ct(Bh,"TEMPLATE",['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""));class Fh extends _i{constructor(t,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=V1),super(t,e),this.quill.container.classList.add("ql-bubble")}extendToolbar(t){this.tooltip=new Bh(this.quill,this.options.bounds),t.container!=null&&(this.tooltip.root.appendChild(t.container),this.buildButtons(t.container.querySelectorAll("button"),ui),this.buildPickers(t.container.querySelectorAll("select"),ui))}}Fh.DEFAULTS=Wr({},_i.DEFAULTS,{modules:{toolbar:{handlers:{link(r){r?this.quill.theme.tooltip.edit():this.quill.format("link",!1,et.sources.USER)}}}}});const G1=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class $h extends kh{constructor(){super(...arguments);ct(this,"preview",this.root.querySelector("a.ql-preview"))}listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const n=this.linkRange;this.restoreFocus(),this.quill.formatText(n,"link",!1,ht.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(ht.events.SELECTION_CHANGE,(e,n,i)=>{if(e!=null){if(e.length===0&&i===ht.sources.USER){const[s,l]=this.quill.scroll.descendant(Gr,e.index);if(s!=null){this.linkRange=new on(e.index-l,s.length());const u=Gr.formats(s.domNode);this.preview.textContent=u,this.preview.setAttribute("href",u),this.show();const a=this.quill.getBounds(this.linkRange);a!=null&&this.position(a);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}ct($h,"TEMPLATE",['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""));class Uh extends _i{constructor(t,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=G1),super(t,e),this.quill.container.classList.add("ql-snow")}extendToolbar(t){t.container!=null&&(t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),ui),this.buildPickers(t.container.querySelectorAll("select"),ui),this.tooltip=new $h(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(e,n)=>{t.handlers.link.call(t,!n.format.link)}))}}Uh.DEFAULTS=Wr({},_i.DEFAULTS,{modules:{toolbar:{handlers:{link(r){if(r){const t=this.quill.getSelection();if(t==null||t.length===0)return;let e=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(e)&&e.indexOf("mailto:")!==0&&(e=`mailto:${e}`);const{tooltip:n}=this.quill.theme;n.edit("link",e)}else this.quill.format("link",!1,et.sources.USER)}}}}});et.register({"attributors/attribute/direction":Eh,"attributors/class/align":yh,"attributors/class/background":cb,"attributors/class/color":ub,"attributors/class/direction":Ah,"attributors/class/font":wh,"attributors/class/size":Rh,"attributors/style/align":bh,"attributors/style/background":El,"attributors/style/color":_l,"attributors/style/direction":Oh,"attributors/style/font":Th,"attributors/style/size":Nh},!0);et.register({"formats/align":yh,"formats/direction":Ah,"formats/indent":t1,"formats/background":El,"formats/color":_l,"formats/font":wh,"formats/size":Rh,"formats/blockquote":el,"formats/code-block":Ne,"formats/header":rl,"formats/list":bi,"formats/bold":li,"formats/code":Al,"formats/italic":nl,"formats/link":Gr,"formats/script":il,"formats/strike":sl,"formats/underline":ol,"formats/formula":Xi,"formats/image":al,"formats/video":Zi,"modules/syntax":Ph,"modules/table":r1,"modules/toolbar":Rl,"themes/bubble":Fh,"themes/snow":Uh,"ui/icons":ui,"ui/picker":Cs,"ui/icon-picker":Mh,"ui/color-picker":Dh,"ui/tooltip":jh},!0);var io={exports:{}};/*! For license information please see quill-cursors.js.LICENSE.txt */var Gu;function W1(){return Gu||(Gu=1,(function(r,t){(function(e,n){r.exports=n()})(self,(()=>(()=>{var e={582:(l,u,a)=>{a.d(u,{Z:()=>d});var o=a(81),c=a.n(o),v=a(645),p=a.n(v)()(c());p.push([l.id,".ql-container{position:relative;overflow:hidden}@media(pointer: coarse){.ql-cursor-caret-container{z-index:-1}}.ql-cursor.hidden{display:none}.ql-cursor .ql-cursor-caret-container,.ql-cursor .ql-cursor-flag{position:absolute}.ql-cursor .ql-cursor-flag{z-index:1;transform:translate3d(-1px, -100%, 0);opacity:0;visibility:hidden;color:#fff;padding-bottom:2px;border-radius:0 3px 3px 0}.ql-cursor .ql-cursor-flag.flag-flipped{border-radius:3px 0 0 3px;transform:translate3d(calc(-100% + 1px ), -100%, 0)}@media screen{.ql-cursor .ql-cursor-flag{transition:opacity 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms,visibility 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms}}.ql-cursor .ql-cursor-flag .ql-cursor-name{margin-left:5px;margin-right:5px;display:inline-block;margin-top:-2px;white-space:nowrap}.ql-cursor .ql-cursor-flag.no-delay[style]{transition-delay:unset !important}.ql-cursor .ql-cursor-caret-container{cursor:text;margin-left:-9px;padding:0 9px}.ql-cursor .ql-cursor-caret-container.hover+.ql-cursor-flag{opacity:1;visibility:visible;transition:none}.ql-cursor .ql-cursor-caret-container.no-pointer{pointer-events:none}.ql-cursor .ql-cursor-caret-container .ql-cursor-caret{position:absolute;top:0;bottom:0;width:2px;margin-left:-1px;background-color:attr(data-color)}.ql-cursor .ql-cursor-selection-block{position:absolute;pointer-events:none}",""]);const d=p},645:l=>{l.exports=function(u){var a=[];return a.toString=function(){return this.map((function(o){var c="",v=o[5]!==void 0;return o[4]&&(c+="@supports (".concat(o[4],") {")),o[2]&&(c+="@media ".concat(o[2]," {")),v&&(c+="@layer".concat(o[5].length>0?" ".concat(o[5]):""," {")),c+=u(o),v&&(c+="}"),o[2]&&(c+="}"),o[4]&&(c+="}"),c})).join("")},a.i=function(o,c,v,p,d){typeof o=="string"&&(o=[[null,o,void 0]]);var y={};if(v)for(var A=0;A<this.length;A++){var O=this[A][0];O!=null&&(y[O]=!0)}for(var E=0;E<o.length;E++){var _=[].concat(o[E]);v&&y[_[0]]||(d!==void 0&&(_[5]===void 0||(_[1]="@layer".concat(_[5].length>0?" ".concat(_[5]):""," {").concat(_[1],"}")),_[5]=d),c&&(_[2]&&(_[1]="@media ".concat(_[2]," {").concat(_[1],"}")),_[2]=c),p&&(_[4]?(_[1]="@supports (".concat(_[4],") {").concat(_[1],"}"),_[4]=p):_[4]="".concat(p)),a.push(_))}},a}},81:l=>{l.exports=function(u){return u[1]}},529:l=>{var u=-1;function a(h,f,g,b){if(h===f)return h?[[0,h]]:[];if(g!=null){var S=(function(M,R,I){var D=typeof I=="number"?{index:I,length:0}:I.oldRange,x=typeof I=="number"?null:I.newRange,$=M.length,V=R.length;if(D.length===0&&(x===null||x.length===0)){var Q=D.index,Y=M.slice(0,Q),st=M.slice(Q),rt=x?x.index:null,L=Q+V-$;if((rt===null||rt===L)&&!(L<0||L>V)){var B=R.slice(0,L);if((it=R.slice(L))===st){var F=Math.min(Q,L);if((k=Y.slice(0,F))===(X=B.slice(0,F)))return E(k,Y.slice(F),B.slice(F),st)}}if(rt===null||rt===Q){var tt=Q,it=(B=R.slice(0,tt),R.slice(tt));if(B===Y){var H=Math.min($-tt,V-tt);if((z=st.slice(st.length-H))===(J=it.slice(it.length-H)))return E(Y,st.slice(0,st.length-H),it.slice(0,it.length-H),z)}}}if(D.length>0&&x&&x.length===0){var k=M.slice(0,D.index),z=M.slice(D.index+D.length);if(!(V<(F=k.length)+(H=z.length))){var X=R.slice(0,F),J=R.slice(V-H);if(k===X&&z===J)return E(k,M.slice(F,$-H),R.slice(F,V-H),z)}}return null})(h,f,g);if(S)return S}var N=c(h,f),C=h.substring(0,N);N=v(h=h.substring(N),f=f.substring(N));var P=h.substring(h.length-N),w=(function(M,R){var I;if(!M)return[[1,R]];if(!R)return[[u,M]];var D=M.length>R.length?M:R,x=M.length>R.length?R:M,$=D.indexOf(x);if($!==-1)return I=[[1,D.substring(0,$)],[0,x],[1,D.substring($+x.length)]],M.length>R.length&&(I[0][0]=I[2][0]=u),I;if(x.length===1)return[[u,M],[1,R]];var V=(function(tt,it){var H=tt.length>it.length?tt:it,k=tt.length>it.length?it:tt;if(H.length<4||2*k.length<H.length)return null;function z(kt,G,Ot){for(var Nt,bt,Tt,Et,Vt=kt.substring(Ot,Ot+Math.floor(kt.length/4)),Bt=-1,Ct="";(Bt=G.indexOf(Vt,Bt+1))!==-1;){var Ft=c(kt.substring(Ot),G.substring(Bt)),$t=v(kt.substring(0,Ot),G.substring(0,Bt));Ct.length<$t+Ft&&(Ct=G.substring(Bt-$t,Bt)+G.substring(Bt,Bt+Ft),Nt=kt.substring(0,Ot-$t),bt=kt.substring(Ot+Ft),Tt=G.substring(0,Bt-$t),Et=G.substring(Bt+Ft))}return 2*Ct.length>=kt.length?[Nt,bt,Tt,Et,Ct]:null}var X,J,nt,lt,dt,vt=z(H,k,Math.ceil(H.length/4)),Ut=z(H,k,Math.ceil(H.length/2));return vt||Ut?(X=Ut?vt&&vt[4].length>Ut[4].length?vt:Ut:vt,tt.length>it.length?(J=X[0],nt=X[1],lt=X[2],dt=X[3]):(lt=X[0],dt=X[1],J=X[2],nt=X[3]),[J,nt,lt,dt,X[4]]):null})(M,R);if(V){var Q=V[0],Y=V[1],st=V[2],rt=V[3],L=V[4],B=a(Q,st),F=a(Y,rt);return B.concat([[0,L]],F)}return(function(tt,it){for(var H=tt.length,k=it.length,z=Math.ceil((H+k)/2),X=z,J=2*z,nt=new Array(J),lt=new Array(J),dt=0;dt<J;dt++)nt[dt]=-1,lt[dt]=-1;nt[X+1]=0,lt[X+1]=0;for(var vt=H-k,Ut=vt%2!=0,kt=0,G=0,Ot=0,Nt=0,bt=0;bt<z;bt++){for(var Tt=-bt+kt;Tt<=bt-G;Tt+=2){for(var Et=X+Tt,Vt=(Dt=Tt===-bt||Tt!==bt&&nt[Et-1]<nt[Et+1]?nt[Et+1]:nt[Et-1]+1)-Tt;Dt<H&&Vt<k&&tt.charAt(Dt)===it.charAt(Vt);)Dt++,Vt++;if(nt[Et]=Dt,Dt>H)G+=2;else if(Vt>k)kt+=2;else if(Ut&&(Ft=X+vt-Tt)>=0&&Ft<J&&lt[Ft]!==-1&&Dt>=(Ct=H-lt[Ft]))return o(tt,it,Dt,Vt)}for(var Bt=-bt+Ot;Bt<=bt-Nt;Bt+=2){for(var Ct,Ft=X+Bt,$t=(Ct=Bt===-bt||Bt!==bt&&lt[Ft-1]<lt[Ft+1]?lt[Ft+1]:lt[Ft-1]+1)-Bt;Ct<H&&$t<k&&tt.charAt(H-Ct-1)===it.charAt(k-$t-1);)Ct++,$t++;if(lt[Ft]=Ct,Ct>H)Nt+=2;else if($t>k)Ot+=2;else if(!Ut){var Dt;if((Et=X+vt-Bt)>=0&&Et<J&&nt[Et]!==-1&&(Vt=X+(Dt=nt[Et])-Et,Dt>=(Ct=H-Ct)))return o(tt,it,Dt,Vt)}}}return[[u,tt],[1,it]]})(M,R)})(h=h.substring(0,h.length-N),f=f.substring(0,f.length-N));return C&&w.unshift([0,C]),P&&w.push([0,P]),p(w,b),w}function o(h,f,g,b){var S=h.substring(0,g),N=f.substring(0,b),C=h.substring(g),P=f.substring(b),w=a(S,N),M=a(C,P);return w.concat(M)}function c(h,f){if(!h||!f||h.charAt(0)!==f.charAt(0))return 0;for(var g=0,b=Math.min(h.length,f.length),S=b,N=0;g<S;)h.substring(N,S)==f.substring(N,S)?N=g=S:b=S,S=Math.floor((b-g)/2+g);return d(h.charCodeAt(S-1))&&S--,S}function v(h,f){if(!h||!f||h.slice(-1)!==f.slice(-1))return 0;for(var g=0,b=Math.min(h.length,f.length),S=b,N=0;g<S;)h.substring(h.length-S,h.length-N)==f.substring(f.length-S,f.length-N)?N=g=S:b=S,S=Math.floor((b-g)/2+g);return y(h.charCodeAt(h.length-S))&&S--,S}function p(h,f){h.push([0,""]);for(var g,b=0,S=0,N=0,C="",P="";b<h.length;)if(b<h.length-1&&!h[b][1])h.splice(b,1);else switch(h[b][0]){case 1:N++,P+=h[b][1],b++;break;case u:S++,C+=h[b][1],b++;break;case 0:var w=b-N-S-1;if(f){if(w>=0&&O(h[w][1])){var M=h[w][1].slice(-1);if(h[w][1]=h[w][1].slice(0,-1),C=M+C,P=M+P,!h[w][1]){h.splice(w,1),b--;var R=w-1;h[R]&&h[R][0]===1&&(N++,P=h[R][1]+P,R--),h[R]&&h[R][0]===u&&(S++,C=h[R][1]+C,R--),w=R}}A(h[b][1])&&(M=h[b][1].charAt(0),h[b][1]=h[b][1].slice(1),C+=M,P+=M)}if(b<h.length-1&&!h[b][1]){h.splice(b,1);break}if(C.length>0||P.length>0){C.length>0&&P.length>0&&((g=c(P,C))!==0&&(w>=0?h[w][1]+=P.substring(0,g):(h.splice(0,0,[0,P.substring(0,g)]),b++),P=P.substring(g),C=C.substring(g)),(g=v(P,C))!==0&&(h[b][1]=P.substring(P.length-g)+h[b][1],P=P.substring(0,P.length-g),C=C.substring(0,C.length-g)));var I=N+S;C.length===0&&P.length===0?(h.splice(b-I,I),b-=I):C.length===0?(h.splice(b-I,I,[1,P]),b=b-I+1):P.length===0?(h.splice(b-I,I,[u,C]),b=b-I+1):(h.splice(b-I,I,[u,C],[1,P]),b=b-I+2)}b!==0&&h[b-1][0]===0?(h[b-1][1]+=h[b][1],h.splice(b,1)):b++,N=0,S=0,C="",P=""}h[h.length-1][1]===""&&h.pop();var D=!1;for(b=1;b<h.length-1;)h[b-1][0]===0&&h[b+1][0]===0&&(h[b][1].substring(h[b][1].length-h[b-1][1].length)===h[b-1][1]?(h[b][1]=h[b-1][1]+h[b][1].substring(0,h[b][1].length-h[b-1][1].length),h[b+1][1]=h[b-1][1]+h[b+1][1],h.splice(b-1,1),D=!0):h[b][1].substring(0,h[b+1][1].length)==h[b+1][1]&&(h[b-1][1]+=h[b+1][1],h[b][1]=h[b][1].substring(h[b+1][1].length)+h[b+1][1],h.splice(b+1,1),D=!0)),b++;D&&p(h,f)}function d(h){return h>=55296&&h<=56319}function y(h){return h>=56320&&h<=57343}function A(h){return y(h.charCodeAt(0))}function O(h){return d(h.charCodeAt(h.length-1))}function E(h,f,g,b){return O(h)||A(b)?null:(function(S){for(var N=[],C=0;C<S.length;C++)S[C][1].length>0&&N.push(S[C]);return N})([[0,h],[u,f],[1,g],[0,b]])}function _(h,f,g){return a(h,f,g,!0)}_.INSERT=1,_.DELETE=u,_.EQUAL=0,l.exports=_},465:(l,u,a)=>{l=a.nmd(l);var o="__lodash_hash_undefined__",c=9007199254740991,v="[object Arguments]",p="[object Boolean]",d="[object Date]",y="[object Function]",A="[object GeneratorFunction]",O="[object Map]",E="[object Number]",_="[object Object]",h="[object Promise]",f="[object RegExp]",g="[object Set]",b="[object String]",S="[object Symbol]",N="[object WeakMap]",C="[object ArrayBuffer]",P="[object DataView]",w="[object Float32Array]",M="[object Float64Array]",R="[object Int8Array]",I="[object Int16Array]",D="[object Int32Array]",x="[object Uint8Array]",$="[object Uint8ClampedArray]",V="[object Uint16Array]",Q="[object Uint32Array]",Y=/\w*$/,st=/^\[object .+?Constructor\]$/,rt=/^(?:0|[1-9]\d*)$/,L={};L[v]=L["[object Array]"]=L[C]=L[P]=L[p]=L[d]=L[w]=L[M]=L[R]=L[I]=L[D]=L[O]=L[E]=L[_]=L[f]=L[g]=L[b]=L[S]=L[x]=L[$]=L[V]=L[Q]=!0,L["[object Error]"]=L[y]=L[N]=!1;var B=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g,F=typeof self=="object"&&self&&self.Object===Object&&self,tt=B||F||Function("return this")(),it=u&&!u.nodeType&&u,H=it&&l&&!l.nodeType&&l,k=H&&H.exports===it;function z(j,K){return j.set(K[0],K[1]),j}function X(j,K){return j.add(K),j}function J(j,K,at,ut){var _t=-1,Mt=j?j.length:0;for(ut;++_t<Mt;)at=K(at,j[_t],_t,j);return at}function nt(j){var K=!1;if(j!=null&&typeof j.toString!="function")try{K=!!(j+"")}catch{}return K}function lt(j){var K=-1,at=Array(j.size);return j.forEach((function(ut,_t){at[++K]=[_t,ut]})),at}function dt(j,K){return function(at){return j(K(at))}}function vt(j){var K=-1,at=Array(j.size);return j.forEach((function(ut){at[++K]=ut})),at}var Ut,kt=Array.prototype,G=Function.prototype,Ot=Object.prototype,Nt=tt["__core-js_shared__"],bt=(Ut=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||""))?"Symbol(src)_1."+Ut:"",Tt=G.toString,Et=Ot.hasOwnProperty,Vt=Ot.toString,Bt=RegExp("^"+Tt.call(Et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ct=k?tt.Buffer:void 0,Ft=tt.Symbol,$t=tt.Uint8Array,Dt=dt(Object.getPrototypeOf,Object),ge=Object.create,fe=Ot.propertyIsEnumerable,Ge=kt.splice,Ie=Object.getOwnPropertySymbols,Be=Ct?Ct.isBuffer:void 0,vr=dt(Object.keys,Object),We=Pe(tt,"DataView"),Ee=Pe(tt,"Map"),ae=Pe(tt,"Promise"),he=Pe(tt,"Set"),le=Pe(tt,"WeakMap"),ne=Pe(Object,"create"),Ke=De(We),de=De(Ee),Ye=De(ae),Fe=De(he),mr=De(le),qe=Ft?Ft.prototype:void 0,yr=qe?qe.valueOf:void 0;function ie(j){var K=-1,at=j?j.length:0;for(this.clear();++K<at;){var ut=j[K];this.set(ut[0],ut[1])}}function pe(j){var K=-1,at=j?j.length:0;for(this.clear();++K<at;){var ut=j[K];this.set(ut[0],ut[1])}}function ve(j){var K=-1,at=j?j.length:0;for(this.clear();++K<at;){var ut=j[K];this.set(ut[0],ut[1])}}function Xe(j){this.__data__=new pe(j)}function Ae(j,K,at){var ut=j[K];Et.call(j,K)&&Br(ut,at)&&(at!==void 0||K in j)||(j[K]=at)}function Ze(j,K){for(var at=j.length;at--;)if(Br(j[at][0],K))return at;return-1}function Wt(j,K,at,ut,_t,Mt,Yt){var Rt;if(ut&&(Rt=Mt?ut(j,_t,Mt,Yt):ut(j)),Rt!==void 0)return Rt;if(!qt(j))return j;var te=U(j);if(te){if(Rt=(function(mt){var jt=mt.length,Zt=mt.constructor(jt);return jt&&typeof mt[0]=="string"&&Et.call(mt,"index")&&(Zt.index=mt.index,Zt.input=mt.input),Zt})(j),!K)return(function(mt,jt){var Zt=-1,St=mt.length;for(jt||(jt=Array(St));++Zt<St;)jt[Zt]=mt[Zt];return jt})(j,Rt)}else{var Xt=Kt(j),Me=Xt==y||Xt==A;if(ot(j))return(function(mt,jt){if(jt)return mt.slice();var Zt=new mt.constructor(mt.length);return mt.copy(Zt),Zt})(j,K);if(Xt==_||Xt==v||Me&&!Mt){if(nt(j))return Mt?j:{};if(Rt=(function(mt){return typeof mt.constructor!="function"||Je(mt)?{}:qt(jt=Dt(mt))?ge(jt):{};var jt})(Me?{}:j),!K)return(function(mt,jt){return jr(mt,Rr(mt),jt)})(j,(function(mt,jt){return mt&&jr(jt,At(jt),mt)})(Rt,j))}else{if(!L[Xt])return Mt?j:{};Rt=(function(mt,jt,Zt,St){var xt,Le=mt.constructor;switch(jt){case C:return br(mt);case p:case d:return new Le(+mt);case P:return(function(Lt,re){var Jt=re?br(Lt.buffer):Lt.buffer;return new Lt.constructor(Jt,Lt.byteOffset,Lt.byteLength)})(mt,St);case w:case M:case R:case I:case D:case x:case $:case V:case Q:return(function(Lt,re){var Jt=re?br(Lt.buffer):Lt.buffer;return new Lt.constructor(Jt,Lt.byteOffset,Lt.length)})(mt,St);case O:return(function(Lt,re,Jt){return J(re?Jt(lt(Lt),!0):lt(Lt),z,new Lt.constructor)})(mt,St,Zt);case E:case b:return new Le(mt);case f:return(function(Lt){var re=new Lt.constructor(Lt.source,Y.exec(Lt));return re.lastIndex=Lt.lastIndex,re})(mt);case g:return(function(Lt,re,Jt){return J(re?Jt(vt(Lt),!0):vt(Lt),X,new Lt.constructor)})(mt,St,Zt);case S:return xt=mt,yr?Object(yr.call(xt)):{}}})(j,Xt,Wt,K)}}Yt||(Yt=new Xe);var Oe=Yt.get(j);if(Oe)return Oe;if(Yt.set(j,Rt),!te)var je=at?(function(mt){return(function(jt,Zt,St){var xt=Zt(jt);return U(jt)?xt:(function(Le,Lt){for(var re=-1,Jt=Lt.length,Ce=Le.length;++re<Jt;)Le[Ce+re]=Lt[re];return Le})(xt,St(jt))})(mt,At,Rr)})(j):At(j);return(function(mt,jt){for(var Zt=-1,St=mt?mt.length:0;++Zt<St&&jt(mt[Zt],Zt)!==!1;);})(je||j,(function(mt,jt){je&&(mt=j[jt=mt]),Ae(Rt,jt,Wt(mt,K,at,ut,jt,j,Yt))})),Rt}function br(j){var K=new j.constructor(j.byteLength);return new $t(K).set(new $t(j)),K}function jr(j,K,at,ut){at||(at={});for(var _t=-1,Mt=K.length;++_t<Mt;){var Yt=K[_t],Rt=void 0;Ae(at,Yt,Rt===void 0?j[Yt]:Rt)}return at}function $e(j,K){var at,ut,_t=j.__data__;return((ut=typeof(at=K))=="string"||ut=="number"||ut=="symbol"||ut=="boolean"?at!=="__proto__":at===null)?_t[typeof K=="string"?"string":"hash"]:_t.map}function Pe(j,K){var at=(function(ut,_t){return ut==null?void 0:ut[_t]})(j,K);return(function(ut){return!(!qt(ut)||(_t=ut,bt&&bt in _t))&&(ft(ut)||nt(ut)?Bt:st).test(De(ut));var _t})(at)?at:void 0}ie.prototype.clear=function(){this.__data__=ne?ne(null):{}},ie.prototype.delete=function(j){return this.has(j)&&delete this.__data__[j]},ie.prototype.get=function(j){var K=this.__data__;if(ne){var at=K[j];return at===o?void 0:at}return Et.call(K,j)?K[j]:void 0},ie.prototype.has=function(j){var K=this.__data__;return ne?K[j]!==void 0:Et.call(K,j)},ie.prototype.set=function(j,K){return this.__data__[j]=ne&&K===void 0?o:K,this},pe.prototype.clear=function(){this.__data__=[]},pe.prototype.delete=function(j){var K=this.__data__,at=Ze(K,j);return!(at<0||(at==K.length-1?K.pop():Ge.call(K,at,1),0))},pe.prototype.get=function(j){var K=this.__data__,at=Ze(K,j);return at<0?void 0:K[at][1]},pe.prototype.has=function(j){return Ze(this.__data__,j)>-1},pe.prototype.set=function(j,K){var at=this.__data__,ut=Ze(at,j);return ut<0?at.push([j,K]):at[ut][1]=K,this},ve.prototype.clear=function(){this.__data__={hash:new ie,map:new(Ee||pe),string:new ie}},ve.prototype.delete=function(j){return $e(this,j).delete(j)},ve.prototype.get=function(j){return $e(this,j).get(j)},ve.prototype.has=function(j){return $e(this,j).has(j)},ve.prototype.set=function(j,K){return $e(this,j).set(j,K),this},Xe.prototype.clear=function(){this.__data__=new pe},Xe.prototype.delete=function(j){return this.__data__.delete(j)},Xe.prototype.get=function(j){return this.__data__.get(j)},Xe.prototype.has=function(j){return this.__data__.has(j)},Xe.prototype.set=function(j,K){var at=this.__data__;if(at instanceof pe){var ut=at.__data__;if(!Ee||ut.length<199)return ut.push([j,K]),this;at=this.__data__=new ve(ut)}return at.set(j,K),this};var Rr=Ie?dt(Ie,Object):function(){return[]},Kt=function(j){return Vt.call(j)};function kr(j,K){return!!(K=K==null?c:K)&&(typeof j=="number"||rt.test(j))&&j>-1&&j%1==0&&j<K}function Je(j){var K=j&&j.constructor;return j===(typeof K=="function"&&K.prototype||Ot)}function De(j){if(j!=null){try{return Tt.call(j)}catch{}try{return j+""}catch{}}return""}function Br(j,K){return j===K||j!=j&&K!=K}(We&&Kt(new We(new ArrayBuffer(1)))!=P||Ee&&Kt(new Ee)!=O||ae&&Kt(ae.resolve())!=h||he&&Kt(new he)!=g||le&&Kt(new le)!=N)&&(Kt=function(j){var K=Vt.call(j),at=K==_?j.constructor:void 0,ut=at?De(at):void 0;if(ut)switch(ut){case Ke:return P;case de:return O;case Ye:return h;case Fe:return g;case mr:return N}return K});var U=Array.isArray;function W(j){return j!=null&&(function(K){return typeof K=="number"&&K>-1&&K%1==0&&K<=c})(j.length)&&!ft(j)}var ot=Be||function(){return!1};function ft(j){var K=qt(j)?Vt.call(j):"";return K==y||K==A}function qt(j){var K=typeof j;return!!j&&(K=="object"||K=="function")}function At(j){return W(j)?(function(K,at){var ut=U(K)||(function(Rt){return(function(te){return(function(Xt){return!!Xt&&typeof Xt=="object"})(te)&&W(te)})(Rt)&&Et.call(Rt,"callee")&&(!fe.call(Rt,"callee")||Vt.call(Rt)==v)})(K)?(function(Rt,te){for(var Xt=-1,Me=Array(Rt);++Xt<Rt;)Me[Xt]=te(Xt);return Me})(K.length,String):[],_t=ut.length,Mt=!!_t;for(var Yt in K)!Et.call(K,Yt)||Mt&&(Yt=="length"||kr(Yt,_t))||ut.push(Yt);return ut})(j):(function(K){if(!Je(K))return vr(K);var at=[];for(var ut in Object(K))Et.call(K,ut)&&ut!="constructor"&&at.push(ut);return at})(j)}l.exports=function(j){return Wt(j,!0,!0)}},307:(l,u,a)=>{l=a.nmd(l);var o="__lodash_hash_undefined__",c=9007199254740991,v="[object Arguments]",p="[object Array]",d="[object Boolean]",y="[object Date]",A="[object Error]",O="[object Function]",E="[object Map]",_="[object Number]",h="[object Object]",f="[object Promise]",g="[object RegExp]",b="[object Set]",S="[object String]",N="[object WeakMap]",C="[object ArrayBuffer]",P="[object DataView]",w=/^\[object .+?Constructor\]$/,M=/^(?:0|[1-9]\d*)$/,R={};R["[object Float32Array]"]=R["[object Float64Array]"]=R["[object Int8Array]"]=R["[object Int16Array]"]=R["[object Int32Array]"]=R["[object Uint8Array]"]=R["[object Uint8ClampedArray]"]=R["[object Uint16Array]"]=R["[object Uint32Array]"]=!0,R[v]=R[p]=R[C]=R[d]=R[P]=R[y]=R[A]=R[O]=R[E]=R[_]=R[h]=R[g]=R[b]=R[S]=R[N]=!1;var I=typeof a.g=="object"&&a.g&&a.g.Object===Object&&a.g,D=typeof self=="object"&&self&&self.Object===Object&&self,x=I||D||Function("return this")(),$=u&&!u.nodeType&&u,V=$&&l&&!l.nodeType&&l,Q=V&&V.exports===$,Y=Q&&I.process,st=(function(){try{return Y&&Y.binding&&Y.binding("util")}catch{}})(),rt=st&&st.isTypedArray;function L(U,W){for(var ot=-1,ft=U==null?0:U.length;++ot<ft;)if(W(U[ot],ot,U))return!0;return!1}function B(U){var W=-1,ot=Array(U.size);return U.forEach((function(ft,qt){ot[++W]=[qt,ft]})),ot}function F(U){var W=-1,ot=Array(U.size);return U.forEach((function(ft){ot[++W]=ft})),ot}var tt,it,H,k=Array.prototype,z=Function.prototype,X=Object.prototype,J=x["__core-js_shared__"],nt=z.toString,lt=X.hasOwnProperty,dt=(tt=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||""))?"Symbol(src)_1."+tt:"",vt=X.toString,Ut=RegExp("^"+nt.call(lt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=Q?x.Buffer:void 0,G=x.Symbol,Ot=x.Uint8Array,Nt=X.propertyIsEnumerable,bt=k.splice,Tt=G?G.toStringTag:void 0,Et=Object.getOwnPropertySymbols,Vt=kt?kt.isBuffer:void 0,Bt=(it=Object.keys,H=Object,function(U){return it(H(U))}),Ct=ve(x,"DataView"),Ft=ve(x,"Map"),$t=ve(x,"Promise"),Dt=ve(x,"Set"),ge=ve(x,"WeakMap"),fe=ve(Object,"create"),Ge=Wt(Ct),Ie=Wt(Ft),Be=Wt($t),vr=Wt(Dt),We=Wt(ge),Ee=G?G.prototype:void 0,ae=Ee?Ee.valueOf:void 0;function he(U){var W=-1,ot=U==null?0:U.length;for(this.clear();++W<ot;){var ft=U[W];this.set(ft[0],ft[1])}}function le(U){var W=-1,ot=U==null?0:U.length;for(this.clear();++W<ot;){var ft=U[W];this.set(ft[0],ft[1])}}function ne(U){var W=-1,ot=U==null?0:U.length;for(this.clear();++W<ot;){var ft=U[W];this.set(ft[0],ft[1])}}function Ke(U){var W=-1,ot=U==null?0:U.length;for(this.__data__=new ne;++W<ot;)this.add(U[W])}function de(U){var W=this.__data__=new le(U);this.size=W.size}function Ye(U,W){for(var ot=U.length;ot--;)if(br(U[ot][0],W))return ot;return-1}function Fe(U){return U==null?U===void 0?"[object Undefined]":"[object Null]":Tt&&Tt in Object(U)?(function(W){var ot=lt.call(W,Tt),ft=W[Tt];try{W[Tt]=void 0;var qt=!0}catch{}var At=vt.call(W);return qt&&(ot?W[Tt]=ft:delete W[Tt]),At})(U):(function(W){return vt.call(W)})(U)}function mr(U){return Je(U)&&Fe(U)==v}function qe(U,W,ot,ft,qt){return U===W||(U==null||W==null||!Je(U)&&!Je(W)?U!=U&&W!=W:(function(At,j,K,at,ut,_t){var Mt=$e(At),Yt=$e(j),Rt=Mt?p:Ae(At),te=Yt?p:Ae(j),Xt=(Rt=Rt==v?h:Rt)==h,Me=(te=te==v?h:te)==h,Oe=Rt==te;if(Oe&&Pe(At)){if(!Pe(j))return!1;Mt=!0,Xt=!1}if(Oe&&!Xt)return _t||(_t=new de),Mt||De(At)?yr(At,j,K,at,ut,_t):(function(St,xt,Le,Lt,re,Jt,Ce){switch(Le){case P:if(St.byteLength!=xt.byteLength||St.byteOffset!=xt.byteOffset)return!1;St=St.buffer,xt=xt.buffer;case C:return!(St.byteLength!=xt.byteLength||!Jt(new Ot(St),new Ot(xt)));case d:case y:case _:return br(+St,+xt);case A:return St.name==xt.name&&St.message==xt.message;case g:case S:return St==xt+"";case E:var Se=B;case b:var me=1&Lt;if(Se||(Se=F),St.size!=xt.size&&!me)return!1;var ye=Ce.get(St);if(ye)return ye==xt;Lt|=2,Ce.set(St,xt);var ue=yr(Se(St),Se(xt),Lt,re,Jt,Ce);return Ce.delete(St),ue;case"[object Symbol]":if(ae)return ae.call(St)==ae.call(xt)}return!1})(At,j,Rt,K,at,ut,_t);if(!(1&K)){var je=Xt&&lt.call(At,"__wrapped__"),mt=Me&&lt.call(j,"__wrapped__");if(je||mt){var jt=je?At.value():At,Zt=mt?j.value():j;return _t||(_t=new de),ut(jt,Zt,K,at,_t)}}return!!Oe&&(_t||(_t=new de),(function(St,xt,Le,Lt,re,Jt){var Ce=1&Le,Se=ie(St),me=Se.length;if(me!=ie(xt).length&&!Ce)return!1;for(var ye=me;ye--;){var ue=Se[ye];if(!(Ce?ue in xt:lt.call(xt,ue)))return!1}var pn=Jt.get(St);if(pn&&Jt.get(xt))return pn==xt;var xe=!0;Jt.set(St,xt),Jt.set(xt,St);for(var en=Ce;++ye<me;){var Fr=St[ue=Se[ye]],$r=xt[ue];if(Lt)var gn=Ce?Lt($r,Fr,ue,xt,St,Jt):Lt(Fr,$r,ue,St,xt,Jt);if(!(gn===void 0?Fr===$r||re(Fr,$r,Le,Lt,Jt):gn)){xe=!1;break}en||(en=ue=="constructor")}if(xe&&!en){var Nr=St.constructor,se=xt.constructor;Nr==se||!("constructor"in St)||!("constructor"in xt)||typeof Nr=="function"&&Nr instanceof Nr&&typeof se=="function"&&se instanceof se||(xe=!1)}return Jt.delete(St),Jt.delete(xt),xe})(At,j,K,at,ut,_t))})(U,W,ot,ft,qe,qt))}function yr(U,W,ot,ft,qt,At){var j=1&ot,K=U.length,at=W.length;if(K!=at&&!(j&&at>K))return!1;var ut=At.get(U);if(ut&&At.get(W))return ut==W;var _t=-1,Mt=!0,Yt=2&ot?new Ke:void 0;for(At.set(U,W),At.set(W,U);++_t<K;){var Rt=U[_t],te=W[_t];if(ft)var Xt=j?ft(te,Rt,_t,W,U,At):ft(Rt,te,_t,U,W,At);if(Xt!==void 0){if(Xt)continue;Mt=!1;break}if(Yt){if(!L(W,(function(Me,Oe){if(je=Oe,!Yt.has(je)&&(Rt===Me||qt(Rt,Me,ot,ft,At)))return Yt.push(Oe);var je}))){Mt=!1;break}}else if(Rt!==te&&!qt(Rt,te,ot,ft,At)){Mt=!1;break}}return At.delete(U),At.delete(W),Mt}function ie(U){return(function(W,ot,ft){var qt=ot(W);return $e(W)?qt:(function(At,j){for(var K=-1,at=j.length,ut=At.length;++K<at;)At[ut+K]=j[K];return At})(qt,ft(W))})(U,Br,Xe)}function pe(U,W){var ot,ft,qt=U.__data__;return((ft=typeof(ot=W))=="string"||ft=="number"||ft=="symbol"||ft=="boolean"?ot!=="__proto__":ot===null)?qt[typeof W=="string"?"string":"hash"]:qt.map}function ve(U,W){var ot=(function(ft,qt){return ft==null?void 0:ft[qt]})(U,W);return(function(ft){return!(!kr(ft)||(function(qt){return!!dt&&dt in qt})(ft))&&(Rr(ft)?Ut:w).test(Wt(ft))})(ot)?ot:void 0}he.prototype.clear=function(){this.__data__=fe?fe(null):{},this.size=0},he.prototype.delete=function(U){var W=this.has(U)&&delete this.__data__[U];return this.size-=W?1:0,W},he.prototype.get=function(U){var W=this.__data__;if(fe){var ot=W[U];return ot===o?void 0:ot}return lt.call(W,U)?W[U]:void 0},he.prototype.has=function(U){var W=this.__data__;return fe?W[U]!==void 0:lt.call(W,U)},he.prototype.set=function(U,W){var ot=this.__data__;return this.size+=this.has(U)?0:1,ot[U]=fe&&W===void 0?o:W,this},le.prototype.clear=function(){this.__data__=[],this.size=0},le.prototype.delete=function(U){var W=this.__data__,ot=Ye(W,U);return!(ot<0||(ot==W.length-1?W.pop():bt.call(W,ot,1),--this.size,0))},le.prototype.get=function(U){var W=this.__data__,ot=Ye(W,U);return ot<0?void 0:W[ot][1]},le.prototype.has=function(U){return Ye(this.__data__,U)>-1},le.prototype.set=function(U,W){var ot=this.__data__,ft=Ye(ot,U);return ft<0?(++this.size,ot.push([U,W])):ot[ft][1]=W,this},ne.prototype.clear=function(){this.size=0,this.__data__={hash:new he,map:new(Ft||le),string:new he}},ne.prototype.delete=function(U){var W=pe(this,U).delete(U);return this.size-=W?1:0,W},ne.prototype.get=function(U){return pe(this,U).get(U)},ne.prototype.has=function(U){return pe(this,U).has(U)},ne.prototype.set=function(U,W){var ot=pe(this,U),ft=ot.size;return ot.set(U,W),this.size+=ot.size==ft?0:1,this},Ke.prototype.add=Ke.prototype.push=function(U){return this.__data__.set(U,o),this},Ke.prototype.has=function(U){return this.__data__.has(U)},de.prototype.clear=function(){this.__data__=new le,this.size=0},de.prototype.delete=function(U){var W=this.__data__,ot=W.delete(U);return this.size=W.size,ot},de.prototype.get=function(U){return this.__data__.get(U)},de.prototype.has=function(U){return this.__data__.has(U)},de.prototype.set=function(U,W){var ot=this.__data__;if(ot instanceof le){var ft=ot.__data__;if(!Ft||ft.length<199)return ft.push([U,W]),this.size=++ot.size,this;ot=this.__data__=new ne(ft)}return ot.set(U,W),this.size=ot.size,this};var Xe=Et?function(U){return U==null?[]:(U=Object(U),(function(W,ot){for(var ft=-1,qt=W==null?0:W.length,At=0,j=[];++ft<qt;){var K=W[ft];at=K,Nt.call(U,at)&&(j[At++]=K)}var at;return j})(Et(U)))}:function(){return[]},Ae=Fe;function Ze(U,W){return!!(W=W==null?c:W)&&(typeof U=="number"||M.test(U))&&U>-1&&U%1==0&&U<W}function Wt(U){if(U!=null){try{return nt.call(U)}catch{}try{return U+""}catch{}}return""}function br(U,W){return U===W||U!=U&&W!=W}(Ct&&Ae(new Ct(new ArrayBuffer(1)))!=P||Ft&&Ae(new Ft)!=E||$t&&Ae($t.resolve())!=f||Dt&&Ae(new Dt)!=b||ge&&Ae(new ge)!=N)&&(Ae=function(U){var W=Fe(U),ot=W==h?U.constructor:void 0,ft=ot?Wt(ot):"";if(ft)switch(ft){case Ge:return P;case Ie:return E;case Be:return f;case vr:return b;case We:return N}return W});var jr=mr((function(){return arguments})())?mr:function(U){return Je(U)&&lt.call(U,"callee")&&!Nt.call(U,"callee")},$e=Array.isArray,Pe=Vt||function(){return!1};function Rr(U){if(!kr(U))return!1;var W=Fe(U);return W==O||W=="[object GeneratorFunction]"||W=="[object AsyncFunction]"||W=="[object Proxy]"}function Kt(U){return typeof U=="number"&&U>-1&&U%1==0&&U<=c}function kr(U){var W=typeof U;return U!=null&&(W=="object"||W=="function")}function Je(U){return U!=null&&typeof U=="object"}var De=rt?(function(U){return function(W){return U(W)}})(rt):function(U){return Je(U)&&Kt(U.length)&&!!R[Fe(U)]};function Br(U){return(W=U)!=null&&Kt(W.length)&&!Rr(W)?(function(ot,ft){var qt=$e(ot),At=!qt&&jr(ot),j=!qt&&!At&&Pe(ot),K=!qt&&!At&&!j&&De(ot),at=qt||At||j||K,ut=at?(function(Yt,Rt){for(var te=-1,Xt=Array(Yt);++te<Yt;)Xt[te]=Rt(te);return Xt})(ot.length,String):[],_t=ut.length;for(var Mt in ot)!lt.call(ot,Mt)||at&&(Mt=="length"||j&&(Mt=="offset"||Mt=="parent")||K&&(Mt=="buffer"||Mt=="byteLength"||Mt=="byteOffset")||Ze(Mt,_t))||ut.push(Mt);return ut})(U):(function(ot){if(qt=(ft=ot)&&ft.constructor,ft!==(typeof qt=="function"&&qt.prototype||X))return Bt(ot);var ft,qt,At=[];for(var j in Object(ot))lt.call(ot,j)&&j!="constructor"&&At.push(j);return At})(U);var W}l.exports=function(U,W){return qe(U,W)}},210:function(l,u,a){var o=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(u,"__esModule",{value:!0});var c,v=o(a(465)),p=o(a(307));(function(d){d.compose=function(y,A,O){y===void 0&&(y={}),A===void 0&&(A={}),typeof y!="object"&&(y={}),typeof A!="object"&&(A={});var E=v.default(A);for(var _ in O||(E=Object.keys(E).reduce((function(h,f){return E[f]!=null&&(h[f]=E[f]),h}),{})),y)y[_]!==void 0&&A[_]===void 0&&(E[_]=y[_]);return Object.keys(E).length>0?E:void 0},d.diff=function(y,A){y===void 0&&(y={}),A===void 0&&(A={}),typeof y!="object"&&(y={}),typeof A!="object"&&(A={});var O=Object.keys(y).concat(Object.keys(A)).reduce((function(E,_){return p.default(y[_],A[_])||(E[_]=A[_]===void 0?null:A[_]),E}),{});return Object.keys(O).length>0?O:void 0},d.invert=function(y,A){y===void 0&&(y={}),A===void 0&&(A={}),y=y||{};var O=Object.keys(A).reduce((function(E,_){return A[_]!==y[_]&&y[_]!==void 0&&(E[_]=A[_]),E}),{});return Object.keys(y).reduce((function(E,_){return y[_]!==A[_]&&A[_]===void 0&&(E[_]=null),E}),O)},d.transform=function(y,A,O){if(O===void 0&&(O=!1),typeof y!="object")return A;if(typeof A=="object"){if(!O)return A;var E=Object.keys(A).reduce((function(_,h){return y[h]===void 0&&(_[h]=A[h]),_}),{});return Object.keys(E).length>0?E:void 0}}})(c||(c={})),u.default=c},895:function(l,u,a){var o=this&&this.__importDefault||function(E){return E&&E.__esModule?E:{default:E}},c=o(a(529)),v=o(a(465)),p=o(a(307)),d=o(a(210)),y=o(a(430)),A="\0",O=(function(){function E(_){Array.isArray(_)?this.ops=_:_!=null&&Array.isArray(_.ops)?this.ops=_.ops:this.ops=[]}return E.prototype.insert=function(_,h){var f={};return typeof _=="string"&&_.length===0?this:(f.insert=_,h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(f.attributes=h),this.push(f))},E.prototype.delete=function(_){return _<=0?this:this.push({delete:_})},E.prototype.retain=function(_,h){if(_<=0)return this;var f={retain:_};return h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(f.attributes=h),this.push(f)},E.prototype.push=function(_){var h=this.ops.length,f=this.ops[h-1];if(_=v.default(_),typeof f=="object"){if(typeof _.delete=="number"&&typeof f.delete=="number")return this.ops[h-1]={delete:f.delete+_.delete},this;if(typeof f.delete=="number"&&_.insert!=null&&(h-=1,typeof(f=this.ops[h-1])!="object"))return this.ops.unshift(_),this;if(p.default(_.attributes,f.attributes)){if(typeof _.insert=="string"&&typeof f.insert=="string")return this.ops[h-1]={insert:f.insert+_.insert},typeof _.attributes=="object"&&(this.ops[h-1].attributes=_.attributes),this;if(typeof _.retain=="number"&&typeof f.retain=="number")return this.ops[h-1]={retain:f.retain+_.retain},typeof _.attributes=="object"&&(this.ops[h-1].attributes=_.attributes),this}}return h===this.ops.length?this.ops.push(_):this.ops.splice(h,0,_),this},E.prototype.chop=function(){var _=this.ops[this.ops.length-1];return _&&_.retain&&!_.attributes&&this.ops.pop(),this},E.prototype.filter=function(_){return this.ops.filter(_)},E.prototype.forEach=function(_){this.ops.forEach(_)},E.prototype.map=function(_){return this.ops.map(_)},E.prototype.partition=function(_){var h=[],f=[];return this.forEach((function(g){(_(g)?h:f).push(g)})),[h,f]},E.prototype.reduce=function(_,h){return this.ops.reduce(_,h)},E.prototype.changeLength=function(){return this.reduce((function(_,h){return h.insert?_+y.default.length(h):h.delete?_-h.delete:_}),0)},E.prototype.length=function(){return this.reduce((function(_,h){return _+y.default.length(h)}),0)},E.prototype.slice=function(_,h){_===void 0&&(_=0),h===void 0&&(h=1/0);for(var f=[],g=y.default.iterator(this.ops),b=0;b<h&&g.hasNext();){var S=void 0;b<_?S=g.next(_-b):(S=g.next(h-b),f.push(S)),b+=y.default.length(S)}return new E(f)},E.prototype.compose=function(_){var h=y.default.iterator(this.ops),f=y.default.iterator(_.ops),g=[],b=f.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){for(var S=b.retain;h.peekType()==="insert"&&h.peekLength()<=S;)S-=h.peekLength(),g.push(h.next());b.retain-S>0&&f.next(b.retain-S)}for(var N=new E(g);h.hasNext()||f.hasNext();)if(f.peekType()==="insert")N.push(f.next());else if(h.peekType()==="delete")N.push(h.next());else{var C=Math.min(h.peekLength(),f.peekLength()),P=h.next(C),w=f.next(C);if(typeof w.retain=="number"){var M={};typeof P.retain=="number"?M.retain=C:M.insert=P.insert;var R=d.default.compose(P.attributes,w.attributes,typeof P.retain=="number");if(R&&(M.attributes=R),N.push(M),!f.hasNext()&&p.default(N.ops[N.ops.length-1],M)){var I=new E(h.rest());return N.concat(I).chop()}}else typeof w.delete=="number"&&typeof P.retain=="number"&&N.push(w)}return N.chop()},E.prototype.concat=function(_){var h=new E(this.ops.slice());return _.ops.length>0&&(h.push(_.ops[0]),h.ops=h.ops.concat(_.ops.slice(1))),h},E.prototype.diff=function(_,h){if(this.ops===_.ops)return new E;var f=[this,_].map((function(C){return C.map((function(P){if(P.insert!=null)return typeof P.insert=="string"?P.insert:A;throw new Error("diff() called "+(C===_?"on":"with")+" non-document")})).join("")})),g=new E,b=c.default(f[0],f[1],h),S=y.default.iterator(this.ops),N=y.default.iterator(_.ops);return b.forEach((function(C){for(var P=C[1].length;P>0;){var w=0;switch(C[0]){case c.default.INSERT:w=Math.min(N.peekLength(),P),g.push(N.next(w));break;case c.default.DELETE:w=Math.min(P,S.peekLength()),S.next(w),g.delete(w);break;case c.default.EQUAL:w=Math.min(S.peekLength(),N.peekLength(),P);var M=S.next(w),R=N.next(w);p.default(M.insert,R.insert)?g.retain(w,d.default.diff(M.attributes,R.attributes)):g.push(R).delete(w)}P-=w}})),g.chop()},E.prototype.eachLine=function(_,h){h===void 0&&(h=`
`);for(var f=y.default.iterator(this.ops),g=new E,b=0;f.hasNext();){if(f.peekType()!=="insert")return;var S=f.peek(),N=y.default.length(S)-f.peekLength(),C=typeof S.insert=="string"?S.insert.indexOf(h,N)-N:-1;if(C<0)g.push(f.next());else if(C>0)g.push(f.next(C));else{if(_(g,f.next(1).attributes||{},b)===!1)return;b+=1,g=new E}}g.length()>0&&_(g,{},b)},E.prototype.invert=function(_){var h=new E;return this.reduce((function(f,g){if(g.insert)h.delete(y.default.length(g));else{if(g.retain&&g.attributes==null)return h.retain(g.retain),f+g.retain;if(g.delete||g.retain&&g.attributes){var b=g.delete||g.retain;return _.slice(f,f+b).forEach((function(S){g.delete?h.push(S):g.retain&&g.attributes&&h.retain(y.default.length(S),d.default.invert(g.attributes,S.attributes))})),f+b}}return f}),0),h.chop()},E.prototype.transform=function(_,h){if(h===void 0&&(h=!1),h=!!h,typeof _=="number")return this.transformPosition(_,h);for(var f=_,g=y.default.iterator(this.ops),b=y.default.iterator(f.ops),S=new E;g.hasNext()||b.hasNext();)if(g.peekType()!=="insert"||!h&&b.peekType()==="insert")if(b.peekType()==="insert")S.push(b.next());else{var N=Math.min(g.peekLength(),b.peekLength()),C=g.next(N),P=b.next(N);if(C.delete)continue;P.delete?S.push(P):S.retain(N,d.default.transform(C.attributes,P.attributes,h))}else S.retain(y.default.length(g.next()));return S.chop()},E.prototype.transformPosition=function(_,h){h===void 0&&(h=!1),h=!!h;for(var f=y.default.iterator(this.ops),g=0;f.hasNext()&&g<=_;){var b=f.peekLength(),S=f.peekType();f.next(),S!=="delete"?(S==="insert"&&(g<_||!h)&&(_+=b),g+=b):_-=Math.min(b,_-g)}return _},E.Op=y.default,E.AttributeMap=d.default,E})();l.exports=O},977:function(l,u,a){var o=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(u,"__esModule",{value:!0});var c=o(a(430)),v=(function(){function p(d){this.ops=d,this.index=0,this.offset=0}return p.prototype.hasNext=function(){return this.peekLength()<1/0},p.prototype.next=function(d){d||(d=1/0);var y=this.ops[this.index];if(y){var A=this.offset,O=c.default.length(y);if(d>=O-A?(d=O-A,this.index+=1,this.offset=0):this.offset+=d,typeof y.delete=="number")return{delete:d};var E={};return y.attributes&&(E.attributes=y.attributes),typeof y.retain=="number"?E.retain=d:typeof y.insert=="string"?E.insert=y.insert.substr(A,d):E.insert=y.insert,E}return{retain:1/0}},p.prototype.peek=function(){return this.ops[this.index]},p.prototype.peekLength=function(){return this.ops[this.index]?c.default.length(this.ops[this.index])-this.offset:1/0},p.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},p.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var d=this.offset,y=this.index,A=this.next(),O=this.ops.slice(this.index);return this.offset=d,this.index=y,[A].concat(O)}return[]},p})();u.default=v},430:function(l,u,a){var o=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(u,"__esModule",{value:!0});var c,v=o(a(977));(function(p){p.iterator=function(d){return new v.default(d)},p.length=function(d){return typeof d.delete=="number"?d.delete:typeof d.retain=="number"?d.retain:typeof d.insert=="string"?d.insert.length:1}})(c||(c={})),u.default=c},165:function(l,u,a){var o,c;(c=typeof(o=function(){var v,p={};function d(O,E,_){var h=O.getClientRects();if(h.length===2){var f=O.getBoundingClientRect();return h[E][_]<f[_]}return!1}function y(O){if(!O||screen.deviceXDPI===screen.logicalXDPI)return O;if("length"in O)return Array.prototype.map.call(O,y);var E=screen.deviceXDPI/screen.logicalXDPI;return{top:O.top/E,bottom:O.bottom/E,left:O.left/E,right:O.right/E,width:O.width/E,height:O.height/E}}function A(O,E){var _,h=0,f=1024;if(f>=E.length)return Array.prototype.push.apply(O,E);for(;h<E.length;)_=Array.prototype.push.apply(O,Array.prototype.slice.call(E,h,h+f)),h+=f;return _}return p.isBroken=function(){if(v===void 0){var O=document.createElement("p"),E=document.createElement("span"),_=document.createTextNode("aa"),h=document.createTextNode("aa"),f=document.createElement("img");f.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");var g=document.createRange();if(v={},O.appendChild(_),O.appendChild(E),E.appendChild(f),E.appendChild(h),document.body.appendChild(O),g.setStart(_,1),g.setEnd(E,0),v.getClientRects=v.getBoundingClientRect=g.getClientRects().length>1,v.getClientRects||(g.setEnd(h,1),v.getClientRects=v.getBoundingClientRect=g.getClientRects().length===2),!v.getBoundingClientRect){g.setEnd(g.startContainer,g.startOffset);var b=g.getBoundingClientRect();v.getBoundingClientRect=b.top===0&&b.left===0}if(document.body.removeChild(O),!v.getBoundingClientRect){var S=document.createElement("p");S.style.width="0px",S.style.fontSize="20px",S.style.whiteSpace="normal",S.style.wordBreak="normal";var N=document.createTextNode("m mm");S.appendChild(N),document.body.appendChild(S),g.setStart(N,1),g.setEnd(N,2),d(g,1,"left")?v.getBoundingClientRect=!0:(g.setStart(N,1),g.setEnd(N,3),d(g,0,"top")&&(v.getBoundingClientRect=!0)),document.body.removeChild(S)}var C=window.ActiveXObject&&new Function("/*@cc_on return @_jscript_version; @*/")();v.ieZoom=!!C&&C<=10}return v},p.getClientRects=function(O){var E=this.isBroken();if(E.ieZoom)return y(O.getClientRects());if(!E.getClientRects)return O.getClientRects();var _=[],h=[],f=O.endContainer,g=O.endOffset,b=document.createRange();function S(N){for(var C=0;N=N.previousSibling;)C++;return C}for(;f!==O.commonAncestorContainer;)b.setStart(f,0),b.setEnd(f,g),A(h,b.getClientRects()),g=S(f),f=f.parentNode;return(b=O.cloneRange()).setEnd(f,g),A(_,b.getClientRects()),A(_,h),_},p.getBoundingClientRect=function(O){var E=this.getClientRects(O);if(E.length===0)return null;var _,h=O.getBoundingClientRect(),f=this.isBroken();if(f.ieZoom)return y(h);if(!f.getBoundingClientRect)return h;if(h.width===0&&h.height===0)return E[0];for(var g=0,b=E.length;g<b;g++){var S=E[g];_?(_.left=Math.min(_.left,S.left),_.top=Math.min(_.top,S.top),_.right=Math.max(_.right,S.right),_.bottom=Math.max(_.bottom,S.bottom)):_={left:S.left,top:S.top,right:S.right,bottom:S.bottom}}return _&&(_.width=_.right-_.left,_.height=_.bottom-_.top),_},p})=="function"?o.call(u,a,u,l):o)===void 0||(l.exports=c)},33:(l,u,a)=>{a.r(u),a.d(u,{default:()=>R});var o=(function(){if(typeof Map!="undefined")return Map;function I(D,x){var $=-1;return D.some((function(V,Q){return V[0]===x&&($=Q,!0)})),$}return(function(){function D(){this.__entries__=[]}return Object.defineProperty(D.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),D.prototype.get=function(x){var $=I(this.__entries__,x),V=this.__entries__[$];return V&&V[1]},D.prototype.set=function(x,$){var V=I(this.__entries__,x);~V?this.__entries__[V][1]=$:this.__entries__.push([x,$])},D.prototype.delete=function(x){var $=this.__entries__,V=I($,x);~V&&$.splice(V,1)},D.prototype.has=function(x){return!!~I(this.__entries__,x)},D.prototype.clear=function(){this.__entries__.splice(0)},D.prototype.forEach=function(x,$){$===void 0&&($=null);for(var V=0,Q=this.__entries__;V<Q.length;V++){var Y=Q[V];x.call($,Y[1],Y[0])}},D})()})(),c=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,v=a.g!==void 0&&a.g.Math===Math?a.g:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")(),p=typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(v):function(I){return setTimeout((function(){return I(Date.now())}),1e3/60)},d=["top","right","bottom","left","width","height","size","weight"],y=typeof MutationObserver!="undefined",A=(function(){function I(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=(function(D,x){var $=!1,V=!1,Q=0;function Y(){$&&($=!1,D()),V&&rt()}function st(){p(Y)}function rt(){var L=Date.now();if($){if(L-Q<2)return;V=!0}else $=!0,V=!1,setTimeout(st,20);Q=L}return rt})(this.refresh.bind(this))}return I.prototype.addObserver=function(D){~this.observers_.indexOf(D)||this.observers_.push(D),this.connected_||this.connect_()},I.prototype.removeObserver=function(D){var x=this.observers_,$=x.indexOf(D);~$&&x.splice($,1),!x.length&&this.connected_&&this.disconnect_()},I.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},I.prototype.updateObservers_=function(){var D=this.observers_.filter((function(x){return x.gatherActive(),x.hasActive()}));return D.forEach((function(x){return x.broadcastActive()})),D.length>0},I.prototype.connect_=function(){c&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),y?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},I.prototype.disconnect_=function(){c&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},I.prototype.onTransitionEnd_=function(D){var x=D.propertyName,$=x===void 0?"":x;d.some((function(V){return!!~$.indexOf(V)}))&&this.refresh()},I.getInstance=function(){return this.instance_||(this.instance_=new I),this.instance_},I.instance_=null,I})(),O=function(I,D){for(var x=0,$=Object.keys(D);x<$.length;x++){var V=$[x];Object.defineProperty(I,V,{value:D[V],enumerable:!1,writable:!1,configurable:!0})}return I},E=function(I){return I&&I.ownerDocument&&I.ownerDocument.defaultView||v},_=S(0,0,0,0);function h(I){return parseFloat(I)||0}function f(I){for(var D=[],x=1;x<arguments.length;x++)D[x-1]=arguments[x];return D.reduce((function($,V){return $+h(I["border-"+V+"-width"])}),0)}var g=typeof SVGGraphicsElement!="undefined"?function(I){return I instanceof E(I).SVGGraphicsElement}:function(I){return I instanceof E(I).SVGElement&&typeof I.getBBox=="function"};function b(I){return c?g(I)?(function(D){var x=D.getBBox();return S(0,0,x.width,x.height)})(I):(function(D){var x=D.clientWidth,$=D.clientHeight;if(!x&&!$)return _;var V=E(D).getComputedStyle(D),Q=(function(tt){for(var it={},H=0,k=["top","right","bottom","left"];H<k.length;H++){var z=k[H],X=tt["padding-"+z];it[z]=h(X)}return it})(V),Y=Q.left+Q.right,st=Q.top+Q.bottom,rt=h(V.width),L=h(V.height);if(V.boxSizing==="border-box"&&(Math.round(rt+Y)!==x&&(rt-=f(V,"left","right")+Y),Math.round(L+st)!==$&&(L-=f(V,"top","bottom")+st)),!(function(tt){return tt===E(tt).document.documentElement})(D)){var B=Math.round(rt+Y)-x,F=Math.round(L+st)-$;Math.abs(B)!==1&&(rt-=B),Math.abs(F)!==1&&(L-=F)}return S(Q.left,Q.top,rt,L)})(I):_}function S(I,D,x,$){return{x:I,y:D,width:x,height:$}}var N=(function(){function I(D){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S(0,0,0,0),this.target=D}return I.prototype.isActive=function(){var D=b(this.target);return this.contentRect_=D,D.width!==this.broadcastWidth||D.height!==this.broadcastHeight},I.prototype.broadcastRect=function(){var D=this.contentRect_;return this.broadcastWidth=D.width,this.broadcastHeight=D.height,D},I})(),C=function(I,D){var x,$,V,Q,Y,st,rt,L=($=(x=D).x,V=x.y,Q=x.width,Y=x.height,st=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,rt=Object.create(st.prototype),O(rt,{x:$,y:V,width:Q,height:Y,top:V,right:$+Q,bottom:Y+V,left:$}),rt);O(this,{target:I,contentRect:L})},P=(function(){function I(D,x,$){if(this.activeObservations_=[],this.observations_=new o,typeof D!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=D,this.controller_=x,this.callbackCtx_=$}return I.prototype.observe=function(D){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element!="undefined"&&Element instanceof Object){if(!(D instanceof E(D).Element))throw new TypeError('parameter 1 is not of type "Element".');var x=this.observations_;x.has(D)||(x.set(D,new N(D)),this.controller_.addObserver(this),this.controller_.refresh())}},I.prototype.unobserve=function(D){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(typeof Element!="undefined"&&Element instanceof Object){if(!(D instanceof E(D).Element))throw new TypeError('parameter 1 is not of type "Element".');var x=this.observations_;x.has(D)&&(x.delete(D),x.size||this.controller_.removeObserver(this))}},I.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},I.prototype.gatherActive=function(){var D=this;this.clearActive(),this.observations_.forEach((function(x){x.isActive()&&D.activeObservations_.push(x)}))},I.prototype.broadcastActive=function(){if(this.hasActive()){var D=this.callbackCtx_,x=this.activeObservations_.map((function($){return new C($.target,$.broadcastRect())}));this.callback_.call(D,x,D),this.clearActive()}},I.prototype.clearActive=function(){this.activeObservations_.splice(0)},I.prototype.hasActive=function(){return this.activeObservations_.length>0},I})(),w=typeof WeakMap!="undefined"?new WeakMap:new o,M=function I(D){if(!(this instanceof I))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var x=A.getInstance(),$=new P(D,x,this);w.set(this,$)};["observe","unobserve","disconnect"].forEach((function(I){M.prototype[I]=function(){var D;return(D=w.get(this))[I].apply(D,arguments)}}));const R=v.ResizeObserver!==void 0?v.ResizeObserver:M},413:(l,u,a)=>{a.r(u),a.d(u,{default:()=>S});var o=a(379),c=a.n(o),v=a(795),p=a.n(v),d=a(569),y=a.n(d),A=a(565),O=a.n(A),E=a(216),_=a.n(E),h=a(589),f=a.n(h),g=a(582),b={};b.styleTagTransform=f(),b.setAttributes=O(),b.insert=y().bind(null,"head"),b.domAPI=p(),b.insertStyleElement=_(),c()(g.Z,b);const S=g.Z&&g.Z.locals?g.Z.locals:void 0},379:l=>{var u=[];function a(v){for(var p=-1,d=0;d<u.length;d++)if(u[d].identifier===v){p=d;break}return p}function o(v,p){for(var d={},y=[],A=0;A<v.length;A++){var O=v[A],E=p.base?O[0]+p.base:O[0],_=d[E]||0,h="".concat(E," ").concat(_);d[E]=_+1;var f=a(h),g={css:O[1],media:O[2],sourceMap:O[3],supports:O[4],layer:O[5]};if(f!==-1)u[f].references++,u[f].updater(g);else{var b=c(g,p);p.byIndex=A,u.splice(A,0,{identifier:h,updater:b,references:1})}y.push(h)}return y}function c(v,p){var d=p.domAPI(p);return d.update(v),function(y){if(y){if(y.css===v.css&&y.media===v.media&&y.sourceMap===v.sourceMap&&y.supports===v.supports&&y.layer===v.layer)return;d.update(v=y)}else d.remove()}}l.exports=function(v,p){var d=o(v=v||[],p=p||{});return function(y){y=y||[];for(var A=0;A<d.length;A++){var O=a(d[A]);u[O].references--}for(var E=o(y,p),_=0;_<d.length;_++){var h=a(d[_]);u[h].references===0&&(u[h].updater(),u.splice(h,1))}d=E}}},569:l=>{var u={};l.exports=function(a,o){var c=(function(v){if(u[v]===void 0){var p=document.querySelector(v);if(window.HTMLIFrameElement&&p instanceof window.HTMLIFrameElement)try{p=p.contentDocument.head}catch{p=null}u[v]=p}return u[v]})(a);if(!c)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");c.appendChild(o)}},216:l=>{l.exports=function(u){var a=document.createElement("style");return u.setAttributes(a,u.attributes),u.insert(a,u.options),a}},565:(l,u,a)=>{l.exports=function(o){var c=a.nc;c&&o.setAttribute("nonce",c)}},795:l=>{l.exports=function(u){var a=u.insertStyleElement(u);return{update:function(o){(function(c,v,p){var d="";p.supports&&(d+="@supports (".concat(p.supports,") {")),p.media&&(d+="@media ".concat(p.media," {"));var y=p.layer!==void 0;y&&(d+="@layer".concat(p.layer.length>0?" ".concat(p.layer):""," {")),d+=p.css,y&&(d+="}"),p.media&&(d+="}"),p.supports&&(d+="}");var A=p.sourceMap;A&&typeof btoa!="undefined"&&(d+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(A))))," */")),v.styleTagTransform(d,c,v.options)})(a,u,o)},remove:function(){(function(o){if(o.parentNode===null)return!1;o.parentNode.removeChild(o)})(a)}}}},589:l=>{l.exports=function(u,a){if(a.styleSheet)a.styleSheet.cssText=u;else{for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(document.createTextNode(u))}}},607:function(l,u,a){var o=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(u,"__esModule",{value:!0}),u.Cursor=u.default=void 0;var c=o(a(678));u.default=c.default;var v=o(a(353));u.Cursor=v.default,a(413)},353:(l,u)=>{Object.defineProperty(u,"__esModule",{value:!0});var a=(function(){function o(c,v,p){this.id=c,this.name=v,this.color=p,this.toggleNearCursor=this.toggleNearCursor.bind(this),this._toggleOpenedCursor=this._toggleOpenedCursor.bind(this),this._setHoverState=this._setHoverState.bind(this)}return o.prototype.build=function(c){var v=document.createElement(o.CONTAINER_ELEMENT_TAG);v.classList.add(o.CURSOR_CLASS),v.id="ql-cursor-".concat(this.id),v.innerHTML=c.template;var p=v.getElementsByClassName(o.SELECTION_CLASS)[0],d=v.getElementsByClassName(o.CARET_CONTAINER_CLASS)[0],y=d.getElementsByClassName(o.CARET_CLASS)[0],A=v.getElementsByClassName(o.FLAG_CLASS)[0];return A.style.backgroundColor=this.color,y.style.backgroundColor=this.color,v.getElementsByClassName(o.NAME_CLASS)[0].textContent=this.name,this._hideDelay="".concat(c.hideDelayMs,"ms"),this._hideSpeedMs=c.hideSpeedMs,this._positionFlag=c.positionFlag,A.style.transitionDelay=this._hideDelay,A.style.transitionDuration="".concat(this._hideSpeedMs,"ms"),this._el=v,this._selectionEl=p,this._caretEl=d,this._flagEl=A,d.addEventListener("mouseover",this._setHoverState,{passive:!0}),this._el},o.prototype.show=function(){this._el.classList.remove(o.HIDDEN_CLASS)},o.prototype.hide=function(){this._el.classList.add(o.HIDDEN_CLASS)},o.prototype.remove=function(){this._el.parentNode.removeChild(this._el)},o.prototype.toggleNearCursor=function(c,v){var p=this._getCoordinates(),d=p.left,y=p.right,A=p.top,O=p.bottom,E=c>=d&&c<=y&&v>=A&&v<=O;return this._caretEl.classList.toggle(o.CONTAINER_HOVER_CLASS,E),E},o.prototype.toggleFlag=function(c){var v=this;this._caretEl.classList.toggle(o.CONTAINER_HOVER_CLASS,c)||(this._flagEl.classList.add(o.NO_DELAY_CLASS),setTimeout((function(){return v._flagEl.classList.remove(o.NO_DELAY_CLASS)}),this._hideSpeedMs))},o.prototype.updateCaret=function(c,v){this._caretEl.style.top="".concat(c.top,"px"),this._caretEl.style.left="".concat(c.left,"px"),this._caretEl.style.height="".concat(c.height,"px"),this._positionFlag?this._positionFlag(this._flagEl,c,v):this._updateCaretFlag(c,v)},o.prototype.updateSelection=function(c,v){var p=this;this._clearSelection(),c=c||[],c=Array.from(c),c=this._sanitize(c),(c=this._sortByDomPosition(c)).forEach((function(d){return p._addSelection(d,v)}))},o.prototype._setHoverState=function(){document.addEventListener("mousemove",this._toggleOpenedCursor,{passive:!0})},o.prototype._toggleOpenedCursor=function(c){var v=this.toggleNearCursor(c.clientX,c.clientY);this._caretEl.classList.toggle(o.CONTAINER_NO_POINTER_CLASS,v),v||document.removeEventListener("mousemove",this._toggleOpenedCursor)},o.prototype._getCoordinates=function(){return this._caretEl.getBoundingClientRect()},o.prototype._updateCaretFlag=function(c,v){this._flagEl.style.width="";var p=this._flagEl.getBoundingClientRect();this._flagEl.classList.remove(o.FLAG_FLIPPED_CLASS),c.left>v.width-p.width&&this._flagEl.classList.add(o.FLAG_FLIPPED_CLASS),this._flagEl.style.left="".concat(c.left,"px"),this._flagEl.style.top="".concat(c.top,"px"),this._flagEl.style.width="".concat(Math.ceil(p.width),"px")},o.prototype._clearSelection=function(){this._selectionEl.innerHTML=""},o.prototype._addSelection=function(c,v){var p=this._selectionBlock(c,v);this._selectionEl.appendChild(p)},o.prototype._selectionBlock=function(c,v){var p=document.createElement(o.SELECTION_ELEMENT_TAG);return p.classList.add(o.SELECTION_BLOCK_CLASS),p.style.top="".concat(c.top-v.top,"px"),p.style.left="".concat(c.left-v.left,"px"),p.style.width="".concat(c.width,"px"),p.style.height="".concat(c.height,"px"),p.style.backgroundColor=this.color,p.style.opacity="0.3",p},o.prototype._sortByDomPosition=function(c){return c.sort((function(v,p){return v.top===p.top?v.left-p.left:v.top-p.top}))},o.prototype._sanitize=function(c){var v=this,p=new Set;return c.filter((function(d){if(!d.width||!d.height)return!1;var y=v._serialize(d);return!p.has(y)&&(p.add(y),!0)}))},o.prototype._serialize=function(c){return["top:".concat(c.top),"right:".concat(c.right),"bottom:".concat(c.bottom),"left:".concat(c.left)].join(";")},o.CONTAINER_ELEMENT_TAG="SPAN",o.SELECTION_ELEMENT_TAG="SPAN",o.CURSOR_CLASS="ql-cursor",o.SELECTION_CLASS="ql-cursor-selections",o.SELECTION_BLOCK_CLASS="ql-cursor-selection-block",o.CARET_CLASS="ql-cursor-caret",o.CARET_CONTAINER_CLASS="ql-cursor-caret-container",o.CONTAINER_HOVER_CLASS="hover",o.CONTAINER_NO_POINTER_CLASS="no-pointer",o.FLAG_CLASS="ql-cursor-flag",o.FLAG_FLIPPED_CLASS="flag-flipped",o.NAME_CLASS="ql-cursor-name",o.HIDDEN_CLASS="hidden",o.NO_DELAY_CLASS="no-delay",o})();u.default=a},678:function(l,u,a){var o=this&&this.__createBinding||(Object.create?function(h,f,g,b){b===void 0&&(b=g);var S=Object.getOwnPropertyDescriptor(f,g);S&&!("get"in S?!f.__esModule:S.writable||S.configurable)||(S={enumerable:!0,get:function(){return f[g]}}),Object.defineProperty(h,b,S)}:function(h,f,g,b){b===void 0&&(b=g),h[b]=f[g]}),c=this&&this.__setModuleDefault||(Object.create?function(h,f){Object.defineProperty(h,"default",{enumerable:!0,value:f})}:function(h,f){h.default=f}),v=this&&this.__importStar||function(h){if(h&&h.__esModule)return h;var f={};if(h!=null)for(var g in h)g!=="default"&&Object.prototype.hasOwnProperty.call(h,g)&&o(f,h,g);return c(f,h),f},p=this&&this.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(u,"__esModule",{value:!0});var d=p(a(353)),y=v(a(165)),A=p(a(338)),O=p(a(33)),E=a(895),_=(function(){function h(f,g){g===void 0&&(g={}),this._cursors={},this._isObserving=!1,this._handleCursorTouch=this._handleCursorTouch.bind(this),this.quill=f,this.options=this._setDefaults(g),this._container=this.quill.addContainer(this.options.containerClass),this._boundsContainer=this.options.boundsContainer||this.quill.container,this._currentSelection=this.quill.getSelection(),this._registerSelectionChangeListeners(),this._registerTextChangeListener(),this._registerDomListeners()}return h.prototype.createCursor=function(f,g,b){var S=this._cursors[f];if(!S){S=new d.default(f,g,b),this._cursors[f]=S;var N=S.build(this.options);this._container.appendChild(N)}return S},h.prototype.moveCursor=function(f,g){var b=this._cursors[f];b&&(b.range=g,this._updateCursor(b))},h.prototype.removeCursor=function(f){var g=this._cursors[f];g&&(g.remove(),delete this._cursors[f])},h.prototype.update=function(){var f=this;this.cursors().forEach((function(g){return f._updateCursor(g)}))},h.prototype.clearCursors=function(){var f=this;this.cursors().forEach((function(g){return f.removeCursor(g.id)}))},h.prototype.toggleFlag=function(f,g){var b=this._cursors[f];b&&b.toggleFlag(g)},h.prototype.cursors=function(){var f=this;return Object.keys(this._cursors).map((function(g){return f._cursors[g]}))},h.prototype._registerSelectionChangeListeners=function(){var f=this;this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,(function(g){f._currentSelection=g}))},h.prototype._registerTextChangeListener=function(){var f=this;this.quill.on(this.quill.constructor.events.TEXT_CHANGE,(function(g){return f._handleTextChange(g)}))},h.prototype._registerDomListeners=function(){var f=this,g=this.quill.container.getElementsByClassName("ql-editor")[0];g.addEventListener("scroll",(function(){return f.update()}),{passive:!0}),g.addEventListener("touchstart",this._handleCursorTouch,{passive:!0})},h.prototype._handleCursorTouch=function(f){var g=this;this.cursors().forEach((function(b){b.toggleNearCursor(f.pageX,f.pageY),setTimeout((function(){return b.toggleFlag(!1)}),g.options.hideDelayMs)}))},h.prototype._registerResizeObserver=function(){var f=this;if(!this._isObserving){var g=this.quill.container.getElementsByClassName("ql-editor")[0],b=new O.default((function(S){if(!S[0].target.isConnected)return b.disconnect(),void(f._isObserving=!1);f.update()}));b.observe(g),this._isObserving=!0}},h.prototype._updateCursor=function(f){if(this._registerResizeObserver(),!f.range)return f.hide();var g=this._indexWithinQuillBounds(f.range.index),b=this._indexWithinQuillBounds(f.range.index+f.range.length),S=this.quill.getLeaf(g),N=this.quill.getLeaf(b);if(!this._leafIsValid(S)||!this._leafIsValid(N))return f.hide();f.show();var C=this._boundsContainer.getBoundingClientRect(),P=this.quill.getBounds(b);f.updateCaret(P,C);var w=this._lineRanges(f,S,N).reduce((function(M,R){return M.concat(Array.from(y.getClientRects(R)))}),[]);f.updateSelection(w,C)},h.prototype._indexWithinQuillBounds=function(f){var g=this.quill.getLength(),b=g?g-1:0;return f=Math.max(f,0),Math.min(f,b)},h.prototype._leafIsValid=function(f){return f&&f[0]&&f[0].domNode&&f[1]>=0},h.prototype._handleTextChange=function(f){var g=this;window.setTimeout((function(){g.options.transformOnTextChange&&g._transformCursors(f),g.options.selectionChangeSource&&(g._emitSelection(),g.update())}))},h.prototype._emitSelection=function(){this.quill.emitter.emit(this.quill.constructor.events.SELECTION_CHANGE,this.quill.getSelection(),this._currentSelection,this.options.selectionChangeSource)},h.prototype._setDefaults=function(f){return(f=Object.assign({},f)).template||(f.template=h.DEFAULTS.template),f.containerClass||(f.containerClass=h.DEFAULTS.containerClass),f.selectionChangeSource!==null&&(f.selectionChangeSource||(f.selectionChangeSource=h.DEFAULTS.selectionChangeSource)),f.hideDelayMs=Number.isInteger(f.hideDelayMs)?f.hideDelayMs:h.DEFAULTS.hideDelayMs,f.hideSpeedMs=Number.isInteger(f.hideSpeedMs)?f.hideSpeedMs:h.DEFAULTS.hideSpeedMs,f.transformOnTextChange=!!f.transformOnTextChange,f},h.prototype._lineRanges=function(f,g,b){var S=this.quill.getLines(f.range);return S.reduce((function(N,C,P){if(!C.children){var w=document.createRange();return w.selectNode(C.domNode),N.concat(w)}var M=P===0?g:C.path(0).pop(),R=M[0],I=M[1],D=P===S.length-1?b:C.path(C.length()-1).pop(),x=D[0],$=D[1],V=document.createRange();return R.domNode.nodeType===Node.TEXT_NODE?V.setStart(R.domNode,I):V.setStartBefore(R.domNode),x.domNode.nodeType===Node.TEXT_NODE?V.setEnd(x.domNode,$):V.setEndAfter(x.domNode),N.concat(V)}),[])},h.prototype._transformCursors=function(f){var g=this;f=new E(f),this.cursors().filter((function(b){return b.range})).forEach((function(b){b.range.index=f.transformPosition(b.range.index),g._updateCursor(b)}))},h.DEFAULTS={template:A.default,containerClass:"ql-cursors",selectionChangeSource:"api",hideDelayMs:3e3,hideSpeedMs:400},h})();u.default=_},338:function(l,u,a){var o=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(u,"__esModule",{value:!0});var c=o(a(353)),v=`
  <span class="`.concat(c.default.SELECTION_CLASS,`"></span>
  <span class="`).concat(c.default.CARET_CONTAINER_CLASS,`">
    <span class="`).concat(c.default.CARET_CLASS,`"></span>
  </span>
  <div class="`).concat(c.default.FLAG_CLASS,`">
    <small class="`).concat(c.default.NAME_CLASS,`"></small>
  </div>
`);u.default=v}},n={};function i(l){var u=n[l];if(u!==void 0)return u.exports;var a=n[l]={id:l,loaded:!1,exports:{}};return e[l].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.n=l=>{var u=l&&l.__esModule?()=>l.default:()=>l;return i.d(u,{a:u}),u},i.d=(l,u)=>{for(var a in u)i.o(u,a)&&!i.o(l,a)&&Object.defineProperty(l,a,{enumerable:!0,get:u[a]})},i.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),i.o=(l,u)=>Object.prototype.hasOwnProperty.call(l,u),i.r=l=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},i.nmd=l=>(l.paths=[],l.children||(l.children=[]),l),i.nc=void 0;var s=i(607);return s.default})()))})(io)),io.exports}var K1=W1();const Y1=vi(K1);var Hr={},Vi={},Gi={exports:{}},Wu;function Hh(){if(Wu)return Gi.exports;Wu=1;var r=typeof Reflect=="object"?Reflect:null,t=r&&typeof r.apply=="function"?r.apply:function(g,b,S){return Function.prototype.apply.call(g,b,S)},e;r&&typeof r.ownKeys=="function"?e=r.ownKeys:Object.getOwnPropertySymbols?e=function(g){return Object.getOwnPropertyNames(g).concat(Object.getOwnPropertySymbols(g))}:e=function(g){return Object.getOwnPropertyNames(g)};function n(f){console&&console.warn&&console.warn(f)}var i=Number.isNaN||function(g){return g!==g};function s(){s.init.call(this)}Gi.exports=s,Gi.exports.once=E,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(f){if(typeof f!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof f)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(f){if(typeof f!="number"||f<0||i(f))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+f+".");l=f}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||i(g))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+g+".");return this._maxListeners=g,this};function a(f){return f._maxListeners===void 0?s.defaultMaxListeners:f._maxListeners}s.prototype.getMaxListeners=function(){return a(this)},s.prototype.emit=function(g){for(var b=[],S=1;S<arguments.length;S++)b.push(arguments[S]);var N=g==="error",C=this._events;if(C!==void 0)N=N&&C.error===void 0;else if(!N)return!1;if(N){var P;if(b.length>0&&(P=b[0]),P instanceof Error)throw P;var w=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw w.context=P,w}var M=C[g];if(M===void 0)return!1;if(typeof M=="function")t(M,this,b);else for(var R=M.length,I=y(M,R),S=0;S<R;++S)t(I[S],this,b);return!0};function o(f,g,b,S){var N,C,P;if(u(b),C=f._events,C===void 0?(C=f._events=Object.create(null),f._eventsCount=0):(C.newListener!==void 0&&(f.emit("newListener",g,b.listener?b.listener:b),C=f._events),P=C[g]),P===void 0)P=C[g]=b,++f._eventsCount;else if(typeof P=="function"?P=C[g]=S?[b,P]:[P,b]:S?P.unshift(b):P.push(b),N=a(f),N>0&&P.length>N&&!P.warned){P.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+P.length+" "+String(g)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=f,w.type=g,w.count=P.length,n(w)}return f}s.prototype.addListener=function(g,b){return o(this,g,b,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(g,b){return o(this,g,b,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(f,g,b){var S={fired:!1,wrapFn:void 0,target:f,type:g,listener:b},N=c.bind(S);return N.listener=b,S.wrapFn=N,N}s.prototype.once=function(g,b){return u(b),this.on(g,v(this,g,b)),this},s.prototype.prependOnceListener=function(g,b){return u(b),this.prependListener(g,v(this,g,b)),this},s.prototype.removeListener=function(g,b){var S,N,C,P,w;if(u(b),N=this._events,N===void 0)return this;if(S=N[g],S===void 0)return this;if(S===b||S.listener===b)--this._eventsCount===0?this._events=Object.create(null):(delete N[g],N.removeListener&&this.emit("removeListener",g,S.listener||b));else if(typeof S!="function"){for(C=-1,P=S.length-1;P>=0;P--)if(S[P]===b||S[P].listener===b){w=S[P].listener,C=P;break}if(C<0)return this;C===0?S.shift():A(S,C),S.length===1&&(N[g]=S[0]),N.removeListener!==void 0&&this.emit("removeListener",g,w||b)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(g){var b,S,N;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[g]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[g]),this;if(arguments.length===0){var C=Object.keys(S),P;for(N=0;N<C.length;++N)P=C[N],P!=="removeListener"&&this.removeAllListeners(P);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(b=S[g],typeof b=="function")this.removeListener(g,b);else if(b!==void 0)for(N=b.length-1;N>=0;N--)this.removeListener(g,b[N]);return this};function p(f,g,b){var S=f._events;if(S===void 0)return[];var N=S[g];return N===void 0?[]:typeof N=="function"?b?[N.listener||N]:[N]:b?O(N):y(N,N.length)}s.prototype.listeners=function(g){return p(this,g,!0)},s.prototype.rawListeners=function(g){return p(this,g,!1)},s.listenerCount=function(f,g){return typeof f.listenerCount=="function"?f.listenerCount(g):d.call(f,g)},s.prototype.listenerCount=d;function d(f){var g=this._events;if(g!==void 0){var b=g[f];if(typeof b=="function")return 1;if(b!==void 0)return b.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]};function y(f,g){for(var b=new Array(g),S=0;S<g;++S)b[S]=f[S];return b}function A(f,g){for(;g+1<f.length;g++)f[g]=f[g+1];f.pop()}function O(f){for(var g=new Array(f.length),b=0;b<g.length;++b)g[b]=f[b].listener||f[b];return g}function E(f,g){return new Promise(function(b,S){function N(P){f.removeListener(g,C),S(P)}function C(){typeof f.removeListener=="function"&&f.removeListener("error",N),b([].slice.call(arguments))}h(f,g,C,{once:!0}),g!=="error"&&_(f,N,{once:!0})})}function _(f,g,b){typeof f.on=="function"&&h(f,"error",g,b)}function h(f,g,b,S){if(typeof f.on=="function")S.once?f.once(g,b):f.on(g,b);else if(typeof f.addEventListener=="function")f.addEventListener(g,function N(C){S.once&&f.removeEventListener(g,N),b(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof f)}return Gi.exports}var Ku;function Bn(){if(Ku)return Vi;Ku=1;var r=Hh().EventEmitter;Vi.EventEmitter=r,Vi.mixin=t;function t(e){for(var n in r.prototype)e.prototype[n]=r.prototype[n]}return Vi}var so,Yu;function X1(){if(Yu)return so;Yu=1;var r=["info","warn","error"];function t(){var e=Object.create(null);r.forEach(function(n){e[n]=console[n].bind(console)}),this.setMethods(e)}return so=t,t.prototype.setMethods=function(e){e=e||{};var n=this;r.forEach(function(i){typeof e[i]=="function"&&(n[i]=e[i])})},so}var oo,Xu;function Nl(){if(Xu)return oo;Xu=1;var r=X1(),t=new r;return oo=t,oo}var ao,Zu;function Ei(){if(Zu)return ao;Zu=1;function r(t,e){this.code=t,this.message=e||"",Error.captureStackTrace?Error.captureStackTrace(this,r):this.stack=new Error().stack}return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.name="ShareDBError",r.CODES={ERR_APPLY_OP_VERSION_DOES_NOT_MATCH_SNAPSHOT:"ERR_APPLY_OP_VERSION_DOES_NOT_MATCH_SNAPSHOT",ERR_APPLY_SNAPSHOT_NOT_PROVIDED:"ERR_APPLY_SNAPSHOT_NOT_PROVIDED",ERR_FIXUP_IS_ONLY_VALID_ON_APPLY:"ERR_FIXUP_IS_ONLY_VALID_ON_APPLY",ERR_CANNOT_FIXUP_DELETION:"ERR_CANNOT_FIXUP_DELETION",ERR_CLIENT_ID_BADLY_FORMED:"ERR_CLIENT_ID_BADLY_FORMED",ERR_CANNOT_PING_OFFLINE:"ERR_CANNOT_PING_OFFLINE",ERR_CONNECTION_SEQ_INTEGER_OVERFLOW:"ERR_CONNECTION_SEQ_INTEGER_OVERFLOW",ERR_CONNECTION_STATE_TRANSITION_INVALID:"ERR_CONNECTION_STATE_TRANSITION_INVALID",ERR_DATABASE_ADAPTER_NOT_FOUND:"ERR_DATABASE_ADAPTER_NOT_FOUND",ERR_DATABASE_DOES_NOT_SUPPORT_SUBSCRIBE:"ERR_DATABASE_DOES_NOT_SUPPORT_SUBSCRIBE",ERR_DATABASE_METHOD_NOT_IMPLEMENTED:"ERR_DATABASE_METHOD_NOT_IMPLEMENTED",ERR_DEFAULT_TYPE_MISMATCH:"ERR_DEFAULT_TYPE_MISMATCH",ERR_DOC_MISSING_VERSION:"ERR_DOC_MISSING_VERSION",ERR_DOC_ALREADY_CREATED:"ERR_DOC_ALREADY_CREATED",ERR_DOC_DOES_NOT_EXIST:"ERR_DOC_DOES_NOT_EXIST",ERR_DOC_TYPE_NOT_RECOGNIZED:"ERR_DOC_TYPE_NOT_RECOGNIZED",ERR_DOC_WAS_DELETED:"ERR_DOC_WAS_DELETED",ERR_DOC_IN_HARD_ROLLBACK:"ERR_DOC_IN_HARD_ROLLBACK",ERR_INFLIGHT_OP_MISSING:"ERR_INFLIGHT_OP_MISSING",ERR_INGESTED_SNAPSHOT_HAS_NO_VERSION:"ERR_INGESTED_SNAPSHOT_HAS_NO_VERSION",ERR_MAX_SUBMIT_RETRIES_EXCEEDED:"ERR_MAX_SUBMIT_RETRIES_EXCEEDED",ERR_MESSAGE_BADLY_FORMED:"ERR_MESSAGE_BADLY_FORMED",ERR_MILESTONE_ARGUMENT_INVALID:"ERR_MILESTONE_ARGUMENT_INVALID",ERR_NO_OP:"ERR_NO_OP",ERR_OP_ALREADY_SUBMITTED:"ERR_OP_ALREADY_SUBMITTED",ERR_OP_NOT_ALLOWED_IN_PROJECTION:"ERR_OP_NOT_ALLOWED_IN_PROJECTION",ERR_OP_SUBMIT_REJECTED:"ERR_OP_SUBMIT_REJECTED",ERR_PENDING_OP_REMOVED_BY_OP_SUBMIT_REJECTED:"ERR_PENDING_OP_REMOVED_BY_OP_SUBMIT_REJECTED",ERR_HARD_ROLLBACK_FETCH_FAILED:"ERR_HARD_ROLLBACK_FETCH_FAILED",ERR_OP_VERSION_MISMATCH_AFTER_TRANSFORM:"ERR_OP_VERSION_MISMATCH_AFTER_TRANSFORM",ERR_OP_VERSION_MISMATCH_DURING_TRANSFORM:"ERR_OP_VERSION_MISMATCH_DURING_TRANSFORM",ERR_OP_VERSION_NEWER_THAN_CURRENT_SNAPSHOT:"ERR_OP_VERSION_NEWER_THAN_CURRENT_SNAPSHOT",ERR_OT_LEGACY_JSON0_OP_CANNOT_BE_NORMALIZED:"ERR_OT_LEGACY_JSON0_OP_CANNOT_BE_NORMALIZED",ERR_OT_OP_BADLY_FORMED:"ERR_OT_OP_BADLY_FORMED",ERR_OT_OP_NOT_APPLIED:"ERR_OT_OP_NOT_APPLIED",ERR_OT_OP_NOT_PROVIDED:"ERR_OT_OP_NOT_PROVIDED",ERR_PRESENCE_TRANSFORM_FAILED:"ERR_PRESENCE_TRANSFORM_FAILED",ERR_PROTOCOL_VERSION_NOT_SUPPORTED:"ERR_PROTOCOL_VERSION_NOT_SUPPORTED",ERR_QUERY_CHANNEL_MISSING:"ERR_QUERY_CHANNEL_MISSING",ERR_QUERY_EMITTER_LISTENER_NOT_ASSIGNED:"ERR_QUERY_EMITTER_LISTENER_NOT_ASSIGNED",ERR_SNAPSHOT_READ_SILENT_REJECTION:"ERR_SNAPSHOT_READ_SILENT_REJECTION",ERR_SNAPSHOT_READS_REJECTED:"ERR_SNAPSHOT_READS_REJECTED",ERR_SUBMIT_TRANSFORM_OPS_NOT_FOUND:"ERR_SUBMIT_TRANSFORM_OPS_NOT_FOUND",ERR_TYPE_CANNOT_BE_PROJECTED:"ERR_TYPE_CANNOT_BE_PROJECTED",ERR_TYPE_DOES_NOT_SUPPORT_COMPOSE:"ERR_TYPE_DOES_NOT_SUPPORT_COMPOSE",ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE:"ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE",ERR_UNKNOWN_ERROR:"ERR_UNKNOWN_ERROR"},ao=r,ao}var lo={},uo,Ju;function zh(){if(Ju)return uo;Ju=1,uo=r;function r(t,e,n,i){var s=function(u,a,o,c){e(o,u,a,"left"),e(c,a,u,"right")},l=t.transformX=function(u,a){n(u),n(a);for(var o=[],c=0;c<a.length;c++){for(var v=a[c],p=[],d=0;d<u.length;){var y=[];if(s(u[d],v,p,y),d++,y.length===1)v=y[0];else if(y.length===0){for(var A=d;A<u.length;A++)i(p,u[A]);v=null;break}else{for(var O=l(u.slice(d),y),E=0;E<O[0].length;E++)i(p,O[0][E]);for(var _=0;_<O[1].length;_++)i(o,O[1][_]);v=null;break}}v!=null&&i(o,v),u=p}return[u,o]};t.transform=function(u,a,o){if(!(o==="left"||o==="right"))throw new Error("type must be 'left' or 'right'");return a.length===0?u:u.length===1&&a.length===1?e([],u[0],a[0],o):o==="left"?l(u,a)[0]:l(a,u)[1]}}return uo}var co={exports:{}},Qu;function Z1(){if(Qu)return co.exports;Qu=1;var r=co.exports={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(a){if(a!=null&&typeof a!="string")throw new Error("Initial data must be a string");return a||""}},t=function(a,o,c){return a.slice(0,o)+c+a.slice(o)},e=function(a){if(typeof a.p!="number")throw new Error("component missing position field");if(typeof a.i=="string"==(typeof a.d=="string"))throw new Error("component needs an i or d field");if(a.p<0)throw new Error("position cannot be negative")},n=function(a){for(var o=0;o<a.length;o++)e(a[o])};r.apply=function(a,o){var c;n(o);for(var v=0;v<o.length;v++){var p=o[v];if(p.i!=null)a=t(a,p.p,p.i);else{if(c=a.slice(p.p,p.p+p.d.length),p.d!==c)throw new Error("Delete component '"+p.d+"' does not match deleted text '"+c+"'");a=a.slice(0,p.p)+a.slice(p.p+p.d.length)}}return a};var i=r._append=function(a,o){if(!(o.i===""||o.d===""))if(a.length===0)a.push(o);else{var c=a[a.length-1];c.i!=null&&o.i!=null&&c.p<=o.p&&o.p<=c.p+c.i.length?a[a.length-1]={i:t(c.i,o.p-c.p,o.i),p:c.p}:c.d!=null&&o.d!=null&&o.p<=c.p&&c.p<=o.p+o.d.length?a[a.length-1]={d:t(o.d,c.p-o.p,c.d),p:o.p}:a.push(o)}};r.compose=function(a,o){n(a),n(o);for(var c=a.slice(),v=0;v<o.length;v++)i(c,o[v]);return c},r.normalize=function(a){var o=[];(a.i!=null||a.p!=null)&&(a=[a]);for(var c=0;c<a.length;c++){var v=a[c];v.p==null&&(v.p=0),i(o,v)}return o};var s=function(a,o,c){return o.i!=null?o.p<a||o.p===a&&c?a+o.i.length:a:a<=o.p?a:a<=o.p+o.d.length?o.p:a-o.d.length};r.transformCursor=function(a,o,c){for(var v=c==="right",p=0;p<o.length;p++)a=s(a,o[p],v);return a};var l=r._tc=function(a,o,c,v){if(e(o),e(c),o.i!=null)i(a,{i:o.i,p:s(o.p,c,v==="right")});else if(c.i!=null){var p=o.d;o.p<c.p&&(i(a,{d:p.slice(0,c.p-o.p),p:o.p}),p=p.slice(c.p-o.p)),p!==""&&i(a,{d:p,p:o.p+c.i.length})}else if(o.p>=c.p+c.d.length)i(a,{d:o.d,p:o.p-c.d.length});else if(o.p+o.d.length<=c.p)i(a,o);else{var d={d:"",p:o.p};o.p<c.p&&(d.d=o.d.slice(0,c.p-o.p)),o.p+o.d.length>c.p+c.d.length&&(d.d+=o.d.slice(c.p+c.d.length-o.p));var y=Math.max(o.p,c.p),A=Math.min(o.p+o.d.length,c.p+c.d.length),O=o.d.slice(y-o.p,A-o.p),E=c.d.slice(y-c.p,A-c.p);if(O!==E)throw new Error("Delete ops delete different text in the same region of the document");d.d!==""&&(d.p=s(d.p,c),i(a,d))}return a},u=function(a){return a.i!=null?{d:a.i,p:a.p}:{i:a.d,p:a.p}};return r.invert=function(a){a=a.slice().reverse();for(var o=0;o<a.length;o++)a[o]=u(a[o]);return a},zh()(r,l,n,i),co.exports}var fo,tc;function J1(){if(tc)return fo;tc=1;var r=function(o){return Object.prototype.toString.call(o)=="[object Array]"},t=function(o){return!!o&&o.constructor===Object},e=function(o){return JSON.parse(JSON.stringify(o))},n={name:"json0",uri:"http://sharejs.org/types/JSONv0"},i={};n.registerSubtype=function(o){i[o.name]=o},n.create=function(o){return o===void 0?null:e(o)},n.invertComponent=function(o){var c={p:o.p};return o.t&&i[o.t]&&(c.t=o.t,c.o=i[o.t].invert(o.o)),o.si!==void 0&&(c.sd=o.si),o.sd!==void 0&&(c.si=o.sd),o.oi!==void 0&&(c.od=o.oi),o.od!==void 0&&(c.oi=o.od),o.li!==void 0&&(c.ld=o.li),o.ld!==void 0&&(c.li=o.ld),o.na!==void 0&&(c.na=-o.na),o.lm!==void 0&&(c.lm=o.p[o.p.length-1],c.p=o.p.slice(0,o.p.length-1).concat([o.lm])),c},n.invert=function(o){for(var c=o.slice().reverse(),v=[],p=0;p<c.length;p++)v.push(n.invertComponent(c[p]));return v},n.checkValidOp=function(o){for(var c=0;c<o.length;c++)if(!r(o[c].p))throw new Error("Missing path")},n.checkList=function(o){if(!r(o))throw new Error("Referenced element not a list")},n.checkObj=function(o){if(!t(o))throw new Error("Referenced element not an object (it was "+JSON.stringify(o)+")")};function s(o){o.t="text0";var c={p:o.p.pop()};o.si!=null&&(c.i=o.si),o.sd!=null&&(c.d=o.sd),o.o=[c]}function l(o){o.p.push(o.o[0].p),o.o[0].i!=null&&(o.si=o.o[0].i),o.o[0].d!=null&&(o.sd=o.o[0].d),delete o.t,delete o.o}n.apply=function(o,c){n.checkValidOp(c),c=e(c);for(var v={data:o},p=0;p<c.length;p++){var d=c[p];(d.si!=null||d.sd!=null)&&s(d);for(var y=null,A=v,O="data",E=0;E<d.p.length;E++){var _=d.p[E];if(y=A,A=A[O],O=_,y==null)throw new Error("Path invalid")}if(d.t&&d.o!==void 0&&i[d.t])A[O]=i[d.t].apply(A[O],d.o);else if(d.na!==void 0){if(typeof A[O]!="number")throw new Error("Referenced element not a number");A[O]+=d.na}else if(d.li!==void 0&&d.ld!==void 0)n.checkList(A),A[O]=d.li;else if(d.li!==void 0)n.checkList(A),A.splice(O,0,d.li);else if(d.ld!==void 0)n.checkList(A),A.splice(O,1);else if(d.lm!==void 0){if(n.checkList(A),d.lm!=O){var h=A[O];A.splice(O,1),A.splice(d.lm,0,h)}}else if(d.oi!==void 0)n.checkObj(A),A[O]=d.oi;else if(d.od!==void 0)n.checkObj(A),delete A[O];else throw new Error("invalid / missing instruction in op")}return v.data},n.shatter=function(o){for(var c=[],v=0;v<o.length;v++)c.push([o[v]]);return c},n.incrementalApply=function(o,c,v){for(var p=0;p<c.length;p++){var d=[c[p]];o=n.apply(o,d),v(d,o)}return o};var u=n.pathMatches=function(o,c,v){if(o.length!=c.length)return!1;for(var p=0;p<o.length;p++)if(o[p]!==c[p]&&(!v||p!==o.length-1))return!1;return!0};n.append=function(o,c){if(c=e(c),o.length===0){o.push(c);return}var v=o[o.length-1];if((c.si!=null||c.sd!=null)&&(v.si!=null||v.sd!=null)&&(s(c),s(v)),u(c.p,v.p))if(c.t&&v.t&&c.t===v.t&&i[c.t]){if(v.o=i[c.t].compose(v.o,c.o),c.si!=null||c.sd!=null){for(var p=c.p,d=0;d<v.o.length-1;d++)c.o=[v.o.pop()],c.p=p.slice(),l(c),o.push(c);l(v)}}else v.na!=null&&c.na!=null?o[o.length-1]={p:v.p,na:v.na+c.na}:v.li!==void 0&&c.li===void 0&&c.ld===v.li?v.ld!==void 0?delete v.li:o.pop():v.od!==void 0&&v.oi===void 0&&c.oi!==void 0&&c.od===void 0?v.oi=c.oi:v.oi!==void 0&&c.od!==void 0?c.oi!==void 0?v.oi=c.oi:v.od!==void 0?delete v.oi:o.pop():c.lm!==void 0&&c.p[c.p.length-1]===c.lm||o.push(c);else(c.si!=null||c.sd!=null)&&(v.si!=null||v.sd!=null)&&(l(c),l(v)),o.push(c)},n.compose=function(o,c){n.checkValidOp(o),n.checkValidOp(c);for(var v=e(o),p=0;p<c.length;p++)n.append(v,c[p]);return v},n.normalize=function(o){var c=[];o=r(o)?o:[o];for(var v=0;v<o.length;v++){var p=o[v];p.p==null&&(p.p=[]),n.append(c,p)}return c},n.commonLengthForOps=function(o,c){var v=o.p.length,p=c.p.length;if((o.na!=null||o.t)&&v++,(c.na!=null||c.t)&&p++,v===0)return-1;if(p===0)return null;v--,p--;for(var d=0;d<v;d++){var y=o.p[d];if(d>=p||y!==c.p[d])return null}return v},n.canOpAffectPath=function(o,c){return n.commonLengthForOps({p:c},o)!=null},n.transformComponent=function(o,c,v,p){c=e(c);var d=n.commonLengthForOps(v,c),y=n.commonLengthForOps(c,v),A=c.p.length,O=v.p.length;if((c.na!=null||c.t)&&A++,(v.na!=null||v.t)&&O++,y!=null&&O>A&&c.p[y]==v.p[y]){if(c.ld!==void 0){var E=e(v);E.p=E.p.slice(A),c.ld=n.apply(e(c.ld),[E])}else if(c.od!==void 0){var E=e(v);E.p=E.p.slice(A),c.od=n.apply(e(c.od),[E])}}if(d!=null){var _=A==O,E=v;if((c.si!=null||c.sd!=null)&&(v.si!=null||v.sd!=null)&&(s(c),E=e(v),s(E)),E.t&&i[E.t]){if(c.t&&c.t===E.t){var h=i[c.t].transform(c.o,E.o,p);if(c.si!=null||c.sd!=null)for(var f=c.p,g=0;g<h.length;g++)c.o=[h[g]],c.p=f.slice(),l(c),n.append(o,c);else(!r(h)||h.length>0)&&(c.o=h,n.append(o,c));return o}}else if(v.na===void 0){if(v.li!==void 0&&v.ld!==void 0){if(v.p[d]===c.p[d])if(_){if(c.ld!==void 0)if(c.li!==void 0&&p==="left")c.ld=e(v.li);else return o}else return o}else if(v.li!==void 0)c.li!==void 0&&c.ld===void 0&&_&&c.p[d]===v.p[d]?p==="right"&&c.p[d]++:v.p[d]<=c.p[d]&&c.p[d]++,c.lm!==void 0&&_&&v.p[d]<=c.lm&&c.lm++;else if(v.ld!==void 0){if(c.lm!==void 0&&_){if(v.p[d]===c.p[d])return o;var f=v.p[d],b=c.p[d],S=c.lm;(f<S||f===S&&b<S)&&c.lm--}if(v.p[d]<c.p[d])c.p[d]--;else if(v.p[d]===c.p[d]){if(O<A)return o;if(c.ld!==void 0)if(c.li!==void 0)delete c.ld;else return o}}else if(v.lm!==void 0)if(c.lm!==void 0&&A===O){var b=c.p[d],S=c.lm,N=v.p[d],C=v.lm;if(N!==C)if(b===N)if(p==="left")c.p[d]=C,b===S&&(c.lm=C);else return o;else b>N&&c.p[d]--,b>C?c.p[d]++:b===C&&N>C&&(c.p[d]++,b===S&&c.lm++),(S>N||S===N&&S>b)&&c.lm--,S>C?c.lm++:S===C&&(C>N&&S>b||C<N&&S<b?p==="right"&&c.lm++:S>b?c.lm++:S===N&&c.lm--)}else if(c.li!==void 0&&c.ld===void 0&&_){var b=v.p[d],S=v.lm;f=c.p[d],f>b&&c.p[d]--,f>S&&c.p[d]++}else{var b=v.p[d],S=v.lm;f=c.p[d],f===b?c.p[d]=S:(f>b&&c.p[d]--,(f>S||f===S&&b>S)&&c.p[d]++)}else if(v.oi!==void 0&&v.od!==void 0){if(c.p[d]===v.p[d])if(c.oi!==void 0&&_){if(p==="right")return o;c.od=v.oi}else return o}else if(v.oi!==void 0){if(c.oi!==void 0&&c.p[d]===v.p[d])if(p==="left")n.append(o,{p:c.p,od:v.oi});else return o}else if(v.od!==void 0&&c.p[d]==v.p[d]){if(!_)return o;if(c.oi!==void 0)delete c.od;else return o}}}return n.append(o,c),o},zh()(n,n.transformComponent,n.checkValidOp,n.append);var a=Z1();return n.registerSubtype(a),fo=n,fo}var ho,ec;function Q1(){return ec||(ec=1,ho={type:J1()}),ho}var rc;function xs(){return rc||(rc=1,(function(r){r.defaultType=Q1().type,r.map=Object.create(null),r.register=function(t){t.name&&(r.map[t.name]=t),t.uri&&(r.map[t.uri]=t)},r.register(r.defaultType)})(lo)),lo}var po={},Wi={},nc;function t0(){if(nc)return Wi;nc=1,Wi.messageChannel=function(){var t=r(arguments),e=new MessageChannel;e.port1.onmessage=function(){t(),e.port1.close()},e.port2.postMessage("")},Wi.setTimeout=function(){var t=r(arguments);setTimeout(t)};function r(t){for(var e=t[0],n=[],i=1;i<t.length;i++)n[i-1]=t[i];return function(){e.apply(null,n)}}return Wi}var go={},vo={},mo,ic;function Vh(){return ic||(ic=1,mo=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;t[e]=i;for(var s in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var l=Object.getOwnPropertySymbols(t);if(l.length!==1||l[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(t,e);if(u.value!==i||u.enumerable!==!0)return!1}return!0}),mo}var yo,sc;function Is(){if(sc)return yo;sc=1;var r=Vh();return yo=function(){return r()&&!!Symbol.toStringTag},yo}var bo,oc;function Gh(){return oc||(oc=1,bo=Object),bo}var _o,ac;function e0(){return ac||(ac=1,_o=Error),_o}var Eo,lc;function r0(){return lc||(lc=1,Eo=EvalError),Eo}var Ao,uc;function n0(){return uc||(uc=1,Ao=RangeError),Ao}var Oo,cc;function i0(){return cc||(cc=1,Oo=ReferenceError),Oo}var So,fc;function Wh(){return fc||(fc=1,So=SyntaxError),So}var wo,hc;function Ai(){return hc||(hc=1,wo=TypeError),wo}var To,dc;function s0(){return dc||(dc=1,To=URIError),To}var Ro,pc;function o0(){return pc||(pc=1,Ro=Math.abs),Ro}var No,gc;function a0(){return gc||(gc=1,No=Math.floor),No}var Lo,vc;function l0(){return vc||(vc=1,Lo=Math.max),Lo}var Co,mc;function u0(){return mc||(mc=1,Co=Math.min),Co}var xo,yc;function c0(){return yc||(yc=1,xo=Math.pow),xo}var Io,bc;function f0(){return bc||(bc=1,Io=Math.round),Io}var qo,_c;function h0(){return _c||(_c=1,qo=Number.isNaN||function(t){return t!==t}),qo}var Po,Ec;function d0(){if(Ec)return Po;Ec=1;var r=h0();return Po=function(e){return r(e)||e===0?e:e<0?-1:1},Po}var Do,Ac;function p0(){return Ac||(Ac=1,Do=Object.getOwnPropertyDescriptor),Do}var Mo,Oc;function Fn(){if(Oc)return Mo;Oc=1;var r=p0();if(r)try{r([],"length")}catch{r=null}return Mo=r,Mo}var jo,Sc;function qs(){if(Sc)return jo;Sc=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return jo=r,jo}var ko,wc;function g0(){if(wc)return ko;wc=1;var r=typeof Symbol!="undefined"&&Symbol,t=Vh();return ko=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},ko}var Bo,Tc;function Kh(){return Tc||(Tc=1,Bo=typeof Reflect!="undefined"&&Reflect.getPrototypeOf||null),Bo}var Fo,Rc;function Yh(){if(Rc)return Fo;Rc=1;var r=Gh();return Fo=r.getPrototypeOf||null,Fo}var $o,Nc;function v0(){if(Nc)return $o;Nc=1;var r="Function.prototype.bind called on incompatible ",t=Object.prototype.toString,e=Math.max,n="[object Function]",i=function(a,o){for(var c=[],v=0;v<a.length;v+=1)c[v]=a[v];for(var p=0;p<o.length;p+=1)c[p+a.length]=o[p];return c},s=function(a,o){for(var c=[],v=o,p=0;v<a.length;v+=1,p+=1)c[p]=a[v];return c},l=function(u,a){for(var o="",c=0;c<u.length;c+=1)o+=u[c],c+1<u.length&&(o+=a);return o};return $o=function(a){var o=this;if(typeof o!="function"||t.apply(o)!==n)throw new TypeError(r+o);for(var c=s(arguments,1),v,p=function(){if(this instanceof v){var E=o.apply(this,i(c,arguments));return Object(E)===E?E:this}return o.apply(a,i(c,arguments))},d=e(0,o.length-c.length),y=[],A=0;A<d;A++)y[A]="$"+A;if(v=Function("binder","return function ("+l(y,",")+"){ return binder.apply(this,arguments); }")(p),o.prototype){var O=function(){};O.prototype=o.prototype,v.prototype=new O,O.prototype=null}return v},$o}var Uo,Lc;function Oi(){if(Lc)return Uo;Lc=1;var r=v0();return Uo=Function.prototype.bind||r,Uo}var Ho,Cc;function Ll(){return Cc||(Cc=1,Ho=Function.prototype.call),Ho}var zo,xc;function Cl(){return xc||(xc=1,zo=Function.prototype.apply),zo}var Vo,Ic;function m0(){return Ic||(Ic=1,Vo=typeof Reflect!="undefined"&&Reflect&&Reflect.apply),Vo}var Go,qc;function Xh(){if(qc)return Go;qc=1;var r=Oi(),t=Cl(),e=Ll(),n=m0();return Go=n||r.call(e,t),Go}var Wo,Pc;function xl(){if(Pc)return Wo;Pc=1;var r=Oi(),t=Ai(),e=Ll(),n=Xh();return Wo=function(s){if(s.length<1||typeof s[0]!="function")throw new t("a function is required");return n(r,e,s)},Wo}var Ko,Dc;function y0(){if(Dc)return Ko;Dc=1;var r=xl(),t=Fn(),e;try{e=[].__proto__===Array.prototype}catch(l){if(!l||typeof l!="object"||!("code"in l)||l.code!=="ERR_PROTO_ACCESS")throw l}var n=!!e&&t&&t(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return Ko=n&&typeof n.get=="function"?r([n.get]):typeof s=="function"?function(u){return s(u==null?u:i(u))}:!1,Ko}var Yo,Mc;function Il(){if(Mc)return Yo;Mc=1;var r=Kh(),t=Yh(),e=y0();return Yo=r?function(i){return r(i)}:t?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return t(i)}:e?function(i){return e(i)}:null,Yo}var Xo,jc;function Zh(){if(jc)return Xo;jc=1;var r=Function.prototype.call,t=Object.prototype.hasOwnProperty,e=Oi();return Xo=e.call(r,t),Xo}var Zo,kc;function Jh(){if(kc)return Zo;kc=1;var r,t=Gh(),e=e0(),n=r0(),i=n0(),s=i0(),l=Wh(),u=Ai(),a=s0(),o=o0(),c=a0(),v=l0(),p=u0(),d=c0(),y=f0(),A=d0(),O=Function,E=function(k){try{return O('"use strict"; return ('+k+").constructor;")()}catch{}},_=Fn(),h=qs(),f=function(){throw new u},g=_?(function(){try{return arguments.callee,f}catch{try{return _(arguments,"callee").get}catch{return f}}})():f,b=g0()(),S=Il(),N=Yh(),C=Kh(),P=Cl(),w=Ll(),M={},R=typeof Uint8Array=="undefined"||!S?r:S(Uint8Array),I={__proto__:null,"%AggregateError%":typeof AggregateError=="undefined"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?r:ArrayBuffer,"%ArrayIteratorPrototype%":b&&S?S([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":M,"%AsyncGenerator%":M,"%AsyncGeneratorFunction%":M,"%AsyncIteratorPrototype%":M,"%Atomics%":typeof Atomics=="undefined"?r:Atomics,"%BigInt%":typeof BigInt=="undefined"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":e,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array=="undefined"?r:Float16Array,"%Float32Array%":typeof Float32Array=="undefined"?r:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?r:FinalizationRegistry,"%Function%":O,"%GeneratorFunction%":M,"%Int8Array%":typeof Int8Array=="undefined"?r:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?r:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":b&&S?S(S([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map=="undefined"?r:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!b||!S?r:S(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":t,"%Object.getOwnPropertyDescriptor%":_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?r:Promise,"%Proxy%":typeof Proxy=="undefined"?r:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect=="undefined"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?r:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!b||!S?r:S(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":b&&S?S(""[Symbol.iterator]()):r,"%Symbol%":b?Symbol:r,"%SyntaxError%":l,"%ThrowTypeError%":g,"%TypedArray%":R,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array=="undefined"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?r:Uint32Array,"%URIError%":a,"%WeakMap%":typeof WeakMap=="undefined"?r:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?r:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?r:WeakSet,"%Function.prototype.call%":w,"%Function.prototype.apply%":P,"%Object.defineProperty%":h,"%Object.getPrototypeOf%":N,"%Math.abs%":o,"%Math.floor%":c,"%Math.max%":v,"%Math.min%":p,"%Math.pow%":d,"%Math.round%":y,"%Math.sign%":A,"%Reflect.getPrototypeOf%":C};if(S)try{null.error}catch(k){var D=S(S(k));I["%Error.prototype%"]=D}var x=function k(z){var X;if(z==="%AsyncFunction%")X=E("async function () {}");else if(z==="%GeneratorFunction%")X=E("function* () {}");else if(z==="%AsyncGeneratorFunction%")X=E("async function* () {}");else if(z==="%AsyncGenerator%"){var J=k("%AsyncGeneratorFunction%");J&&(X=J.prototype)}else if(z==="%AsyncIteratorPrototype%"){var nt=k("%AsyncGenerator%");nt&&S&&(X=S(nt.prototype))}return I[z]=X,X},$={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},V=Oi(),Q=Zh(),Y=V.call(w,Array.prototype.concat),st=V.call(P,Array.prototype.splice),rt=V.call(w,String.prototype.replace),L=V.call(w,String.prototype.slice),B=V.call(w,RegExp.prototype.exec),F=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,tt=/\\(\\)?/g,it=function(z){var X=L(z,0,1),J=L(z,-1);if(X==="%"&&J!=="%")throw new l("invalid intrinsic syntax, expected closing `%`");if(J==="%"&&X!=="%")throw new l("invalid intrinsic syntax, expected opening `%`");var nt=[];return rt(z,F,function(lt,dt,vt,Ut){nt[nt.length]=vt?rt(Ut,tt,"$1"):dt||lt}),nt},H=function(z,X){var J=z,nt;if(Q($,J)&&(nt=$[J],J="%"+nt[0]+"%"),Q(I,J)){var lt=I[J];if(lt===M&&(lt=x(J)),typeof lt=="undefined"&&!X)throw new u("intrinsic "+z+" exists, but is not available. Please file an issue!");return{alias:nt,name:J,value:lt}}throw new l("intrinsic "+z+" does not exist!")};return Zo=function(z,X){if(typeof z!="string"||z.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof X!="boolean")throw new u('"allowMissing" argument must be a boolean');if(B(/^%?[^%]*%?$/,z)===null)throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var J=it(z),nt=J.length>0?J[0]:"",lt=H("%"+nt+"%",X),dt=lt.name,vt=lt.value,Ut=!1,kt=lt.alias;kt&&(nt=kt[0],st(J,Y([0,1],kt)));for(var G=1,Ot=!0;G<J.length;G+=1){var Nt=J[G],bt=L(Nt,0,1),Tt=L(Nt,-1);if((bt==='"'||bt==="'"||bt==="`"||Tt==='"'||Tt==="'"||Tt==="`")&&bt!==Tt)throw new l("property names with quotes must have matching quotes");if((Nt==="constructor"||!Ot)&&(Ut=!0),nt+="."+Nt,dt="%"+nt+"%",Q(I,dt))vt=I[dt];else if(vt!=null){if(!(Nt in vt)){if(!X)throw new u("base intrinsic for "+z+" exists, but the property is not available.");return}if(_&&G+1>=J.length){var Et=_(vt,Nt);Ot=!!Et,Ot&&"get"in Et&&!("originalValue"in Et.get)?vt=Et.get:vt=vt[Nt]}else Ot=Q(vt,Nt),vt=vt[Nt];Ot&&!Ut&&(I[dt]=vt)}}return vt},Zo}var Jo,Bc;function Si(){if(Bc)return Jo;Bc=1;var r=Jh(),t=xl(),e=t([r("%String.prototype.indexOf%")]);return Jo=function(i,s){var l=r(i,!!s);return typeof l=="function"&&e(i,".prototype.")>-1?t([l]):l},Jo}var Qo,Fc;function b0(){if(Fc)return Qo;Fc=1;var r=Is()(),t=Si(),e=t("Object.prototype.toString"),n=function(u){return r&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:e(u)==="[object Arguments]"},i=function(u){return n(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&e(u)!=="[object Array]"&&"callee"in u&&e(u.callee)==="[object Function]"},s=(function(){return n(arguments)})();return n.isLegacyArguments=i,Qo=s?n:i,Qo}var ta,$c;function _0(){if($c)return ta;$c=1;var r=Si(),t=Is()(),e=Zh(),n=Fn(),i;if(t){var s=r("RegExp.prototype.exec"),l={},u=function(){throw l},a={toString:u,valueOf:u};typeof Symbol.toPrimitive=="symbol"&&(a[Symbol.toPrimitive]=u),i=function(p){if(!p||typeof p!="object")return!1;var d=n(p,"lastIndex"),y=d&&e(d,"value");if(!y)return!1;try{s(p,a)}catch(A){return A===l}}}else{var o=r("Object.prototype.toString"),c="[object RegExp]";i=function(p){return!p||typeof p!="object"&&typeof p!="function"?!1:o(p)===c}}return ta=i,ta}var ea,Uc;function E0(){if(Uc)return ea;Uc=1;var r=Si(),t=_0(),e=r("RegExp.prototype.exec"),n=Ai();return ea=function(s){if(!t(s))throw new n("`regex` must be a RegExp");return function(u){return e(s,u)!==null}},ea}var ra,Hc;function A0(){if(Hc)return ra;Hc=1;var r=Si(),t=E0(),e=t(/^\s*(?:function)?\*/),n=Is()(),i=Il(),s=r("Object.prototype.toString"),l=r("Function.prototype.toString"),u=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},a;return ra=function(c){if(typeof c!="function")return!1;if(e(l(c)))return!0;if(!n){var v=s(c);return v==="[object GeneratorFunction]"}if(!i)return!1;if(typeof a=="undefined"){var p=u();a=p?i(p):!1}return i(c)===a},ra}var na,zc;function O0(){if(zc)return na;zc=1;var r=Function.prototype.toString,t=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,e,n;if(typeof t=="function"&&typeof Object.defineProperty=="function")try{e=Object.defineProperty({},"length",{get:function(){throw n}}),n={},t(function(){throw 42},null,e)}catch(_){_!==n&&(t=null)}else t=null;var i=/^\s*class\b/,s=function(h){try{var f=r.call(h);return i.test(f)}catch{return!1}},l=function(h){try{return s(h)?!1:(r.call(h),!0)}catch{return!1}},u=Object.prototype.toString,a="[object Object]",o="[object Function]",c="[object GeneratorFunction]",v="[object HTMLAllCollection]",p="[object HTML document.all class]",d="[object HTMLCollection]",y=typeof Symbol=="function"&&!!Symbol.toStringTag,A=!(0 in[,]),O=function(){return!1};if(typeof document=="object"){var E=document.all;u.call(E)===u.call(document.all)&&(O=function(h){if((A||!h)&&(typeof h=="undefined"||typeof h=="object"))try{var f=u.call(h);return(f===v||f===p||f===d||f===a)&&h("")==null}catch{}return!1})}return na=t?function(h){if(O(h))return!0;if(!h||typeof h!="function"&&typeof h!="object")return!1;try{t(h,null,e)}catch(f){if(f!==n)return!1}return!s(h)&&l(h)}:function(h){if(O(h))return!0;if(!h||typeof h!="function"&&typeof h!="object")return!1;if(y)return l(h);if(s(h))return!1;var f=u.call(h);return f!==o&&f!==c&&!/^\[object HTML/.test(f)?!1:l(h)},na}var ia,Vc;function S0(){if(Vc)return ia;Vc=1;var r=O0(),t=Object.prototype.toString,e=Object.prototype.hasOwnProperty,n=function(a,o,c){for(var v=0,p=a.length;v<p;v++)e.call(a,v)&&(c==null?o(a[v],v,a):o.call(c,a[v],v,a))},i=function(a,o,c){for(var v=0,p=a.length;v<p;v++)c==null?o(a.charAt(v),v,a):o.call(c,a.charAt(v),v,a)},s=function(a,o,c){for(var v in a)e.call(a,v)&&(c==null?o(a[v],v,a):o.call(c,a[v],v,a))};function l(u){return t.call(u)==="[object Array]"}return ia=function(a,o,c){if(!r(o))throw new TypeError("iterator must be a function");var v;arguments.length>=3&&(v=c),l(a)?n(a,o,v):typeof a=="string"?i(a,o,v):s(a,o,v)},ia}var sa,Gc;function w0(){return Gc||(Gc=1,sa=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),sa}var oa,Wc;function T0(){if(Wc)return oa;Wc=1;var r=w0(),t=typeof globalThis=="undefined"?window:globalThis;return oa=function(){for(var n=[],i=0;i<r.length;i++)typeof t[r[i]]=="function"&&(n[n.length]=r[i]);return n},oa}var aa={exports:{}},la,Kc;function R0(){if(Kc)return la;Kc=1;var r=qs(),t=Wh(),e=Ai(),n=Fn();return la=function(s,l,u){if(!s||typeof s!="object"&&typeof s!="function")throw new e("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new e("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new e("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new e("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new e("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new e("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,v=arguments.length>6?arguments[6]:!1,p=!!n&&n(s,l);if(r)r(s,l,{configurable:c===null&&p?p.configurable:!c,enumerable:a===null&&p?p.enumerable:!a,value:u,writable:o===null&&p?p.writable:!o});else if(v||!a&&!o&&!c)s[l]=u;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},la}var ua,Yc;function N0(){if(Yc)return ua;Yc=1;var r=qs(),t=function(){return!!r};return t.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},ua=t,ua}var ca,Xc;function L0(){if(Xc)return ca;Xc=1;var r=Jh(),t=R0(),e=N0()(),n=Fn(),i=Ai(),s=r("%Math.floor%");return ca=function(u,a){if(typeof u!="function")throw new i("`fn` is not a function");if(typeof a!="number"||a<0||a>4294967295||s(a)!==a)throw new i("`length` must be a positive 32-bit integer");var o=arguments.length>2&&!!arguments[2],c=!0,v=!0;if("length"in u&&n){var p=n(u,"length");p&&!p.configurable&&(c=!1),p&&!p.writable&&(v=!1)}return(c||v||!o)&&(e?t(u,"length",a,!0,!0):t(u,"length",a)),u},ca}var fa,Zc;function C0(){if(Zc)return fa;Zc=1;var r=Oi(),t=Cl(),e=Xh();return fa=function(){return e(r,t,arguments)},fa}var Jc;function x0(){return Jc||(Jc=1,(function(r){var t=L0(),e=qs(),n=xl(),i=C0();r.exports=function(l){var u=n(arguments),a=l.length-(arguments.length-1);return t(u,1+(a>0?a:0),!0)},e?e(r.exports,"apply",{value:i}):r.exports.apply=i})(aa)),aa.exports}var ha,Qc;function Qh(){if(Qc)return ha;Qc=1;var r=S0(),t=T0(),e=x0(),n=Si(),i=Fn(),s=Il(),l=n("Object.prototype.toString"),u=Is()(),a=typeof globalThis=="undefined"?window:globalThis,o=t(),c=n("String.prototype.slice"),v=n("Array.prototype.indexOf",!0)||function(O,E){for(var _=0;_<O.length;_+=1)if(O[_]===E)return _;return-1},p={__proto__:null};u&&i&&s?r(o,function(A){var O=new a[A];if(Symbol.toStringTag in O&&s){var E=s(O),_=i(E,Symbol.toStringTag);if(!_&&E){var h=s(E);_=i(h,Symbol.toStringTag)}p["$"+A]=e(_.get)}}):r(o,function(A){var O=new a[A],E=O.slice||O.set;E&&(p["$"+A]=e(E))});var d=function(O){var E=!1;return r(p,function(_,h){if(!E)try{"$"+_(O)===h&&(E=c(h,1))}catch{}}),E},y=function(O){var E=!1;return r(p,function(_,h){if(!E)try{_(O),E=c(h,1)}catch{}}),E};return ha=function(O){if(!O||typeof O!="object")return!1;if(!u){var E=c(l(O),8,-1);return v(o,E)>-1?E:E!=="Object"?!1:y(O)}return i?d(O):null},ha}var da,tf;function I0(){if(tf)return da;tf=1;var r=Qh();return da=function(e){return!!r(e)},da}var ef;function q0(){return ef||(ef=1,(function(r){var t=b0(),e=A0(),n=Qh(),i=I0();function s(G){return G.call.bind(G)}var l=typeof BigInt!="undefined",u=typeof Symbol!="undefined",a=s(Object.prototype.toString),o=s(Number.prototype.valueOf),c=s(String.prototype.valueOf),v=s(Boolean.prototype.valueOf);if(l)var p=s(BigInt.prototype.valueOf);if(u)var d=s(Symbol.prototype.valueOf);function y(G,Ot){if(typeof G!="object")return!1;try{return Ot(G),!0}catch{return!1}}r.isArgumentsObject=t,r.isGeneratorFunction=e,r.isTypedArray=i;function A(G){return typeof Promise!="undefined"&&G instanceof Promise||G!==null&&typeof G=="object"&&typeof G.then=="function"&&typeof G.catch=="function"}r.isPromise=A;function O(G){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(G):i(G)||L(G)}r.isArrayBufferView=O;function E(G){return n(G)==="Uint8Array"}r.isUint8Array=E;function _(G){return n(G)==="Uint8ClampedArray"}r.isUint8ClampedArray=_;function h(G){return n(G)==="Uint16Array"}r.isUint16Array=h;function f(G){return n(G)==="Uint32Array"}r.isUint32Array=f;function g(G){return n(G)==="Int8Array"}r.isInt8Array=g;function b(G){return n(G)==="Int16Array"}r.isInt16Array=b;function S(G){return n(G)==="Int32Array"}r.isInt32Array=S;function N(G){return n(G)==="Float32Array"}r.isFloat32Array=N;function C(G){return n(G)==="Float64Array"}r.isFloat64Array=C;function P(G){return n(G)==="BigInt64Array"}r.isBigInt64Array=P;function w(G){return n(G)==="BigUint64Array"}r.isBigUint64Array=w;function M(G){return a(G)==="[object Map]"}M.working=typeof Map!="undefined"&&M(new Map);function R(G){return typeof Map=="undefined"?!1:M.working?M(G):G instanceof Map}r.isMap=R;function I(G){return a(G)==="[object Set]"}I.working=typeof Set!="undefined"&&I(new Set);function D(G){return typeof Set=="undefined"?!1:I.working?I(G):G instanceof Set}r.isSet=D;function x(G){return a(G)==="[object WeakMap]"}x.working=typeof WeakMap!="undefined"&&x(new WeakMap);function $(G){return typeof WeakMap=="undefined"?!1:x.working?x(G):G instanceof WeakMap}r.isWeakMap=$;function V(G){return a(G)==="[object WeakSet]"}V.working=typeof WeakSet!="undefined"&&V(new WeakSet);function Q(G){return V(G)}r.isWeakSet=Q;function Y(G){return a(G)==="[object ArrayBuffer]"}Y.working=typeof ArrayBuffer!="undefined"&&Y(new ArrayBuffer);function st(G){return typeof ArrayBuffer=="undefined"?!1:Y.working?Y(G):G instanceof ArrayBuffer}r.isArrayBuffer=st;function rt(G){return a(G)==="[object DataView]"}rt.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&rt(new DataView(new ArrayBuffer(1),0,1));function L(G){return typeof DataView=="undefined"?!1:rt.working?rt(G):G instanceof DataView}r.isDataView=L;var B=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function F(G){return a(G)==="[object SharedArrayBuffer]"}function tt(G){return typeof B=="undefined"?!1:(typeof F.working=="undefined"&&(F.working=F(new B)),F.working?F(G):G instanceof B)}r.isSharedArrayBuffer=tt;function it(G){return a(G)==="[object AsyncFunction]"}r.isAsyncFunction=it;function H(G){return a(G)==="[object Map Iterator]"}r.isMapIterator=H;function k(G){return a(G)==="[object Set Iterator]"}r.isSetIterator=k;function z(G){return a(G)==="[object Generator]"}r.isGeneratorObject=z;function X(G){return a(G)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=X;function J(G){return y(G,o)}r.isNumberObject=J;function nt(G){return y(G,c)}r.isStringObject=nt;function lt(G){return y(G,v)}r.isBooleanObject=lt;function dt(G){return l&&y(G,p)}r.isBigIntObject=dt;function vt(G){return u&&y(G,d)}r.isSymbolObject=vt;function Ut(G){return J(G)||nt(G)||lt(G)||dt(G)||vt(G)}r.isBoxedPrimitive=Ut;function kt(G){return typeof Uint8Array!="undefined"&&(st(G)||tt(G))}r.isAnyArrayBuffer=kt,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(G){Object.defineProperty(r,G,{enumerable:!1,value:function(){throw new Error(G+" is not supported in userland")}})})})(vo)),vo}var pa,rf;function P0(){return rf||(rf=1,pa=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}),pa}var Ki={exports:{}},nf;function td(){return nf||(nf=1,typeof Object.create=="function"?Ki.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ki.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}),Ki.exports}var sf;function D0(){return sf||(sf=1,(function(r){var t={},e=Object.getOwnPropertyDescriptors||function(B){for(var F=Object.keys(B),tt={},it=0;it<F.length;it++)tt[F[it]]=Object.getOwnPropertyDescriptor(B,F[it]);return tt},n=/%[sdj%]/g;r.format=function(L){if(!b(L)){for(var B=[],F=0;F<arguments.length;F++)B.push(u(arguments[F]));return B.join(" ")}for(var F=1,tt=arguments,it=tt.length,H=String(L).replace(n,function(z){if(z==="%%")return"%";if(F>=it)return z;switch(z){case"%s":return String(tt[F++]);case"%d":return Number(tt[F++]);case"%j":try{return JSON.stringify(tt[F++])}catch{return"[Circular]"}default:return z}}),k=tt[F];F<it;k=tt[++F])h(k)||!P(k)?H+=" "+k:H+=" "+u(k);return H},r.deprecate=function(L,B){if(typeof process!="undefined"&&process.noDeprecation===!0)return L;if(typeof process=="undefined")return function(){return r.deprecate(L,B).apply(this,arguments)};var F=!1;function tt(){if(!F){if(process.throwDeprecation)throw new Error(B);process.traceDeprecation?console.trace(B):console.error(B),F=!0}return L.apply(this,arguments)}return tt};var i={},s=/^$/;if(t.NODE_DEBUG){var l=t.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+l+"$","i")}r.debuglog=function(L){if(L=L.toUpperCase(),!i[L])if(s.test(L)){var B=process.pid;i[L]=function(){var F=r.format.apply(r,arguments);console.error("%s %d: %s",L,B,F)}}else i[L]=function(){};return i[L]};function u(L,B){var F={seen:[],stylize:o};return arguments.length>=3&&(F.depth=arguments[2]),arguments.length>=4&&(F.colors=arguments[3]),_(B)?F.showHidden=B:B&&r._extend(F,B),N(F.showHidden)&&(F.showHidden=!1),N(F.depth)&&(F.depth=2),N(F.colors)&&(F.colors=!1),N(F.customInspect)&&(F.customInspect=!0),F.colors&&(F.stylize=a),v(F,L,F.depth)}r.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function a(L,B){var F=u.styles[B];return F?"\x1B["+u.colors[F][0]+"m"+L+"\x1B["+u.colors[F][1]+"m":L}function o(L,B){return L}function c(L){var B={};return L.forEach(function(F,tt){B[F]=!0}),B}function v(L,B,F){if(L.customInspect&&B&&R(B.inspect)&&B.inspect!==r.inspect&&!(B.constructor&&B.constructor.prototype===B)){var tt=B.inspect(F,L);return b(tt)||(tt=v(L,tt,F)),tt}var it=p(L,B);if(it)return it;var H=Object.keys(B),k=c(H);if(L.showHidden&&(H=Object.getOwnPropertyNames(B)),M(B)&&(H.indexOf("message")>=0||H.indexOf("description")>=0))return d(B);if(H.length===0){if(R(B)){var z=B.name?": "+B.name:"";return L.stylize("[Function"+z+"]","special")}if(C(B))return L.stylize(RegExp.prototype.toString.call(B),"regexp");if(w(B))return L.stylize(Date.prototype.toString.call(B),"date");if(M(B))return d(B)}var X="",J=!1,nt=["{","}"];if(E(B)&&(J=!0,nt=["[","]"]),R(B)){var lt=B.name?": "+B.name:"";X=" [Function"+lt+"]"}if(C(B)&&(X=" "+RegExp.prototype.toString.call(B)),w(B)&&(X=" "+Date.prototype.toUTCString.call(B)),M(B)&&(X=" "+d(B)),H.length===0&&(!J||B.length==0))return nt[0]+X+nt[1];if(F<0)return C(B)?L.stylize(RegExp.prototype.toString.call(B),"regexp"):L.stylize("[Object]","special");L.seen.push(B);var dt;return J?dt=y(L,B,F,k,H):dt=H.map(function(vt){return A(L,B,F,k,vt,J)}),L.seen.pop(),O(dt,X,nt)}function p(L,B){if(N(B))return L.stylize("undefined","undefined");if(b(B)){var F="'"+JSON.stringify(B).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return L.stylize(F,"string")}if(g(B))return L.stylize(""+B,"number");if(_(B))return L.stylize(""+B,"boolean");if(h(B))return L.stylize("null","null")}function d(L){return"["+Error.prototype.toString.call(L)+"]"}function y(L,B,F,tt,it){for(var H=[],k=0,z=B.length;k<z;++k)Q(B,String(k))?H.push(A(L,B,F,tt,String(k),!0)):H.push("");return it.forEach(function(X){X.match(/^\d+$/)||H.push(A(L,B,F,tt,X,!0))}),H}function A(L,B,F,tt,it,H){var k,z,X;if(X=Object.getOwnPropertyDescriptor(B,it)||{value:B[it]},X.get?X.set?z=L.stylize("[Getter/Setter]","special"):z=L.stylize("[Getter]","special"):X.set&&(z=L.stylize("[Setter]","special")),Q(tt,it)||(k="["+it+"]"),z||(L.seen.indexOf(X.value)<0?(h(F)?z=v(L,X.value,null):z=v(L,X.value,F-1),z.indexOf(`
`)>-1&&(H?z=z.split(`
`).map(function(J){return"  "+J}).join(`
`).slice(2):z=`
`+z.split(`
`).map(function(J){return"   "+J}).join(`
`))):z=L.stylize("[Circular]","special")),N(k)){if(H&&it.match(/^\d+$/))return z;k=JSON.stringify(""+it),k.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(k=k.slice(1,-1),k=L.stylize(k,"name")):(k=k.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),k=L.stylize(k,"string"))}return k+": "+z}function O(L,B,F){var tt=L.reduce(function(it,H){return H.indexOf(`
`)>=0,it+H.replace(/\u001b\[\d\d?m/g,"").length+1},0);return tt>60?F[0]+(B===""?"":B+`
 `)+" "+L.join(`,
  `)+" "+F[1]:F[0]+B+" "+L.join(", ")+" "+F[1]}r.types=q0();function E(L){return Array.isArray(L)}r.isArray=E;function _(L){return typeof L=="boolean"}r.isBoolean=_;function h(L){return L===null}r.isNull=h;function f(L){return L==null}r.isNullOrUndefined=f;function g(L){return typeof L=="number"}r.isNumber=g;function b(L){return typeof L=="string"}r.isString=b;function S(L){return typeof L=="symbol"}r.isSymbol=S;function N(L){return L===void 0}r.isUndefined=N;function C(L){return P(L)&&D(L)==="[object RegExp]"}r.isRegExp=C,r.types.isRegExp=C;function P(L){return typeof L=="object"&&L!==null}r.isObject=P;function w(L){return P(L)&&D(L)==="[object Date]"}r.isDate=w,r.types.isDate=w;function M(L){return P(L)&&(D(L)==="[object Error]"||L instanceof Error)}r.isError=M,r.types.isNativeError=M;function R(L){return typeof L=="function"}r.isFunction=R;function I(L){return L===null||typeof L=="boolean"||typeof L=="number"||typeof L=="string"||typeof L=="symbol"||typeof L=="undefined"}r.isPrimitive=I,r.isBuffer=P0();function D(L){return Object.prototype.toString.call(L)}function x(L){return L<10?"0"+L.toString(10):L.toString(10)}var $=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function V(){var L=new Date,B=[x(L.getHours()),x(L.getMinutes()),x(L.getSeconds())].join(":");return[L.getDate(),$[L.getMonth()],B].join(" ")}r.log=function(){console.log("%s - %s",V(),r.format.apply(r,arguments))},r.inherits=td(),r._extend=function(L,B){if(!B||!P(B))return L;for(var F=Object.keys(B),tt=F.length;tt--;)L[F[tt]]=B[F[tt]];return L};function Q(L,B){return Object.prototype.hasOwnProperty.call(L,B)}var Y=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;r.promisify=function(B){if(typeof B!="function")throw new TypeError('The "original" argument must be of type Function');if(Y&&B[Y]){var F=B[Y];if(typeof F!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(F,Y,{value:F,enumerable:!1,writable:!1,configurable:!0}),F}function F(){for(var tt,it,H=new Promise(function(X,J){tt=X,it=J}),k=[],z=0;z<arguments.length;z++)k.push(arguments[z]);k.push(function(X,J){X?it(X):tt(J)});try{B.apply(this,k)}catch(X){it(X)}return H}return Object.setPrototypeOf(F,Object.getPrototypeOf(B)),Y&&Object.defineProperty(F,Y,{value:F,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(F,e(B))},r.promisify.custom=Y;function st(L,B){if(!L){var F=new Error("Promise was rejected with a falsy value");F.reason=L,L=F}return B(L)}function rt(L){if(typeof L!="function")throw new TypeError('The "original" argument must be of type Function');function B(){for(var F=[],tt=0;tt<arguments.length;tt++)F.push(arguments[tt]);var it=F.pop();if(typeof it!="function")throw new TypeError("The last argument must be of type Function");var H=this,k=function(){return it.apply(H,arguments)};L.apply(this,F).then(function(z){process.nextTick(k.bind(null,null,z))},function(z){process.nextTick(st.bind(null,z,k))})}return Object.setPrototypeOf(B,Object.getPrototypeOf(L)),Object.defineProperties(B,e(L)),B}r.callbackify=rt})(go)),go}var of;function pr(){return of||(of=1,(function(r){var t=t0();r.doNothing=e;function e(){}r.hasKeys=function(l){for(var u in l)return!0;return!1};var n;r.hasOwn=n=Object.hasOwn||function(l,u){return Object.prototype.hasOwnProperty.call(l,u)},r.isInteger=Number.isInteger||function(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l},r.isValidVersion=function(l){return l===null?!0:r.isInteger(l)&&l>=0},r.isValidTimestamp=function(l){return r.isValidVersion(l)},r.MAX_SAFE_INTEGER=9007199254740991,r.dig=function(){for(var l=arguments[0],u=1;u<arguments.length;u++){var a=arguments[u];l=n(l,a)?l[a]:u===arguments.length-1?void 0:Object.create(null)}return l},r.digOrCreate=function(){for(var l=arguments[0],u=arguments[arguments.length-1],a=1;a<arguments.length-1;a++){var o=arguments[a];l=n(l,o)?l[o]:l[o]=a===arguments.length-2?u():Object.create(null)}return l},r.digAndRemove=function(){for(var l=arguments[0],u=[l],a=1;a<arguments.length-1;a++){var o=arguments[a];if(!n(l,o))break;l=l[o],u.push(l)}for(var a=u.length-1;a>=0;a--){var c=u[a],o=arguments[a+1],v=c[o];(a===u.length-1||!r.hasKeys(v))&&delete c[o]}},r.supportsPresence=function(l){return l&&typeof l.transformPresence=="function"},r.callEach=function(l,u){var a=!1;return l.forEach(function(o){o&&(o(u),a=!0)}),a},r.truthy=function(l){return!!l},typeof process!="undefined"&&typeof process.nextTick=="function"?r.nextTick=process.nextTick:typeof MessageChannel!="undefined"?r.nextTick=t.messageChannel:r.nextTick=t.setTimeout,r.clone=function(l){return l===void 0?void 0:JSON.parse(JSON.stringify(l))};var i=Object.create(null);Object.getOwnPropertyNames(Object.prototype).forEach(function(l){l!=="__proto__"&&(i[l]=!0)}),r.isDangerousProperty=function(l){return l==="__proto__"||i[l]};try{var s=D0();if(typeof s.inherits!="function")throw new Error("Could not find util.inherits()");r.inherits=s.inherits}catch{try{r.inherits=td()}catch{throw new Error('If running sharedb in a browser, please install the "inherits" or "util" package')}}})(po)),po}var ga,af;function M0(){return af||(af=1,ga=function r(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,i,s;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(!r(t[i],e[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[i]))return!1;for(i=n;i--!==0;){var l=s[i];if(!r(t[l],e[l]))return!1}return!0}return t!==t&&e!==e}),ga}var va={},lf;function dn(){return lf||(lf=1,va.ACTIONS={initLegacy:"init",handshake:"hs",queryFetch:"qf",querySubscribe:"qs",queryUnsubscribe:"qu",queryUpdate:"q",bulkFetch:"bf",bulkSubscribe:"bs",bulkUnsubscribe:"bu",fetch:"f",fixup:"fixup",subscribe:"s",unsubscribe:"u",op:"op",snapshotFetch:"nf",snapshotFetchByTimestamp:"nt",pingPong:"pp",presence:"p",presenceSubscribe:"ps",presenceUnsubscribe:"pu",presenceRequest:"pr"}),va}var ma,uf;function ed(){if(uf)return ma;uf=1;var r=Bn(),t=Nl(),e=Ei(),n=xs(),i=pr(),s=i.clone,l=M0(),u=dn().ACTIONS,a=e.CODES;ma=o;function o(d,y,A){r.EventEmitter.call(this),this.connection=d,this.collection=y,this.id=A,this.version=null,this.type=null,this.data=void 0,this.inflightFetch=[],this.inflightSubscribe=null,this.pendingFetch=[],this.pendingSubscribe=[],this._isInHardRollback=!1,this.subscribed=!1,this.wantSubscribe=!1,this._wantsDestroy=!1,this.inflightOp=null,this.pendingOps=[],this.applyStack=null,this.preventCompose=!1,this.submitSource=!1,this.paused=!1,this._dataStateVersion=0}r.mixin(o),o.prototype.destroy=function(d){this._wantsDestroy=!0;var y=this;y.whenNothingPending(function(){y.wantSubscribe?y.unsubscribe(function(A){if(A)return d?d(A):y.emit("error",A);y.connection._destroyDoc(y),d&&d()}):(y.connection._destroyDoc(y),d&&d())})},o.prototype._setType=function(d){if(typeof d=="string"&&(d=n.map[d]),d)this.type=d;else if(d===null)this.type=d,this._setData(void 0);else{var y=new e(a.ERR_DOC_TYPE_NOT_RECOGNIZED,"Missing type "+d);return this.emit("error",y)}},o.prototype._setData=function(d){this.data=d,this._dataStateVersion++},o.prototype.ingestSnapshot=function(d,y){if(!d)return y&&y();if(typeof d.v!="number"){var A=new e(a.ERR_INGESTED_SNAPSHOT_HAS_NO_VERSION,"Missing version in ingested snapshot. "+this.collection+"."+this.id);return y?y(A):this.emit("error",A)}if(this.type||this.hasWritePending()){if(this.version==null){if(this.hasWritePending())return y&&this.once("no write pending",y);var A=new e(a.ERR_DOC_MISSING_VERSION,"Cannot ingest snapshot in doc with null version. "+this.collection+"."+this.id);return y?y(A):this.emit("error",A)}return d.v>this.version?this.fetch(y):y&&y()}if(this.version>d.v)return y&&y();this.version=d.v;var O=d.type===void 0?n.defaultType:d.type;this._setType(O),this._setData(this.type&&this.type.deserialize?this.type.deserialize(d.data):d.data),this.emit("load"),y&&y()},o.prototype.whenNothingPending=function(d){var y=this;i.nextTick(function(){if(y.hasPending()){y.once("nothing pending",d);return}d()})},o.prototype.hasPending=function(){return!!(this.inflightOp||this.pendingOps.length||this.inflightFetch.length||this.inflightSubscribe||this.pendingFetch.length||this.pendingSubscribe.length)},o.prototype.hasWritePending=function(){return!!(this.inflightOp||this.pendingOps.length)},o.prototype._emitNothingPending=function(){this.hasWritePending()||(this.emit("no write pending"),!this.hasPending()&&this.emit("nothing pending"))},o.prototype._emitResponseError=function(d,y){if(d&&d.code===a.ERR_SNAPSHOT_READ_SILENT_REJECTION){this.wantSubscribe=!1,y&&y(),this._emitNothingPending();return}if(y){y(d),this._emitNothingPending();return}this._emitNothingPending(),this.emit("error",d)},o.prototype._handleFetch=function(d,y){var A=this.pendingFetch;this.pendingFetch=[];var O=this.inflightFetch.shift();if(O&&A.unshift(O),A.length&&(O=function(E){i.callEach(A,E)}),d)return this._emitResponseError(d,O);this.ingestSnapshot(y,O),this._emitNothingPending()},o.prototype._handleSubscribe=function(d,y){var A=this.inflightSubscribe;this.inflightSubscribe=null;var O=this.pendingFetch;this.pendingFetch=[],A.callback&&O.push(A.callback);var E;if(O.length&&(E=function(_){i.callEach(O,_)}),d)return this._emitResponseError(d,E);this.subscribed=A.wantSubscribe,this.subscribed?this.ingestSnapshot(y,E):E&&E(),this._emitNothingPending(),this._flushSubscribe()},o.prototype._handleOp=function(d,y){if(d)return d.code===a.ERR_NO_OP&&y.seq===this.inflightOp.seq?this.fetch(this._clearInflightOp.bind(this)):this.inflightOp?this._rollback(d):this.emit("error",d);if(this.inflightOp&&y.src===this.inflightOp.src&&y.seq===this.inflightOp.seq){this._opAcknowledged(y);return}if(this.version==null||y.v>this.version){this.fetch();return}if(!(y.v<this.version)){if(this.inflightOp){var A=p(this.inflightOp,y);if(A)return this._hardRollback(A)}for(var O=0;O<this.pendingOps.length;O++){var A=p(this.pendingOps[O],y);if(A)return this._hardRollback(A)}this.version++;try{this._otApply(y,!1)}catch(E){return this._hardRollback(E)}}},o.prototype._onConnectionStateChanged=function(){this.connection.canSend?(this.flush(),this._resubscribe()):(this.inflightOp&&(this.pendingOps.unshift(this.inflightOp),this.inflightOp=null),this.subscribed=!1,this.inflightSubscribe&&(this.inflightSubscribe.wantSubscribe?(this.pendingSubscribe.unshift(this.inflightSubscribe),this.inflightSubscribe=null):this._handleSubscribe()),this.inflightFetch.length&&(this.pendingFetch=this.pendingFetch.concat(this.inflightFetch),this.inflightFetch.length=0))},o.prototype._resubscribe=function(){if(!this.pendingSubscribe.length&&this.wantSubscribe)return this.subscribe();var d=this.pendingSubscribe.some(function(y){return y.wantSubscribe});!d&&this.pendingFetch.length&&this.fetch(),this._flushSubscribe()},o.prototype.fetch=function(d){this._fetch({},d)},o.prototype._fetch=function(d,y){this.pendingFetch.push(y);var A=this.connection.canSend&&(d.force||!this.inflightFetch.length);A&&(this.inflightFetch.push(this.pendingFetch.shift()),this.connection.sendFetch(this))},o.prototype.subscribe=function(d){var y=!0;this._queueSubscribe(y,d)},o.prototype.unsubscribe=function(d){var y=!1;this._queueSubscribe(y,d)},o.prototype._queueSubscribe=function(d,y){var A=this.pendingSubscribe[this.pendingSubscribe.length-1]||this.inflightSubscribe,O=A&&A.wantSubscribe===d;if(O){A.callback=c([A.callback,y]);return}this.pendingSubscribe.push({wantSubscribe:!!d,callback:y}),this._flushSubscribe()},o.prototype._flushSubscribe=function(){if(!(this.inflightSubscribe||!this.pendingSubscribe.length)){if(this.connection.canSend){this.inflightSubscribe=this.pendingSubscribe.shift(),this.wantSubscribe=this.inflightSubscribe.wantSubscribe,this.wantSubscribe?this.connection.sendSubscribe(this):(this.subscribed=!1,this.connection.sendUnsubscribe(this));return}if(!this.pendingSubscribe[0].wantSubscribe){this.inflightSubscribe=this.pendingSubscribe.shift();var d=this;i.nextTick(function(){d._handleSubscribe()})}}};function c(d){return d=d.filter(i.truthy),d.length?function(y){i.callEach(d,y)}:null}o.prototype.flush=function(){!this.connection.canSend||this.inflightOp||!this.paused&&this.pendingOps.length&&this._sendOp()};function v(d){delete d.op,delete d.create,delete d.del}function p(d,y){if(d.del)return v(y);if(y.del)return new e(a.ERR_DOC_WAS_DELETED,"Document was deleted");if(y.create)return new e(a.ERR_DOC_ALREADY_CREATED,"Document already created");if("op"in y){if(d.create)return new e(a.ERR_DOC_ALREADY_CREATED,"Document already created");if(d.type.transformX){var A=d.type.transformX(d.op,y.op);d.op=A[0],y.op=A[1]}else{var O=d.type.transform(d.op,y.op,"left"),E=d.type.transform(y.op,d.op,"right");d.op=O,y.op=E}}}return o.prototype._otApply=function(d,y){if("op"in d){if(!this.type)throw new e(a.ERR_DOC_DOES_NOT_EXIST,"Cannot apply op to uncreated document. "+this.collection+"."+this.id);if(this.emit("before op batch",d.op,y),!y&&this.type===n.defaultType&&d.op.length>1){this.applyStack||(this.applyStack=[]);for(var A=this.applyStack.length,O=0;O<d.op.length;O++){var E=d.op[O],_={op:[E]};this.emit("before op",_.op,y,d.src);for(var h=A;h<this.applyStack.length;h++){var f=p(this.applyStack[h],_);if(f)return this._hardRollback(f)}this._setData(this.type.apply(this.data,_.op)),this.emit("op",_.op,y,d.src)}this.emit("op batch",d.op,y),this._popApplyStack(A);return}this.emit("before op",d.op,y,d.src),this._setData(this.type.apply(this.data,d.op)),this.emit("op",d.op,y,d.src),this.emit("op batch",d.op,y);return}if(d.create){this._setType(d.create.type),this.type.deserialize?this.type.createDeserialized?this._setData(this.type.createDeserialized(d.create.data)):this._setData(this.type.deserialize(this.type.create(d.create.data))):this._setData(this.type.create(d.create.data)),this.emit("create",y);return}if(d.del){var g=this.data;this._setType(null),this.emit("del",g,y);return}},o.prototype._sendOp=function(){if(this.connection.canSend){var d=this.connection.id;this.inflightOp||(this.inflightOp=this.pendingOps.shift());var y=this.inflightOp;if(!y){var A=new e(a.ERR_INFLIGHT_OP_MISSING,"No op to send on call to _sendOp");return this.emit("error",A)}if(y.sentAt=Date.now(),y.retries=y.retries==null?0:y.retries+1,y.seq==null){if(this.connection.seq>=i.MAX_SAFE_INTEGER)return this.emit("error",new e(a.ERR_CONNECTION_SEQ_INTEGER_OVERFLOW,"Connection seq has exceeded the max safe integer, maybe from being open for too long"));y.seq=this.connection.seq++}this.connection.sendOp(this,y),y.src==null&&(y.src=d)}},o.prototype._submit=function(d,y,A){if(y||(y=!0),"op"in d){if(!this.type){if(this._isInHardRollback)var O=new e(a.ERR_DOC_IN_HARD_ROLLBACK,"Cannot submit op. Document is performing hard rollback. "+this.collection+"."+this.id);else var O=new e(a.ERR_DOC_DOES_NOT_EXIST,"Cannot submit op. Document has not been created. "+this.collection+"."+this.id);return A?A(O):this.emit("error",O)}this.type.normalize&&(d.op=this.type.normalize(d.op))}try{this._pushOp(d,y,A),this._otApply(d,y)}catch(_){return this._hardRollback(_)}var E=this;i.nextTick(function(){E.flush()})},o.prototype._pushOp=function(d,y,A){if(d.source=y,this.applyStack)this.applyStack.push(d);else{var O=this._tryCompose(d);if(O){O.callbacks.push(A);return}}d.type=this.type,d.callbacks=[A],this.pendingOps.push(d)},o.prototype._popApplyStack=function(d){if(d>0){this.applyStack.length=d;return}var y=this.applyStack[0];if(this.applyStack=null,!!y){var A=this.pendingOps.indexOf(y);if(A!==-1)for(var O=this.pendingOps.splice(A),A=0;A<O.length;A++){var y=O[A],E=this._tryCompose(y);E?E.callbacks=E.callbacks.concat(y.callbacks):this.pendingOps.push(y)}}},o.prototype._tryCompose=function(d){if(!this.preventCompose){var y=this.pendingOps[this.pendingOps.length-1];if(!(!y||y.sentAt)&&!(this.submitSource&&!l(d.source,y.source))){if(y.create&&"op"in d)return y.create.data=this.type.apply(y.create.data,d.op),y;if("op"in y&&"op"in d&&this.type.compose)return y.op=this.type.compose(y.op,d.op),y}}},o.prototype.submitOp=function(d,y,A){typeof y=="function"&&(A=y,y=null);var O={op:d},E=y&&y.source;this._submit(O,E,A)},o.prototype.create=function(d,y,A,O){if(typeof y=="function"?(O=y,A=null,y=null):typeof A=="function"&&(O=A,A=null),y||(y=n.defaultType.uri),this.type){var E=new e(a.ERR_DOC_ALREADY_CREATED,"Document already exists");return O?O(E):this.emit("error",E)}var _={create:{type:y,data:d}},h=A&&A.source;this._submit(_,h,O)},o.prototype.del=function(d,y){if(typeof d=="function"&&(y=d,d=null),!this.type){var A=new e(a.ERR_DOC_DOES_NOT_EXIST,"Document does not exist");return y?y(A):this.emit("error",A)}var O={del:!0},E=d&&d.source;this._submit(O,E,y)},o.prototype.pause=function(){this.paused=!0},o.prototype.resume=function(){this.paused=!1,this.flush()},o.prototype.toSnapshot=function(){return{v:this.version,data:s(this.data),type:this.type.uri}},o.prototype._opAcknowledged=function(d){if(this.inflightOp.create)this.version=d.v;else if(d.v!==this.version)return t.warn("Invalid version from server. Expected: "+this.version+" Received: "+d.v,d),this.fetch();if(d[u.fixup])for(var y=0;y<d[u.fixup].length;y++){for(var A=d[u.fixup][y],O=0;O<this.pendingOps.length;O++){var E=p(this.pendingOps[y],A);if(E)return this._hardRollback(E)}try{this._otApply(A,!1)}catch(_){return this._hardRollback(_)}}this.version++,this._clearInflightOp()},o.prototype._rollback=function(d){var y=this.inflightOp;if(!("op"in y&&y.type.invert))return this._hardRollback(d);try{y.op=y.type.invert(y.op)}catch{return this._hardRollback(d)}for(var A=0;A<this.pendingOps.length;A++){var O=p(this.pendingOps[A],y);if(O)return this._hardRollback(O)}try{this._otApply(y,!1)}catch(E){return this._hardRollback(E)}if(d.code===a.ERR_OP_SUBMIT_REJECTED)return this._clearInflightOp(null);this._clearInflightOp(d)},o.prototype._hardRollback=function(d){this._isInHardRollback=!0;var y=this.pendingOps,A=this.inflightOp;this._setType(null),this.version=null,this.inflightOp=null,this.pendingOps=[];var O=this;this._fetch({force:!0},function(E){if(O._isInHardRollback=!1,E&&(t.error("Hard rollback doc fetch failed.",E,A),O.emit("error",new e(a.ERR_HARD_ROLLBACK_FETCH_FAILED,"Hard rollback fetch failed: "+E.message))),d.code===a.ERR_OP_SUBMIT_REJECTED){if(A&&(i.callEach(A.callbacks),A=null),!y.length)return;d=new e(a.ERR_PENDING_OP_REMOVED_BY_OP_SUBMIT_REJECTED,"Discarding pending op because of hard rollback during ERR_OP_SUBMIT_REJECTED")}A&&y.unshift(A);for(var _=!!y.length,h=0;h<y.length;h++)_=i.callEach(y[h].callbacks,d)&&_;d&&!_&&O.emit("error",d)})},o.prototype._clearInflightOp=function(d){var y=this.inflightOp;this.inflightOp=null;var A=i.callEach(y.callbacks,d);if(this.flush(),this._emitNothingPending(),d&&!A)return this.emit("error",d)},ma}var ya,cf;function rd(){if(cf)return ya;cf=1;var r=Bn(),t=dn().ACTIONS,e=pr();ya=n;function n(i,s,l,u,a,o,c){r.EventEmitter.call(this),this.action=i,this.connection=s,this.id=l,this.collection=u,this.query=a,this.results=null,o&&o.results&&(this.results=o.results,delete o.results),this.extra=void 0,this.options=o,this.callback=c,this.ready=!1,this.sent=!1}return r.mixin(n),n.prototype.hasPending=function(){return!this.ready},n.prototype.send=function(){if(this.connection.canSend){var i={a:this.action,id:this.id,c:this.collection,q:this.query};if(this.options&&(i.o=this.options),this.results){for(var s=[],l=0;l<this.results.length;l++){var u=this.results[l];s.push([u.id,u.version])}i.r=s}this.connection.send(i),this.sent=!0}},n.prototype.destroy=function(i){this.connection.canSend&&this.action===t.querySubscribe&&this.connection.send({a:t.queryUnsubscribe,id:this.id}),this.connection._destroyQuery(this),i&&e.nextTick(i)},n.prototype._onConnectionStateChanged=function(){this.connection.canSend&&!this.sent?this.send():this.sent=!1},n.prototype._handleFetch=function(i,s,l){this.connection._destroyQuery(this),this._handleResponse(i,s,l)},n.prototype._handleSubscribe=function(i,s,l){this._handleResponse(i,s,l)},n.prototype._handleResponse=function(i,s,l){var u=this.callback;if(this.callback=null,i)return this._finishResponse(i,u);if(!s)return this._finishResponse(null,u);var a=this,o=1,c=function(y){if(y)return a._finishResponse(y,u);--o||a._finishResponse(null,u)};if(Array.isArray(s))o+=s.length,this.results=this._ingestSnapshots(s,c),this.extra=l;else for(var v in s){o++;var p=s[v],d=this.connection.get(p.c||this.collection,v);d.ingestSnapshot(p,c)}c()},n.prototype._ingestSnapshots=function(i,s){for(var l=[],u=0;u<i.length;u++){var a=i[u],o=this.connection.get(a.c||this.collection,a.d);o.ingestSnapshot(a,s),l.push(o)}return l},n.prototype._finishResponse=function(i,s){if(this.emit("ready"),this.ready=!0,i)return this.connection._destroyQuery(this),s?s(i):this.emit("error",i);s&&s(null,this.results,this.extra)},n.prototype._handleError=function(i){this.emit("error",i)},n.prototype._handleDiff=function(i){for(var s=0;s<i.length;s++){var l=i[s];l.type==="insert"&&(l.values=this._ingestSnapshots(l.values))}for(var s=0;s<i.length;s++){var l=i[s];switch(l.type){case"insert":var u=l.values;Array.prototype.splice.apply(this.results,[l.index,0].concat(u)),this.emit("insert",u,l.index);break;case"remove":var o=l.howMany||1,a=this.results.splice(l.index,o);this.emit("remove",a,l.index);break;case"move":var o=l.howMany||1,c=this.results.splice(l.from,o);Array.prototype.splice.apply(this.results,[l.to,0].concat(c)),this.emit("move",c,l.from,l.to);break}}this.emit("changed",this.results)},n.prototype._handleExtra=function(i){this.extra=i,this.emit("extra",i)},ya}var ba,ff;function nd(){if(ff)return ba;ff=1;var r=Bn(),t=dn().ACTIONS,e=pr();ba=n;function n(i,s){if(r.EventEmitter.call(this),!s||typeof s!="string")throw new Error("LocalPresence presenceId must be a string");this.presence=i,this.presenceId=s,this.connection=i.connection,this.presenceVersion=0,this.value=null,this._pendingMessages=[],this._callbacksByPresenceVersion=Object.create(null)}return r.mixin(n),n.prototype.submit=function(i,s){this.value=i,this.send(s)},n.prototype.send=function(i){var s=this._message();this._pendingMessages.push(s),this._callbacksByPresenceVersion[s.pv]=i,this._sendPending()},n.prototype.destroy=function(i){var s=this;this.submit(null,function(l){if(l)return s._callbackOrEmit(l,i);delete s.presence.localPresences[s.presenceId],i&&i()})},n.prototype._sendPending=function(){if(this.connection.canSend){var i=this;this._pendingMessages.forEach(function(s){i.connection.send(s)}),this._pendingMessages=[]}},n.prototype._ack=function(i,s){var l=this._getCallback(s);this._callbackOrEmit(i,l)},n.prototype._message=function(){return{a:t.presence,ch:this.presence.channel,id:this.presenceId,p:this.value,pv:this.presenceVersion++}},n.prototype._getCallback=function(i){var s=this._callbacksByPresenceVersion[i];return delete this._callbacksByPresenceVersion[i],s},n.prototype._callbackOrEmit=function(i,s){if(s)return e.nextTick(s,i);i&&this.emit("error",i)},ba}var _a,hf;function id(){if(hf)return _a;hf=1;var r=pr();_a=t;function t(e,n){this.presence=e,this.presenceId=n,this.connection=this.presence.connection,this.value=null,this.presenceVersion=0}return t.prototype.receiveUpdate=function(e){e.pv<this.presenceVersion||(this.value=e.p,this.presenceVersion=e.pv,this.presence._updateRemotePresence(this))},t.prototype.destroy=function(e){delete this.presence._remotePresenceInstances[this.presenceId],delete this.presence.remotePresences[this.presenceId],e&&r.nextTick(e)},_a}function sd(r,...t){return(...e)=>r(...t,...e)}function wi(r){return function(...t){var e=t.pop();return r.call(this,t,e)}}var j0=typeof queueMicrotask=="function"&&queueMicrotask,od=typeof setImmediate=="function"&&setImmediate,ad=typeof process=="object"&&typeof process.nextTick=="function";function ld(r){setTimeout(r,0)}function ud(r){return(t,...e)=>r(()=>t(...e))}var Jn;j0?Jn=queueMicrotask:od?Jn=setImmediate:ad?Jn=process.nextTick:Jn=ld;var Kr=ud(Jn);function ci(r){return Ti(r)?function(...t){const e=t.pop(),n=r.apply(this,t);return df(n,e)}:wi(function(t,e){var n;try{n=r.apply(this,t)}catch(i){return e(i)}if(n&&typeof n.then=="function")return df(n,e);e(null,n)})}function df(r,t){return r.then(e=>{pf(t,null,e)},e=>{pf(t,e&&(e instanceof Error||e.message)?e:new Error(e))})}function pf(r,t,e){try{r(t,e)}catch(n){Kr(i=>{throw i},n)}}function Ti(r){return r[Symbol.toStringTag]==="AsyncFunction"}function k0(r){return r[Symbol.toStringTag]==="AsyncGenerator"}function B0(r){return typeof r[Symbol.asyncIterator]=="function"}function Pt(r){if(typeof r!="function")throw new Error("expected a function");return Ti(r)?ci(r):r}function It(r,t){if(t||(t=r.length),!t)throw new Error("arity is undefined");function e(...n){return typeof n[t-1]=="function"?r.apply(this,n):new Promise((i,s)=>{n[t-1]=(l,...u)=>{if(l)return s(l);i(u.length>1?u:u[0])},r.apply(this,n)})}return e}function cd(r){return function(e,...n){return It(function(s){var l=this;return r(e,(u,a)=>{Pt(u).apply(l,n.concat(a))},s)})}}function ql(r,t,e,n){t=t||[];var i=[],s=0,l=Pt(e);return r(t,(u,a,o)=>{var c=s++;l(u,(v,p)=>{i[c]=p,o(v)})},u=>{n(u,i)})}function Ps(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}const Ds={};function Qr(r){function t(...e){if(r!==null){var n=r;r=null,n.apply(this,e)}}return Object.assign(t,r),t}function F0(r){return r[Symbol.iterator]&&r[Symbol.iterator]()}function $0(r){var t=-1,e=r.length;return function(){return++t<e?{value:r[t],key:t}:null}}function U0(r){var t=-1;return function(){var n=r.next();return n.done?null:(t++,{value:n.value,key:t})}}function H0(r){var t=r?Object.keys(r):[],e=-1,n=t.length;return function i(){var s=t[++e];return s==="__proto__"?i():e<n?{value:r[s],key:s}:null}}function z0(r){if(Ps(r))return $0(r);var t=F0(r);return t?U0(t):H0(r)}function tn(r){return function(...t){if(r===null)throw new Error("Callback was already called.");var e=r;r=null,e.apply(this,t)}}function gf(r,t,e,n){let i=!1,s=!1,l=!1,u=0,a=0;function o(){u>=t||l||i||(l=!0,r.next().then(({value:p,done:d})=>{if(!(s||i)){if(l=!1,d){i=!0,u<=0&&n(null);return}u++,e(p,a,c),a++,o()}}).catch(v))}function c(p,d){if(u-=1,!s){if(p)return v(p);if(p===!1){i=!0,s=!0;return}if(d===Ds||i&&u<=0)return i=!0,n(null);o()}}function v(p){s||(l=!1,i=!0,n(p))}o()}var gr=r=>(t,e,n)=>{if(n=Qr(n),r<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return n(null);if(k0(t))return gf(t,r,e,n);if(B0(t))return gf(t[Symbol.asyncIterator](),r,e,n);var i=z0(t),s=!1,l=!1,u=0,a=!1;function o(v,p){if(!l)if(u-=1,v)s=!0,n(v);else if(v===!1)s=!0,l=!0;else{if(p===Ds||s&&u<=0)return s=!0,n(null);a||c()}}function c(){for(a=!0;u<r&&!s;){var v=i();if(v===null){s=!0,u<=0&&n(null);return}u+=1,e(v.value,v.key,tn(o))}a=!1}c()};function V0(r,t,e,n){return gr(t)(r,Pt(e),n)}var Dn=It(V0,4);function G0(r,t,e){e=Qr(e);var n=0,i=0,{length:s}=r,l=!1;s===0&&e(null);function u(a,o){a===!1&&(l=!0),l!==!0&&(a?e(a):(++i===s||o===Ds)&&e(null))}for(;n<s;n++)t(r[n],n,tn(u))}function W0(r,t,e){return Dn(r,1/0,t,e)}function K0(r,t,e){var n=Ps(r)?G0:W0;return n(r,Pt(t),e)}var ze=It(K0,3);function Y0(r,t,e){return ql(ze,r,t,e)}var Ms=It(Y0,3),fd=cd(Ms);function X0(r,t,e){return Dn(r,1,t,e)}var cr=It(X0,3);function Z0(r,t,e){return ql(cr,r,t,e)}var Pl=It(Z0,3),hd=cd(Pl);const $n=Symbol("promiseCallback");function Mn(){let r,t;function e(n,...i){if(n)return t(n);r(i.length>1?i:i[0])}return e[$n]=new Promise((n,i)=>{r=n,t=i}),e}function Dl(r,t,e){typeof t!="number"&&(e=t,t=null),e=Qr(e||Mn());var n=Object.keys(r).length;if(!n)return e(null);t||(t=n);var i={},s=0,l=!1,u=!1,a=Object.create(null),o=[],c=[],v={};Object.keys(r).forEach(h=>{var f=r[h];if(!Array.isArray(f)){p(h,[f]),c.push(h);return}var g=f.slice(0,f.length-1),b=g.length;if(b===0){p(h,f),c.push(h);return}v[h]=b,g.forEach(S=>{if(!r[S])throw new Error("async.auto task `"+h+"` has a non-existent dependency `"+S+"` in "+g.join(", "));y(S,()=>{b--,b===0&&p(h,f)})})}),E(),d();function p(h,f){o.push(()=>O(h,f))}function d(){if(!l){if(o.length===0&&s===0)return e(null,i);for(;o.length&&s<t;){var h=o.shift();h()}}}function y(h,f){var g=a[h];g||(g=a[h]=[]),g.push(f)}function A(h){var f=a[h]||[];f.forEach(g=>g()),d()}function O(h,f){if(!u){var g=tn((S,...N)=>{if(s--,S===!1){l=!0;return}if(N.length<2&&([N]=N),S){var C={};if(Object.keys(i).forEach(P=>{C[P]=i[P]}),C[h]=N,u=!0,a=Object.create(null),l)return;e(S,C)}else i[h]=N,A(h)});s++;var b=Pt(f[f.length-1]);f.length>1?b(i,g):b(g)}}function E(){for(var h,f=0;c.length;)h=c.pop(),f++,_(h).forEach(g=>{--v[g]===0&&c.push(g)});if(f!==n)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function _(h){var f=[];return Object.keys(r).forEach(g=>{const b=r[g];Array.isArray(b)&&b.indexOf(h)>=0&&f.push(g)}),f}return e[$n]}var J0=/^(?:async\s)?(?:function)?\s*(?:\w+\s*)?\(([^)]+)\)(?:\s*{)/,Q0=/^(?:async\s)?\s*(?:\(\s*)?((?:[^)=\s]\s*)*)(?:\)\s*)?=>/,t_=/,/,e_=/(=.+)?(\s*)$/;function r_(r){let t="",e=0,n=r.indexOf("*/");for(;e<r.length;)if(r[e]==="/"&&r[e+1]==="/"){let i=r.indexOf(`
`,e);e=i===-1?r.length:i}else if(n!==-1&&r[e]==="/"&&r[e+1]==="*"){let i=r.indexOf("*/",e);i!==-1?(e=i+2,n=r.indexOf("*/",e)):(t+=r[e],e++)}else t+=r[e],e++;return t}function n_(r){const t=r_(r.toString());let e=t.match(J0);if(e||(e=t.match(Q0)),!e)throw new Error(`could not parse args in autoInject
Source:
`+t);let[,n]=e;return n.replace(/\s/g,"").split(t_).map(i=>i.replace(e_,"").trim())}function dd(r,t){var e={};return Object.keys(r).forEach(n=>{var i=r[n],s,l=Ti(i),u=!l&&i.length===1||l&&i.length===0;if(Array.isArray(i))s=[...i],i=s.pop(),e[n]=s.concat(s.length>0?a:i);else if(u)e[n]=i;else{if(s=n_(i),i.length===0&&!l&&s.length===0)throw new Error("autoInject task functions require explicit parameters.");l||s.pop(),e[n]=s.concat(a)}function a(o,c){var v=s.map(p=>o[p]);v.push(c),Pt(i)(...v)}}),Dl(e,t)}class i_{constructor(){this.head=this.tail=null,this.length=0}removeLink(t){return t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,t.prev=t.next=null,this.length-=1,t}empty(){for(;this.head;)this.shift();return this}insertAfter(t,e){e.prev=t,e.next=t.next,t.next?t.next.prev=e:this.tail=e,t.next=e,this.length+=1}insertBefore(t,e){e.prev=t.prev,e.next=t,t.prev?t.prev.next=e:this.head=e,t.prev=e,this.length+=1}unshift(t){this.head?this.insertBefore(this.head,t):vf(this,t)}push(t){this.tail?this.insertAfter(this.tail,t):vf(this,t)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var t=this.head;t;)yield t.data,t=t.next}remove(t){for(var e=this.head;e;){var{next:n}=e;t(e)&&this.removeLink(e),e=n}return this}}function vf(r,t){r.length=1,r.head=r.tail=t}function Ml(r,t,e){if(t==null)t=1;else if(t===0)throw new RangeError("Concurrency must not be zero");var n=Pt(r),i=0,s=[];const l={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function u(_,h){l[_].push(h)}function a(_,h){const f=(...g)=>{o(_,f),h(...g)};l[_].push(f)}function o(_,h){if(!_)return Object.keys(l).forEach(f=>l[f]=[]);if(!h)return l[_]=[];l[_]=l[_].filter(f=>f!==h)}function c(_,...h){l[_].forEach(f=>f(...h))}var v=!1;function p(_,h,f,g){if(g!=null&&typeof g!="function")throw new Error("task callback must be a function");E.started=!0;var b,S;function N(P,...w){if(P)return f?S(P):b();if(w.length<=1)return b(w[0]);b(w)}var C=E._createTaskItem(_,f?N:g||N);if(h?E._tasks.unshift(C):E._tasks.push(C),v||(v=!0,Kr(()=>{v=!1,E.process()})),f||!g)return new Promise((P,w)=>{b=P,S=w})}function d(_){return function(h,...f){i-=1;for(var g=0,b=_.length;g<b;g++){var S=_[g],N=s.indexOf(S);N===0?s.shift():N>0&&s.splice(N,1),S.callback(h,...f),h!=null&&c("error",h,S.data)}i<=E.concurrency-E.buffer&&c("unsaturated"),E.idle()&&c("drain"),E.process()}}function y(_){return _.length===0&&E.idle()?(Kr(()=>c("drain")),!0):!1}const A=_=>h=>{if(!h)return new Promise((f,g)=>{a(_,(b,S)=>{if(b)return g(b);f(S)})});o(_),u(_,h)};var O=!1,E={_tasks:new i_,_createTaskItem(_,h){return{data:_,callback:h}},*[Symbol.iterator](){yield*E._tasks[Symbol.iterator]()},concurrency:t,payload:e,buffer:t/4,started:!1,paused:!1,push(_,h){return Array.isArray(_)?y(_)?void 0:_.map(f=>p(f,!1,!1,h)):p(_,!1,!1,h)},pushAsync(_,h){return Array.isArray(_)?y(_)?void 0:_.map(f=>p(f,!1,!0,h)):p(_,!1,!0,h)},kill(){o(),E._tasks.empty()},unshift(_,h){return Array.isArray(_)?y(_)?void 0:_.map(f=>p(f,!0,!1,h)):p(_,!0,!1,h)},unshiftAsync(_,h){return Array.isArray(_)?y(_)?void 0:_.map(f=>p(f,!0,!0,h)):p(_,!0,!0,h)},remove(_){E._tasks.remove(_)},process(){if(!O){for(O=!0;!E.paused&&i<E.concurrency&&E._tasks.length;){var _=[],h=[],f=E._tasks.length;E.payload&&(f=Math.min(f,E.payload));for(var g=0;g<f;g++){var b=E._tasks.shift();_.push(b),s.push(b),h.push(b.data)}i+=1,E._tasks.length===0&&c("empty"),i===E.concurrency&&c("saturated");var S=tn(d(_));n(h,S)}O=!1}},length(){return E._tasks.length},running(){return i},workersList(){return s},idle(){return E._tasks.length+i===0},pause(){E.paused=!0},resume(){E.paused!==!1&&(E.paused=!1,Kr(E.process))}};return Object.defineProperties(E,{saturated:{writable:!1,value:A("saturated")},unsaturated:{writable:!1,value:A("unsaturated")},empty:{writable:!1,value:A("empty")},drain:{writable:!1,value:A("drain")},error:{writable:!1,value:A("error")}}),E}function pd(r,t){return Ml(r,1,t)}function gd(r,t,e){return Ml(r,t,e)}function s_(r,t,e,n){n=Qr(n);var i=Pt(e);return cr(r,(s,l,u)=>{i(t,s,(a,o)=>{t=o,u(a)})},s=>n(s,t))}var Yr=It(s_,4);function jl(...r){var t=r.map(Pt);return function(...e){var n=this,i=e[e.length-1];return typeof i=="function"?e.pop():i=Mn(),Yr(t,e,(s,l,u)=>{l.apply(n,s.concat((a,...o)=>{u(a,o)}))},(s,l)=>i(s,...l)),i[$n]}}function vd(...r){return jl(...r.reverse())}function o_(r,t,e,n){return ql(gr(t),r,e,n)}var Ri=It(o_,4);function a_(r,t,e,n){var i=Pt(e);return Ri(r,t,(s,l)=>{i(s,(u,...a)=>u?l(u):l(u,a))},(s,l)=>{for(var u=[],a=0;a<l.length;a++)l[a]&&(u=u.concat(...l[a]));return n(s,u)})}var jn=It(a_,4);function l_(r,t,e){return jn(r,1/0,t,e)}var ns=It(l_,3);function u_(r,t,e){return jn(r,1,t,e)}var is=It(u_,3);function md(...r){return function(...t){var e=t.pop();return e(null,...r)}}function Mr(r,t){return(e,n,i,s)=>{var l=!1,u;const a=Pt(i);e(n,(o,c,v)=>{a(o,(p,d)=>{if(p||p===!1)return v(p);if(r(d)&&!u)return l=!0,u=t(!0,o),v(null,Ds);v()})},o=>{if(o)return s(o);s(null,l?u:t(!1))})}}function c_(r,t,e){return Mr(n=>n,(n,i)=>i)(ze,r,t,e)}var ss=It(c_,3);function f_(r,t,e,n){return Mr(i=>i,(i,s)=>s)(gr(t),r,e,n)}var os=It(f_,4);function h_(r,t,e){return Mr(n=>n,(n,i)=>i)(gr(1),r,t,e)}var as=It(h_,3);function yd(r){return(t,...e)=>Pt(t)(...e,(n,...i)=>{typeof console=="object"&&(n?console.error&&console.error(n):console[r]&&i.forEach(s=>console[r](s)))})}var bd=yd("dir");function d_(r,t,e){e=tn(e);var n=Pt(r),i=Pt(t),s;function l(a,...o){if(a)return e(a);a!==!1&&(s=o,i(...o,u))}function u(a,o){if(a)return e(a);if(a!==!1){if(!o)return e(null,...s);n(l)}}return u(null,!0)}var fi=It(d_,3);function _d(r,t,e){const n=Pt(t);return fi(r,(...i)=>{const s=i.pop();n(...i,(l,u)=>s(l,!u))},e)}function Ed(r){return(t,e,n)=>r(t,n)}function p_(r,t,e){return ze(r,Ed(Pt(t)),e)}var ls=It(p_,3);function g_(r,t,e,n){return gr(t)(r,Ed(Pt(e)),n)}var hi=It(g_,4);function v_(r,t,e){return hi(r,1,t,e)}var di=It(v_,3);function kl(r){return Ti(r)?r:function(...t){var e=t.pop(),n=!0;t.push((...i)=>{n?Kr(()=>e(...i)):e(...i)}),r.apply(this,t),n=!1}}function m_(r,t,e){return Mr(n=>!n,n=>!n)(ze,r,t,e)}var us=It(m_,3);function y_(r,t,e,n){return Mr(i=>!i,i=>!i)(gr(t),r,e,n)}var cs=It(y_,4);function b_(r,t,e){return Mr(n=>!n,n=>!n)(cr,r,t,e)}var fs=It(b_,3);function __(r,t,e,n){var i=new Array(t.length);r(t,(s,l,u)=>{e(s,(a,o)=>{i[l]=!!o,u(a)})},s=>{if(s)return n(s);for(var l=[],u=0;u<t.length;u++)i[u]&&l.push(t[u]);n(null,l)})}function E_(r,t,e,n){var i=[];r(t,(s,l,u)=>{e(s,(a,o)=>{if(a)return u(a);o&&i.push({index:l,value:s}),u(a)})},s=>{if(s)return n(s);n(null,i.sort((l,u)=>l.index-u.index).map(l=>l.value))})}function js(r,t,e,n){var i=Ps(t)?__:E_;return i(r,t,Pt(e),n)}function A_(r,t,e){return js(ze,r,t,e)}var hs=It(A_,3);function O_(r,t,e,n){return js(gr(t),r,e,n)}var ds=It(O_,4);function S_(r,t,e){return js(cr,r,t,e)}var ps=It(S_,3);function w_(r,t){var e=tn(t),n=Pt(kl(r));function i(s){if(s)return e(s);s!==!1&&n(i)}return i()}var Ad=It(w_,2);function T_(r,t,e,n){var i=Pt(e);return Ri(r,t,(s,l)=>{i(s,(u,a)=>u?l(u):l(u,{key:a,val:s}))},(s,l)=>{for(var u={},{hasOwnProperty:a}=Object.prototype,o=0;o<l.length;o++)if(l[o]){var{key:c}=l[o],{val:v}=l[o];a.call(u,c)?u[c].push(v):u[c]=[v]}return n(s,u)})}var ks=It(T_,4);function Od(r,t,e){return ks(r,1/0,t,e)}function Sd(r,t,e){return ks(r,1,t,e)}var wd=yd("log");function R_(r,t,e,n){n=Qr(n);var i={},s=Pt(e);return gr(t)(r,(l,u,a)=>{s(l,u,(o,c)=>{if(o)return a(o);i[u]=c,a(o)})},l=>n(l,i))}var Bs=It(R_,4);function Td(r,t,e){return Bs(r,1/0,t,e)}function Rd(r,t,e){return Bs(r,1,t,e)}function Nd(r,t=e=>e){var e=Object.create(null),n=Object.create(null),i=Pt(r),s=wi((l,u)=>{var a=t(...l);a in e?Kr(()=>u(null,...e[a])):a in n?n[a].push(u):(n[a]=[u],i(...l,(o,...c)=>{o||(e[a]=c);var v=n[a];delete n[a];for(var p=0,d=v.length;p<d;p++)v[p](o,...c)}))});return s.memo=e,s.unmemoized=r,s}var Ji;ad?Ji=process.nextTick:od?Ji=setImmediate:Ji=ld;var Ld=ud(Ji),Bl=It((r,t,e)=>{var n=Ps(t)?[]:{};r(t,(i,s,l)=>{Pt(i)((u,...a)=>{a.length<2&&([a]=a),n[s]=a,l(u)})},i=>e(i,n))},3);function Cd(r,t){return Bl(ze,r,t)}function xd(r,t,e){return Bl(gr(t),r,e)}function Fl(r,t){var e=Pt(r);return Ml((n,i)=>{e(n[0],i)},t,1)}class N_{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(t){let e;for(;t>0&&Ea(this.heap[t],this.heap[e=mf(t)]);){let n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,t=e}}percDown(t){let e;for(;(e=L_(t))<this.heap.length&&(e+1<this.heap.length&&Ea(this.heap[e+1],this.heap[e])&&(e=e+1),!Ea(this.heap[t],this.heap[e]));){let n=this.heap[t];this.heap[t]=this.heap[e],this.heap[e]=n,t=e}}push(t){t.pushCount=++this.pushCount,this.heap.push(t),this.percUp(this.heap.length-1)}unshift(t){return this.heap.push(t)}shift(){let[t]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),t}toArray(){return[...this]}*[Symbol.iterator](){for(let t=0;t<this.heap.length;t++)yield this.heap[t].data}remove(t){let e=0;for(let n=0;n<this.heap.length;n++)t(this.heap[n])||(this.heap[e]=this.heap[n],e++);this.heap.splice(e);for(let n=mf(this.heap.length-1);n>=0;n--)this.percDown(n);return this}}function L_(r){return(r<<1)+1}function mf(r){return(r+1>>1)-1}function Ea(r,t){return r.priority!==t.priority?r.priority<t.priority:r.pushCount<t.pushCount}function Id(r,t){var e=Fl(r,t),{push:n,pushAsync:i}=e;e._tasks=new N_,e._createTaskItem=({data:l,priority:u},a)=>({data:l,priority:u,callback:a});function s(l,u){return Array.isArray(l)?l.map(a=>({data:a,priority:u})):{data:l,priority:u}}return e.push=function(l,u=0,a){return n(s(l,u),a)},e.pushAsync=function(l,u=0,a){return i(s(l,u),a)},delete e.unshift,delete e.unshiftAsync,e}function C_(r,t){if(t=Qr(t),!Array.isArray(r))return t(new TypeError("First argument to race must be an array of functions"));if(!r.length)return t();for(var e=0,n=r.length;e<n;e++)Pt(r[e])(t)}var qd=It(C_,2);function gs(r,t,e,n){var i=[...r].reverse();return Yr(i,t,e,n)}function vs(r){var t=Pt(r);return wi(function(n,i){return n.push((s,...l)=>{let u={};if(s&&(u.error=s),l.length>0){var a=l;l.length<=1&&([a]=l),u.value=a}i(null,u)}),t.apply(this,n)})}function Pd(r){var t;return Array.isArray(r)?t=r.map(vs):(t={},Object.keys(r).forEach(e=>{t[e]=vs.call(this,r[e])})),t}function $l(r,t,e,n){const i=Pt(e);return js(r,t,(s,l)=>{i(s,(u,a)=>{l(u,!a)})},n)}function x_(r,t,e){return $l(ze,r,t,e)}var Dd=It(x_,3);function I_(r,t,e,n){return $l(gr(t),r,e,n)}var Md=It(I_,4);function q_(r,t,e){return $l(cr,r,t,e)}var jd=It(q_,3);function kd(r){return function(){return r}}const ll=5,Bd=0;function ms(r,t,e){var n={times:ll,intervalFunc:kd(Bd)};if(arguments.length<3&&typeof r=="function"?(e=t||Mn(),t=r):(P_(n,r),e=e||Mn()),typeof t!="function")throw new Error("Invalid arguments for async.retry");var i=Pt(t),s=1;function l(){i((u,...a)=>{u!==!1&&(u&&s++<n.times&&(typeof n.errorFilter!="function"||n.errorFilter(u))?setTimeout(l,n.intervalFunc(s-1)):e(u,...a))})}return l(),e[$n]}function P_(r,t){if(typeof t=="object")r.times=+t.times||ll,r.intervalFunc=typeof t.interval=="function"?t.interval:kd(+t.interval||Bd),r.errorFilter=t.errorFilter;else if(typeof t=="number"||typeof t=="string")r.times=+t||ll;else throw new Error("Invalid arguments for async.retry")}function Fd(r,t){t||(t=r,r=null);let e=r&&r.arity||t.length;Ti(t)&&(e+=1);var n=Pt(t);return wi((i,s)=>{(i.length<e-1||s==null)&&(i.push(s),s=Mn());function l(u){n(...i,u)}return r?ms(r,l,s):ms(l,s),s[$n]})}function $d(r,t){return Bl(cr,r,t)}function D_(r,t,e){return Mr(Boolean,n=>n)(ze,r,t,e)}var ys=It(D_,3);function M_(r,t,e,n){return Mr(Boolean,i=>i)(gr(t),r,e,n)}var bs=It(M_,4);function j_(r,t,e){return Mr(Boolean,n=>n)(cr,r,t,e)}var _s=It(j_,3);function k_(r,t,e){var n=Pt(t);return Ms(r,(s,l)=>{n(s,(u,a)=>{if(u)return l(u);l(u,{value:s,criteria:a})})},(s,l)=>{if(s)return e(s);e(null,l.sort(i).map(u=>u.value))});function i(s,l){var u=s.criteria,a=l.criteria;return u<a?-1:u>a?1:0}}var Ud=It(k_,3);function Hd(r,t,e){var n=Pt(r);return wi((i,s)=>{var l=!1,u;function a(){var o=r.name||"anonymous",c=new Error('Callback function "'+o+'" timed out.');c.code="ETIMEDOUT",e&&(c.info=e),l=!0,s(c)}i.push((...o)=>{l||(s(...o),clearTimeout(u))}),u=setTimeout(a,t),n(...i)})}function B_(r){for(var t=Array(r);r--;)t[r]=r;return t}function Fs(r,t,e,n){var i=Pt(e);return Ri(B_(r),t,i,n)}function zd(r,t,e){return Fs(r,1/0,t,e)}function Vd(r,t,e){return Fs(r,1,t,e)}function Gd(r,t,e,n){arguments.length<=3&&typeof t=="function"&&(n=e,e=t,t=Array.isArray(r)?[]:{}),n=Qr(n||Mn());var i=Pt(e);return ze(r,(s,l,u)=>{i(t,s,l,u)},s=>n(s,t)),n[$n]}function F_(r,t){var e=null,n;return di(r,(i,s)=>{Pt(i)((l,...u)=>{if(l===!1)return s(l);u.length<2?[n]=u:n=u,e=l,s(l?null:{})})},()=>t(e,n))}var Wd=It(F_);function Kd(r){return(...t)=>(r.unmemoized||r)(...t)}function $_(r,t,e){e=tn(e);var n=Pt(t),i=Pt(r),s=[];function l(a,...o){if(a)return e(a);s=o,a!==!1&&i(u)}function u(a,o){if(a)return e(a);if(a!==!1){if(!o)return e(null,...s);n(l)}}return i(u)}var pi=It($_,3);function Yd(r,t,e){const n=Pt(r);return pi(i=>n((s,l)=>i(s,!l)),t,e)}function U_(r,t){if(t=Qr(t),!Array.isArray(r))return t(new Error("First argument to waterfall must be an array of functions"));if(!r.length)return t();var e=0;function n(s){var l=Pt(r[e++]);l(...s,tn(i))}function i(s,...l){if(s!==!1){if(s||e===r.length)return t(s,...l);n(l)}}n([])}var Xd=It(U_),H_={apply:sd,applyEach:fd,applyEachSeries:hd,asyncify:ci,auto:Dl,autoInject:dd,cargo:pd,cargoQueue:gd,compose:vd,concat:ns,concatLimit:jn,concatSeries:is,constant:md,detect:ss,detectLimit:os,detectSeries:as,dir:bd,doUntil:_d,doWhilst:fi,each:ls,eachLimit:hi,eachOf:ze,eachOfLimit:Dn,eachOfSeries:cr,eachSeries:di,ensureAsync:kl,every:us,everyLimit:cs,everySeries:fs,filter:hs,filterLimit:ds,filterSeries:ps,forever:Ad,groupBy:Od,groupByLimit:ks,groupBySeries:Sd,log:wd,map:Ms,mapLimit:Ri,mapSeries:Pl,mapValues:Td,mapValuesLimit:Bs,mapValuesSeries:Rd,memoize:Nd,nextTick:Ld,parallel:Cd,parallelLimit:xd,priorityQueue:Id,queue:Fl,race:qd,reduce:Yr,reduceRight:gs,reflect:vs,reflectAll:Pd,reject:Dd,rejectLimit:Md,rejectSeries:jd,retry:ms,retryable:Fd,seq:jl,series:$d,setImmediate:Kr,some:ys,someLimit:bs,someSeries:_s,sortBy:Ud,timeout:Hd,times:zd,timesLimit:Fs,timesSeries:Vd,transform:Gd,tryEach:Wd,unmemoize:Kd,until:Yd,waterfall:Xd,whilst:pi,all:us,allLimit:cs,allSeries:fs,any:ys,anyLimit:bs,anySeries:_s,find:ss,findLimit:os,findSeries:as,flatMap:ns,flatMapLimit:jn,flatMapSeries:is,forEach:ls,forEachSeries:di,forEachLimit:hi,forEachOf:ze,forEachOfSeries:cr,forEachOfLimit:Dn,inject:Yr,foldl:Yr,foldr:gs,select:hs,selectLimit:ds,selectSeries:ps,wrapSync:ci,during:pi,doDuring:fi};const z_=Object.freeze(Object.defineProperty({__proto__:null,all:us,allLimit:cs,allSeries:fs,any:ys,anyLimit:bs,anySeries:_s,apply:sd,applyEach:fd,applyEachSeries:hd,asyncify:ci,auto:Dl,autoInject:dd,cargo:pd,cargoQueue:gd,compose:vd,concat:ns,concatLimit:jn,concatSeries:is,constant:md,default:H_,detect:ss,detectLimit:os,detectSeries:as,dir:bd,doDuring:fi,doUntil:_d,doWhilst:fi,during:pi,each:ls,eachLimit:hi,eachOf:ze,eachOfLimit:Dn,eachOfSeries:cr,eachSeries:di,ensureAsync:kl,every:us,everyLimit:cs,everySeries:fs,filter:hs,filterLimit:ds,filterSeries:ps,find:ss,findLimit:os,findSeries:as,flatMap:ns,flatMapLimit:jn,flatMapSeries:is,foldl:Yr,foldr:gs,forEach:ls,forEachLimit:hi,forEachOf:ze,forEachOfLimit:Dn,forEachOfSeries:cr,forEachSeries:di,forever:Ad,groupBy:Od,groupByLimit:ks,groupBySeries:Sd,inject:Yr,log:wd,map:Ms,mapLimit:Ri,mapSeries:Pl,mapValues:Td,mapValuesLimit:Bs,mapValuesSeries:Rd,memoize:Nd,nextTick:Ld,parallel:Cd,parallelLimit:xd,priorityQueue:Id,queue:Fl,race:qd,reduce:Yr,reduceRight:gs,reflect:vs,reflectAll:Pd,reject:Dd,rejectLimit:Md,rejectSeries:jd,retry:ms,retryable:Fd,select:hs,selectLimit:ds,selectSeries:ps,seq:jl,series:$d,setImmediate:Kr,some:ys,someLimit:bs,someSeries:_s,sortBy:Ud,timeout:Hd,times:zd,timesLimit:Fs,timesSeries:Vd,transform:Gd,tryEach:Wd,unmemoize:Kd,until:Yd,waterfall:Xd,whilst:pi,wrapSync:ci},Symbol.toStringTag,{value:"Module"})),V_=By(z_);var Aa={exports:{}},yf;function G_(){if(yf)return Aa.exports;yf=1;var r=Aa.exports=function(t,e){if(e||(e=16),t===void 0&&(t=128),t<=0)return"0";for(var n=Math.log(Math.pow(2,t))/Math.log(e),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,t/i))/Math.log(e)*i;for(var s=n-Math.floor(n),l="",i=0;i<Math.floor(n);i++){var u=Math.floor(Math.random()*e).toString(e);l=u+l}if(s){var a=Math.pow(e,s),u=Math.floor(Math.random()*a).toString(e);l=u+l}var o=parseInt(l,e);return o!==1/0&&o>=Math.pow(2,t)?r(t,e):l};return r.rack=function(t,e,n){var i=function(l){var u=0;do{if(u++>10)if(n)t+=n;else throw new Error("too many ID collisions, use more bits");var a=r(t,e)}while(Object.hasOwnProperty.call(s,a));return s[a]=l,a},s=i.hats={};return i.get=function(l){return i.hats[l]},i.set=function(l,u){return i.hats[l]=u,i},i.bits=t||128,i.base=e||16,i},Aa.exports}var Oa,bf;function Zd(){if(bf)return Oa;bf=1;var r=Bn(),t=nd(),e=id(),n=pr(),i=V_,s=G_(),l=dn().ACTIONS;Oa=u;function u(a,o){if(r.EventEmitter.call(this),!o||typeof o!="string")throw new Error("Presence channel must be provided");this.connection=a,this.channel=o,this.wantSubscribe=!1,this.subscribed=!1,this.remotePresences=Object.create(null),this.localPresences=Object.create(null),this._remotePresenceInstances=Object.create(null),this._subscriptionCallbacksBySeq=Object.create(null),this._wantsDestroy=!1}return r.mixin(u),u.prototype.subscribe=function(a){this._sendSubscriptionAction(!0,a)},u.prototype.unsubscribe=function(a){this._sendSubscriptionAction(!1,a)},u.prototype.create=function(a){if(this._wantsDestroy)throw new Error("Presence is being destroyed");a=a||s();var o=this._createLocalPresence(a);return this.localPresences[a]=o,o},u.prototype.destroy=function(a){this._wantsDestroy=!0;var o=this,c=Object.keys(o.localPresences);this.unsubscribe(function(v){if(v)return o._callbackOrEmit(v,a);var p=Object.keys(o._remotePresenceInstances);i.parallel([function(d){i.each(c,function(y,A){var O=o.localPresences[y];if(!O)return A();O.destroy(A)},d)},function(d){if(!o._wantsDestroy)return d();i.each(p,function(y,A){o._remotePresenceInstances[y].destroy(A)},d)}],function(d){o._wantsDestroy&&delete o.connection._presences[o.channel],o._callbackOrEmit(d,a)})})},u.prototype._sendSubscriptionAction=function(a,o){if(a=!!a,a===this.wantSubscribe){if(!o)return;if(a===this.subscribed)return n.nextTick(o);if(Object.keys(this._subscriptionCallbacksBySeq).length)return this._combineSubscribeCallbackWithLastAdded(o)}this.wantSubscribe=a;var c=this.wantSubscribe?l.presenceSubscribe:l.presenceUnsubscribe,v=this.connection._presenceSeq++;this._subscriptionCallbacksBySeq[v]=o,this.connection.canSend&&this.connection._sendPresenceAction(c,v,this)},u.prototype._requestRemotePresence=function(){this.connection._requestRemotePresence(this.channel)},u.prototype._handleSubscribe=function(a,o){this.wantSubscribe&&(this.subscribed=!0);var c=this._subscriptionCallback(o);this._callbackOrEmit(a,c)},u.prototype._handleUnsubscribe=function(a,o){this.subscribed=!1;var c=this._subscriptionCallback(o);this._callbackOrEmit(a,c)},u.prototype._receiveUpdate=function(a,o){var c=n.dig(this.localPresences,o.id);if(c)return c._ack(a,o.pv);if(a)return this.emit("error",a);var v=this,p=n.digOrCreate(this._remotePresenceInstances,o.id,function(){return v._createRemotePresence(o.id)});p.receiveUpdate(o)},u.prototype._updateRemotePresence=function(a){this.remotePresences[a.presenceId]=a.value,a.value===null&&this._removeRemotePresence(a.presenceId),this.emit("receive",a.presenceId,a.value)},u.prototype._broadcastAllLocalPresence=function(a){if(a)return this.emit("error",a);for(var o in this.localPresences){var c=this.localPresences[o];c.value!==null&&c.send()}},u.prototype._removeRemotePresence=function(a){this._remotePresenceInstances[a].destroy(),delete this._remotePresenceInstances[a],delete this.remotePresences[a]},u.prototype._onConnectionStateChanged=function(){if(!this.connection.canSend){this.subscribed=!1;return}this._resubscribe();for(var a in this.localPresences)this.localPresences[a]._sendPending()},u.prototype._resubscribe=function(){var a=[];for(var o in this._subscriptionCallbacksBySeq){var c=this._subscriptionCallback(o);a.push(c)}if(!this.wantSubscribe)return this._callEachOrEmit(a);var v=this;this.subscribe(function(p){v._callEachOrEmit(a,p)})},u.prototype._subscriptionCallback=function(a){var o=this._subscriptionCallbacksBySeq[a];return delete this._subscriptionCallbacksBySeq[a],o},u.prototype._callbackOrEmit=function(a,o){if(o)return n.nextTick(o,a);a&&this.emit("error",a)},u.prototype._createLocalPresence=function(a){return new t(this,a)},u.prototype._createRemotePresence=function(a){return new e(this,a)},u.prototype._callEachOrEmit=function(a,o){var c=n.callEach(a,o);!c&&o&&this.emit("error",o)},u.prototype._combineSubscribeCallbackWithLastAdded=function(a){var o=Object.keys(this._subscriptionCallbacksBySeq),c=o[o.length-1],v=this._subscriptionCallbacksBySeq[c];if(!v)return this._subscriptionCallbacksBySeq[c]=a;this._subscriptionCallbacksBySeq[c]=function(p){v(p),a(p)}},Oa}var Sa,_f;function W_(){if(_f)return Sa;_f=1;var r=nd(),t=Ei(),e=pr(),n=t.CODES;Sa=i;function i(s,l){r.call(this,s,l),this.collection=this.presence.collection,this.id=this.presence.id,this._doc=this.connection.get(this.collection,this.id),this._emitter=this.connection._docPresenceEmitter,this._isSending=!1,this._docDataVersionByPresenceVersion=Object.create(null),this._opHandler=this._transformAgainstOp.bind(this),this._createOrDelHandler=this._handleCreateOrDel.bind(this),this._loadHandler=this._handleLoad.bind(this),this._destroyHandler=this.destroy.bind(this),this._registerWithDoc()}return i.prototype=Object.create(r.prototype),i.prototype.submit=function(s,l){if(!this._doc.type){if(s===null)return this._callbackOrEmit(null,l);var u=null;return this._doc._isInHardRollback?u={code:n.ERR_DOC_IN_HARD_ROLLBACK,message:"Cannot submit presence. Document is processing hard rollback"}:u={code:n.ERR_DOC_DOES_NOT_EXIST,message:"Cannot submit presence. Document has not been created"},this._callbackOrEmit(u,l)}this._docDataVersionByPresenceVersion[this.presenceVersion]=this._doc._dataStateVersion,r.prototype.submit.call(this,s,l)},i.prototype.destroy=function(s){this._emitter.removeEventListener(this._doc,"op",this._opHandler),this._emitter.removeEventListener(this._doc,"create",this._createOrDelHandler),this._emitter.removeEventListener(this._doc,"del",this._createOrDelHandler),this._emitter.removeEventListener(this._doc,"load",this._loadHandler),this._emitter.removeEventListener(this._doc,"destroy",this._destroyHandler),r.prototype.destroy.call(this,s)},i.prototype._sendPending=function(){if(!this._isSending){this._isSending=!0;var s=this;this._doc.whenNothingPending(function(){s._isSending=!1,s.connection.canSend&&(s._pendingMessages.forEach(function(l){l.t=s._doc.type.uri,l.v=s._doc.version,s.connection.send(l)}),s._pendingMessages=[],s._docDataVersionByPresenceVersion=Object.create(null))})}},i.prototype._registerWithDoc=function(){this._emitter.addEventListener(this._doc,"op",this._opHandler),this._emitter.addEventListener(this._doc,"create",this._createOrDelHandler),this._emitter.addEventListener(this._doc,"del",this._createOrDelHandler),this._emitter.addEventListener(this._doc,"load",this._loadHandler),this._emitter.addEventListener(this._doc,"destroy",this._destroyHandler)},i.prototype._transformAgainstOp=function(s,l){var u=this,a=this._doc._dataStateVersion;this._pendingMessages.forEach(function(o){var c=u._docDataVersionByPresenceVersion[o.pv];if(!(c>=a))try{o.p=u._transformPresence(o.p,s,l),u._docDataVersionByPresenceVersion[o.pv]=a}catch(p){var v=u._getCallback(o.pv);u._callbackOrEmit(p,v)}});try{this.value=this._transformPresence(this.value,s,l)}catch(o){this.emit("error",o)}},i.prototype._handleCreateOrDel=function(){this._pendingMessages.forEach(function(s){s.p=null}),this.value=null},i.prototype._handleLoad=function(){this.value=null,this._pendingMessages=[],this._docDataVersionByPresenceVersion=Object.create(null)},i.prototype._message=function(){var s=r.prototype._message.call(this);return s.c=this.collection,s.d=this.id,s.v=null,s.t=null,s},i.prototype._transformPresence=function(s,l,u){var a=this._doc.type;if(!e.supportsPresence(a))throw new t(n.ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE,"Type does not support presence: "+a.name);return a.transformPresence(s,l,u)},Sa}var wa={},Ef;function K_(){return Ef||(Ef=1,(function(r){var t=xs(),e=Ei(),n=pr(),i=e.CODES;r.checkOp=function(u){if(u==null||typeof u!="object")return new e(i.ERR_OT_OP_BADLY_FORMED,"Op must be an object");if(u.create!=null){if(typeof u.create!="object")return new e(i.ERR_OT_OP_BADLY_FORMED,"Create data must be an object");var a=u.create.type;if(typeof a!="string")return new e(i.ERR_OT_OP_BADLY_FORMED,"Missing create type");var o=t.map[a];if(o==null||typeof o!="object")return new e(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type")}else if(u.del!=null){if(u.del!==!0)return new e(i.ERR_OT_OP_BADLY_FORMED,"del value must be true")}else if(!("op"in u))return new e(i.ERR_OT_OP_BADLY_FORMED,"Missing op, create, or del");if(u.src!=null&&typeof u.src!="string")return new e(i.ERR_OT_OP_BADLY_FORMED,"src must be a string");if(u.seq!=null&&typeof u.seq!="number")return new e(i.ERR_OT_OP_BADLY_FORMED,"seq must be a number");if(u.src==null&&u.seq!=null||u.src!=null&&u.seq==null)return new e(i.ERR_OT_OP_BADLY_FORMED,"Both src and seq must be set together");if(u.m!=null&&typeof u.m!="object")return new e(i.ERR_OT_OP_BADLY_FORMED,"op.m must be an object or null")},r.normalizeType=function(u){return t.map[u]&&t.map[u].uri},r.apply=function(u,a){if(typeof u!="object")return new e(i.ERR_APPLY_SNAPSHOT_NOT_PROVIDED,"Missing snapshot");if(u.v!=null&&a.v!=null&&u.v!==a.v)return new e(i.ERR_APPLY_OP_VERSION_DOES_NOT_MATCH_SNAPSHOT,"Version mismatch");if(a.create){if(u.type)return new e(i.ERR_DOC_ALREADY_CREATED,"Document already exists");var o=a.create,c=t.map[o.type];if(!c)return new e(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type");try{u.data=c.create(o.data),u.type=c.uri,u.v++}catch(p){return p}}else if(a.del)u.data=void 0,u.type=null,u.v++;else if("op"in a){var v=s(u,a.op);if(v)return v;u.v++}else u.v++};function s(u,a){if(!u.type)return new e(i.ERR_DOC_DOES_NOT_EXIST,"Document does not exist");if(a===void 0)return new e(i.ERR_OT_OP_NOT_PROVIDED,"Missing op");var o=t.map[u.type];if(!o)return new e(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type");if(o.name==="json0"&&Array.isArray(a))for(var c=0;c<a.length;c++){var v=a[c];if(Array.isArray(v.p))for(var p=0;p<v.p.length;p++){var d=v.p[p];if(n.isDangerousProperty(d))return new e(i.ERR_OT_OP_NOT_APPLIED,"Invalid path segment")}}try{u.data=o.apply(u.data,a)}catch(y){return new e(i.ERR_OT_OP_NOT_APPLIED,y.message)}}r.transform=function(u,a,o){if(a.v!=null&&a.v!==o.v)return new e(i.ERR_OP_VERSION_MISMATCH_DURING_TRANSFORM,"Version mismatch");if(o.del){if(a.create||"op"in a)return new e(i.ERR_DOC_WAS_DELETED,"Document was deleted")}else{if(o.create&&("op"in a||a.create||a.del)||"op"in o&&a.create)return new e(i.ERR_DOC_ALREADY_CREATED,"Document was created remotely");if("op"in o&&"op"in a){if(!u)return new e(i.ERR_DOC_DOES_NOT_EXIST,"Document does not exist");if(typeof u=="string"&&(u=t.map[u],!u))return new e(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type");try{a.op=u.transform(a.op,o.op,"left")}catch(c){return c}}}a.v!=null&&a.v++},r.applyOps=function(u,a,o){o=o||{};for(var c=0;c<a.length;c++){var v=a[c];if(o._normalizeLegacyJson0Ops)try{l(u,v)}catch{return new e(i.ERR_OT_LEGACY_JSON0_OP_CANNOT_BE_NORMALIZED,"Cannot normalize legacy json0 op")}u.v=v.v;var p=r.apply(u,v);if(p)return p}},r.transformPresence=function(u,a,o){var c=this.checkOp(a);if(c)return c;var v=u.t;if(typeof v=="string"&&(v=t.map[v]),!v)return{code:i.ERR_DOC_TYPE_NOT_RECOGNIZED,message:"Unknown type"};if(!n.supportsPresence(v))return{code:i.ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE,message:"Type does not support presence"};if(a.create||a.del){u.p=null,u.v++;return}try{u.p=u.p===null?null:v.transformPresence(u.p,a.op,o)}catch(p){return{code:i.ERR_PRESENCE_TRANSFORM_FAILED,message:p.message||p}}u.v++};function l(u,a){if(u.type===t.defaultType.uri){var o=a.op;if(o){var c=u.data;o.length>1&&(c=n.clone(c));for(var v=0;v<o.length;v++){var p=o[v];typeof p.lm=="string"&&(p.lm=+p.lm);for(var d=p.p,y=c,A=0;A<d.length;A++){var O=d[A];Object.prototype.toString.call(y)=="[object Array]"?d[A]=+O:y.constructor===Object&&(d[A]=O.toString()),y=y[O]}v<o.length-1&&(c=t.defaultType.apply(c,[p]))}}}}})(wa)),wa}var Ta,Af;function Y_(){if(Af)return Ta;Af=1;var r=id(),t=K_();Ta=e;function e(n,i){r.call(this,n,i),this.collection=this.presence.collection,this.id=this.presence.id,this.src=null,this.presenceVersion=null,this._doc=this.connection.get(this.collection,this.id),this._emitter=this.connection._docPresenceEmitter,this._pending=null,this._opCache=null,this._pendingSetPending=!1,this._opHandler=this._handleOp.bind(this),this._createDelHandler=this._handleCreateDel.bind(this),this._loadHandler=this._handleLoad.bind(this),this._registerWithDoc()}return e.prototype=Object.create(r.prototype),e.prototype.receiveUpdate=function(n){this._pending&&n.pv<this._pending.pv||(this.src=n.src,this._pending=n,this._setPendingPresence())},e.prototype.destroy=function(n){this._emitter.removeEventListener(this._doc,"op",this._opHandler),this._emitter.removeEventListener(this._doc,"create",this._createDelHandler),this._emitter.removeEventListener(this._doc,"del",this._createDelHandler),this._emitter.removeEventListener(this._doc,"load",this._loadHandler),r.prototype.destroy.call(this,n)},e.prototype._registerWithDoc=function(){this._emitter.addEventListener(this._doc,"op",this._opHandler),this._emitter.addEventListener(this._doc,"create",this._createDelHandler),this._emitter.addEventListener(this._doc,"del",this._createDelHandler),this._emitter.addEventListener(this._doc,"load",this._loadHandler)},e.prototype._setPendingPresence=function(){if(!this._pendingSetPending){this._pendingSetPending=!0;var n=this;this._doc.whenNothingPending(function(){if(n._pendingSetPending=!1,!!n._pending){if(n._pending.pv<n.presenceVersion)return n._pending=null;if(n._pending.v>n._doc.version)return n._doc.fetch();n._catchUpStalePresence()&&(n.value=n._pending.p,n.presenceVersion=n._pending.pv,n._pending=null,n.presence._updateRemotePresence(n))}})}},e.prototype._handleOp=function(n,i,s){var l=s===this.src;this._transformAgainstOp(n,l),this._cacheOp(n,l),this._setPendingPresence()},r.prototype._handleCreateDel=function(){this._cacheOp(null),this._setPendingPresence()},r.prototype._handleLoad=function(){this.value=null,this._pending=null,this._opCache=null,this.presence._updateRemotePresence(this)},e.prototype._transformAgainstOp=function(n,i){if(this.value){try{this.value=this._doc.type.transformPresence(this.value,n,i)}catch(s){return this.presence.emit("error",s)}this.presence._updateRemotePresence(this)}},e.prototype._catchUpStalePresence=function(){if(this._pending.v>=this._doc.version)return!0;if(!this._opCache)return this._startCachingOps(),this._doc.fetch(),this.presence._requestRemotePresence(),!1;for(;this._opCache[this._pending.v];){var n=this._opCache[this._pending.v],i=n.op,s=n.isOwnOp;i===null?(this._pending.p=null,this._pending.v++):t.transformPresence(this._pending,i,s)}var l=this._pending.v>=this._doc.version;return l&&this._stopCachingOps(),l},e.prototype._startCachingOps=function(){this._opCache=[]},e.prototype._stopCachingOps=function(){this._opCache=null},e.prototype._cacheOp=function(n,i){this._opCache&&(n=n?{op:n}:null,this._opCache[this._doc.version-1]={op:n,isOwnOp:i})},Ta}var Ra,Of;function X_(){if(Of)return Ra;Of=1;var r=Zd(),t=W_(),e=Y_();function n(i,s,l){var u=n.channel(s,l);r.call(this,i,u),this.collection=s,this.id=l}return Ra=n,n.prototype=Object.create(r.prototype),n.channel=function(i,s){return i+"."+s},n.prototype._createLocalPresence=function(i){return new t(this,i)},n.prototype._createRemotePresence=function(i){return new e(this,i)},Ra}var Na,Sf;function Z_(){if(Sf)return Na;Sf=1,Na=r;function r(t,e,n,i,s){this.id=t,this.v=e,this.type=n,this.data=i,this.m=s}return Na}var La,wf;function Jd(){if(wf)return La;wf=1;var r=Z_(),t=Bn();La=e;function e(n,i,s,l,u){if(t.EventEmitter.call(this),typeof u!="function")throw new Error("Callback is required for SnapshotRequest");this.requestId=i,this.connection=n,this.id=l,this.collection=s,this.callback=u,this.sent=!1}return t.mixin(e),e.prototype.send=function(){this.connection.canSend&&(this.connection.send(this._message()),this.sent=!0)},e.prototype._onConnectionStateChanged=function(){this.connection.canSend?this.sent||this.send():this.sent=!1},e.prototype._handleResponse=function(n,i){if(this.emit("ready"),n)return this.callback(n);var s=i.meta?i.meta:null,l=new r(this.id,i.v,i.type,i.data,s);this.callback(null,l)},La}var Ca,Tf;function J_(){if(Tf)return Ca;Tf=1;var r=Jd(),t=pr(),e=dn().ACTIONS;Ca=n;function n(i,s,l,u,a,o){if(r.call(this,i,s,l,u,o),!t.isValidVersion(a))throw new Error("Snapshot version must be a positive integer or null");this.version=a}return n.prototype=Object.create(r.prototype),n.prototype._message=function(){return{a:e.snapshotFetch,id:this.requestId,c:this.collection,d:this.id,v:this.version}},Ca}var xa,Rf;function Q_(){if(Rf)return xa;Rf=1;var r=Jd(),t=pr(),e=dn().ACTIONS;xa=n;function n(i,s,l,u,a,o){if(r.call(this,i,s,l,u,o),!t.isValidTimestamp(a))throw new Error("Snapshot timestamp must be a positive integer or null");this.timestamp=a}return n.prototype=Object.create(r.prototype),n.prototype._message=function(){return{a:e.snapshotFetchByTimestamp,id:this.requestId,c:this.collection,d:this.id,ts:this.timestamp}},xa}var Ia,Nf;function tE(){if(Nf)return Ia;Nf=1;var r=pr(),t=Hh().EventEmitter,e=["create","del","destroy","load","op"];Ia=n;function n(){this._docs=Object.create(null),this._forwarders=Object.create(null),this._emitters=Object.create(null)}return n.prototype.addEventListener=function(i,s,l){this._registerDoc(i);var u=r.dig(this._emitters,i.collection,i.id);u.on(s,l)},n.prototype.removeEventListener=function(i,s,l){var u=r.dig(this._emitters,i.collection,i.id);u&&(u.off(s,l),u._eventsCount===1&&this._unregisterDoc(i))},n.prototype._registerDoc=function(i){var s=!0;if(r.digOrCreate(this._docs,i.collection,i.id,function(){return s=!1,i}),!s){var l=r.digOrCreate(this._emitters,i.collection,i.id,function(){var a=new t;return a.setMaxListeners(1e3),a}),u=this;e.forEach(function(a){var o=r.digOrCreate(u._forwarders,i.collection,i.id,a,function(){return l.emit.bind(l,a)});i.on(a,o)}),this.addEventListener(i,"destroy",this._unregisterDoc.bind(this,i))}},n.prototype._unregisterDoc=function(i){var s=r.dig(this._forwarders,i.collection,i.id);for(var l in s)i.off(l,s[l]);var u=r.dig(this._emitters,i.collection,i.id);u.removeAllListeners(),r.digAndRemove(this._forwarders,i.collection,i.id),r.digAndRemove(this._emitters,i.collection,i.id),r.digAndRemove(this._docs,i.collection,i.id)},Ia}var qa,Lf;function eE(){if(Lf)return qa;Lf=1,qa={major:1,minor:2,checkAtLeast:r};function r(e,n){return e=t(e),n=t(n),e.major>n.major?!0:e.major===n.major&&e.minor>=n.minor}function t(e){if(typeof e=="string"){var n=e.split(".");e={major:n[0],minor:n[1]}}return{major:+(e.protocol||e.major||0),minor:+(e.protocolMinor||e.minor||0)}}return qa}var Pa,Cf;function rE(){if(Cf)return Pa;Cf=1;var r=ed(),t=rd(),e=Zd(),n=X_(),i=J_(),s=Q_(),l=Bn(),u=Ei(),a=dn().ACTIONS,o=xs(),c=pr(),v=Nl(),p=tE(),d=eE(),y=u.CODES;function A(f){return f.readyState===0||f.readyState===1?"connecting":"disconnected"}Pa=O;function O(f){l.EventEmitter.call(this),this.collections=Object.create(null),this.nextQueryId=1,this.nextSnapshotRequestId=1,this.queries=Object.create(null),this._presences=Object.create(null),this._docPresenceEmitter=new p,this._snapshotRequests=Object.create(null),this.seq=1,this._presenceSeq=1,this.id=null,this.agent=null,this.debug=!1,this.state=A(f),this.bindToSocket(f)}l.mixin(O),O.prototype.bindToSocket=function(f){this.socket&&(this.socket.close(),this.socket.onmessage=null,this.socket.onopen=null,this.socket.onerror=null,this.socket.onclose=null),this.socket=f;var g=A(f);this._setState(g),this.canSend=!1;var b=this;f.onmessage=function(S){try{var N=typeof S.data=="string"?JSON.parse(S.data):S.data}catch{v.warn("Failed to parse message",S);return}b.debug&&v.info("RECV",JSON.stringify(N));var C={data:N};if(b.emit("receive",C),!!C.data)try{b.handleMessage(C.data)}catch(P){c.nextTick(function(){b.emit("error",P)})}},f.readyState===1&&b._initializeHandshake(),f.onopen=function(){b._setState("connecting"),b._initializeHandshake()},f.onerror=function(S){b.emit("connection error",S)},f.onclose=function(S){S==="closed"||S==="Closed"?b._setState("closed",S):S==="stopped"||S==="Stopped by server"?b._setState("stopped",S):b._setState("disconnected",S)}},O.prototype.handleMessage=function(f){var g=null;switch(f.error&&(g=E(f.error,f),delete f.error),f.a){case a.initLegacy:return this._handleLegacyInit(f);case a.handshake:return this._handleHandshake(g,f);case a.queryFetch:var b=this.queries[f.id];b&&b._handleFetch(g,f.data,f.extra);return;case a.querySubscribe:var b=this.queries[f.id];b&&b._handleSubscribe(g,f.data,f.extra);return;case a.queryUnsubscribe:return;case a.queryUpdate:var b=this.queries[f.id];if(!b)return;if(g)return b._handleError(g);f.diff&&b._handleDiff(f.diff),c.hasOwn(f,"extra")&&b._handleExtra(f.extra);return;case a.bulkFetch:return this._handleBulkMessage(g,f,"_handleFetch");case a.bulkSubscribe:case a.bulkUnsubscribe:return this._handleBulkMessage(g,f,"_handleSubscribe");case a.snapshotFetch:case a.snapshotFetchByTimestamp:return this._handleSnapshotFetch(g,f);case a.fetch:var S=this.getExisting(f.c,f.d);S&&S._handleFetch(g,f.data);return;case a.subscribe:case a.unsubscribe:var S=this.getExisting(f.c,f.d);S&&S._handleSubscribe(g,f.data);return;case a.op:var S=this.getExisting(f.c,f.d);S&&S._handleOp(g,f);return;case a.presence:return this._handlePresence(g,f);case a.presenceSubscribe:return this._handlePresenceSubscribe(g,f);case a.presenceUnsubscribe:return this._handlePresenceUnsubscribe(g,f);case a.presenceRequest:return this._handlePresenceRequest(g,f);case a.pingPong:return this._handlePingPong(g);default:v.warn("Ignoring unrecognized message",f)}};function E(f,g){var b=new Error(f.message);return b.code=f.code,g&&(b.data=g),b}O.prototype._handleBulkMessage=function(f,g,b){if(g.data)for(var S in g.data){var N=g.data[S],C=this.getExisting(g.c,S);C&&(f?C[b](f):N.error?C[b](E(N.error)):C[b](null,N))}else if(Array.isArray(g.b))for(var P=0;P<g.b.length;P++){var S=g.b[P],C=this.getExisting(g.c,S);C&&C[b](f)}else if(g.b)for(var S in g.b){var C=this.getExisting(g.c,S);C&&C[b](f)}else v.error("Invalid bulk message",g)},O.prototype._reset=function(){this.agent=null},O.prototype._setState=function(f,g){if(this.state!==f){if(f==="connecting"&&this.state!=="disconnected"&&this.state!=="stopped"&&this.state!=="closed"||f==="connected"&&this.state!=="connecting"){var b=new u(y.ERR_CONNECTION_STATE_TRANSITION_INVALID,"Cannot transition directly from "+this.state+" to "+f);return this.emit("error",b)}this.state=f,this.canSend=f==="connected",(f==="disconnected"||f==="stopped"||f==="closed")&&this._reset(),this.startBulk();for(var S in this.queries){var N=this.queries[S];N._onConnectionStateChanged()}for(var C in this.collections){var P=this.collections[C];for(var S in P)P[S]._onConnectionStateChanged()}for(var w in this._presences)this._presences[w]._onConnectionStateChanged();for(var S in this._snapshotRequests){var M=this._snapshotRequests[S];M._onConnectionStateChanged()}this.endBulk(),this.emit(f,g),this.emit("state",f,g)}},O.prototype.startBulk=function(){this.bulk||(this.bulk=Object.create(null))},O.prototype.endBulk=function(){if(this.bulk)for(var f in this.bulk){var g=this.bulk[f];this._sendBulk("f",f,g.f),this._sendBulk("s",f,g.s),this._sendBulk("u",f,g.u)}this.bulk=null},O.prototype._sendBulk=function(f,g,b){if(b){var S=[],N=Object.create(null),C=0,P;for(var w in b){var M=b[w];M==null?S.push(w):(N[w]=M,P=w,C++)}if(S.length===1){var w=S[0];this.send({a:f,c:g,d:w})}else S.length&&this.send({a:"b"+f,c:g,b:S});if(C===1){var R=N[P];this.send({a:f,c:g,d:P,v:R})}else C&&this.send({a:"b"+f,c:g,b:N})}},O.prototype._sendActions=function(f,g,b){if(this._addDoc(g),this.bulk){var S=this.bulk[g.collection]||(this.bulk[g.collection]=Object.create(null)),N=S[f]||(S[f]=Object.create(null)),C=c.hasOwn(N,g.id);return N[g.id]=b,C}else{var P={a:f,c:g.collection,d:g.id,v:b};this.send(P)}},O.prototype.sendFetch=function(f){return this._sendActions(a.fetch,f,f.version)},O.prototype.sendSubscribe=function(f){return this._sendActions(a.subscribe,f,f.version)},O.prototype.sendUnsubscribe=function(f){return this._sendActions(a.unsubscribe,f)},O.prototype.sendOp=function(f,g){this._addDoc(f);var b={a:a.op,c:f.collection,d:f.id,v:f.version,src:g.src,seq:g.seq,x:{}};"op"in g&&(b.op=g.op),g.create&&(b.create=g.create),g.del&&(b.del=g.del),f.submitSource&&(b.x.source=g.source),this.send(b)},O.prototype.send=function(f){this.debug&&v.info("SEND",JSON.stringify(f)),this.emit("send",f),this.socket.send(JSON.stringify(f))},O.prototype.ping=function(){if(!this.canSend)throw new u(y.ERR_CANNOT_PING_OFFLINE,"Socket must be CONNECTED to ping");var f={a:a.pingPong};this.send(f)},O.prototype.close=function(){this.socket.close()},O.prototype.getExisting=function(f,g){if(this.collections[f])return this.collections[f][g]},O.prototype.get=function(f,g){var b=this.collections[f]||(this.collections[f]=Object.create(null)),S=b[g];return S||(S=b[g]=new r(this,f,g),this.emit("doc",S)),S._wantsDestroy=!1,S},O.prototype._destroyDoc=function(f){f._wantsDestroy&&(c.digAndRemove(this.collections,f.collection,f.id),f.emit("destroy"))},O.prototype._addDoc=function(f){var g=this.collections[f.collection];g||(g=this.collections[f.collection]=Object.create(null)),g[f.id]!==f&&(g[f.id]=f)},O.prototype._createQuery=function(f,g,b,S,N){var C=this.nextQueryId++,P=new t(f,this,C,g,b,S,N);return this.queries[C]=P,P.send(),P},O.prototype._destroyQuery=function(f){delete this.queries[f.id]},O.prototype.createFetchQuery=function(f,g,b,S){return this._createQuery(a.queryFetch,f,g,b,S)},O.prototype.createSubscribeQuery=function(f,g,b,S){return this._createQuery(a.querySubscribe,f,g,b,S)},O.prototype.hasPending=function(){return!!(this._firstDoc(_)||this._firstQuery(_)||this._firstSnapshotRequest())};function _(f){return f.hasPending()}O.prototype.hasWritePending=function(){return!!this._firstDoc(h)};function h(f){return f.hasWritePending()}return O.prototype.whenNothingPending=function(f){var g=this._firstDoc(_);if(g){g.once("nothing pending",this._nothingPendingRetry(f));return}var b=this._firstQuery(_);if(b){b.once("ready",this._nothingPendingRetry(f));return}var S=this._firstSnapshotRequest();if(S){S.once("ready",this._nothingPendingRetry(f));return}c.nextTick(f)},O.prototype._nothingPendingRetry=function(f){var g=this;return function(){c.nextTick(function(){g.whenNothingPending(f)})}},O.prototype._firstDoc=function(f){for(var g in this.collections){var b=this.collections[g];for(var S in b){var N=b[S];if(f(N))return N}}},O.prototype._firstQuery=function(f){for(var g in this.queries){var b=this.queries[g];if(f(b))return b}},O.prototype._firstSnapshotRequest=function(){for(var f in this._snapshotRequests)return this._snapshotRequests[f]},O.prototype.fetchSnapshot=function(f,g,b,S){typeof b=="function"&&(S=b,b=null);var N=this.nextSnapshotRequestId++,C=new i(this,N,f,g,b,S);this._snapshotRequests[C.requestId]=C,C.send()},O.prototype.fetchSnapshotByTimestamp=function(f,g,b,S){typeof b=="function"&&(S=b,b=null);var N=this.nextSnapshotRequestId++,C=new s(this,N,f,g,b,S);this._snapshotRequests[C.requestId]=C,C.send()},O.prototype._handleSnapshotFetch=function(f,g){var b=this._snapshotRequests[g.id];b&&(delete this._snapshotRequests[g.id],b._handleResponse(f,g))},O.prototype._handleLegacyInit=function(f){if(d.checkAtLeast(f,"1.1"))return this._initializeHandshake();this._initialize(f)},O.prototype._initializeHandshake=function(){this.send({a:a.handshake,id:this.id,protocol:d.major,protocolMinor:d.minor})},O.prototype._handleHandshake=function(f,g){if(f)return this.emit("error",f);this._initialize(g)},O.prototype._handlePingPong=function(f){if(f)return this.emit("error",f);this.emit("pong")},O.prototype._initialize=function(f){if(this.state==="connecting"){if(f.protocol!==d.major)return this.emit("error",new u(y.ERR_PROTOCOL_VERSION_NOT_SUPPORTED,"Unsupported protocol version: "+f.protocol));if(o.map[f.type]!==o.defaultType)return this.emit("error",new u(y.ERR_DEFAULT_TYPE_MISMATCH,f.type+" does not match the server default type"));if(typeof f.id!="string")return this.emit("error",new u(y.ERR_CLIENT_ID_BADLY_FORMED,"Client id must be a string"));this.id=f.id,this._setState("connected")}},O.prototype.getPresence=function(f){var g=this,b=c.digOrCreate(this._presences,f,function(){return new e(g,f)});return b._wantsDestroy=!1,b},O.prototype.getDocPresence=function(f,g){var b=n.channel(f,g),S=this,N=c.digOrCreate(this._presences,b,function(){return new n(S,f,g)});return N._wantsDestroy=!1,N},O.prototype._sendPresenceAction=function(f,g,b){this._addPresence(b);var S={a:f,ch:b.channel,seq:g};return this.send(S),S.seq},O.prototype._addPresence=function(f){c.digOrCreate(this._presences,f.channel,function(){return f})},O.prototype._requestRemotePresence=function(f){this.send({a:a.presenceRequest,ch:f})},O.prototype._handlePresenceSubscribe=function(f,g){var b=c.dig(this._presences,g.ch);b&&b._handleSubscribe(f,g.seq)},O.prototype._handlePresenceUnsubscribe=function(f,g){var b=c.dig(this._presences,g.ch);b&&b._handleUnsubscribe(f,g.seq)},O.prototype._handlePresence=function(f,g){var b=c.dig(this._presences,g.ch);b&&b._receiveUpdate(f,g)},O.prototype._handlePresenceRequest=function(f,g){var b=c.dig(this._presences,g.ch);b&&b._broadcastAllLocalPresence(f,g)},Pa}var xf;function nE(){return xf||(xf=1,Hr.Connection=rE(),Hr.Doc=ed(),Hr.Error=Ei(),Hr.Query=rd(),Hr.types=xs(),Hr.logger=Nl()),Hr}var iE=nE();const Qd=vi(iE);var Da,If;function sE(){if(If)return Da;If=1;var r=-1,t=1,e=0;function n(h,f,g,b){if(h===f)return h?[[e,h]]:[];if(g!=null){var S=E(h,f,g);if(S)return S}var N=u(h,f),C=h.substring(0,N);h=h.substring(N),f=f.substring(N),N=a(h,f);var P=h.substring(h.length-N);h=h.substring(0,h.length-N),f=f.substring(0,f.length-N);var w=i(h,f);return C&&w.unshift([e,C]),P&&w.push([e,P]),c(w,b),w}function i(h,f){var g;if(!h)return[[t,f]];if(!f)return[[r,h]];var b=h.length>f.length?h:f,S=h.length>f.length?f:h,N=b.indexOf(S);if(N!==-1)return g=[[t,b.substring(0,N)],[e,S],[t,b.substring(N+S.length)]],h.length>f.length&&(g[0][0]=g[2][0]=r),g;if(S.length===1)return[[r,h],[t,f]];var C=o(h,f);if(C){var P=C[0],w=C[1],M=C[2],R=C[3],I=C[4],D=n(P,M),x=n(w,R);return D.concat([[e,I]],x)}return s(h,f)}function s(h,f){for(var g=h.length,b=f.length,S=Math.ceil((g+b)/2),N=S,C=2*S,P=new Array(C),w=new Array(C),M=0;M<C;M++)P[M]=-1,w[M]=-1;P[N+1]=0,w[N+1]=0;for(var R=g-b,I=R%2!==0,D=0,x=0,$=0,V=0,Q=0;Q<S;Q++){for(var Y=-Q+D;Y<=Q-x;Y+=2){var st=N+Y,rt;Y===-Q||Y!==Q&&P[st-1]<P[st+1]?rt=P[st+1]:rt=P[st-1]+1;for(var L=rt-Y;rt<g&&L<b&&h.charAt(rt)===f.charAt(L);)rt++,L++;if(P[st]=rt,rt>g)x+=2;else if(L>b)D+=2;else if(I){var B=N+R-Y;if(B>=0&&B<C&&w[B]!==-1){var F=g-w[B];if(rt>=F)return l(h,f,rt,L)}}}for(var tt=-Q+$;tt<=Q-V;tt+=2){var B=N+tt,F;tt===-Q||tt!==Q&&w[B-1]<w[B+1]?F=w[B+1]:F=w[B-1]+1;for(var it=F-tt;F<g&&it<b&&h.charAt(g-F-1)===f.charAt(b-it-1);)F++,it++;if(w[B]=F,F>g)V+=2;else if(it>b)$+=2;else if(!I){var st=N+R-tt;if(st>=0&&st<C&&P[st]!==-1){var rt=P[st],L=N+rt-st;if(F=g-F,rt>=F)return l(h,f,rt,L)}}}}return[[r,h],[t,f]]}function l(h,f,g,b){var S=h.substring(0,g),N=f.substring(0,b),C=h.substring(g),P=f.substring(b),w=n(S,N),M=n(C,P);return w.concat(M)}function u(h,f){if(!h||!f||h.charAt(0)!==f.charAt(0))return 0;for(var g=0,b=Math.min(h.length,f.length),S=b,N=0;g<S;)h.substring(N,S)==f.substring(N,S)?(g=S,N=g):b=S,S=Math.floor((b-g)/2+g);return v(h.charCodeAt(S-1))&&S--,S}function a(h,f){if(!h||!f||h.slice(-1)!==f.slice(-1))return 0;for(var g=0,b=Math.min(h.length,f.length),S=b,N=0;g<S;)h.substring(h.length-S,h.length-N)==f.substring(f.length-S,f.length-N)?(g=S,N=g):b=S,S=Math.floor((b-g)/2+g);return p(h.charCodeAt(h.length-S))&&S--,S}function o(h,f){var g=h.length>f.length?h:f,b=h.length>f.length?f:h;if(g.length<4||b.length*2<g.length)return null;function S(x,$,V){for(var Q=x.substring(V,V+Math.floor(x.length/4)),Y=-1,st="",rt,L,B,F;(Y=$.indexOf(Q,Y+1))!==-1;){var tt=u(x.substring(V),$.substring(Y)),it=a(x.substring(0,V),$.substring(0,Y));st.length<it+tt&&(st=$.substring(Y-it,Y)+$.substring(Y,Y+tt),rt=x.substring(0,V-it),L=x.substring(V+tt),B=$.substring(0,Y-it),F=$.substring(Y+tt))}return st.length*2>=x.length?[rt,L,B,F,st]:null}var N=S(g,b,Math.ceil(g.length/4)),C=S(g,b,Math.ceil(g.length/2)),P;if(!N&&!C)return null;C?N?P=N[4].length>C[4].length?N:C:P=C:P=N;var w,M,R,I;h.length>f.length?(w=P[0],M=P[1],R=P[2],I=P[3]):(R=P[0],I=P[1],w=P[2],M=P[3]);var D=P[4];return[w,M,R,I,D]}function c(h,f){h.push([e,""]);for(var g=0,b=0,S=0,N="",C="",P;g<h.length;){if(g<h.length-1&&!h[g][1]){h.splice(g,1);continue}switch(h[g][0]){case t:S++,C+=h[g][1],g++;break;case r:b++,N+=h[g][1],g++;break;case e:var w=g-S-b-1;if(f){if(w>=0&&y(h[w][1])){var M=h[w][1].slice(-1);if(h[w][1]=h[w][1].slice(0,-1),N=M+N,C=M+C,!h[w][1]){h.splice(w,1),g--;var R=w-1;h[R]&&h[R][0]===t&&(S++,C=h[R][1]+C,R--),h[R]&&h[R][0]===r&&(b++,N=h[R][1]+N,R--),w=R}}if(d(h[g][1])){var M=h[g][1].charAt(0);h[g][1]=h[g][1].slice(1),N+=M,C+=M}}if(g<h.length-1&&!h[g][1]){h.splice(g,1);break}if(N.length>0||C.length>0){N.length>0&&C.length>0&&(P=u(C,N),P!==0&&(w>=0?h[w][1]+=C.substring(0,P):(h.splice(0,0,[e,C.substring(0,P)]),g++),C=C.substring(P),N=N.substring(P)),P=a(C,N),P!==0&&(h[g][1]=C.substring(C.length-P)+h[g][1],C=C.substring(0,C.length-P),N=N.substring(0,N.length-P)));var I=S+b;N.length===0&&C.length===0?(h.splice(g-I,I),g=g-I):N.length===0?(h.splice(g-I,I,[t,C]),g=g-I+1):C.length===0?(h.splice(g-I,I,[r,N]),g=g-I+1):(h.splice(g-I,I,[r,N],[t,C]),g=g-I+2)}g!==0&&h[g-1][0]===e?(h[g-1][1]+=h[g][1],h.splice(g,1)):g++,S=0,b=0,N="",C="";break}}h[h.length-1][1]===""&&h.pop();var D=!1;for(g=1;g<h.length-1;)h[g-1][0]===e&&h[g+1][0]===e&&(h[g][1].substring(h[g][1].length-h[g-1][1].length)===h[g-1][1]?(h[g][1]=h[g-1][1]+h[g][1].substring(0,h[g][1].length-h[g-1][1].length),h[g+1][1]=h[g-1][1]+h[g+1][1],h.splice(g-1,1),D=!0):h[g][1].substring(0,h[g+1][1].length)==h[g+1][1]&&(h[g-1][1]+=h[g+1][1],h[g][1]=h[g][1].substring(h[g+1][1].length)+h[g+1][1],h.splice(g+1,1),D=!0)),g++;D&&c(h,f)}function v(h){return h>=55296&&h<=56319}function p(h){return h>=56320&&h<=57343}function d(h){return p(h.charCodeAt(0))}function y(h){return v(h.charCodeAt(h.length-1))}function A(h){for(var f=[],g=0;g<h.length;g++)h[g][1].length>0&&f.push(h[g]);return f}function O(h,f,g,b){return y(h)||d(b)?null:A([[e,h],[r,f],[t,g],[e,b]])}function E(h,f,g){var b=typeof g=="number"?{index:g,length:0}:g.oldRange,S=typeof g=="number"?null:g.newRange,N=h.length,C=f.length;if(b.length===0&&(S===null||S.length===0)){var P=b.index,w=h.slice(0,P),M=h.slice(P),R=S?S.index:null;t:{var I=P+C-N;if(R!==null&&R!==I||I<0||I>C)break t;var D=f.slice(0,I),x=f.slice(I);if(x!==M)break t;var $=Math.min(P,I),V=w.slice(0,$),Q=D.slice(0,$);if(V!==Q)break t;var Y=w.slice($),st=D.slice($);return O(V,Y,st,M)}t:{if(R!==null&&R!==P)break t;var rt=P,D=f.slice(0,rt),x=f.slice(rt);if(D!==w)break t;var L=Math.min(N-rt,C-rt),B=M.slice(M.length-L),F=x.slice(x.length-L);if(B!==F)break t;var Y=M.slice(0,M.length-L),st=x.slice(0,x.length-L);return O(w,Y,st,B)}}if(b.length>0&&S&&S.length===0)t:{var V=h.slice(0,b.index),B=h.slice(b.index+b.length),$=V.length,L=B.length;if(C<$+L)break t;var Q=f.slice(0,$),F=f.slice(C-L);if(V!==Q||B!==F)break t;var Y=h.slice($,N-L),st=f.slice($,C-L);return O(V,Y,st,B)}return null}function _(h,f,g){return n(h,f,g,!0)}return _.INSERT=t,_.DELETE=r,_.EQUAL=e,Da=_,Da}var yn={},qf;function oE(){if(qf)return yn;qf=1;var r=yn&&yn.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(yn,"__esModule",{value:!0});var t=r(Ts()),e=r(Rs()),n;return(function(i){function s(o,c,v){o===void 0&&(o={}),c===void 0&&(c={}),typeof o!="object"&&(o={}),typeof c!="object"&&(c={});var p=t.default(c);v||(p=Object.keys(p).reduce(function(y,A){return p[A]!=null&&(y[A]=p[A]),y},{}));for(var d in o)o[d]!==void 0&&c[d]===void 0&&(p[d]=o[d]);return Object.keys(p).length>0?p:void 0}i.compose=s;function l(o,c){o===void 0&&(o={}),c===void 0&&(c={}),typeof o!="object"&&(o={}),typeof c!="object"&&(c={});var v=Object.keys(o).concat(Object.keys(c)).reduce(function(p,d){return e.default(o[d],c[d])||(p[d]=c[d]===void 0?null:c[d]),p},{});return Object.keys(v).length>0?v:void 0}i.diff=l;function u(o,c){o===void 0&&(o={}),c===void 0&&(c={}),o=o||{};var v=Object.keys(c).reduce(function(p,d){return c[d]!==o[d]&&o[d]!==void 0&&(p[d]=c[d]),p},{});return Object.keys(o).reduce(function(p,d){return o[d]!==c[d]&&c[d]===void 0&&(p[d]=null),p},v)}i.invert=u;function a(o,c,v){if(v===void 0&&(v=!1),typeof o!="object")return c;if(typeof c=="object"){if(!v)return c;var p=Object.keys(c).reduce(function(d,y){return o[y]===void 0&&(d[y]=c[y]),d},{});return Object.keys(p).length>0?p:void 0}}i.transform=a})(n||(n={})),yn.default=n,yn}var bn={},_n={},Pf;function aE(){if(Pf)return _n;Pf=1;var r=_n&&_n.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(_n,"__esModule",{value:!0});var t=r(tp()),e=(function(){function n(i){this.ops=i,this.index=0,this.offset=0}return n.prototype.hasNext=function(){return this.peekLength()<1/0},n.prototype.next=function(i){i||(i=1/0);var s=this.ops[this.index];if(s){var l=this.offset,u=t.default.length(s);if(i>=u-l?(i=u-l,this.index+=1,this.offset=0):this.offset+=i,typeof s.delete=="number")return{delete:i};var a={};return s.attributes&&(a.attributes=s.attributes),typeof s.retain=="number"?a.retain=i:typeof s.insert=="string"?a.insert=s.insert.substr(l,i):a.insert=s.insert,a}else return{retain:1/0}},n.prototype.peek=function(){return this.ops[this.index]},n.prototype.peekLength=function(){return this.ops[this.index]?t.default.length(this.ops[this.index])-this.offset:1/0},n.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},n.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var i=this.offset,s=this.index,l=this.next(),u=this.ops.slice(this.index);return this.offset=i,this.index=s,[l].concat(u)}else return[]},n})();return _n.default=e,_n}var Df;function tp(){if(Df)return bn;Df=1;var r=bn&&bn.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(bn,"__esModule",{value:!0});var t=r(aE()),e;return(function(n){function i(l){return new t.default(l)}n.iterator=i;function s(l){return typeof l.delete=="number"?l.delete:typeof l.retain=="number"?l.retain:typeof l.insert=="string"?l.insert.length:1}n.length=s})(e||(e={})),bn.default=e,bn}var Wn,Mf;function lE(){if(Mf)return Wn;Mf=1;var r=Wn&&Wn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},t=r(sE()),e=r(Ts()),n=r(Rs()),i=r(oE()),s=r(tp()),l="\0",u=(function(){function a(o){Array.isArray(o)?this.ops=o:o!=null&&Array.isArray(o.ops)?this.ops=o.ops:this.ops=[]}return a.prototype.insert=function(o,c){var v={};return typeof o=="string"&&o.length===0?this:(v.insert=o,c!=null&&typeof c=="object"&&Object.keys(c).length>0&&(v.attributes=c),this.push(v))},a.prototype.delete=function(o){return o<=0?this:this.push({delete:o})},a.prototype.retain=function(o,c){if(o<=0)return this;var v={retain:o};return c!=null&&typeof c=="object"&&Object.keys(c).length>0&&(v.attributes=c),this.push(v)},a.prototype.push=function(o){var c=this.ops.length,v=this.ops[c-1];if(o=e.default(o),typeof v=="object"){if(typeof o.delete=="number"&&typeof v.delete=="number")return this.ops[c-1]={delete:v.delete+o.delete},this;if(typeof v.delete=="number"&&o.insert!=null&&(c-=1,v=this.ops[c-1],typeof v!="object"))return this.ops.unshift(o),this;if(n.default(o.attributes,v.attributes)){if(typeof o.insert=="string"&&typeof v.insert=="string")return this.ops[c-1]={insert:v.insert+o.insert},typeof o.attributes=="object"&&(this.ops[c-1].attributes=o.attributes),this;if(typeof o.retain=="number"&&typeof v.retain=="number")return this.ops[c-1]={retain:v.retain+o.retain},typeof o.attributes=="object"&&(this.ops[c-1].attributes=o.attributes),this}}return c===this.ops.length?this.ops.push(o):this.ops.splice(c,0,o),this},a.prototype.chop=function(){var o=this.ops[this.ops.length-1];return o&&o.retain&&!o.attributes&&this.ops.pop(),this},a.prototype.filter=function(o){return this.ops.filter(o)},a.prototype.forEach=function(o){this.ops.forEach(o)},a.prototype.map=function(o){return this.ops.map(o)},a.prototype.partition=function(o){var c=[],v=[];return this.forEach(function(p){var d=o(p)?c:v;d.push(p)}),[c,v]},a.prototype.reduce=function(o,c){return this.ops.reduce(o,c)},a.prototype.changeLength=function(){return this.reduce(function(o,c){return c.insert?o+s.default.length(c):c.delete?o-c.delete:o},0)},a.prototype.length=function(){return this.reduce(function(o,c){return o+s.default.length(c)},0)},a.prototype.slice=function(o,c){o===void 0&&(o=0),c===void 0&&(c=1/0);for(var v=[],p=s.default.iterator(this.ops),d=0;d<c&&p.hasNext();){var y=void 0;d<o?y=p.next(o-d):(y=p.next(c-d),v.push(y)),d+=s.default.length(y)}return new a(v)},a.prototype.compose=function(o){var c=s.default.iterator(this.ops),v=s.default.iterator(o.ops),p=[],d=v.peek();if(d!=null&&typeof d.retain=="number"&&d.attributes==null){for(var y=d.retain;c.peekType()==="insert"&&c.peekLength()<=y;)y-=c.peekLength(),p.push(c.next());d.retain-y>0&&v.next(d.retain-y)}for(var A=new a(p);c.hasNext()||v.hasNext();)if(v.peekType()==="insert")A.push(v.next());else if(c.peekType()==="delete")A.push(c.next());else{var O=Math.min(c.peekLength(),v.peekLength()),E=c.next(O),_=v.next(O);if(typeof _.retain=="number"){var h={};typeof E.retain=="number"?h.retain=O:h.insert=E.insert;var f=i.default.compose(E.attributes,_.attributes,typeof E.retain=="number");if(f&&(h.attributes=f),A.push(h),!v.hasNext()&&n.default(A.ops[A.ops.length-1],h)){var g=new a(c.rest());return A.concat(g).chop()}}else typeof _.delete=="number"&&typeof E.retain=="number"&&A.push(_)}return A.chop()},a.prototype.concat=function(o){var c=new a(this.ops.slice());return o.ops.length>0&&(c.push(o.ops[0]),c.ops=c.ops.concat(o.ops.slice(1))),c},a.prototype.diff=function(o,c){if(this.ops===o.ops)return new a;var v=[this,o].map(function(O){return O.map(function(E){if(E.insert!=null)return typeof E.insert=="string"?E.insert:l;var _=O===o?"on":"with";throw new Error("diff() called "+_+" non-document")}).join("")}),p=new a,d=t.default(v[0],v[1],c),y=s.default.iterator(this.ops),A=s.default.iterator(o.ops);return d.forEach(function(O){for(var E=O[1].length;E>0;){var _=0;switch(O[0]){case t.default.INSERT:_=Math.min(A.peekLength(),E),p.push(A.next(_));break;case t.default.DELETE:_=Math.min(E,y.peekLength()),y.next(_),p.delete(_);break;case t.default.EQUAL:_=Math.min(y.peekLength(),A.peekLength(),E);var h=y.next(_),f=A.next(_);n.default(h.insert,f.insert)?p.retain(_,i.default.diff(h.attributes,f.attributes)):p.push(f).delete(_);break}E-=_}}),p.chop()},a.prototype.eachLine=function(o,c){c===void 0&&(c=`
`);for(var v=s.default.iterator(this.ops),p=new a,d=0;v.hasNext();){if(v.peekType()!=="insert")return;var y=v.peek(),A=s.default.length(y)-v.peekLength(),O=typeof y.insert=="string"?y.insert.indexOf(c,A)-A:-1;if(O<0)p.push(v.next());else if(O>0)p.push(v.next(O));else{if(o(p,v.next(1).attributes||{},d)===!1)return;d+=1,p=new a}}p.length()>0&&o(p,{},d)},a.prototype.invert=function(o){var c=new a;return this.reduce(function(v,p){if(p.insert)c.delete(s.default.length(p));else{if(p.retain&&p.attributes==null)return c.retain(p.retain),v+p.retain;if(p.delete||p.retain&&p.attributes){var d=p.delete||p.retain,y=o.slice(v,v+d);return y.forEach(function(A){p.delete?c.push(A):p.retain&&p.attributes&&c.retain(s.default.length(A),i.default.invert(p.attributes,A.attributes))}),v+d}}return v},0),c.chop()},a.prototype.transform=function(o,c){if(c===void 0&&(c=!1),c=!!c,typeof o=="number")return this.transformPosition(o,c);for(var v=o,p=s.default.iterator(this.ops),d=s.default.iterator(v.ops),y=new a;p.hasNext()||d.hasNext();)if(p.peekType()==="insert"&&(c||d.peekType()!=="insert"))y.retain(s.default.length(p.next()));else if(d.peekType()==="insert")y.push(d.next());else{var A=Math.min(p.peekLength(),d.peekLength()),O=p.next(A),E=d.next(A);if(O.delete)continue;E.delete?y.push(E):y.retain(A,i.default.transform(O.attributes,E.attributes,c))}return y.chop()},a.prototype.transformPosition=function(o,c){c===void 0&&(c=!1),c=!!c;for(var v=s.default.iterator(this.ops),p=0;v.hasNext()&&p<=o;){var d=v.peekLength(),y=v.peekType();if(v.next(),y==="delete"){o-=Math.min(d,o-p);continue}else y==="insert"&&(p<o||!c)&&(o+=d);p+=d}return o},a.Op=s.default,a.AttributeMap=i.default,a})();return Wn=u,Wn}var Ma,jf;function uE(){if(jf)return Ma;jf=1;var r=lE();return Ma={Delta:r,type:{name:"rich-text",uri:"http://sharejs.org/types/rich-text/v1",create:function(t){return new r(t)},apply:function(t,e){return t=new r(t),e=new r(e),t.compose(e)},compose:function(t,e){return t=new r(t),e=new r(e),t.compose(e)},diff:function(t,e){return t=new r(t),e=new r(e),t.diff(e)},transform:function(t,e,n){return t=new r(t),e=new r(e),e.transform(t,n==="left")},transformCursor:function(t,e,n){return e.transformPosition(t,!n)},normalize:function(t){return t},serialize:function(t){return t.ops},deserialize:function(t){return new r(t)},transformPresence:function(t,e,n){if(!t)return null;const i=new r(e),s=this.transformCursor(t.index,i,n),l=this.transformCursor(t.index+t.length,i,n);return Object.assign({},t,{index:s,length:l-s})}}},Ma}var ja,kf;function cE(){return kf||(kf=1,ja=uE()),ja}var fE=cE();const hE=vi(fE),ka={};Qd.types.register(hE.type);et.register("modules/cursors",Y1);function Kn(r){let t=0;for(let e=0;e<r.length;e++)t=t*31+r.charCodeAt(e)>>>0;return`hsl(${t%360}deg 80% 60%)`}function dE(r){return(window.PEER_NAMES||{})[r]||`User ${String(r).slice(0,4)}`}if(window.__OT_V2_INIT__)console.warn("[OT] déjà initialisé, on ignore.");else{window.__OT_V2_INIT__=!0;const r=window.ROOM_ID;if(!r)console.warn("[OT] Pas de ROOM_ID");else{const t=e=>{const n=e&&e.detail&&e.detail.clientId||window.WRTC_CLIENT_ID;pE(r,n)};window.WRTC_CLIENT_ID?t():window.addEventListener("wrtc-joined",t,{once:!0})}}function pE(r,t){t||(t=Math.random().toString(36).slice(2,8));const e=location.protocol==="https:"?"wss":"ws",n=location.hostname,i=Number(ka==null?void 0:ka.VITE_OT_PORT)||3001,s=new WebSocket(`${e}://${n}:${i}/?cid=${t}`),l=new Qd.Connection(s),u=l.get("docs",r),a=new et("#editor",{theme:"snow",placeholder:"Écris ici… (collab en direct)",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","code-block","blockquote"],["clean"]],cursors:!0}}),o=a.getModule("cursors"),c=l.getDocPresence("docs",r),v=c.create(t),p=new Map,d=new Map;function y(E){const _=dE(E),h=p.get(E);if(h){if(h.name!==_){const f=d.get(E);o.removeCursor(E),o.createCursor(E,_,Kn(E)),f&&o.moveCursor(E,f),p.set(E,{name:_,color:Kn(E)})}}else{const f=Kn(E);o.createCursor(E,_,f),p.set(E,{name:_,color:f});const g=d.get(E);g&&o.moveCursor(E,g)}}function A(E){v.submit(E||null,_=>{_&&console.warn("[OT] presence submit warn:",_)})}c.subscribe(E=>{E&&console.error("[OT] docPresence subscribe error:",E)}),c.on("receive",(E,_)=>{E!==t&&(_&&typeof _.index=="number"?(d.set(E,_),y(E),o.moveCursor(E,_)):(o.removeCursor(E),p.delete(E),d.delete(E)))}),window.addEventListener("peer-name",E=>{const{id:_,name:h}=E.detail||{};if(!_||!h)return;const f=d.get(_);o.removeCursor(_),o.createCursor(_,h,Kn(_)),f&&o.moveCursor(_,f),p.set(_,{name:h,color:Kn(_)})});let O=!1;u.subscribe(E=>{if(E)return console.error("[OT] subscribe error:",E);try{a.setContents(u.data||[{insert:`
`}],"silent")}catch{a.setContents([{insert:`
`}],"silent")}if(O)return;O=!0,a.on("text-change",(H,k,z)=>{z==="user"&&u.submitOp(H,{source:a},X=>{X&&console.warn("[OT] submitOp warn:",X)})}),a.on("selection-change",(H,k,z)=>{z==="user"&&A(H)}),u.on("op",(H,k)=>{k!==a&&a.updateContents(H,"silent")}),A(a.getSelection()),console.log("[OT] prêt (cursors on) pour",r,"id=",t);const _=l.get("boards",r),h=document.getElementById("notesLayer"),f=document.getElementById("board"),g=24,b=40,S=()=>Math.random().toString(36).slice(2);function N(){if(!h||!_.data||!_.data.notes)return;let H=0;h.querySelectorAll(".note").forEach(X=>{const J=parseInt(X.style.top||"0",10),nt=X.offsetHeight||120,lt=J+nt;lt>H&&(H=lt)});const z=Math.max(h.clientHeight,H+g);h.style.minHeight=`${z}px`}const C=160,P=110,w=16;function M(H,k){return!(H.x+H.w<=k.x||k.x+k.w<=H.x||H.y+H.h<=k.y||k.y+k.h<=H.y)}function R(H,k,z,X,J,nt){const lt={x:H,y:k,w:z,h:X};for(const dt of J){if(dt.id===nt)continue;const vt={x:dt.x,y:dt.y,w:dt.w||180,h:dt.h||120};if(vt.x-=w/2,vt.y-=w/2,vt.w+=w,vt.h+=w,M(lt,vt))return!0}return!1}function I(H,k,z,X){const J=h.clientWidth||1e3,nt=Math.max(0,Math.min(H,Math.max(0,J-z))),lt=_.data&&_.data.notes||[],dt=z+w,vt=X+w,Ut=4e3;for(let G=Math.max(0,k);G<Ut;G+=vt)for(let Ot=0;Ot<=J-z;Ot+=Math.max(100,Math.min(dt,260))){const Nt=Math.abs(Ot-nt)<80?nt:Ot;if(!R(Nt,G,z,X,lt)){const bt=G+X+g,Tt=parseInt(getComputedStyle(h).minHeight||"0",10);return bt>Tt&&(h.style.minHeight=`${bt}px`),{x:Nt,y:G}}}const kt=(h.scrollHeight||0)+w;return{x:nt,y:kt}}function D(){if(!h)return;h.innerHTML="";const H=_.data||{notes:[]};for(const k of H.notes){const z=x(k);h.appendChild(z)}N()}function x(H){const k=document.createElement("div");k.className="note",k.tabIndex=0,k.dataset.id=H.id;const z=Math.max(C,H.w||180),X=Math.max(P,H.h||120);k.style.left=`${H.x}px`,k.style.top=`${H.y}px`,k.style.width=`${z}px`,k.style.height=`${X}px`;const J=document.createElement("button");J.className="note__close",J.type="button",J.setAttribute("aria-label","Supprimer la note"),J.textContent="×",k.appendChild(J);const nt=document.createElement("div");nt.className="note__text",nt.textContent=H.text||"Votre note…",k.appendChild(nt);const lt=document.createElement("div");lt.className="note__resize",k.appendChild(lt),J.addEventListener("click",bt=>{bt.stopPropagation(),Q(H.id)});let dt=0,vt=0,Ut=H.x,kt=H.y,G=!1;const Ot=bt=>{if(!G)return;const Tt=bt.clientX-dt,Et=bt.clientY-vt,Vt=h.clientWidth,Bt=k.offsetWidth,Ct=k.offsetHeight,Ft=Math.max(0,Math.min(Ut+Tt,Math.max(0,Vt-Bt))),$t=Math.max(0,kt+Et),ge=$t+Ct+g,fe=parseInt(getComputedStyle(h).minHeight||"0",10);ge>fe&&(h.style.minHeight=`${ge}px`,f&&(f.scrollTop=f.scrollHeight)),k.style.left=`${Ft}px`,k.style.top=`${$t}px`},Nt=()=>{if(!G)return;G=!1,k.classList.remove("dragging"),document.removeEventListener("mousemove",Ot),document.removeEventListener("mouseup",Nt);const bt=parseInt(k.style.left||"0",10),Tt=parseInt(k.style.top||"0",10),Et=Math.max(0,bt),Vt=Math.max(0,Tt),Bt=(_.data.notes||[]).findIndex(Ct=>Ct.id===H.id);Bt>=0&&_.submitOp([{p:["notes",Bt,"x"],od:H.x,oi:Et},{p:["notes",Bt,"y"],od:H.y,oi:Vt}],Ct=>Ct&&console.warn("[board] move error:",Ct))};return k.addEventListener("mousedown",bt=>{bt.target===nt||bt.target.closest(".note__text")||bt.target===J||bt.target===lt||k.classList.contains("editing")||(G=!0,k.classList.add("dragging"),dt=bt.clientX,vt=bt.clientY,Ut=parseInt(k.style.left,10)||0,kt=parseInt(k.style.top,10)||0,document.addEventListener("mousemove",Ot),document.addEventListener("mouseup",Nt))}),nt.addEventListener("dblclick",bt=>{bt.stopPropagation(),$(H.id,nt)}),lt.addEventListener("mousedown",bt=>{bt.stopPropagation();const Tt=bt.clientX,Et=bt.clientY,Vt=k.offsetWidth,Bt=k.offsetHeight;k.classList.add("resizing");const Ct=$t=>{const Dt=$t.clientX-Tt,ge=$t.clientY-Et,fe=Math.max(C,Vt+Dt),Ge=Math.max(P,Bt+ge);k.style.width=`${fe}px`,k.style.height=`${Ge}px`;const Be=parseInt(k.style.top||"0",10)+Ge+g,vr=parseInt(getComputedStyle(h).minHeight||"0",10);Be>vr&&(h.style.minHeight=`${Be}px`,f&&(f.scrollTop=f.scrollHeight))},Ft=()=>{document.removeEventListener("mousemove",Ct),document.removeEventListener("mouseup",Ft),k.classList.remove("resizing");const $t=(_.data.notes||[]).findIndex(Dt=>Dt.id===H.id);if($t>=0){const Dt=_.data.notes[$t].w||Vt,ge=_.data.notes[$t].h||Bt,fe=Math.max(C,Math.round(k.offsetWidth)),Ge=Math.max(P,Math.round(k.offsetHeight));_.submitOp([{p:["notes",$t,"w"],od:Dt,oi:fe},{p:["notes",$t,"h"],od:ge,oi:Ge}],Ie=>Ie&&console.warn("[board] resize error:",Ie))}N()};document.addEventListener("mousemove",Ct),document.addEventListener("mouseup",Ft)}),k}function $(H,k){const z=(_.data.notes||[]).findIndex(G=>G.id===H);if(z<0)return;const X=_.data.notes[z].text||"",J=k.closest(".note");if(!J)return;const nt=J.offsetHeight;J.classList.add("editing"),k.setAttribute("contenteditable","true"),k.focus();const lt=window.getSelection(),dt=document.createRange();dt.selectNodeContents(k),dt.collapse(!1),lt.removeAllRanges(),lt.addRange(dt),Y(J,k);const vt=()=>{requestAnimationFrame(()=>Y(J,k))},Ut=G=>{G.key==="Enter"&&!G.shiftKey&&(G.preventDefault(),k.blur())},kt=()=>{k.removeEventListener("input",vt),k.removeEventListener("keydown",Ut),k.removeEventListener("blur",kt),k.removeAttribute("contenteditable"),J.classList.remove("editing");const G=k.textContent||"",Ot=Math.max(P,Math.round(J.offsetHeight)),Nt=[];G!==X&&Nt.push({p:["notes",z,"text"],od:X,oi:G});const bt=_.data.notes[z].h||nt;Ot!==bt&&Nt.push({p:["notes",z,"h"],od:bt,oi:Ot}),Nt.length&&_.submitOp(Nt,Tt=>Tt&&console.warn("[board] edit/height error:",Tt)),N()};k.addEventListener("input",vt),k.addEventListener("keydown",Ut),k.addEventListener("blur",kt)}function V(H,k){if(!h)return;const z=180,X=120,J=h.getBoundingClientRect(),nt=Math.max(0,Math.round(J.width/2-z/2)),lt=Math.max(0,typeof k=="number"?k:Math.round(J.height/2-X/2)),dt=I(nt,lt,z,X),vt={id:S(),x:dt.x,y:dt.y,w:z,h:X,text:"Nouvelle note",color:"#fff6a9"},kt=(_.data&&_.data.notes||[]).length;_.submitOp([{p:["notes",kt],li:vt}],G=>{G&&console.warn("[board] add error:",G),requestAnimationFrame(()=>{N(),f&&(f.scrollTop=f.scrollHeight)})})}function Q(H){const k=_.data&&_.data.notes||[],z=k.findIndex(J=>J.id===H);if(z<0)return;const X=k[z];_.submitOp([{p:["notes",z],ld:X}],J=>{J&&console.warn("[board] delete error:",J)})}function Y(H,k){const z=Math.max(P,(k.scrollHeight||0)+16);H.style.height=`${z}px`;const J=parseInt(H.style.top||"0",10)+z+g,nt=parseInt(getComputedStyle(h).minHeight||"0",10);J>nt&&(h.style.minHeight=`${J}px`,f&&(f.scrollTop=f.scrollHeight))}function st(){const H=_.data&&_.data.notes||[];H.length===0||!window.confirm(`Supprimer ${H.length} post-it${H.length>1?"s":""} ?`)||_.submitOp([{p:["notes"],od:H,oi:[]}],z=>{z&&console.warn("[board] clear-all error:",z),!z&&window.Toastify&&Toastify({text:"Tous les post-its ont été supprimés.",duration:2500,gravity:"top",position:"center",close:!0,backgroundColor:"#2b6cff",stopOnFocus:!0}).showToast()})}_.subscribe(H=>{if(H)return console.error("[board] subscribe error",H);_.type,D(),_.on("op",(k,z)=>{D()})});const rt=document.getElementById("btnToolNote");rt&&h&&rt.addEventListener("click",()=>{V(void 0,(h.scrollHeight||h.clientHeight)/2-60+b)});const L=document.getElementById("btnClearNotes");L&&L.addEventListener("click",st);function B(H,k,z){const X=z instanceof Blob?z:new Blob([z],{type:k}),J=URL.createObjectURL(X),nt=document.createElement("a");nt.href=J,nt.download=H,document.body.appendChild(nt),nt.click(),setTimeout(()=>{document.body.removeChild(nt),URL.revokeObjectURL(J)},0)}function F(H){const k=`note_${r}`;if(H==="delta"){const z=u.data||a.getContents();B(`${k}.delta.json`,"application/json;charset=utf-8",JSON.stringify(z,null,2));return}if(H==="html"){const z=a.root.innerHTML;B(`${k}.html`,"text/html;charset=utf-8",`<!doctype html>
<html><head><meta charset="utf-8"><title>${k}</title></head><body>${z}</body></html>`);return}if(H==="md"){if(!window.TurndownService){alert("Turndown (Markdown) non chargé. Garde HTML/Delta/TXT ou ajoute le <script> CDN.");return}const X=new window.TurndownService().turndown(a.root.innerHTML);B(`${k}.md`,"text/markdown;charset=utf-8",X);return}if(H==="txt"){const z=a.getText();B(`${k}.txt`,"text/plain;charset=utf-8",z);return}if(H==="pdf"){if(!window.html2pdf){alert("html2pdf.js non chargé. Ajoute le <script> CDN ou choisis un autre format.");return}const z={margin:10,filename:`${k}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};window.html2pdf().set(z).from(a.root).save();return}alert("Format d’export inconnu.")}const tt=document.getElementById("btnExport"),it=document.getElementById("selExportFmt");tt&&it&&tt.addEventListener("click",()=>F(it.value))}),window.addEventListener("beforeunload",()=>{try{v.submit(null,()=>{})}catch{}})}});export default gE();
//# sourceMappingURL=ot-main.js.map
