var Xd=Object.defineProperty;var Qd=(r,e,t)=>e in r?Xd(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ep=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Q=(r,e,t)=>Qd(r,typeof e!="symbol"?e+"":e,t);var aE=ep((xe,De)=>{var Mf=typeof window=="object"&&window&&window.Object===Object&&window,tp=typeof self=="object"&&self&&self.Object===Object&&self,dt=Mf||tp||Function("return this")(),kt=dt.Symbol,kf=Object.prototype,rp=kf.hasOwnProperty,np=kf.toString,Qr=kt?kt.toStringTag:void 0;function ip(r){var e=rp.call(r,Qr),t=r[Qr];try{r[Qr]=void 0;var n=!0}catch{}var i=np.call(r);return n&&(e?r[Qr]=t:delete r[Qr]),i}var sp=Object.prototype,op=sp.toString;function ap(r){return op.call(r)}var lp="[object Null]",up="[object Undefined]",Fl=kt?kt.toStringTag:void 0;function Dr(r){return r==null?r===void 0?up:lp:Fl&&Fl in Object(r)?ip(r):ap(r)}function At(r){return r!=null&&typeof r=="object"}var Yt=Array.isArray;function jt(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}function jf(r){return r}var cp="[object AsyncFunction]",fp="[object Function]",hp="[object GeneratorFunction]",dp="[object Proxy]";function al(r){if(!jt(r))return!1;var e=Dr(r);return e==fp||e==hp||e==cp||e==dp}var Hs=dt["__core-js_shared__"],Ul=(function(){var r=/[^.]+$/.exec(Hs&&Hs.keys&&Hs.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""})();function pp(r){return!!Ul&&Ul in r}var gp=Function.prototype,mp=gp.toString;function Xt(r){if(r!=null){try{return mp.call(r)}catch{}try{return r+""}catch{}}return""}var vp=/[\\^$.*+?()[\]{}|]/g,yp=/^\[object .+?Constructor\]$/,bp=Function.prototype,_p=Object.prototype,Ep=bp.toString,Ap=_p.hasOwnProperty,Op=RegExp("^"+Ep.call(Ap).replace(vp,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Sp(r){if(!jt(r)||pp(r))return!1;var e=al(r)?Op:yp;return e.test(Xt(r))}function wp(r,e){return r==null?void 0:r[e]}function Qt(r,e){var t=wp(r,e);return Sp(t)?t:void 0}var ka=Qt(dt,"WeakMap"),Hl=Object.create,Rp=(function(){function r(){}return function(e){if(!jt(e))return{};if(Hl)return Hl(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}})();function Tp(r,e,t){switch(t.length){case 0:return r.call(e);case 1:return r.call(e,t[0]);case 2:return r.call(e,t[0],t[1]);case 3:return r.call(e,t[0],t[1],t[2])}return r.apply(e,t)}function Np(r,e){var t=-1,n=r.length;for(e||(e=Array(n));++t<n;)e[t]=r[t];return e}var Lp=800,Ip=16,qp=Date.now;function Pp(r){var e=0,t=0;return function(){var n=qp(),i=Ip-(n-t);if(t=n,i>0){if(++e>=Lp)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}function Cp(r){return function(){return r}}var gi=(function(){try{var r=Qt(Object,"defineProperty");return r({},"",{}),r}catch{}})(),xp=gi?function(r,e){return gi(r,"toString",{configurable:!0,enumerable:!1,value:Cp(e),writable:!0})}:jf,Dp=Pp(xp);function Mp(r,e){for(var t=-1,n=r==null?0:r.length;++t<n&&e(r[t],t,r)!==!1;);return r}var kp=9007199254740991,jp=/^(?:0|[1-9]\d*)$/;function Bf(r,e){var t=typeof r;return e=e==null?kp:e,!!e&&(t=="number"||t!="symbol"&&jp.test(r))&&r>-1&&r%1==0&&r<e}function ll(r,e,t){e=="__proto__"&&gi?gi(r,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):r[e]=t}function On(r,e){return r===e||r!==r&&e!==e}var Bp=Object.prototype,$p=Bp.hasOwnProperty;function $f(r,e,t){var n=r[e];(!($p.call(r,e)&&On(n,t))||t===void 0&&!(e in r))&&ll(r,e,t)}function Fp(r,e,t,n){var i=!t;t||(t={});for(var s=-1,l=e.length;++s<l;){var u=e[s],a=void 0;a===void 0&&(a=r[u]),i?ll(t,u,a):$f(t,u,a)}return t}var Vl=Math.max;function Up(r,e,t){return e=Vl(e===void 0?r.length-1:e,0),function(){for(var n=arguments,i=-1,s=Vl(n.length-e,0),l=Array(s);++i<s;)l[i]=n[e+i];i=-1;for(var u=Array(e+1);++i<e;)u[i]=n[i];return u[e]=t(l),Tp(r,this,u)}}function Hp(r,e){return Dp(Up(r,e,jf),r+"")}var Vp=9007199254740991;function Ff(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Vp}function ki(r){return r!=null&&Ff(r.length)&&!al(r)}function Gp(r,e,t){if(!jt(t))return!1;var n=typeof e;return(n=="number"?ki(t)&&Bf(e,t.length):n=="string"&&e in t)?On(t[e],r):!1}function zp(r){return Hp(function(e,t){var n=-1,i=t.length,s=i>1?t[i-1]:void 0,l=i>2?t[2]:void 0;for(s=r.length>3&&typeof s=="function"?(i--,s):void 0,l&&Gp(t[0],t[1],l)&&(s=i<3?void 0:s,i=1),e=Object(e);++n<i;){var u=t[n];u&&r(e,u,n,s)}return e})}var Wp=Object.prototype;function ul(r){var e=r&&r.constructor,t=typeof e=="function"&&e.prototype||Wp;return r===t}function Kp(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var Yp="[object Arguments]";function Gl(r){return At(r)&&Dr(r)==Yp}var Uf=Object.prototype,Zp=Uf.hasOwnProperty,Jp=Uf.propertyIsEnumerable,ja=Gl((function(){return arguments})())?Gl:function(r){return At(r)&&Zp.call(r,"callee")&&!Jp.call(r,"callee")};function Xp(){return!1}var Hf=typeof xe=="object"&&xe&&!xe.nodeType&&xe,zl=Hf&&typeof De=="object"&&De&&!De.nodeType&&De,Qp=zl&&zl.exports===Hf,Wl=Qp?dt.Buffer:void 0,eg=Wl?Wl.isBuffer:void 0,fn=eg||Xp,tg="[object Arguments]",rg="[object Array]",ng="[object Boolean]",ig="[object Date]",sg="[object Error]",og="[object Function]",ag="[object Map]",lg="[object Number]",ug="[object Object]",cg="[object RegExp]",fg="[object Set]",hg="[object String]",dg="[object WeakMap]",pg="[object ArrayBuffer]",gg="[object DataView]",mg="[object Float32Array]",vg="[object Float64Array]",yg="[object Int8Array]",bg="[object Int16Array]",_g="[object Int32Array]",Eg="[object Uint8Array]",Ag="[object Uint8ClampedArray]",Og="[object Uint16Array]",Sg="[object Uint32Array]",ve={};ve[mg]=ve[vg]=ve[yg]=ve[bg]=ve[_g]=ve[Eg]=ve[Ag]=ve[Og]=ve[Sg]=!0;ve[tg]=ve[rg]=ve[pg]=ve[ng]=ve[gg]=ve[ig]=ve[sg]=ve[og]=ve[ag]=ve[lg]=ve[ug]=ve[cg]=ve[fg]=ve[hg]=ve[dg]=!1;function wg(r){return At(r)&&Ff(r.length)&&!!ve[Dr(r)]}function cl(r){return function(e){return r(e)}}var Vf=typeof xe=="object"&&xe&&!xe.nodeType&&xe,an=Vf&&typeof De=="object"&&De&&!De.nodeType&&De,Rg=an&&an.exports===Vf,Vs=Rg&&Mf.process,Tr=(function(){try{var r=an&&an.require&&an.require("util").types;return r||Vs&&Vs.binding&&Vs.binding("util")}catch{}})(),Kl=Tr&&Tr.isTypedArray,fl=Kl?cl(Kl):wg,Tg=Object.prototype,Ng=Tg.hasOwnProperty;function Gf(r,e){var t=Yt(r),n=!t&&ja(r),i=!t&&!n&&fn(r),s=!t&&!n&&!i&&fl(r),l=t||n||i||s,u=l?Kp(r.length,String):[],a=u.length;for(var o in r)(e||Ng.call(r,o))&&!(l&&(o=="length"||i&&(o=="offset"||o=="parent")||s&&(o=="buffer"||o=="byteLength"||o=="byteOffset")||Bf(o,a)))&&u.push(o);return u}function zf(r,e){return function(t){return r(e(t))}}var Lg=zf(Object.keys,Object),Ig=Object.prototype,qg=Ig.hasOwnProperty;function Pg(r){if(!ul(r))return Lg(r);var e=[];for(var t in Object(r))qg.call(r,t)&&t!="constructor"&&e.push(t);return e}function Cg(r){return ki(r)?Gf(r):Pg(r)}function xg(r){var e=[];if(r!=null)for(var t in Object(r))e.push(t);return e}var Dg=Object.prototype,Mg=Dg.hasOwnProperty;function kg(r){if(!jt(r))return xg(r);var e=ul(r),t=[];for(var n in r)n=="constructor"&&(e||!Mg.call(r,n))||t.push(n);return t}function Wf(r){return ki(r)?Gf(r,!0):kg(r)}var hn=Qt(Object,"create");function jg(){this.__data__=hn?hn(null):{},this.size=0}function Bg(r){var e=this.has(r)&&delete this.__data__[r];return this.size-=e?1:0,e}var $g="__lodash_hash_undefined__",Fg=Object.prototype,Ug=Fg.hasOwnProperty;function Hg(r){var e=this.__data__;if(hn){var t=e[r];return t===$g?void 0:t}return Ug.call(e,r)?e[r]:void 0}var Vg=Object.prototype,Gg=Vg.hasOwnProperty;function zg(r){var e=this.__data__;return hn?e[r]!==void 0:Gg.call(e,r)}var Wg="__lodash_hash_undefined__";function Kg(r,e){var t=this.__data__;return this.size+=this.has(r)?0:1,t[r]=hn&&e===void 0?Wg:e,this}function Zt(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}Zt.prototype.clear=jg;Zt.prototype.delete=Bg;Zt.prototype.get=Hg;Zt.prototype.has=zg;Zt.prototype.set=Kg;function Yg(){this.__data__=[],this.size=0}function ji(r,e){for(var t=r.length;t--;)if(On(r[t][0],e))return t;return-1}var Zg=Array.prototype,Jg=Zg.splice;function Xg(r){var e=this.__data__,t=ji(e,r);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():Jg.call(e,t,1),--this.size,!0}function Qg(r){var e=this.__data__,t=ji(e,r);return t<0?void 0:e[t][1]}function em(r){return ji(this.__data__,r)>-1}function tm(r,e){var t=this.__data__,n=ji(t,r);return n<0?(++this.size,t.push([r,e])):t[n][1]=e,this}function wt(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}wt.prototype.clear=Yg;wt.prototype.delete=Xg;wt.prototype.get=Qg;wt.prototype.has=em;wt.prototype.set=tm;var dn=Qt(dt,"Map");function rm(){this.size=0,this.__data__={hash:new Zt,map:new(dn||wt),string:new Zt}}function nm(r){var e=typeof r;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?r!=="__proto__":r===null}function Bi(r,e){var t=r.__data__;return nm(e)?t[typeof e=="string"?"string":"hash"]:t.map}function im(r){var e=Bi(this,r).delete(r);return this.size-=e?1:0,e}function sm(r){return Bi(this,r).get(r)}function om(r){return Bi(this,r).has(r)}function am(r,e){var t=Bi(this,r),n=t.size;return t.set(r,e),this.size+=t.size==n?0:1,this}function er(r){var e=-1,t=r==null?0:r.length;for(this.clear();++e<t;){var n=r[e];this.set(n[0],n[1])}}er.prototype.clear=rm;er.prototype.delete=im;er.prototype.get=sm;er.prototype.has=om;er.prototype.set=am;function lm(r,e){for(var t=-1,n=e.length,i=r.length;++t<n;)r[i+t]=e[t];return r}var Kf=zf(Object.getPrototypeOf,Object),um="[object Object]",cm=Function.prototype,fm=Object.prototype,Yf=cm.toString,hm=fm.hasOwnProperty,dm=Yf.call(Object);function pm(r){if(!At(r)||Dr(r)!=um)return!1;var e=Kf(r);if(e===null)return!0;var t=hm.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Yf.call(t)==dm}function gm(){this.__data__=new wt,this.size=0}function mm(r){var e=this.__data__,t=e.delete(r);return this.size=e.size,t}function vm(r){return this.__data__.get(r)}function ym(r){return this.__data__.has(r)}var bm=200;function _m(r,e){var t=this.__data__;if(t instanceof wt){var n=t.__data__;if(!dn||n.length<bm-1)return n.push([r,e]),this.size=++t.size,this;t=this.__data__=new er(n)}return t.set(r,e),this.size=t.size,this}function ut(r){var e=this.__data__=new wt(r);this.size=e.size}ut.prototype.clear=gm;ut.prototype.delete=mm;ut.prototype.get=vm;ut.prototype.has=ym;ut.prototype.set=_m;var Zf=typeof xe=="object"&&xe&&!xe.nodeType&&xe,Yl=Zf&&typeof De=="object"&&De&&!De.nodeType&&De,Em=Yl&&Yl.exports===Zf,Zl=Em?dt.Buffer:void 0,Jl=Zl?Zl.allocUnsafe:void 0;function Jf(r,e){if(e)return r.slice();var t=r.length,n=Jl?Jl(t):new r.constructor(t);return r.copy(n),n}function Am(r,e){for(var t=-1,n=r==null?0:r.length,i=0,s=[];++t<n;){var l=r[t];e(l,t,r)&&(s[i++]=l)}return s}function Om(){return[]}var Sm=Object.prototype,wm=Sm.propertyIsEnumerable,Xl=Object.getOwnPropertySymbols,Rm=Xl?function(r){return r==null?[]:(r=Object(r),Am(Xl(r),function(e){return wm.call(r,e)}))}:Om;function Tm(r,e,t){var n=e(r);return Yt(r)?n:lm(n,t(r))}function Ba(r){return Tm(r,Cg,Rm)}var $a=Qt(dt,"DataView"),Fa=Qt(dt,"Promise"),Ua=Qt(dt,"Set"),Ql="[object Map]",Nm="[object Object]",eu="[object Promise]",tu="[object Set]",ru="[object WeakMap]",nu="[object DataView]",Lm=Xt($a),Im=Xt(dn),qm=Xt(Fa),Pm=Xt(Ua),Cm=Xt(ka),Ye=Dr;($a&&Ye(new $a(new ArrayBuffer(1)))!=nu||dn&&Ye(new dn)!=Ql||Fa&&Ye(Fa.resolve())!=eu||Ua&&Ye(new Ua)!=tu||ka&&Ye(new ka)!=ru)&&(Ye=function(r){var e=Dr(r),t=e==Nm?r.constructor:void 0,n=t?Xt(t):"";if(n)switch(n){case Lm:return nu;case Im:return Ql;case qm:return eu;case Pm:return tu;case Cm:return ru}return e});var xm=Object.prototype,Dm=xm.hasOwnProperty;function Mm(r){var e=r.length,t=new r.constructor(e);return e&&typeof r[0]=="string"&&Dm.call(r,"index")&&(t.index=r.index,t.input=r.input),t}var mi=dt.Uint8Array;function hl(r){var e=new r.constructor(r.byteLength);return new mi(e).set(new mi(r)),e}function km(r,e){var t=hl(r.buffer);return new r.constructor(t,r.byteOffset,r.byteLength)}var jm=/\w*$/;function Bm(r){var e=new r.constructor(r.source,jm.exec(r));return e.lastIndex=r.lastIndex,e}var iu=kt?kt.prototype:void 0,su=iu?iu.valueOf:void 0;function $m(r){return su?Object(su.call(r)):{}}function Xf(r,e){var t=e?hl(r.buffer):r.buffer;return new r.constructor(t,r.byteOffset,r.length)}var Fm="[object Boolean]",Um="[object Date]",Hm="[object Map]",Vm="[object Number]",Gm="[object RegExp]",zm="[object Set]",Wm="[object String]",Km="[object Symbol]",Ym="[object ArrayBuffer]",Zm="[object DataView]",Jm="[object Float32Array]",Xm="[object Float64Array]",Qm="[object Int8Array]",ev="[object Int16Array]",tv="[object Int32Array]",rv="[object Uint8Array]",nv="[object Uint8ClampedArray]",iv="[object Uint16Array]",sv="[object Uint32Array]";function ov(r,e,t){var n=r.constructor;switch(e){case Ym:return hl(r);case Fm:case Um:return new n(+r);case Zm:return km(r);case Jm:case Xm:case Qm:case ev:case tv:case rv:case nv:case iv:case sv:return Xf(r,t);case Hm:return new n;case Vm:case Wm:return new n(r);case Gm:return Bm(r);case zm:return new n;case Km:return $m(r)}}function Qf(r){return typeof r.constructor=="function"&&!ul(r)?Rp(Kf(r)):{}}var av="[object Map]";function lv(r){return At(r)&&Ye(r)==av}var ou=Tr&&Tr.isMap,uv=ou?cl(ou):lv,cv="[object Set]";function fv(r){return At(r)&&Ye(r)==cv}var au=Tr&&Tr.isSet,hv=au?cl(au):fv,dv=1,eh="[object Arguments]",pv="[object Array]",gv="[object Boolean]",mv="[object Date]",vv="[object Error]",th="[object Function]",yv="[object GeneratorFunction]",bv="[object Map]",_v="[object Number]",rh="[object Object]",Ev="[object RegExp]",Av="[object Set]",Ov="[object String]",Sv="[object Symbol]",wv="[object WeakMap]",Rv="[object ArrayBuffer]",Tv="[object DataView]",Nv="[object Float32Array]",Lv="[object Float64Array]",Iv="[object Int8Array]",qv="[object Int16Array]",Pv="[object Int32Array]",Cv="[object Uint8Array]",xv="[object Uint8ClampedArray]",Dv="[object Uint16Array]",Mv="[object Uint32Array]",ge={};ge[eh]=ge[pv]=ge[Rv]=ge[Tv]=ge[gv]=ge[mv]=ge[Nv]=ge[Lv]=ge[Iv]=ge[qv]=ge[Pv]=ge[bv]=ge[_v]=ge[rh]=ge[Ev]=ge[Av]=ge[Ov]=ge[Sv]=ge[Cv]=ge[xv]=ge[Dv]=ge[Mv]=!0;ge[vv]=ge[th]=ge[wv]=!1;function fi(r,e,t,n,i,s){var l,u=e&dv;if(l!==void 0)return l;if(!jt(r))return r;var a=Yt(r);if(a)l=Mm(r);else{var o=Ye(r),c=o==th||o==yv;if(fn(r))return Jf(r,u);if(o==rh||o==eh||c&&!i)l=c?{}:Qf(r);else{if(!ge[o])return i?r:{};l=ov(r,o,u)}}s||(s=new ut);var d=s.get(r);if(d)return d;s.set(r,l),hv(r)?r.forEach(function(v){l.add(fi(v,e,t,v,r,s))}):uv(r)&&r.forEach(function(v,_){l.set(_,fi(v,e,t,_,r,s))});var p=Ba,h=a?void 0:p(r);return Mp(h||r,function(v,_){h&&(_=v,v=r[_]),$f(l,_,fi(v,e,t,_,r,s))}),l}var kv=1,jv=4;function Sr(r){return fi(r,kv|jv)}var Bv="__lodash_hash_undefined__";function $v(r){return this.__data__.set(r,Bv),this}function Fv(r){return this.__data__.has(r)}function vi(r){var e=-1,t=r==null?0:r.length;for(this.__data__=new er;++e<t;)this.add(r[e])}vi.prototype.add=vi.prototype.push=$v;vi.prototype.has=Fv;function Uv(r,e){for(var t=-1,n=r==null?0:r.length;++t<n;)if(e(r[t],t,r))return!0;return!1}function Hv(r,e){return r.has(e)}var Vv=1,Gv=2;function nh(r,e,t,n,i,s){var l=t&Vv,u=r.length,a=e.length;if(u!=a&&!(l&&a>u))return!1;var o=s.get(r),c=s.get(e);if(o&&c)return o==e&&c==r;var d=-1,p=!0,h=t&Gv?new vi:void 0;for(s.set(r,e),s.set(e,r);++d<u;){var v=r[d],_=e[d];if(n)var E=l?n(_,v,d,e,r,s):n(v,_,d,r,e,s);if(E!==void 0){if(E)continue;p=!1;break}if(h){if(!Uv(e,function(w,R){if(!Hv(h,R)&&(v===w||i(v,w,t,n,s)))return h.push(R)})){p=!1;break}}else if(!(v===_||i(v,_,t,n,s))){p=!1;break}}return s.delete(r),s.delete(e),p}function zv(r){var e=-1,t=Array(r.size);return r.forEach(function(n,i){t[++e]=[i,n]}),t}function Wv(r){var e=-1,t=Array(r.size);return r.forEach(function(n){t[++e]=n}),t}var Kv=1,Yv=2,Zv="[object Boolean]",Jv="[object Date]",Xv="[object Error]",Qv="[object Map]",ey="[object Number]",ty="[object RegExp]",ry="[object Set]",ny="[object String]",iy="[object Symbol]",sy="[object ArrayBuffer]",oy="[object DataView]",lu=kt?kt.prototype:void 0,Gs=lu?lu.valueOf:void 0;function ay(r,e,t,n,i,s,l){switch(t){case oy:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case sy:return!(r.byteLength!=e.byteLength||!s(new mi(r),new mi(e)));case Zv:case Jv:case ey:return On(+r,+e);case Xv:return r.name==e.name&&r.message==e.message;case ty:case ny:return r==e+"";case Qv:var u=zv;case ry:var a=n&Kv;if(u||(u=Wv),r.size!=e.size&&!a)return!1;var o=l.get(r);if(o)return o==e;n|=Yv,l.set(r,e);var c=nh(u(r),u(e),n,i,s,l);return l.delete(r),c;case iy:if(Gs)return Gs.call(r)==Gs.call(e)}return!1}var ly=1,uy=Object.prototype,cy=uy.hasOwnProperty;function fy(r,e,t,n,i,s){var l=t&ly,u=Ba(r),a=u.length,o=Ba(e),c=o.length;if(a!=c&&!l)return!1;for(var d=a;d--;){var p=u[d];if(!(l?p in e:cy.call(e,p)))return!1}var h=s.get(r),v=s.get(e);if(h&&v)return h==e&&v==r;var _=!0;s.set(r,e),s.set(e,r);for(var E=l;++d<a;){p=u[d];var w=r[p],R=e[p];if(n)var y=l?n(R,w,p,e,r,s):n(w,R,p,r,e,s);if(!(y===void 0?w===R||i(w,R,t,n,s):y)){_=!1;break}E||(E=p=="constructor")}if(_&&!E){var g=r.constructor,m=e.constructor;g!=m&&"constructor"in r&&"constructor"in e&&!(typeof g=="function"&&g instanceof g&&typeof m=="function"&&m instanceof m)&&(_=!1)}return s.delete(r),s.delete(e),_}var hy=1,uu="[object Arguments]",cu="[object Array]",Jn="[object Object]",dy=Object.prototype,fu=dy.hasOwnProperty;function py(r,e,t,n,i,s){var l=Yt(r),u=Yt(e),a=l?cu:Ye(r),o=u?cu:Ye(e);a=a==uu?Jn:a,o=o==uu?Jn:o;var c=a==Jn,d=o==Jn,p=a==o;if(p&&fn(r)){if(!fn(e))return!1;l=!0,c=!1}if(p&&!c)return s||(s=new ut),l||fl(r)?nh(r,e,t,n,i,s):ay(r,e,a,t,n,i,s);if(!(t&hy)){var h=c&&fu.call(r,"__wrapped__"),v=d&&fu.call(e,"__wrapped__");if(h||v){var _=h?r.value():r,E=v?e.value():e;return s||(s=new ut),i(_,E,t,n,s)}}return p?(s||(s=new ut),fy(r,e,t,n,i,s)):!1}function ih(r,e,t,n,i){return r===e?!0:r==null||e==null||!At(r)&&!At(e)?r!==r&&e!==e:py(r,e,t,n,ih,i)}function gy(r){return function(e,t,n){for(var i=-1,s=Object(e),l=n(e),u=l.length;u--;){var a=l[++i];if(t(s[a],a,s)===!1)break}return e}}var my=gy();function Ha(r,e,t){(t!==void 0&&!On(r[e],t)||t===void 0&&!(e in r))&&ll(r,e,t)}function vy(r){return At(r)&&ki(r)}function Va(r,e){if(!(e==="constructor"&&typeof r[e]=="function")&&e!="__proto__")return r[e]}function yy(r){return Fp(r,Wf(r))}function by(r,e,t,n,i,s,l){var u=Va(r,t),a=Va(e,t),o=l.get(a);if(o){Ha(r,t,o);return}var c=s?s(u,a,t+"",r,e,l):void 0,d=c===void 0;if(d){var p=Yt(a),h=!p&&fn(a),v=!p&&!h&&fl(a);c=a,p||h||v?Yt(u)?c=u:vy(u)?c=Np(u):h?(d=!1,c=Jf(a,!0)):v?(d=!1,c=Xf(a,!0)):c=[]:pm(a)||ja(a)?(c=u,ja(u)?c=yy(u):(!jt(u)||al(u))&&(c=Qf(a))):d=!1}d&&(l.set(a,c),i(c,a,n,s,l),l.delete(a)),Ha(r,t,c)}function sh(r,e,t,n,i){r!==e&&my(e,function(s,l){if(i||(i=new ut),jt(s))by(r,e,l,t,sh,n,i);else{var u=n?n(Va(r,l),s,l+"",r,e,i):void 0;u===void 0&&(u=s),Ha(r,l,u)}},Wf)}function dl(r,e){return ih(r,e)}var xt=zp(function(r,e,t){sh(r,e,t)}),ie=(r=>(r[r.TYPE=3]="TYPE",r[r.LEVEL=12]="LEVEL",r[r.ATTRIBUTE=13]="ATTRIBUTE",r[r.BLOT=14]="BLOT",r[r.INLINE=7]="INLINE",r[r.BLOCK=11]="BLOCK",r[r.BLOCK_BLOT=10]="BLOCK_BLOT",r[r.INLINE_BLOT=6]="INLINE_BLOT",r[r.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",r[r.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",r[r.ANY=15]="ANY",r))(ie||{});class ft{constructor(e,t,n={}){this.attrName=e,this.keyName=t;const i=ie.TYPE&ie.ATTRIBUTE;this.scope=n.scope!=null?n.scope&ie.LEVEL|i:ie.ATTRIBUTE,n.whitelist!=null&&(this.whitelist=n.whitelist)}static keys(e){return Array.from(e.attributes).map(t=>t.name)}add(e,t){return this.canAdd(e,t)?(e.setAttribute(this.keyName,t),!0):!1}canAdd(e,t){return this.whitelist==null?!0:typeof t=="string"?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1}remove(e){e.removeAttribute(this.keyName)}value(e){const t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""}}class wr extends Error{constructor(e){e="[Parchment] "+e,super(e),this.message=e,this.name=this.constructor.name}}const oh=class Ga{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(e,t=!1){if(e==null)return null;if(this.blots.has(e))return this.blots.get(e)||null;if(t){let n=null;try{n=e.parentNode}catch{return null}return this.find(n,t)}return null}create(e,t,n){const i=this.query(t);if(i==null)throw new wr(`Unable to create ${t} blot`);const s=i,l=t instanceof Node||t.nodeType===Node.TEXT_NODE?t:s.create(n),u=new s(e,l,n);return Ga.blots.set(u.domNode,u),u}find(e,t=!1){return Ga.find(e,t)}query(e,t=ie.ANY){let n;return typeof e=="string"?n=this.types[e]||this.attributes[e]:e instanceof Text||e.nodeType===Node.TEXT_NODE?n=this.types.text:typeof e=="number"?e&ie.LEVEL&ie.BLOCK?n=this.types.block:e&ie.LEVEL&ie.INLINE&&(n=this.types.inline):e instanceof Element&&((e.getAttribute("class")||"").split(/\s+/).some(i=>(n=this.classes[i],!!n)),n=n||this.tags[e.tagName]),n==null?null:"scope"in n&&t&ie.LEVEL&n.scope&&t&ie.TYPE&n.scope?n:null}register(...e){return e.map(t=>{const n="blotName"in t,i="attrName"in t;if(!n&&!i)throw new wr("Invalid definition");if(n&&t.blotName==="abstract")throw new wr("Cannot register abstract class");const s=n?t.blotName:i?t.attrName:void 0;return this.types[s]=t,i?typeof t.keyName=="string"&&(this.attributes[t.keyName]=t):n&&(t.className&&(this.classes[t.className]=t),t.tagName&&(Array.isArray(t.tagName)?t.tagName=t.tagName.map(l=>l.toUpperCase()):t.tagName=t.tagName.toUpperCase(),(Array.isArray(t.tagName)?t.tagName:[t.tagName]).forEach(l=>{(this.tags[l]==null||t.className==null)&&(this.tags[l]=t)}))),t})}};oh.blots=new WeakMap;let Nr=oh;function hu(r,e){return(r.getAttribute("class")||"").split(/\s+/).filter(t=>t.indexOf(`${e}-`)===0)}class _y extends ft{static keys(e){return(e.getAttribute("class")||"").split(/\s+/).map(t=>t.split("-").slice(0,-1).join("-"))}add(e,t){return this.canAdd(e,t)?(this.remove(e),e.classList.add(`${this.keyName}-${t}`),!0):!1}remove(e){hu(e,this.keyName).forEach(t=>{e.classList.remove(t)}),e.classList.length===0&&e.removeAttribute("class")}value(e){const t=(hu(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""}}const et=_y;function zs(r){const e=r.split("-"),t=e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("");return e[0]+t}class Ey extends ft{static keys(e){return(e.getAttribute("style")||"").split(";").map(t=>t.split(":")[0].trim())}add(e,t){return this.canAdd(e,t)?(e.style[zs(this.keyName)]=t,!0):!1}remove(e){e.style[zs(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")}value(e){const t=e.style[zs(this.keyName)];return this.canAdd(e,t)?t:""}}const Bt=Ey;class Ay{constructor(e){this.attributes={},this.domNode=e,this.build()}attribute(e,t){t?e.add(this.domNode,t)&&(e.value(this.domNode)!=null?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])}build(){this.attributes={};const e=Nr.find(this.domNode);if(e==null)return;const t=ft.keys(this.domNode),n=et.keys(this.domNode),i=Bt.keys(this.domNode);t.concat(n).concat(i).forEach(s=>{const l=e.scroll.query(s,ie.ATTRIBUTE);l instanceof ft&&(this.attributes[l.attrName]=l)})}copy(e){Object.keys(this.attributes).forEach(t=>{const n=this.attributes[t].value(this.domNode);e.format(t,n)})}move(e){this.copy(e),Object.keys(this.attributes).forEach(t=>{this.attributes[t].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((e,t)=>(e[t]=this.attributes[t].value(this.domNode),e),{})}}const $i=Ay,ah=class{constructor(e,t){this.scroll=e,this.domNode=t,Nr.blots.set(t,this),this.prev=null,this.next=null}static create(e){if(this.tagName==null)throw new wr("Blot definition missing tagName");let t,n;return Array.isArray(this.tagName)?(typeof e=="string"?(n=e.toUpperCase(),parseInt(n,10).toString()===n&&(n=parseInt(n,10))):typeof e=="number"&&(n=e),typeof n=="number"?t=document.createElement(this.tagName[n-1]):n&&this.tagName.indexOf(n)>-1?t=document.createElement(n):t=document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t}get statics(){return this.constructor}attach(){}clone(){const e=this.domNode.cloneNode(!1);return this.scroll.create(e)}detach(){this.parent!=null&&this.parent.removeChild(this),Nr.blots.delete(this.domNode)}deleteAt(e,t){this.isolate(e,t).remove()}formatAt(e,t,n,i){const s=this.isolate(e,t);if(this.scroll.query(n,ie.BLOT)!=null&&i)s.wrap(n,i);else if(this.scroll.query(n,ie.ATTRIBUTE)!=null){const l=this.scroll.create(this.statics.scope);s.wrap(l),l.format(n,i)}}insertAt(e,t,n){const i=n==null?this.scroll.create("text",t):this.scroll.create(t,n),s=this.split(e);this.parent.insertBefore(i,s||void 0)}isolate(e,t){const n=this.split(e);if(n==null)throw new Error("Attempt to isolate at end");return n.split(t),n}length(){return 1}offset(e=this.parent){return this.parent==null||this===e?0:this.parent.children.offset(this)+this.parent.offset(e)}optimize(e){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(e,t){const n=typeof e=="string"?this.scroll.create(e,t):e;return this.parent!=null&&(this.parent.insertBefore(n,this.next||void 0),this.remove()),n}split(e,t){return e===0?this:this.next}update(e,t){}wrap(e,t){const n=typeof e=="string"?this.scroll.create(e,t):e;if(this.parent!=null&&this.parent.insertBefore(n,this.next||void 0),typeof n.appendChild!="function")throw new wr(`Cannot wrap ${e}`);return n.appendChild(this),n}};ah.blotName="abstract";let lh=ah;const uh=class extends lh{static value(e){return!0}index(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1}position(e,t){let n=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};uh.scope=ie.INLINE_BLOT;let Oy=uh;const Te=Oy;class Sy{constructor(){this.head=null,this.tail=null,this.length=0}append(...e){if(this.insertBefore(e[0],null),e.length>1){const t=e.slice(1);this.append(...t)}}at(e){const t=this.iterator();let n=t();for(;n&&e>0;)e-=1,n=t();return n}contains(e){const t=this.iterator();let n=t();for(;n;){if(n===e)return!0;n=t()}return!1}indexOf(e){const t=this.iterator();let n=t(),i=0;for(;n;){if(n===e)return i;i+=1,n=t()}return-1}insertBefore(e,t){e!=null&&(this.remove(e),e.next=t,t!=null?(e.prev=t.prev,t.prev!=null&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):this.tail!=null?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)}offset(e){let t=0,n=this.head;for(;n!=null;){if(n===e)return t;t+=n.length(),n=n.next}return-1}remove(e){this.contains(e)&&(e.prev!=null&&(e.prev.next=e.next),e.next!=null&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)}iterator(e=this.head){return()=>{const t=e;return e!=null&&(e=e.next),t}}find(e,t=!1){const n=this.iterator();let i=n();for(;i;){const s=i.length();if(e<s||t&&e===s&&(i.next==null||i.next.length()!==0))return[i,e];e-=s,i=n()}return[null,0]}forEach(e){const t=this.iterator();let n=t();for(;n;)e(n),n=t()}forEachAt(e,t,n){if(t<=0)return;const[i,s]=this.find(e);let l=e-s;const u=this.iterator(i);let a=u();for(;a&&l<e+t;){const o=a.length();e>l?n(a,e-l,Math.min(t,l+o-e)):n(a,0,Math.min(o,e+t-l)),l+=o,a=u()}}map(e){return this.reduce((t,n)=>(t.push(e(n)),t),[])}reduce(e,t){const n=this.iterator();let i=n();for(;i;)t=e(t,i),i=n();return t}}function du(r,e){const t=e.find(r);if(t)return t;try{return e.create(r)}catch{const n=e.create(ie.INLINE);return Array.from(r.childNodes).forEach(i=>{n.domNode.appendChild(i)}),r.parentNode&&r.parentNode.replaceChild(n.domNode,r),n.attach(),n}}const ch=class qt extends lh{constructor(e,t){super(e,t),this.uiNode=null,this.build()}appendChild(e){this.insertBefore(e)}attach(){super.attach(),this.children.forEach(e=>{e.attach()})}attachUI(e){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=e,qt.uiClass&&this.uiNode.classList.add(qt.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Sy,Array.from(this.domNode.childNodes).filter(e=>e!==this.uiNode).reverse().forEach(e=>{try{const t=du(e,this.scroll);this.insertBefore(t,this.children.head||void 0)}catch(t){if(t instanceof wr)return;throw t}})}deleteAt(e,t){if(e===0&&t===this.length())return this.remove();this.children.forEachAt(e,t,(n,i,s)=>{n.deleteAt(i,s)})}descendant(e,t=0){const[n,i]=this.children.find(t);return e.blotName==null&&e(n)||e.blotName!=null&&n instanceof e?[n,i]:n instanceof qt?n.descendant(e,i):[null,-1]}descendants(e,t=0,n=Number.MAX_VALUE){let i=[],s=n;return this.children.forEachAt(t,n,(l,u,a)=>{(e.blotName==null&&e(l)||e.blotName!=null&&l instanceof e)&&i.push(l),l instanceof qt&&(i=i.concat(l.descendants(e,u,s))),s-=a}),i}detach(){this.children.forEach(e=>{e.detach()}),super.detach()}enforceAllowedChildren(){let e=!1;this.children.forEach(t=>{e||this.statics.allowedChildren.some(n=>t instanceof n)||(t.statics.scope===ie.BLOCK_BLOT?(t.next!=null&&this.splitAfter(t),t.prev!=null&&this.splitAfter(t.prev),t.parent.unwrap(),e=!0):t instanceof qt?t.unwrap():t.remove())})}formatAt(e,t,n,i){this.children.forEachAt(e,t,(s,l,u)=>{s.formatAt(l,u,n,i)})}insertAt(e,t,n){const[i,s]=this.children.find(e);if(i)i.insertAt(s,t,n);else{const l=n==null?this.scroll.create("text",t):this.scroll.create(t,n);this.appendChild(l)}}insertBefore(e,t){e.parent!=null&&e.parent.children.remove(e);let n=null;this.children.insertBefore(e,t||null),e.parent=this,t!=null&&(n=t.domNode),(this.domNode.parentNode!==e.domNode||this.domNode.nextSibling!==n)&&this.domNode.insertBefore(e.domNode,n),e.attach()}length(){return this.children.reduce((e,t)=>e+t.length(),0)}moveChildren(e,t){this.children.forEach(n=>{e.insertBefore(n,t)})}optimize(e){if(super.optimize(e),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const t=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(t)}else this.remove()}path(e,t=!1){const[n,i]=this.children.find(e,t),s=[[this,e]];return n instanceof qt?s.concat(n.path(i,t)):(n!=null&&s.push([n,i]),s)}removeChild(e){this.children.remove(e)}replaceWith(e,t){const n=typeof e=="string"?this.scroll.create(e,t):e;return n instanceof qt&&this.moveChildren(n),super.replaceWith(n)}split(e,t=!1){if(!t){if(e===0)return this;if(e===this.length())return this.next}const n=this.clone();return this.parent&&this.parent.insertBefore(n,this.next||void 0),this.children.forEachAt(e,this.length(),(i,s,l)=>{const u=i.split(s,t);u!=null&&n.appendChild(u)}),n}splitAfter(e){const t=this.clone();for(;e.next!=null;)t.appendChild(e.next);return this.parent&&this.parent.insertBefore(t,this.next||void 0),t}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(e,t){const n=[],i=[];e.forEach(s=>{s.target===this.domNode&&s.type==="childList"&&(n.push(...s.addedNodes),i.push(...s.removedNodes))}),i.forEach(s=>{if(s.parentNode!=null&&s.tagName!=="IFRAME"&&document.body.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const l=this.scroll.find(s);l!=null&&(l.domNode.parentNode==null||l.domNode.parentNode===this.domNode)&&l.detach()}),n.filter(s=>s.parentNode===this.domNode&&s!==this.uiNode).sort((s,l)=>s===l?0:s.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(s=>{let l=null;s.nextSibling!=null&&(l=this.scroll.find(s.nextSibling));const u=du(s,this.scroll);(u.next!==l||u.next==null)&&(u.parent!=null&&u.parent.removeChild(this),this.insertBefore(u,l||void 0))}),this.enforceAllowedChildren()}};ch.uiClass="";let wy=ch;const Je=wy;function Ry(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}const yr=class br extends Je{static create(e){return super.create(e)}static formats(e,t){const n=t.query(br.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new $i(this.domNode)}format(e,t){if(e===this.statics.blotName&&!t)this.children.forEach(n=>{n instanceof br||(n=n.wrap(br.blotName,!0)),this.attributes.copy(n)}),this.unwrap();else{const n=this.scroll.query(e,ie.INLINE);if(n==null)return;n instanceof ft?this.attributes.attribute(n,t):t&&(e!==this.statics.blotName||this.formats()[e]!==t)&&this.replaceWith(e,t)}}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return t!=null&&(e[this.statics.blotName]=t),e}formatAt(e,t,n,i){this.formats()[n]!=null||this.scroll.query(n,ie.ATTRIBUTE)?this.isolate(e,t).format(n,i):super.formatAt(e,t,n,i)}optimize(e){super.optimize(e);const t=this.formats();if(Object.keys(t).length===0)return this.unwrap();const n=this.next;n instanceof br&&n.prev===this&&Ry(t,n.formats())&&(n.moveChildren(this),n.remove())}replaceWith(e,t){const n=super.replaceWith(e,t);return this.attributes.copy(n),n}update(e,t){super.update(e,t),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}wrap(e,t){const n=super.wrap(e,t);return n instanceof br&&this.attributes.move(n),n}};yr.allowedChildren=[yr,Te],yr.blotName="inline",yr.scope=ie.INLINE_BLOT,yr.tagName="SPAN";let Ty=yr;const pl=Ty,_r=class za extends Je{static create(e){return super.create(e)}static formats(e,t){const n=t.query(za.blotName);if(!(n!=null&&e.tagName===n.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return e.tagName.toLowerCase()}}constructor(e,t){super(e,t),this.attributes=new $i(this.domNode)}format(e,t){const n=this.scroll.query(e,ie.BLOCK);n!=null&&(n instanceof ft?this.attributes.attribute(n,t):e===this.statics.blotName&&!t?this.replaceWith(za.blotName):t&&(e!==this.statics.blotName||this.formats()[e]!==t)&&this.replaceWith(e,t))}formats(){const e=this.attributes.values(),t=this.statics.formats(this.domNode,this.scroll);return t!=null&&(e[this.statics.blotName]=t),e}formatAt(e,t,n,i){this.scroll.query(n,ie.BLOCK)!=null?this.format(n,i):super.formatAt(e,t,n,i)}insertAt(e,t,n){if(n==null||this.scroll.query(t,ie.INLINE)!=null)super.insertAt(e,t,n);else{const i=this.split(e);if(i!=null){const s=this.scroll.create(t,n);i.parent.insertBefore(s,i)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(e,t){const n=super.replaceWith(e,t);return this.attributes.copy(n),n}update(e,t){super.update(e,t),e.some(n=>n.target===this.domNode&&n.type==="attributes")&&this.attributes.build()}};_r.blotName="block",_r.scope=ie.BLOCK_BLOT,_r.tagName="P",_r.allowedChildren=[pl,_r,Te];let Ny=_r;const pn=Ny,Wa=class extends Je{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(e,t){super.deleteAt(e,t),this.enforceAllowedChildren()}formatAt(e,t,n,i){super.formatAt(e,t,n,i),this.enforceAllowedChildren()}insertAt(e,t,n){super.insertAt(e,t,n),this.enforceAllowedChildren()}optimize(e){super.optimize(e),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Wa.blotName="container",Wa.scope=ie.BLOCK_BLOT;let Ly=Wa;const Fi=Ly;class Iy extends Te{static formats(e,t){}format(e,t){super.formatAt(0,this.length(),e,t)}formatAt(e,t,n,i){e===0&&t===this.length()?this.format(n,i):super.formatAt(e,t,n,i)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const ke=Iy,qy={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Py=100,Er=class extends Je{constructor(e,t){super(null,t),this.registry=e,this.scroll=this,this.build(),this.observer=new MutationObserver(n=>{this.update(n)}),this.observer.observe(this.domNode,qy),this.attach()}create(e,t){return this.registry.create(this,e,t)}find(e,t=!1){const n=this.registry.find(e,t);return n?n.scroll===this?n:t?this.find(n.scroll.domNode.parentNode,!0):null:null}query(e,t=ie.ANY){return this.registry.query(e,t)}register(...e){return this.registry.register(...e)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(e,t){this.update(),e===0&&t===this.length()?this.children.forEach(n=>{n.remove()}):super.deleteAt(e,t)}formatAt(e,t,n,i){this.update(),super.formatAt(e,t,n,i)}insertAt(e,t,n){this.update(),super.insertAt(e,t,n)}optimize(e=[],t={}){super.optimize(t);const n=t.mutationsMap||new WeakMap;let i=Array.from(this.observer.takeRecords());for(;i.length>0;)e.push(i.pop());const s=(a,o=!0)=>{a==null||a===this||a.domNode.parentNode!=null&&(n.has(a.domNode)||n.set(a.domNode,[]),o&&s(a.parent))},l=a=>{n.has(a.domNode)&&(a instanceof Je&&a.children.forEach(l),n.delete(a.domNode),a.optimize(t))};let u=e;for(let a=0;u.length>0;a+=1){if(a>=Py)throw new Error("[Parchment] Maximum optimize iterations reached");for(u.forEach(o=>{const c=this.find(o.target,!0);c!=null&&(c.domNode===o.target&&(o.type==="childList"?(s(this.find(o.previousSibling,!1)),Array.from(o.addedNodes).forEach(d=>{const p=this.find(d,!1);s(p,!1),p instanceof Je&&p.children.forEach(h=>{s(h,!1)})})):o.type==="attributes"&&s(c.prev)),s(c))}),this.children.forEach(l),u=Array.from(this.observer.takeRecords()),i=u.slice();i.length>0;)e.push(i.pop())}}update(e,t={}){e=e||this.observer.takeRecords();const n=new WeakMap;e.map(i=>{const s=this.find(i.target,!0);return s==null?null:n.has(s.domNode)?(n.get(s.domNode).push(i),null):(n.set(s.domNode,[i]),s)}).forEach(i=>{i!=null&&i!==this&&n.has(i.domNode)&&i.update(n.get(i.domNode)||[],t)}),t.mutationsMap=n,n.has(this.domNode)&&super.update(n.get(this.domNode),t),this.optimize(e,t)}};Er.blotName="scroll",Er.defaultChild=pn,Er.allowedChildren=[pn,Fi],Er.scope=ie.BLOCK_BLOT,Er.tagName="DIV";let Cy=Er;const gl=Cy,Ka=class fh extends Te{static create(e){return document.createTextNode(e)}static value(e){return e.data}constructor(e,t){super(e,t),this.text=this.statics.value(this.domNode)}deleteAt(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)}index(e,t){return this.domNode===e?t:-1}insertAt(e,t,n){n==null?(this.text=this.text.slice(0,e)+t+this.text.slice(e),this.domNode.data=this.text):super.insertAt(e,t,n)}length(){return this.text.length}optimize(e){super.optimize(e),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof fh&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(e,t=!1){return[this.domNode,e]}split(e,t=!1){if(!t){if(e===0)return this;if(e===this.length())return this.next}const n=this.scroll.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next||void 0),this.text=this.statics.value(this.domNode),n}update(e,t){e.some(n=>n.type==="characterData"&&n.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Ka.blotName="text",Ka.scope=ie.INLINE_BLOT;let xy=Ka;const yi=xy,Dy=Object.freeze(Object.defineProperty({__proto__:null,Attributor:ft,AttributorStore:$i,BlockBlot:pn,ClassAttributor:et,ContainerBlot:Fi,EmbedBlot:ke,InlineBlot:pl,LeafBlot:Te,ParentBlot:Je,Registry:Nr,Scope:ie,ScrollBlot:gl,StyleAttributor:Bt,TextBlot:yi},Symbol.toStringTag,{value:"Module"}));function Ui(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function My(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function n(){var i=!1;try{i=this instanceof n}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var Xn={exports:{}},Ws,pu;function ky(){if(pu)return Ws;pu=1;var r=-1,e=1,t=0;function n(O,x,L,j,H){if(O===x)return O?[[t,O]]:[];if(L!=null){var M=C(O,x,L);if(M)return M}var U=u(O,x),V=O.substring(0,U);O=O.substring(U),x=x.substring(U),U=o(O,x);var z=O.substring(O.length-U);O=O.substring(0,O.length-U),x=x.substring(0,x.length-U);var F=i(O,x);return V&&F.unshift([t,V]),z&&F.push([t,z]),R(F,H),j&&d(F),F}function i(O,x){var L;if(!O)return[[e,x]];if(!x)return[[r,O]];var j=O.length>x.length?O:x,H=O.length>x.length?x:O,M=j.indexOf(H);if(M!==-1)return L=[[e,j.substring(0,M)],[t,H],[e,j.substring(M+H.length)]],O.length>x.length&&(L[0][0]=L[2][0]=r),L;if(H.length===1)return[[r,O],[e,x]];var U=c(O,x);if(U){var V=U[0],z=U[1],F=U[2],X=U[3],Y=U[4],N=n(V,F),q=n(z,X);return N.concat([[t,Y]],q)}return s(O,x)}function s(O,x){for(var L=O.length,j=x.length,H=Math.ceil((L+j)/2),M=H,U=2*H,V=new Array(U),z=new Array(U),F=0;F<U;F++)V[F]=-1,z[F]=-1;V[M+1]=0,z[M+1]=0;for(var X=L-j,Y=X%2!==0,N=0,q=0,P=0,W=0,ee=0;ee<H;ee++){for(var J=-ee+N;J<=ee-q;J+=2){var K=M+J,G;J===-ee||J!==ee&&V[K-1]<V[K+1]?G=V[K+1]:G=V[K-1]+1;for(var Z=G-J;G<L&&Z<j&&O.charAt(G)===x.charAt(Z);)G++,Z++;if(V[K]=G,G>L)q+=2;else if(Z>j)N+=2;else if(Y){var te=M+X-J;if(te>=0&&te<U&&z[te]!==-1){var oe=L-z[te];if(G>=oe)return l(O,x,G,Z)}}}for(var ce=-ee+P;ce<=ee-W;ce+=2){var te=M+ce,oe;ce===-ee||ce!==ee&&z[te-1]<z[te+1]?oe=z[te+1]:oe=z[te-1]+1;for(var de=oe-ce;oe<L&&de<j&&O.charAt(L-oe-1)===x.charAt(j-de-1);)oe++,de++;if(z[te]=oe,oe>L)W+=2;else if(de>j)P+=2;else if(!Y){var K=M+X-ce;if(K>=0&&K<U&&V[K]!==-1){var G=V[K],Z=M+G-K;if(oe=L-oe,G>=oe)return l(O,x,G,Z)}}}}return[[r,O],[e,x]]}function l(O,x,L,j){var H=O.substring(0,L),M=x.substring(0,j),U=O.substring(L),V=x.substring(j),z=n(H,M),F=n(U,V);return z.concat(F)}function u(O,x){if(!O||!x||O.charAt(0)!==x.charAt(0))return 0;for(var L=0,j=Math.min(O.length,x.length),H=j,M=0;L<H;)O.substring(M,H)==x.substring(M,H)?(L=H,M=L):j=H,H=Math.floor((j-L)/2+L);return y(O.charCodeAt(H-1))&&H--,H}function a(O,x){var L=O.length,j=x.length;if(L==0||j==0)return 0;L>j?O=O.substring(L-j):L<j&&(x=x.substring(0,L));var H=Math.min(L,j);if(O==x)return H;for(var M=0,U=1;;){var V=O.substring(H-U),z=x.indexOf(V);if(z==-1)return M;U+=z,(z==0||O.substring(H-U)==x.substring(0,U))&&(M=U,U++)}}function o(O,x){if(!O||!x||O.slice(-1)!==x.slice(-1))return 0;for(var L=0,j=Math.min(O.length,x.length),H=j,M=0;L<H;)O.substring(O.length-H,O.length-M)==x.substring(x.length-H,x.length-M)?(L=H,M=L):j=H,H=Math.floor((j-L)/2+L);return g(O.charCodeAt(O.length-H))&&H--,H}function c(O,x){var L=O.length>x.length?O:x,j=O.length>x.length?x:O;if(L.length<4||j.length*2<L.length)return null;function H(q,P,W){for(var ee=q.substring(W,W+Math.floor(q.length/4)),J=-1,K="",G,Z,te,oe;(J=P.indexOf(ee,J+1))!==-1;){var ce=u(q.substring(W),P.substring(J)),de=o(q.substring(0,W),P.substring(0,J));K.length<de+ce&&(K=P.substring(J-de,J)+P.substring(J,J+ce),G=q.substring(0,W-de),Z=q.substring(W+ce),te=P.substring(0,J-de),oe=P.substring(J+ce))}return K.length*2>=q.length?[G,Z,te,oe,K]:null}var M=H(L,j,Math.ceil(L.length/4)),U=H(L,j,Math.ceil(L.length/2)),V;if(!M&&!U)return null;U?M?V=M[4].length>U[4].length?M:U:V=U:V=M;var z,F,X,Y;O.length>x.length?(z=V[0],F=V[1],X=V[2],Y=V[3]):(X=V[0],Y=V[1],z=V[2],F=V[3]);var N=V[4];return[z,F,X,Y,N]}function d(O){for(var x=!1,L=[],j=0,H=null,M=0,U=0,V=0,z=0,F=0;M<O.length;)O[M][0]==t?(L[j++]=M,U=z,V=F,z=0,F=0,H=O[M][1]):(O[M][0]==e?z+=O[M][1].length:F+=O[M][1].length,H&&H.length<=Math.max(U,V)&&H.length<=Math.max(z,F)&&(O.splice(L[j-1],0,[r,H]),O[L[j-1]+1][0]=e,j--,j--,M=j>0?L[j-1]:-1,U=0,V=0,z=0,F=0,H=null,x=!0)),M++;for(x&&R(O),w(O),M=1;M<O.length;){if(O[M-1][0]==r&&O[M][0]==e){var X=O[M-1][1],Y=O[M][1],N=a(X,Y),q=a(Y,X);N>=q?(N>=X.length/2||N>=Y.length/2)&&(O.splice(M,0,[t,Y.substring(0,N)]),O[M-1][1]=X.substring(0,X.length-N),O[M+1][1]=Y.substring(N),M++):(q>=X.length/2||q>=Y.length/2)&&(O.splice(M,0,[t,X.substring(0,q)]),O[M-1][0]=e,O[M-1][1]=Y.substring(0,Y.length-q),O[M+1][0]=r,O[M+1][1]=X.substring(q),M++),M++}M++}}var p=/[^a-zA-Z0-9]/,h=/\s/,v=/[\r\n]/,_=/\n\r?\n$/,E=/^\r?\n\r?\n/;function w(O){function x(q,P){if(!q||!P)return 6;var W=q.charAt(q.length-1),ee=P.charAt(0),J=W.match(p),K=ee.match(p),G=J&&W.match(h),Z=K&&ee.match(h),te=G&&W.match(v),oe=Z&&ee.match(v),ce=te&&q.match(_),de=oe&&P.match(E);return ce||de?5:te||oe?4:J&&!G&&Z?3:G||Z?2:J||K?1:0}for(var L=1;L<O.length-1;){if(O[L-1][0]==t&&O[L+1][0]==t){var j=O[L-1][1],H=O[L][1],M=O[L+1][1],U=o(j,H);if(U){var V=H.substring(H.length-U);j=j.substring(0,j.length-U),H=V+H.substring(0,H.length-U),M=V+M}for(var z=j,F=H,X=M,Y=x(j,H)+x(H,M);H.charAt(0)===M.charAt(0);){j+=H.charAt(0),H=H.substring(1)+M.charAt(0),M=M.substring(1);var N=x(j,H)+x(H,M);N>=Y&&(Y=N,z=j,F=H,X=M)}O[L-1][1]!=z&&(z?O[L-1][1]=z:(O.splice(L-1,1),L--),O[L][1]=F,X?O[L+1][1]=X:(O.splice(L+1,1),L--))}L++}}function R(O,x){O.push([t,""]);for(var L=0,j=0,H=0,M="",U="",V;L<O.length;){if(L<O.length-1&&!O[L][1]){O.splice(L,1);continue}switch(O[L][0]){case e:H++,U+=O[L][1],L++;break;case r:j++,M+=O[L][1],L++;break;case t:var z=L-H-j-1;if(x){if(z>=0&&A(O[z][1])){var F=O[z][1].slice(-1);if(O[z][1]=O[z][1].slice(0,-1),M=F+M,U=F+U,!O[z][1]){O.splice(z,1),L--;var X=z-1;O[X]&&O[X][0]===e&&(H++,U=O[X][1]+U,X--),O[X]&&O[X][0]===r&&(j++,M=O[X][1]+M,X--),z=X}}if(m(O[L][1])){var F=O[L][1].charAt(0);O[L][1]=O[L][1].slice(1),M+=F,U+=F}}if(L<O.length-1&&!O[L][1]){O.splice(L,1);break}if(M.length>0||U.length>0){M.length>0&&U.length>0&&(V=u(U,M),V!==0&&(z>=0?O[z][1]+=U.substring(0,V):(O.splice(0,0,[t,U.substring(0,V)]),L++),U=U.substring(V),M=M.substring(V)),V=o(U,M),V!==0&&(O[L][1]=U.substring(U.length-V)+O[L][1],U=U.substring(0,U.length-V),M=M.substring(0,M.length-V)));var Y=H+j;M.length===0&&U.length===0?(O.splice(L-Y,Y),L=L-Y):M.length===0?(O.splice(L-Y,Y,[e,U]),L=L-Y+1):U.length===0?(O.splice(L-Y,Y,[r,M]),L=L-Y+1):(O.splice(L-Y,Y,[r,M],[e,U]),L=L-Y+2)}L!==0&&O[L-1][0]===t?(O[L-1][1]+=O[L][1],O.splice(L,1)):L++,H=0,j=0,M="",U="";break}}O[O.length-1][1]===""&&O.pop();var N=!1;for(L=1;L<O.length-1;)O[L-1][0]===t&&O[L+1][0]===t&&(O[L][1].substring(O[L][1].length-O[L-1][1].length)===O[L-1][1]?(O[L][1]=O[L-1][1]+O[L][1].substring(0,O[L][1].length-O[L-1][1].length),O[L+1][1]=O[L-1][1]+O[L+1][1],O.splice(L-1,1),N=!0):O[L][1].substring(0,O[L+1][1].length)==O[L+1][1]&&(O[L-1][1]+=O[L+1][1],O[L][1]=O[L][1].substring(O[L+1][1].length)+O[L+1][1],O.splice(L+1,1),N=!0)),L++;N&&R(O,x)}function y(O){return O>=55296&&O<=56319}function g(O){return O>=56320&&O<=57343}function m(O){return g(O.charCodeAt(0))}function A(O){return y(O.charCodeAt(O.length-1))}function S(O){for(var x=[],L=0;L<O.length;L++)O[L][1].length>0&&x.push(O[L]);return x}function I(O,x,L,j){return A(O)||m(j)?null:S([[t,O],[r,x],[e,L],[t,j]])}function C(O,x,L){var j=typeof L=="number"?{index:L,length:0}:L.oldRange,H=typeof L=="number"?null:L.newRange,M=O.length,U=x.length;if(j.length===0&&(H===null||H.length===0)){var V=j.index,z=O.slice(0,V),F=O.slice(V),X=H?H.index:null;e:{var Y=V+U-M;if(X!==null&&X!==Y||Y<0||Y>U)break e;var N=x.slice(0,Y),q=x.slice(Y);if(q!==F)break e;var P=Math.min(V,Y),W=z.slice(0,P),ee=N.slice(0,P);if(W!==ee)break e;var J=z.slice(P),K=N.slice(P);return I(W,J,K,F)}e:{if(X!==null&&X!==V)break e;var G=V,N=x.slice(0,G),q=x.slice(G);if(N!==z)break e;var Z=Math.min(M-G,U-G),te=F.slice(F.length-Z),oe=q.slice(q.length-Z);if(te!==oe)break e;var J=F.slice(0,F.length-Z),K=q.slice(0,q.length-Z);return I(z,J,K,te)}}if(j.length>0&&H&&H.length===0)e:{var W=O.slice(0,j.index),te=O.slice(j.index+j.length),P=W.length,Z=te.length;if(U<P+Z)break e;var ee=x.slice(0,P),oe=x.slice(U-Z);if(W!==ee||te!==oe)break e;var J=O.slice(P,M-Z),K=x.slice(P,U-Z);return I(W,J,K,te)}return null}function D(O,x,L,j){return n(O,x,L,j,!0)}return D.INSERT=e,D.DELETE=r,D.EQUAL=t,Ws=D,Ws}var rn={exports:{}};rn.exports;var gu;function Hi(){return gu||(gu=1,(function(r,e){var t=200,n="__lodash_hash_undefined__",i=9007199254740991,s="[object Arguments]",l="[object Array]",u="[object Boolean]",a="[object Date]",o="[object Error]",c="[object Function]",d="[object GeneratorFunction]",p="[object Map]",h="[object Number]",v="[object Object]",_="[object Promise]",E="[object RegExp]",w="[object Set]",R="[object String]",y="[object Symbol]",g="[object WeakMap]",m="[object ArrayBuffer]",A="[object DataView]",S="[object Float32Array]",I="[object Float64Array]",C="[object Int8Array]",D="[object Int16Array]",O="[object Int32Array]",x="[object Uint8Array]",L="[object Uint8ClampedArray]",j="[object Uint16Array]",H="[object Uint32Array]",M=/[\\^$.*+?()[\]{}|]/g,U=/\w*$/,V=/^\[object .+?Constructor\]$/,z=/^(?:0|[1-9]\d*)$/,F={};F[s]=F[l]=F[m]=F[A]=F[u]=F[a]=F[S]=F[I]=F[C]=F[D]=F[O]=F[p]=F[h]=F[v]=F[E]=F[w]=F[R]=F[y]=F[x]=F[L]=F[j]=F[H]=!0,F[o]=F[c]=F[g]=!1;var X=typeof window=="object"&&window&&window.Object===Object&&window,Y=typeof self=="object"&&self&&self.Object===Object&&self,N=X||Y||Function("return this")(),q=e&&!e.nodeType&&e,P=q&&!0&&r&&!r.nodeType&&r,W=P&&P.exports===q;function ee(f,b){return f.set(b[0],b[1]),f}function J(f,b){return f.add(b),f}function K(f,b){for(var T=-1,k=f?f.length:0;++T<k&&b(f[T],T,f)!==!1;);return f}function G(f,b){for(var T=-1,k=b.length,ae=f.length;++T<k;)f[ae+T]=b[T];return f}function Z(f,b,T,k){for(var ae=-1,se=f?f.length:0;++ae<se;)T=b(T,f[ae],ae,f);return T}function te(f,b){for(var T=-1,k=Array(f);++T<f;)k[T]=b(T);return k}function oe(f,b){return f==null?void 0:f[b]}function ce(f){var b=!1;if(f!=null&&typeof f.toString!="function")try{b=!!(f+"")}catch{}return b}function de(f){var b=-1,T=Array(f.size);return f.forEach(function(k,ae){T[++b]=[ae,k]}),T}function me(f,b){return function(T){return f(b(T))}}function Ve(f){var b=-1,T=Array(f.size);return f.forEach(function(k){T[++b]=k}),T}var pt=Array.prototype,$=Function.prototype,qe=Object.prototype,Oe=N["__core-js_shared__"],gt=(function(){var f=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""})(),mt=$.toString,Le=qe.hasOwnProperty,sr=qe.toString,is=RegExp("^"+mt.call(Le).replace(M,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=W?N.Buffer:void 0,or=N.Symbol,Br=N.Uint8Array,je=me(Object.getPrototypeOf,Object),Dn=Object.create,Mn=qe.propertyIsEnumerable,ss=pt.splice,$r=Object.getOwnPropertySymbols,ar=Ut?Ut.isBuffer:void 0,kn=me(Object.keys,Object),lr=ze(N,"DataView"),Ht=ze(N,"Map"),Ge=ze(N,"Promise"),ur=ze(N,"Set"),Fr=ze(N,"WeakMap"),Vt=ze(Object,"create"),Ur=Ie(lr),Gt=Ie(Ht),Hr=Ie(Ge),Vr=Ie(ur),Gr=Ie(Fr),Nt=or?or.prototype:void 0,jn=Nt?Nt.valueOf:void 0;function vt(f){var b=-1,T=f?f.length:0;for(this.clear();++b<T;){var k=f[b];this.set(k[0],k[1])}}function os(){this.__data__=Vt?Vt(null):{}}function as(f){return this.has(f)&&delete this.__data__[f]}function ls(f){var b=this.__data__;if(Vt){var T=b[f];return T===n?void 0:T}return Le.call(b,f)?b[f]:void 0}function Bn(f){var b=this.__data__;return Vt?b[f]!==void 0:Le.call(b,f)}function zr(f,b){var T=this.__data__;return T[f]=Vt&&b===void 0?n:b,this}vt.prototype.clear=os,vt.prototype.delete=as,vt.prototype.get=ls,vt.prototype.has=Bn,vt.prototype.set=zr;function _e(f){var b=-1,T=f?f.length:0;for(this.clear();++b<T;){var k=f[b];this.set(k[0],k[1])}}function us(){this.__data__=[]}function cs(f){var b=this.__data__,T=fr(b,f);if(T<0)return!1;var k=b.length-1;return T==k?b.pop():ss.call(b,T,1),!0}function fs(f){var b=this.__data__,T=fr(b,f);return T<0?void 0:b[T][1]}function hs(f){return fr(this.__data__,f)>-1}function ds(f,b){var T=this.__data__,k=fr(T,f);return k<0?T.push([f,b]):T[k][1]=b,this}_e.prototype.clear=us,_e.prototype.delete=cs,_e.prototype.get=fs,_e.prototype.has=hs,_e.prototype.set=ds;function Se(f){var b=-1,T=f?f.length:0;for(this.clear();++b<T;){var k=f[b];this.set(k[0],k[1])}}function ps(){this.__data__={hash:new vt,map:new(Ht||_e),string:new vt}}function gs(f){return Wt(this,f).delete(f)}function ms(f){return Wt(this,f).get(f)}function vs(f){return Wt(this,f).has(f)}function ys(f,b){return Wt(this,f).set(f,b),this}Se.prototype.clear=ps,Se.prototype.delete=gs,Se.prototype.get=ms,Se.prototype.has=vs,Se.prototype.set=ys;function Pe(f){this.__data__=new _e(f)}function bs(){this.__data__=new _e}function _s(f){return this.__data__.delete(f)}function Es(f){return this.__data__.get(f)}function As(f){return this.__data__.has(f)}function Os(f,b){var T=this.__data__;if(T instanceof _e){var k=T.__data__;if(!Ht||k.length<t-1)return k.push([f,b]),this;T=this.__data__=new Se(k)}return T.set(f,b),this}Pe.prototype.clear=bs,Pe.prototype.delete=_s,Pe.prototype.get=Es,Pe.prototype.has=As,Pe.prototype.set=Os;function cr(f,b){var T=Zr(f)||dr(f)?te(f.length,String):[],k=T.length,ae=!!k;for(var se in f)Le.call(f,se)&&!(ae&&(se=="length"||ks(se,k)))&&T.push(se);return T}function $n(f,b,T){var k=f[b];(!(Le.call(f,b)&&Gn(k,T))||T===void 0&&!(b in f))&&(f[b]=T)}function fr(f,b){for(var T=f.length;T--;)if(Gn(f[T][0],b))return T;return-1}function st(f,b){return f&&Yr(b,Xr(b),f)}function Wr(f,b,T,k,ae,se,he){var fe;if(k&&(fe=se?k(f,ae,se,he):k(f)),fe!==void 0)return fe;if(!at(f))return f;var ye=Zr(f);if(ye){if(fe=Ds(f),!b)return Ps(f,fe)}else{var pe=bt(f),we=pe==c||pe==d;if(zn(f))return hr(f,b);if(pe==v||pe==s||we&&!se){if(ce(f))return se?f:{};if(fe=ot(we?{}:f),!b)return Cs(f,st(fe,f))}else{if(!F[pe])return se?f:{};fe=Ms(f,pe,Wr,b)}}he||(he=new Pe);var Ce=he.get(f);if(Ce)return Ce;if(he.set(f,fe),!ye)var be=T?xs(f):Xr(f);return K(be||f,function(Re,Ee){be&&(Ee=Re,Re=f[Ee]),$n(fe,Ee,Wr(Re,b,T,k,Ee,f,he))}),fe}function Ss(f){return at(f)?Dn(f):{}}function ws(f,b,T){var k=b(f);return Zr(f)?k:G(k,T(f))}function Rs(f){return sr.call(f)}function Ts(f){if(!at(f)||Bs(f))return!1;var b=Jr(f)||ce(f)?is:V;return b.test(Ie(f))}function Ns(f){if(!Hn(f))return kn(f);var b=[];for(var T in Object(f))Le.call(f,T)&&T!="constructor"&&b.push(T);return b}function hr(f,b){if(b)return f.slice();var T=new f.constructor(f.length);return f.copy(T),T}function Kr(f){var b=new f.constructor(f.byteLength);return new Br(b).set(new Br(f)),b}function zt(f,b){var T=b?Kr(f.buffer):f.buffer;return new f.constructor(T,f.byteOffset,f.byteLength)}function Fn(f,b,T){var k=b?T(de(f),!0):de(f);return Z(k,ee,new f.constructor)}function Un(f){var b=new f.constructor(f.source,U.exec(f));return b.lastIndex=f.lastIndex,b}function Ls(f,b,T){var k=b?T(Ve(f),!0):Ve(f);return Z(k,J,new f.constructor)}function Is(f){return jn?Object(jn.call(f)):{}}function qs(f,b){var T=b?Kr(f.buffer):f.buffer;return new f.constructor(T,f.byteOffset,f.length)}function Ps(f,b){var T=-1,k=f.length;for(b||(b=Array(k));++T<k;)b[T]=f[T];return b}function Yr(f,b,T,k){T||(T={});for(var ae=-1,se=b.length;++ae<se;){var he=b[ae],fe=void 0;$n(T,he,fe===void 0?f[he]:fe)}return T}function Cs(f,b){return Yr(f,yt(f),b)}function xs(f){return ws(f,Xr,yt)}function Wt(f,b){var T=f.__data__;return js(b)?T[typeof b=="string"?"string":"hash"]:T.map}function ze(f,b){var T=oe(f,b);return Ts(T)?T:void 0}var yt=$r?me($r,Object):Fs,bt=Rs;(lr&&bt(new lr(new ArrayBuffer(1)))!=A||Ht&&bt(new Ht)!=p||Ge&&bt(Ge.resolve())!=_||ur&&bt(new ur)!=w||Fr&&bt(new Fr)!=g)&&(bt=function(f){var b=sr.call(f),T=b==v?f.constructor:void 0,k=T?Ie(T):void 0;if(k)switch(k){case Ur:return A;case Gt:return p;case Hr:return _;case Vr:return w;case Gr:return g}return b});function Ds(f){var b=f.length,T=f.constructor(b);return b&&typeof f[0]=="string"&&Le.call(f,"index")&&(T.index=f.index,T.input=f.input),T}function ot(f){return typeof f.constructor=="function"&&!Hn(f)?Ss(je(f)):{}}function Ms(f,b,T,k){var ae=f.constructor;switch(b){case m:return Kr(f);case u:case a:return new ae(+f);case A:return zt(f,k);case S:case I:case C:case D:case O:case x:case L:case j:case H:return qs(f,k);case p:return Fn(f,k,T);case h:case R:return new ae(f);case E:return Un(f);case w:return Ls(f,k,T);case y:return Is(f)}}function ks(f,b){return b=b==null?i:b,!!b&&(typeof f=="number"||z.test(f))&&f>-1&&f%1==0&&f<b}function js(f){var b=typeof f;return b=="string"||b=="number"||b=="symbol"||b=="boolean"?f!=="__proto__":f===null}function Bs(f){return!!gt&&gt in f}function Hn(f){var b=f&&f.constructor,T=typeof b=="function"&&b.prototype||qe;return f===T}function Ie(f){if(f!=null){try{return mt.call(f)}catch{}try{return f+""}catch{}}return""}function Vn(f){return Wr(f,!0,!0)}function Gn(f,b){return f===b||f!==f&&b!==b}function dr(f){return $s(f)&&Le.call(f,"callee")&&(!Mn.call(f,"callee")||sr.call(f)==s)}var Zr=Array.isArray;function pr(f){return f!=null&&Wn(f.length)&&!Jr(f)}function $s(f){return Kn(f)&&pr(f)}var zn=ar||Us;function Jr(f){var b=at(f)?sr.call(f):"";return b==c||b==d}function Wn(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=i}function at(f){var b=typeof f;return!!f&&(b=="object"||b=="function")}function Kn(f){return!!f&&typeof f=="object"}function Xr(f){return pr(f)?cr(f):Ns(f)}function Fs(){return[]}function Us(){return!1}r.exports=Vn})(rn,rn.exports)),rn.exports}var nn={exports:{}};nn.exports;var mu;function Vi(){return mu||(mu=1,(function(r,e){var t=200,n="__lodash_hash_undefined__",i=1,s=2,l=9007199254740991,u="[object Arguments]",a="[object Array]",o="[object AsyncFunction]",c="[object Boolean]",d="[object Date]",p="[object Error]",h="[object Function]",v="[object GeneratorFunction]",_="[object Map]",E="[object Number]",w="[object Null]",R="[object Object]",y="[object Promise]",g="[object Proxy]",m="[object RegExp]",A="[object Set]",S="[object String]",I="[object Symbol]",C="[object Undefined]",D="[object WeakMap]",O="[object ArrayBuffer]",x="[object DataView]",L="[object Float32Array]",j="[object Float64Array]",H="[object Int8Array]",M="[object Int16Array]",U="[object Int32Array]",V="[object Uint8Array]",z="[object Uint8ClampedArray]",F="[object Uint16Array]",X="[object Uint32Array]",Y=/[\\^$.*+?()[\]{}|]/g,N=/^\[object .+?Constructor\]$/,q=/^(?:0|[1-9]\d*)$/,P={};P[L]=P[j]=P[H]=P[M]=P[U]=P[V]=P[z]=P[F]=P[X]=!0,P[u]=P[a]=P[O]=P[c]=P[x]=P[d]=P[p]=P[h]=P[_]=P[E]=P[R]=P[m]=P[A]=P[S]=P[D]=!1;var W=typeof window=="object"&&window&&window.Object===Object&&window,ee=typeof self=="object"&&self&&self.Object===Object&&self,J=W||ee||Function("return this")(),K=e&&!e.nodeType&&e,G=K&&!0&&r&&!r.nodeType&&r,Z=G&&G.exports===K,te=Z&&W.process,oe=(function(){try{return te&&te.binding&&te.binding("util")}catch{}})(),ce=oe&&oe.isTypedArray;function de(f,b){for(var T=-1,k=f==null?0:f.length,ae=0,se=[];++T<k;){var he=f[T];b(he,T,f)&&(se[ae++]=he)}return se}function me(f,b){for(var T=-1,k=b.length,ae=f.length;++T<k;)f[ae+T]=b[T];return f}function Ve(f,b){for(var T=-1,k=f==null?0:f.length;++T<k;)if(b(f[T],T,f))return!0;return!1}function pt(f,b){for(var T=-1,k=Array(f);++T<f;)k[T]=b(T);return k}function $(f){return function(b){return f(b)}}function qe(f,b){return f.has(b)}function Oe(f,b){return f==null?void 0:f[b]}function gt(f){var b=-1,T=Array(f.size);return f.forEach(function(k,ae){T[++b]=[ae,k]}),T}function mt(f,b){return function(T){return f(b(T))}}function Le(f){var b=-1,T=Array(f.size);return f.forEach(function(k){T[++b]=k}),T}var sr=Array.prototype,is=Function.prototype,Ut=Object.prototype,or=J["__core-js_shared__"],Br=is.toString,je=Ut.hasOwnProperty,Dn=(function(){var f=/[^.]+$/.exec(or&&or.keys&&or.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""})(),Mn=Ut.toString,ss=RegExp("^"+Br.call(je).replace(Y,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$r=Z?J.Buffer:void 0,ar=J.Symbol,kn=J.Uint8Array,lr=Ut.propertyIsEnumerable,Ht=sr.splice,Ge=ar?ar.toStringTag:void 0,ur=Object.getOwnPropertySymbols,Fr=$r?$r.isBuffer:void 0,Vt=mt(Object.keys,Object),Ur=yt(J,"DataView"),Gt=yt(J,"Map"),Hr=yt(J,"Promise"),Vr=yt(J,"Set"),Gr=yt(J,"WeakMap"),Nt=yt(Object,"create"),jn=Ie(Ur),vt=Ie(Gt),os=Ie(Hr),as=Ie(Vr),ls=Ie(Gr),Bn=ar?ar.prototype:void 0,zr=Bn?Bn.valueOf:void 0;function _e(f){var b=-1,T=f==null?0:f.length;for(this.clear();++b<T;){var k=f[b];this.set(k[0],k[1])}}function us(){this.__data__=Nt?Nt(null):{},this.size=0}function cs(f){var b=this.has(f)&&delete this.__data__[f];return this.size-=b?1:0,b}function fs(f){var b=this.__data__;if(Nt){var T=b[f];return T===n?void 0:T}return je.call(b,f)?b[f]:void 0}function hs(f){var b=this.__data__;return Nt?b[f]!==void 0:je.call(b,f)}function ds(f,b){var T=this.__data__;return this.size+=this.has(f)?0:1,T[f]=Nt&&b===void 0?n:b,this}_e.prototype.clear=us,_e.prototype.delete=cs,_e.prototype.get=fs,_e.prototype.has=hs,_e.prototype.set=ds;function Se(f){var b=-1,T=f==null?0:f.length;for(this.clear();++b<T;){var k=f[b];this.set(k[0],k[1])}}function ps(){this.__data__=[],this.size=0}function gs(f){var b=this.__data__,T=hr(b,f);if(T<0)return!1;var k=b.length-1;return T==k?b.pop():Ht.call(b,T,1),--this.size,!0}function ms(f){var b=this.__data__,T=hr(b,f);return T<0?void 0:b[T][1]}function vs(f){return hr(this.__data__,f)>-1}function ys(f,b){var T=this.__data__,k=hr(T,f);return k<0?(++this.size,T.push([f,b])):T[k][1]=b,this}Se.prototype.clear=ps,Se.prototype.delete=gs,Se.prototype.get=ms,Se.prototype.has=vs,Se.prototype.set=ys;function Pe(f){var b=-1,T=f==null?0:f.length;for(this.clear();++b<T;){var k=f[b];this.set(k[0],k[1])}}function bs(){this.size=0,this.__data__={hash:new _e,map:new(Gt||Se),string:new _e}}function _s(f){var b=ze(this,f).delete(f);return this.size-=b?1:0,b}function Es(f){return ze(this,f).get(f)}function As(f){return ze(this,f).has(f)}function Os(f,b){var T=ze(this,f),k=T.size;return T.set(f,b),this.size+=T.size==k?0:1,this}Pe.prototype.clear=bs,Pe.prototype.delete=_s,Pe.prototype.get=Es,Pe.prototype.has=As,Pe.prototype.set=Os;function cr(f){var b=-1,T=f==null?0:f.length;for(this.__data__=new Pe;++b<T;)this.add(f[b])}function $n(f){return this.__data__.set(f,n),this}function fr(f){return this.__data__.has(f)}cr.prototype.add=cr.prototype.push=$n,cr.prototype.has=fr;function st(f){var b=this.__data__=new Se(f);this.size=b.size}function Wr(){this.__data__=new Se,this.size=0}function Ss(f){var b=this.__data__,T=b.delete(f);return this.size=b.size,T}function ws(f){return this.__data__.get(f)}function Rs(f){return this.__data__.has(f)}function Ts(f,b){var T=this.__data__;if(T instanceof Se){var k=T.__data__;if(!Gt||k.length<t-1)return k.push([f,b]),this.size=++T.size,this;T=this.__data__=new Pe(k)}return T.set(f,b),this.size=T.size,this}st.prototype.clear=Wr,st.prototype.delete=Ss,st.prototype.get=ws,st.prototype.has=Rs,st.prototype.set=Ts;function Ns(f,b){var T=dr(f),k=!T&&Gn(f),ae=!T&&!k&&pr(f),se=!T&&!k&&!ae&&Kn(f),he=T||k||ae||se,fe=he?pt(f.length,String):[],ye=fe.length;for(var pe in f)je.call(f,pe)&&!(he&&(pe=="length"||ae&&(pe=="offset"||pe=="parent")||se&&(pe=="buffer"||pe=="byteLength"||pe=="byteOffset")||Ms(pe,ye)))&&fe.push(pe);return fe}function hr(f,b){for(var T=f.length;T--;)if(Vn(f[T][0],b))return T;return-1}function Kr(f,b,T){var k=b(f);return dr(f)?k:me(k,T(f))}function zt(f){return f==null?f===void 0?C:w:Ge&&Ge in Object(f)?bt(f):Hn(f)}function Fn(f){return at(f)&&zt(f)==u}function Un(f,b,T,k,ae){return f===b?!0:f==null||b==null||!at(f)&&!at(b)?f!==f&&b!==b:Ls(f,b,T,k,Un,ae)}function Ls(f,b,T,k,ae,se){var he=dr(f),fe=dr(b),ye=he?a:ot(f),pe=fe?a:ot(b);ye=ye==u?R:ye,pe=pe==u?R:pe;var we=ye==R,Ce=pe==R,be=ye==pe;if(be&&pr(f)){if(!pr(b))return!1;he=!0,we=!1}if(be&&!we)return se||(se=new st),he||Kn(f)?Yr(f,b,T,k,ae,se):Cs(f,b,ye,T,k,ae,se);if(!(T&i)){var Re=we&&je.call(f,"__wrapped__"),Ee=Ce&&je.call(b,"__wrapped__");if(Re||Ee){var Lt=Re?f.value():f,_t=Ee?b.value():b;return se||(se=new st),ae(Lt,_t,T,k,se)}}return be?(se||(se=new st),xs(f,b,T,k,ae,se)):!1}function Is(f){if(!Wn(f)||js(f))return!1;var b=zn(f)?ss:N;return b.test(Ie(f))}function qs(f){return at(f)&&Jr(f.length)&&!!P[zt(f)]}function Ps(f){if(!Bs(f))return Vt(f);var b=[];for(var T in Object(f))je.call(f,T)&&T!="constructor"&&b.push(T);return b}function Yr(f,b,T,k,ae,se){var he=T&i,fe=f.length,ye=b.length;if(fe!=ye&&!(he&&ye>fe))return!1;var pe=se.get(f);if(pe&&se.get(b))return pe==b;var we=-1,Ce=!0,be=T&s?new cr:void 0;for(se.set(f,b),se.set(b,f);++we<fe;){var Re=f[we],Ee=b[we];if(k)var Lt=he?k(Ee,Re,we,b,f,se):k(Re,Ee,we,f,b,se);if(Lt!==void 0){if(Lt)continue;Ce=!1;break}if(be){if(!Ve(b,function(_t,Kt){if(!qe(be,Kt)&&(Re===_t||ae(Re,_t,T,k,se)))return be.push(Kt)})){Ce=!1;break}}else if(!(Re===Ee||ae(Re,Ee,T,k,se))){Ce=!1;break}}return se.delete(f),se.delete(b),Ce}function Cs(f,b,T,k,ae,se,he){switch(T){case x:if(f.byteLength!=b.byteLength||f.byteOffset!=b.byteOffset)return!1;f=f.buffer,b=b.buffer;case O:return!(f.byteLength!=b.byteLength||!se(new kn(f),new kn(b)));case c:case d:case E:return Vn(+f,+b);case p:return f.name==b.name&&f.message==b.message;case m:case S:return f==b+"";case _:var fe=gt;case A:var ye=k&i;if(fe||(fe=Le),f.size!=b.size&&!ye)return!1;var pe=he.get(f);if(pe)return pe==b;k|=s,he.set(f,b);var we=Yr(fe(f),fe(b),k,ae,se,he);return he.delete(f),we;case I:if(zr)return zr.call(f)==zr.call(b)}return!1}function xs(f,b,T,k,ae,se){var he=T&i,fe=Wt(f),ye=fe.length,pe=Wt(b),we=pe.length;if(ye!=we&&!he)return!1;for(var Ce=ye;Ce--;){var be=fe[Ce];if(!(he?be in b:je.call(b,be)))return!1}var Re=se.get(f);if(Re&&se.get(b))return Re==b;var Ee=!0;se.set(f,b),se.set(b,f);for(var Lt=he;++Ce<ye;){be=fe[Ce];var _t=f[be],Kt=b[be];if(k)var $l=he?k(Kt,_t,be,b,f,se):k(_t,Kt,be,f,b,se);if(!($l===void 0?_t===Kt||ae(_t,Kt,T,k,se):$l)){Ee=!1;break}Lt||(Lt=be=="constructor")}if(Ee&&!Lt){var Yn=f.constructor,Zn=b.constructor;Yn!=Zn&&"constructor"in f&&"constructor"in b&&!(typeof Yn=="function"&&Yn instanceof Yn&&typeof Zn=="function"&&Zn instanceof Zn)&&(Ee=!1)}return se.delete(f),se.delete(b),Ee}function Wt(f){return Kr(f,Xr,Ds)}function ze(f,b){var T=f.__data__;return ks(b)?T[typeof b=="string"?"string":"hash"]:T.map}function yt(f,b){var T=Oe(f,b);return Is(T)?T:void 0}function bt(f){var b=je.call(f,Ge),T=f[Ge];try{f[Ge]=void 0;var k=!0}catch{}var ae=Mn.call(f);return k&&(b?f[Ge]=T:delete f[Ge]),ae}var Ds=ur?function(f){return f==null?[]:(f=Object(f),de(ur(f),function(b){return lr.call(f,b)}))}:Fs,ot=zt;(Ur&&ot(new Ur(new ArrayBuffer(1)))!=x||Gt&&ot(new Gt)!=_||Hr&&ot(Hr.resolve())!=y||Vr&&ot(new Vr)!=A||Gr&&ot(new Gr)!=D)&&(ot=function(f){var b=zt(f),T=b==R?f.constructor:void 0,k=T?Ie(T):"";if(k)switch(k){case jn:return x;case vt:return _;case os:return y;case as:return A;case ls:return D}return b});function Ms(f,b){return b=b==null?l:b,!!b&&(typeof f=="number"||q.test(f))&&f>-1&&f%1==0&&f<b}function ks(f){var b=typeof f;return b=="string"||b=="number"||b=="symbol"||b=="boolean"?f!=="__proto__":f===null}function js(f){return!!Dn&&Dn in f}function Bs(f){var b=f&&f.constructor,T=typeof b=="function"&&b.prototype||Ut;return f===T}function Hn(f){return Mn.call(f)}function Ie(f){if(f!=null){try{return Br.call(f)}catch{}try{return f+""}catch{}}return""}function Vn(f,b){return f===b||f!==f&&b!==b}var Gn=Fn((function(){return arguments})())?Fn:function(f){return at(f)&&je.call(f,"callee")&&!lr.call(f,"callee")},dr=Array.isArray;function Zr(f){return f!=null&&Jr(f.length)&&!zn(f)}var pr=Fr||Us;function $s(f,b){return Un(f,b)}function zn(f){if(!Wn(f))return!1;var b=zt(f);return b==h||b==v||b==o||b==g}function Jr(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=l}function Wn(f){var b=typeof f;return f!=null&&(b=="object"||b=="function")}function at(f){return f!=null&&typeof f=="object"}var Kn=ce?$(ce):qs;function Xr(f){return Zr(f)?Ns(f):Ps(f)}function Fs(){return[]}function Us(){return!1}r.exports=$s})(nn,nn.exports)),nn.exports}var Qn={},vu;function jy(){if(vu)return Qn;vu=1,Object.defineProperty(Qn,"__esModule",{value:!0});const r=Hi(),e=Vi();var t;return(function(n){function i(a={},o={},c=!1){typeof a!="object"&&(a={}),typeof o!="object"&&(o={});let d=r(o);c||(d=Object.keys(d).reduce((p,h)=>(d[h]!=null&&(p[h]=d[h]),p),{}));for(const p in a)a[p]!==void 0&&o[p]===void 0&&(d[p]=a[p]);return Object.keys(d).length>0?d:void 0}n.compose=i;function s(a={},o={}){typeof a!="object"&&(a={}),typeof o!="object"&&(o={});const c=Object.keys(a).concat(Object.keys(o)).reduce((d,p)=>(e(a[p],o[p])||(d[p]=o[p]===void 0?null:o[p]),d),{});return Object.keys(c).length>0?c:void 0}n.diff=s;function l(a={},o={}){a=a||{};const c=Object.keys(o).reduce((d,p)=>(o[p]!==a[p]&&a[p]!==void 0&&(d[p]=o[p]),d),{});return Object.keys(a).reduce((d,p)=>(a[p]!==o[p]&&o[p]===void 0&&(d[p]=null),d),c)}n.invert=l;function u(a,o,c=!1){if(typeof a!="object")return o;if(typeof o!="object")return;if(!c)return o;const d=Object.keys(o).reduce((p,h)=>(a[h]===void 0&&(p[h]=o[h]),p),{});return Object.keys(d).length>0?d:void 0}n.transform=u})(t||(t={})),Qn.default=t,Qn}var ei={},yu;function hh(){if(yu)return ei;yu=1,Object.defineProperty(ei,"__esModule",{value:!0});var r;return(function(e){function t(n){return typeof n.delete=="number"?n.delete:typeof n.retain=="number"?n.retain:typeof n.retain=="object"&&n.retain!==null?1:typeof n.insert=="string"?n.insert.length:1}e.length=t})(r||(r={})),ei.default=r,ei}var ti={},bu;function By(){if(bu)return ti;bu=1,Object.defineProperty(ti,"__esModule",{value:!0});const r=hh();class e{constructor(n){this.ops=n,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(n){n||(n=1/0);const i=this.ops[this.index];if(i){const s=this.offset,l=r.default.length(i);if(n>=l-s?(n=l-s,this.index+=1,this.offset=0):this.offset+=n,typeof i.delete=="number")return{delete:n};{const u={};return i.attributes&&(u.attributes=i.attributes),typeof i.retain=="number"?u.retain=n:typeof i.retain=="object"&&i.retain!==null?u.retain=i.retain:typeof i.insert=="string"?u.insert=i.insert.substr(s,n):u.insert=i.insert,u}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?r.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const n=this.ops[this.index];return n?typeof n.delete=="number"?"delete":typeof n.retain=="number"||typeof n.retain=="object"&&n.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const n=this.offset,i=this.index,s=this.next(),l=this.ops.slice(this.index);return this.offset=n,this.index=i,[s].concat(l)}}else return[]}}return ti.default=e,ti}var _u;function $y(){return _u||(_u=1,(function(r,e){Object.defineProperty(e,"__esModule",{value:!0}),e.AttributeMap=e.OpIterator=e.Op=void 0;const t=ky(),n=Hi(),i=Vi(),s=jy();e.AttributeMap=s.default;const l=hh();e.Op=l.default;const u=By();e.OpIterator=u.default;const a="\0",o=(d,p)=>{if(typeof d!="object"||d===null)throw new Error(`cannot retain a ${typeof d}`);if(typeof p!="object"||p===null)throw new Error(`cannot retain a ${typeof p}`);const h=Object.keys(d)[0];if(!h||h!==Object.keys(p)[0])throw new Error(`embed types not matched: ${h} != ${Object.keys(p)[0]}`);return[h,d[h],p[h]]};class c{constructor(p){Array.isArray(p)?this.ops=p:p!=null&&Array.isArray(p.ops)?this.ops=p.ops:this.ops=[]}static registerEmbed(p,h){this.handlers[p]=h}static unregisterEmbed(p){delete this.handlers[p]}static getHandler(p){const h=this.handlers[p];if(!h)throw new Error(`no handlers for embed type "${p}"`);return h}insert(p,h){const v={};return typeof p=="string"&&p.length===0?this:(v.insert=p,h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(v.attributes=h),this.push(v))}delete(p){return p<=0?this:this.push({delete:p})}retain(p,h){if(typeof p=="number"&&p<=0)return this;const v={retain:p};return h!=null&&typeof h=="object"&&Object.keys(h).length>0&&(v.attributes=h),this.push(v)}push(p){let h=this.ops.length,v=this.ops[h-1];if(p=n(p),typeof v=="object"){if(typeof p.delete=="number"&&typeof v.delete=="number")return this.ops[h-1]={delete:v.delete+p.delete},this;if(typeof v.delete=="number"&&p.insert!=null&&(h-=1,v=this.ops[h-1],typeof v!="object"))return this.ops.unshift(p),this;if(i(p.attributes,v.attributes)){if(typeof p.insert=="string"&&typeof v.insert=="string")return this.ops[h-1]={insert:v.insert+p.insert},typeof p.attributes=="object"&&(this.ops[h-1].attributes=p.attributes),this;if(typeof p.retain=="number"&&typeof v.retain=="number")return this.ops[h-1]={retain:v.retain+p.retain},typeof p.attributes=="object"&&(this.ops[h-1].attributes=p.attributes),this}}return h===this.ops.length?this.ops.push(p):this.ops.splice(h,0,p),this}chop(){const p=this.ops[this.ops.length-1];return p&&typeof p.retain=="number"&&!p.attributes&&this.ops.pop(),this}filter(p){return this.ops.filter(p)}forEach(p){this.ops.forEach(p)}map(p){return this.ops.map(p)}partition(p){const h=[],v=[];return this.forEach(_=>{(p(_)?h:v).push(_)}),[h,v]}reduce(p,h){return this.ops.reduce(p,h)}changeLength(){return this.reduce((p,h)=>h.insert?p+l.default.length(h):h.delete?p-h.delete:p,0)}length(){return this.reduce((p,h)=>p+l.default.length(h),0)}slice(p=0,h=1/0){const v=[],_=new u.default(this.ops);let E=0;for(;E<h&&_.hasNext();){let w;E<p?w=_.next(p-E):(w=_.next(h-E),v.push(w)),E+=l.default.length(w)}return new c(v)}compose(p){const h=new u.default(this.ops),v=new u.default(p.ops),_=[],E=v.peek();if(E!=null&&typeof E.retain=="number"&&E.attributes==null){let R=E.retain;for(;h.peekType()==="insert"&&h.peekLength()<=R;)R-=h.peekLength(),_.push(h.next());E.retain-R>0&&v.next(E.retain-R)}const w=new c(_);for(;h.hasNext()||v.hasNext();)if(v.peekType()==="insert")w.push(v.next());else if(h.peekType()==="delete")w.push(h.next());else{const R=Math.min(h.peekLength(),v.peekLength()),y=h.next(R),g=v.next(R);if(g.retain){const m={};if(typeof y.retain=="number")m.retain=typeof g.retain=="number"?R:g.retain;else if(typeof g.retain=="number")y.retain==null?m.insert=y.insert:m.retain=y.retain;else{const S=y.retain==null?"insert":"retain",[I,C,D]=o(y[S],g.retain),O=c.getHandler(I);m[S]={[I]:O.compose(C,D,S==="retain")}}const A=s.default.compose(y.attributes,g.attributes,typeof y.retain=="number");if(A&&(m.attributes=A),w.push(m),!v.hasNext()&&i(w.ops[w.ops.length-1],m)){const S=new c(h.rest());return w.concat(S).chop()}}else typeof g.delete=="number"&&(typeof y.retain=="number"||typeof y.retain=="object"&&y.retain!==null)&&w.push(g)}return w.chop()}concat(p){const h=new c(this.ops.slice());return p.ops.length>0&&(h.push(p.ops[0]),h.ops=h.ops.concat(p.ops.slice(1))),h}diff(p,h){if(this.ops===p.ops)return new c;const v=[this,p].map(y=>y.map(g=>{if(g.insert!=null)return typeof g.insert=="string"?g.insert:a;const m=y===p?"on":"with";throw new Error("diff() called "+m+" non-document")}).join("")),_=new c,E=t(v[0],v[1],h,!0),w=new u.default(this.ops),R=new u.default(p.ops);return E.forEach(y=>{let g=y[1].length;for(;g>0;){let m=0;switch(y[0]){case t.INSERT:m=Math.min(R.peekLength(),g),_.push(R.next(m));break;case t.DELETE:m=Math.min(g,w.peekLength()),w.next(m),_.delete(m);break;case t.EQUAL:m=Math.min(w.peekLength(),R.peekLength(),g);const A=w.next(m),S=R.next(m);i(A.insert,S.insert)?_.retain(m,s.default.diff(A.attributes,S.attributes)):_.push(S).delete(m);break}g-=m}}),_.chop()}eachLine(p,h=`
`){const v=new u.default(this.ops);let _=new c,E=0;for(;v.hasNext();){if(v.peekType()!=="insert")return;const w=v.peek(),R=l.default.length(w)-v.peekLength(),y=typeof w.insert=="string"?w.insert.indexOf(h,R)-R:-1;if(y<0)_.push(v.next());else if(y>0)_.push(v.next(y));else{if(p(_,v.next(1).attributes||{},E)===!1)return;E+=1,_=new c}}_.length()>0&&p(_,{},E)}invert(p){const h=new c;return this.reduce((v,_)=>{if(_.insert)h.delete(l.default.length(_));else{if(typeof _.retain=="number"&&_.attributes==null)return h.retain(_.retain),v+_.retain;if(_.delete||typeof _.retain=="number"){const E=_.delete||_.retain;return p.slice(v,v+E).forEach(R=>{_.delete?h.push(R):_.retain&&_.attributes&&h.retain(l.default.length(R),s.default.invert(_.attributes,R.attributes))}),v+E}else if(typeof _.retain=="object"&&_.retain!==null){const E=p.slice(v,v+1),w=new u.default(E.ops).next(),[R,y,g]=o(_.retain,w.insert),m=c.getHandler(R);return h.retain({[R]:m.invert(y,g)},s.default.invert(_.attributes,w.attributes)),v+1}}return v},0),h.chop()}transform(p,h=!1){if(h=!!h,typeof p=="number")return this.transformPosition(p,h);const v=p,_=new u.default(this.ops),E=new u.default(v.ops),w=new c;for(;_.hasNext()||E.hasNext();)if(_.peekType()==="insert"&&(h||E.peekType()!=="insert"))w.retain(l.default.length(_.next()));else if(E.peekType()==="insert")w.push(E.next());else{const R=Math.min(_.peekLength(),E.peekLength()),y=_.next(R),g=E.next(R);if(y.delete)continue;if(g.delete)w.push(g);else{const m=y.retain,A=g.retain;let S=typeof A=="object"&&A!==null?A:R;if(typeof m=="object"&&m!==null&&typeof A=="object"&&A!==null){const I=Object.keys(m)[0];if(I===Object.keys(A)[0]){const C=c.getHandler(I);C&&(S={[I]:C.transform(m[I],A[I],h)})}}w.retain(S,s.default.transform(y.attributes,g.attributes,h))}}return w.chop()}transformPosition(p,h=!1){h=!!h;const v=new u.default(this.ops);let _=0;for(;v.hasNext()&&_<=p;){const E=v.peekLength(),w=v.peekType();if(v.next(),w==="delete"){p-=Math.min(E,p-_);continue}else w==="insert"&&(_<p||!h)&&(p+=E);_+=E}return p}}c.Op=l.default,c.OpIterator=u.default,c.AttributeMap=s.default,c.handlers={},e.default=c,r.exports=c,r.exports.default=c})(Xn,Xn.exports)),Xn.exports}var He=$y();const ne=Ui(He);class tt extends ke{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}tt.blotName="break";tt.tagName="BR";let Xe=class extends yi{};const Fy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Gi(r){return r.replace(/[&<>"']/g,e=>Fy[e])}const lt=class lt extends pl{static compare(e,t){const n=lt.order.indexOf(e),i=lt.order.indexOf(t);return n>=0||i>=0?n-i:e===t?0:e<t?-1:1}formatAt(e,t,n,i){if(lt.compare(this.statics.blotName,n)<0&&this.scroll.query(n,ie.BLOT)){const s=this.isolate(e,t);i&&s.wrap(n,i)}else super.formatAt(e,t,n,i)}optimize(e){if(super.optimize(e),this.parent instanceof lt&&lt.compare(this.statics.blotName,this.parent.statics.blotName)>0){const t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}};Q(lt,"allowedChildren",[lt,tt,ke,Xe]),Q(lt,"order",["cursor","inline","link","underline","strike","italic","bold","script","code"]);let ht=lt;const Eu=1;class Ae extends pn{constructor(){super(...arguments);Q(this,"cache",{})}delta(){return this.cache.delta==null&&(this.cache.delta=dh(this)),this.cache.delta}deleteAt(t,n){super.deleteAt(t,n),this.cache={}}formatAt(t,n,i,s){n<=0||(this.scroll.query(i,ie.BLOCK)?t+n===this.length()&&this.format(i,s):super.formatAt(t,Math.min(n,this.length()-t-1),i,s),this.cache={})}insertAt(t,n,i){if(i!=null){super.insertAt(t,n,i),this.cache={};return}if(n.length===0)return;const s=n.split(`
`),l=s.shift();l.length>0&&(t<this.length()-1||this.children.tail==null?super.insertAt(Math.min(t,this.length()-1),l):this.children.tail.insertAt(this.children.tail.length(),l),this.cache={});let u=this;s.reduce((a,o)=>(u=u.split(a,!0),u.insertAt(0,o),o.length),t+l.length)}insertBefore(t,n){const{head:i}=this.children;super.insertBefore(t,n),i instanceof tt&&i.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Eu),this.cache.length}moveChildren(t,n){super.moveChildren(t,n),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n&&(t===0||t>=this.length()-Eu)){const s=this.clone();return t===0?(this.parent.insertBefore(s,this),this):(this.parent.insertBefore(s,this.next),s)}const i=super.split(t,n);return this.cache={},i}}Ae.blotName="block";Ae.tagName="P";Ae.defaultChild=tt;Ae.allowedChildren=[tt,ht,ke,Xe];class Ue extends ke{attach(){super.attach(),this.attributes=new $i(this.domNode)}delta(){return new ne().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(e,t){const n=this.scroll.query(e,ie.BLOCK_ATTRIBUTE);n!=null&&this.attributes.attribute(n,t)}formatAt(e,t,n,i){this.format(n,i)}insertAt(e,t,n){if(n!=null){super.insertAt(e,t,n);return}const i=t.split(`
`),s=i.pop(),l=i.map(a=>{const o=this.scroll.create(Ae.blotName);return o.insertAt(0,a),o}),u=this.split(e);l.forEach(a=>{this.parent.insertBefore(a,u)}),s&&this.parent.insertBefore(this.scroll.create("text",s),u)}}Ue.scope=ie.BLOCK_BLOT;function dh(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r.descendants(Te).reduce((t,n)=>n.length()===0?t:t.insert(n.value(),$e(n,{},e)),new ne).insert(`
`,$e(r))}function $e(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return r==null||("formats"in r&&typeof r.formats=="function"&&(e={...e,...r.formats()},t&&delete e["code-token"]),r.parent==null||r.parent.statics.blotName==="scroll"||r.parent.statics.scope!==r.statics.scope)?e:$e(r.parent,e,t)}const Be=class Be extends ke{static value(){}constructor(e,t,n){super(e,t),this.selection=n,this.textNode=document.createTextNode(Be.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(e,t){if(this.savedLength!==0){super.format(e,t);return}let n=this,i=0;for(;n!=null&&n.statics.scope!==ie.BLOCK_BLOT;)i+=n.offset(n.parent),n=n.parent;n!=null&&(this.savedLength=Be.CONTENTS.length,n.optimize(),n.formatAt(i,Be.CONTENTS.length,e,t),this.savedLength=0)}index(e,t){return e===this.textNode?0:super.index(e,t)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const e=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const t=this.prev instanceof Xe?this.prev:null,n=t?t.length():0,i=this.next instanceof Xe?this.next:null,s=i?i.text:"",{textNode:l}=this,u=l.data.split(Be.CONTENTS).join("");l.data=Be.CONTENTS;let a;if(t)a=t,(u||i)&&(t.insertAt(t.length(),u+s),i&&i.remove());else if(i)a=i,i.insertAt(0,u);else{const o=document.createTextNode(u);a=this.scroll.create(o),this.parent.insertBefore(a,this)}if(this.remove(),e){const o=(p,h)=>t&&p===t.domNode?h:p===l?n+h-1:i&&p===i.domNode?n+u.length+h:null,c=o(e.start.node,e.start.offset),d=o(e.end.node,e.end.offset);if(c!==null&&d!==null)return{startNode:a.domNode,startOffset:c,endNode:a.domNode,endOffset:d}}return null}update(e,t){if(e.some(n=>n.type==="characterData"&&n.target===this.textNode)){const n=this.restore();n&&(t.range=n)}}optimize(e){super.optimize(e);let{parent:t}=this;for(;t;){if(t.domNode.tagName==="A"){this.savedLength=Be.CONTENTS.length,t.isolate(this.offset(t),this.length()).unwrap(),this.savedLength=0;break}t=t.parent}}value(){return""}};Q(Be,"blotName","cursor"),Q(Be,"className","ql-cursor"),Q(Be,"tagName","span"),Q(Be,"CONTENTS","\uFEFF");let Lr=Be;var Ks={exports:{}},Au;function Uy(){return Au||(Au=1,(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(a,o,c){this.fn=a,this.context=o,this.once=c||!1}function s(a,o,c,d,p){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new i(c,d||a,p),v=t?t+o:o;return a._events[v]?a._events[v].fn?a._events[v]=[a._events[v],h]:a._events[v].push(h):(a._events[v]=h,a._eventsCount++),a}function l(a,o){--a._eventsCount===0?a._events=new n:delete a._events[o]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var o=[],c,d;if(this._eventsCount===0)return o;for(d in c=this._events)e.call(c,d)&&o.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(c)):o},u.prototype.listeners=function(o){var c=t?t+o:o,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,h=d.length,v=new Array(h);p<h;p++)v[p]=d[p].fn;return v},u.prototype.listenerCount=function(o){var c=t?t+o:o,d=this._events[c];return d?d.fn?1:d.length:0},u.prototype.emit=function(o,c,d,p,h,v){var _=t?t+o:o;if(!this._events[_])return!1;var E=this._events[_],w=arguments.length,R,y;if(E.fn){switch(E.once&&this.removeListener(o,E.fn,void 0,!0),w){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,c),!0;case 3:return E.fn.call(E.context,c,d),!0;case 4:return E.fn.call(E.context,c,d,p),!0;case 5:return E.fn.call(E.context,c,d,p,h),!0;case 6:return E.fn.call(E.context,c,d,p,h,v),!0}for(y=1,R=new Array(w-1);y<w;y++)R[y-1]=arguments[y];E.fn.apply(E.context,R)}else{var g=E.length,m;for(y=0;y<g;y++)switch(E[y].once&&this.removeListener(o,E[y].fn,void 0,!0),w){case 1:E[y].fn.call(E[y].context);break;case 2:E[y].fn.call(E[y].context,c);break;case 3:E[y].fn.call(E[y].context,c,d);break;case 4:E[y].fn.call(E[y].context,c,d,p);break;default:if(!R)for(m=1,R=new Array(w-1);m<w;m++)R[m-1]=arguments[m];E[y].fn.apply(E[y].context,R)}}return!0},u.prototype.on=function(o,c,d){return s(this,o,c,d,!1)},u.prototype.once=function(o,c,d){return s(this,o,c,d,!0)},u.prototype.removeListener=function(o,c,d,p){var h=t?t+o:o;if(!this._events[h])return this;if(!c)return l(this,h),this;var v=this._events[h];if(v.fn)v.fn===c&&(!p||v.once)&&(!d||v.context===d)&&l(this,h);else{for(var _=0,E=[],w=v.length;_<w;_++)(v[_].fn!==c||p&&!v[_].once||d&&v[_].context!==d)&&E.push(v[_]);E.length?this._events[h]=E.length===1?E[0]:E:l(this,h)}return this},u.prototype.removeAllListeners=function(o){var c;return o?(c=t?t+o:o,this._events[c]&&l(this,c)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,r.exports=u})(Ks)),Ks.exports}var Hy=Uy();const Vy=Ui(Hy),Ya=new WeakMap,Za=["error","warn","log","info"];let Ja="warn";function ph(r){if(Ja&&Za.indexOf(r)<=Za.indexOf(Ja)){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];console[r](...t)}}function Rt(r){return Za.reduce((e,t)=>(e[t]=ph.bind(console,t,r),e),{})}Rt.level=r=>{Ja=r};ph.level=Rt.level;const Ys=Rt("quill:events"),Gy=["selectionchange","mousedown","mouseup","click"];Gy.forEach(r=>{document.addEventListener(r,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Array.from(document.querySelectorAll(".ql-container")).forEach(i=>{const s=Ya.get(i);s&&s.emitter&&s.emitter.handleDOM(...t)})})});class re extends Vy{constructor(){super(),this.domListeners={},this.on("error",Ys.error)}emit(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ys.log.call(Ys,...t),super.emit(...t)}handleDOM(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];(this.domListeners[e.type]||[]).forEach(s=>{let{node:l,handler:u}=s;(e.target===l||l.contains(e.target))&&u(e,...n)})}listenDOM(e,t,n){this.domListeners[e]||(this.domListeners[e]=[]),this.domListeners[e].push({node:t,handler:n})}}Q(re,"events",{EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"}),Q(re,"sources",{API:"api",SILENT:"silent",USER:"user"});const Zs=Rt("quill:selection");class Jt{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=e,this.length=t}}class zy{constructor(e,t){this.emitter=t,this.scroll=e,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Jt(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,re.sources.USER),1)}),this.emitter.on(re.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const n=this.getNativeRange();n!=null&&n.start.node!==this.cursor.textNode&&this.emitter.once(re.events.SCROLL_UPDATE,(i,s)=>{try{this.root.contains(n.start.node)&&this.root.contains(n.end.node)&&this.setNativeRange(n.start.node,n.start.offset,n.end.node,n.end.offset);const l=s.some(u=>u.type==="characterData"||u.type==="childList"||u.type==="attributes"&&u.target===this.root);this.update(l?re.sources.SILENT:i)}catch{}})}),this.emitter.on(re.events.SCROLL_OPTIMIZE,(n,i)=>{if(i.range){const{startNode:s,startOffset:l,endNode:u,endOffset:a}=i.range;this.setNativeRange(s,l,u,a),this.update(re.sources.SILENT)}}),this.update(re.sources.SILENT)}handleComposition(){this.emitter.on(re.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(re.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const e=this.cursor.restore();if(!e)return;setTimeout(()=>{this.setNativeRange(e.startNode,e.startOffset,e.endNode,e.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(re.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(e,t){this.scroll.update();const n=this.getNativeRange();if(!(n==null||!n.native.collapsed||this.scroll.query(e,ie.BLOCK))){if(n.start.node!==this.cursor.textNode){const i=this.scroll.find(n.start.node,!1);if(i==null)return;if(i instanceof Te){const s=i.split(n.start.offset);i.parent.insertBefore(this.cursor,s)}else i.insertBefore(this.cursor,n.start.node);this.cursor.attach()}this.cursor.format(e,t),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.scroll.length();e=Math.min(e,n-1),t=Math.min(e+t,n-1)-e;let i,[s,l]=this.scroll.leaf(e);if(s==null)return null;if(t>0&&l===s.length()){const[c]=this.scroll.leaf(e+1);if(c){const[d]=this.scroll.line(e),[p]=this.scroll.line(e+1);d===p&&(s=c,l=0)}}[i,l]=s.position(l,!0);const u=document.createRange();if(t>0)return u.setStart(i,l),[s,l]=this.scroll.leaf(e+t),s==null?null:([i,l]=s.position(l,!0),u.setEnd(i,l),u.getBoundingClientRect());let a="left",o;if(i instanceof Text){if(!i.data.length)return null;l<i.data.length?(u.setStart(i,l),u.setEnd(i,l+1)):(u.setStart(i,l-1),u.setEnd(i,l),a="right"),o=u.getBoundingClientRect()}else{if(!(s.domNode instanceof Element))return null;o=s.domNode.getBoundingClientRect(),l>0&&(a="right")}return{bottom:o.top+o.height,height:o.height,left:o[a],right:o[a],top:o.top,width:0}}getNativeRange(){const e=document.getSelection();if(e==null||e.rangeCount<=0)return null;const t=e.getRangeAt(0);if(t==null)return null;const n=this.normalizeNative(t);return Zs.info("getNativeRange",n),n}getRange(){const e=this.scroll.domNode;if("isConnected"in e&&!e.isConnected)return[null,null];const t=this.getNativeRange();return t==null?[null,null]:[this.normalizedToRange(t),t]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Js(this.root,document.activeElement)}normalizedToRange(e){const t=[[e.start.node,e.start.offset]];e.native.collapsed||t.push([e.end.node,e.end.offset]);const n=t.map(l=>{const[u,a]=l,o=this.scroll.find(u,!0),c=o.offset(this.scroll);return a===0?c:o instanceof Te?c+o.index(u,a):c+o.length()}),i=Math.min(Math.max(...n),this.scroll.length()-1),s=Math.min(i,...n);return new Jt(s,i-s)}normalizeNative(e){if(!Js(this.root,e.startContainer)||!e.collapsed&&!Js(this.root,e.endContainer))return null;const t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach(n=>{let{node:i,offset:s}=n;for(;!(i instanceof Text)&&i.childNodes.length>0;)if(i.childNodes.length>s)i=i.childNodes[s],s=0;else if(i.childNodes.length===s)i=i.lastChild,i instanceof Text?s=i.data.length:i.childNodes.length>0?s=i.childNodes.length:s=i.childNodes.length+1;else break;n.node=i,n.offset=s}),t}rangeToNative(e){const t=this.scroll.length(),n=(i,s)=>{i=Math.min(t-1,i);const[l,u]=this.scroll.leaf(i);return l?l.position(u,s):[null,-1]};return[...n(e.index,!1),...n(e.index+e.length,!0)]}setNativeRange(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:t,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Zs.info("setNativeRange",e,t,n,i),e!=null&&(this.root.parentNode==null||e.parentNode==null||n.parentNode==null))return;const l=document.getSelection();if(l!=null)if(e!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:u}=this.getNativeRange()||{};if(u==null||s||e!==u.startContainer||t!==u.startOffset||n!==u.endContainer||i!==u.endOffset){e instanceof Element&&e.tagName==="BR"&&(t=Array.from(e.parentNode.childNodes).indexOf(e),e=e.parentNode),n instanceof Element&&n.tagName==="BR"&&(i=Array.from(n.parentNode.childNodes).indexOf(n),n=n.parentNode);const a=document.createRange();a.setStart(e,t),a.setEnd(n,i),l.removeAllRanges(),l.addRange(a)}}else l.removeAllRanges(),this.root.blur()}setRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:re.sources.API;if(typeof t=="string"&&(n=t,t=!1),Zs.info("setRange",e),e!=null){const i=this.rangeToNative(e);this.setNativeRange(...i,t)}else this.setNativeRange(null);this.update(n)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:re.sources.USER;const t=this.lastRange,[n,i]=this.getRange();if(this.lastRange=n,this.lastNative=i,this.lastRange!=null&&(this.savedRange=this.lastRange),!dl(t,this.lastRange)){if(!this.composing&&i!=null&&i.native.collapsed&&i.start.node!==this.cursor.textNode){const l=this.cursor.restore();l&&this.setNativeRange(l.startNode,l.startOffset,l.endNode,l.endOffset)}const s=[re.events.SELECTION_CHANGE,Sr(this.lastRange),Sr(t),e];this.emitter.emit(re.events.EDITOR_CHANGE,...s),e!==re.sources.SILENT&&this.emitter.emit(...s)}}}function Js(r,e){try{e.parentNode}catch{return!1}return r.contains(e)}const Wy=/^[ -~]*$/;class Ky{constructor(e){this.scroll=e,this.delta=this.getDelta()}applyDelta(e){this.scroll.update();let t=this.scroll.length();this.scroll.batchStart();const n=Ou(e),i=new ne;return Zy(n.ops.slice()).reduce((l,u)=>{const a=He.Op.length(u);let o=u.attributes||{},c=!1,d=!1;if(u.insert!=null){if(i.retain(a),typeof u.insert=="string"){const v=u.insert;d=!v.endsWith(`
`)&&(t<=l||!!this.scroll.descendant(Ue,l)[0]),this.scroll.insertAt(l,v);const[_,E]=this.scroll.line(l);let w=xt({},$e(_));if(_ instanceof Ae){const[R]=_.descendant(Te,E);R&&(w=xt(w,$e(R)))}o=He.AttributeMap.diff(w,o)||{}}else if(typeof u.insert=="object"){const v=Object.keys(u.insert)[0];if(v==null)return l;const _=this.scroll.query(v,ie.INLINE)!=null;if(_)(t<=l||this.scroll.descendant(Ue,l)[0])&&(d=!0);else if(l>0){const[E,w]=this.scroll.descendant(Te,l-1);E instanceof Xe?E.value()[w]!==`
`&&(c=!0):E instanceof ke&&E.statics.scope===ie.INLINE_BLOT&&(c=!0)}if(this.scroll.insertAt(l,v,u.insert[v]),_){const[E]=this.scroll.descendant(Te,l);if(E){const w=xt({},$e(E));o=He.AttributeMap.diff(w,o)||{}}}}t+=a}else if(i.push(u),u.retain!==null&&typeof u.retain=="object"){const v=Object.keys(u.retain)[0];if(v==null)return l;this.scroll.updateEmbedAt(l,v,u.retain[v])}Object.keys(o).forEach(v=>{this.scroll.formatAt(l,a,v,o[v])});const p=c?1:0,h=d?1:0;return t+=p+h,i.retain(p),i.delete(h),l+a+p+h},0),i.reduce((l,u)=>typeof u.delete=="number"?(this.scroll.deleteAt(l,u.delete),l):l+He.Op.length(u),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(n)}deleteText(e,t){return this.scroll.deleteAt(e,t),this.update(new ne().retain(e).delete(t))}formatLine(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(n).forEach(s=>{this.scroll.lines(e,Math.max(t,1)).forEach(l=>{l.format(s,n[s])})}),this.scroll.optimize();const i=new ne().retain(e).retain(t,Sr(n));return this.update(i)}formatText(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(n).forEach(s=>{this.scroll.formatAt(e,t,s,n[s])});const i=new ne().retain(e).retain(t,Sr(n));return this.update(i)}getContents(e,t){return this.delta.slice(e,e+t)}getDelta(){return this.scroll.lines().reduce((e,t)=>e.concat(t.delta()),new ne)}getFormat(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=[],i=[];t===0?this.scroll.path(e).forEach(u=>{const[a]=u;a instanceof Ae?n.push(a):a instanceof Te&&i.push(a)}):(n=this.scroll.lines(e,t),i=this.scroll.descendants(Te,e,t));const[s,l]=[n,i].map(u=>{const a=u.shift();if(a==null)return{};let o=$e(a);for(;Object.keys(o).length>0;){const c=u.shift();if(c==null)return o;o=Yy($e(c),o)}return o});return{...s,...l}}getHTML(e,t){const[n,i]=this.scroll.line(e);if(n){const s=n.length();return n.length()>=i+t&&!(i===0&&t===s)?gn(n,i,t,!0):gn(this.scroll,e,t,!0)}return""}getText(e,t){return this.getContents(e,t).filter(n=>typeof n.insert=="string").map(n=>n.insert).join("")}insertContents(e,t){const n=Ou(t),i=new ne().retain(e).concat(n);return this.scroll.insertContents(e,n),this.update(i)}insertEmbed(e,t,n){return this.scroll.insertAt(e,t,n),this.update(new ne().retain(e).insert({[t]:n}))}insertText(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(e,t),Object.keys(n).forEach(i=>{this.scroll.formatAt(e,t.length,i,n[i])}),this.update(new ne().retain(e).insert(t,Sr(n)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const e=this.scroll.children.head;if((e==null?void 0:e.statics.blotName)!==Ae.blotName)return!1;const t=e;return t.children.length>1?!1:t.children.head instanceof tt}removeFormat(e,t){const n=this.getText(e,t),[i,s]=this.scroll.line(e+t);let l=0,u=new ne;i!=null&&(l=i.length()-s,u=i.delta().slice(s,s+l-1).insert(`
`));const o=this.getContents(e,t+l).diff(new ne().insert(n).concat(u)),c=new ne().retain(e).concat(o);return this.applyDelta(c)}update(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const i=this.delta;if(t.length===1&&t[0].type==="characterData"&&t[0].target.data.match(Wy)&&this.scroll.find(t[0].target)){const s=this.scroll.find(t[0].target),l=$e(s),u=s.offset(this.scroll),a=t[0].oldValue.replace(Lr.CONTENTS,""),o=new ne().insert(a),c=new ne().insert(s.value()),d=n&&{oldRange:Su(n.oldRange,-u),newRange:Su(n.newRange,-u)};e=new ne().retain(u).concat(o.diff(c,d)).reduce((h,v)=>v.insert?h.insert(v.insert,l):h.push(v),new ne),this.delta=i.compose(e)}else this.delta=this.getDelta(),(!e||!dl(i.compose(e),this.delta))&&(e=i.diff(this.delta,n));return e}}function Ar(r,e,t){if(r.length===0){const[h]=Xs(t.pop());return e<=0?`</li></${h}>`:`</li></${h}>${Ar([],e-1,t)}`}const[{child:n,offset:i,length:s,indent:l,type:u},...a]=r,[o,c]=Xs(u);if(l>e)return t.push(u),l===e+1?`<${o}><li${c}>${gn(n,i,s)}${Ar(a,l,t)}`:`<${o}><li>${Ar(r,e+1,t)}`;const d=t[t.length-1];if(l===e&&u===d)return`</li><li${c}>${gn(n,i,s)}${Ar(a,l,t)}`;const[p]=Xs(t.pop());return`</li></${p}>${Ar(r,e-1,t)}`}function gn(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in r&&typeof r.html=="function")return r.html(e,t);if(r instanceof Xe)return Gi(r.value().slice(e,e+t)).replaceAll(" ","&nbsp;");if(r instanceof Je){if(r.statics.blotName==="list-container"){const o=[];return r.children.forEachAt(e,t,(c,d,p)=>{const h="formats"in c&&typeof c.formats=="function"?c.formats():{};o.push({child:c,offset:d,length:p,indent:h.indent||0,type:h.list})}),Ar(o,-1,[])}const i=[];if(r.children.forEachAt(e,t,(o,c,d)=>{i.push(gn(o,c,d))}),n||r.statics.blotName==="list")return i.join("");const{outerHTML:s,innerHTML:l}=r.domNode,[u,a]=s.split(`>${l}<`);return u==="<table"?`<table style="border: 1px solid #000;">${i.join("")}<${a}`:`${u}>${i.join("")}<${a}`}return r.domNode instanceof Element?r.domNode.outerHTML:""}function Yy(r,e){return Object.keys(e).reduce((t,n)=>{if(r[n]==null)return t;const i=e[n];return i===r[n]?t[n]=i:Array.isArray(i)?i.indexOf(r[n])<0?t[n]=i.concat([r[n]]):t[n]=i:t[n]=[i,r[n]],t},{})}function Xs(r){const e=r==="ordered"?"ol":"ul";switch(r){case"checked":return[e,' data-list="checked"'];case"unchecked":return[e,' data-list="unchecked"'];default:return[e,""]}}function Ou(r){return r.reduce((e,t)=>{if(typeof t.insert=="string"){const n=t.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return e.insert(n,t.attributes)}return e.push(t)},new ne)}function Su(r,e){let{index:t,length:n}=r;return new Jt(t+e,n)}function Zy(r){const e=[];return r.forEach(t=>{typeof t.insert=="string"?t.insert.split(`
`).forEach((i,s)=>{s&&e.push({insert:`
`,attributes:t.attributes}),i&&e.push({insert:i,attributes:t.attributes})}):e.push(t)}),e}class rt{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=e,this.options=t}}Q(rt,"DEFAULTS",{});const ri="\uFEFF";class ml extends ke{constructor(e,t){super(e,t),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(n=>{this.contentNode.appendChild(n)}),this.leftGuard=document.createTextNode(ri),this.rightGuard=document.createTextNode(ri),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:super.index(e,t)}restore(e){let t=null,n;const i=e.data.split(ri).join("");if(e===this.leftGuard)if(this.prev instanceof Xe){const s=this.prev.length();this.prev.insertAt(s,i),t={startNode:this.prev.domNode,startOffset:s+i.length}}else n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this),t={startNode:n,startOffset:i.length};else e===this.rightGuard&&(this.next instanceof Xe?(this.next.insertAt(0,i),t={startNode:this.next.domNode,startOffset:i.length}):(n=document.createTextNode(i),this.parent.insertBefore(this.scroll.create(n),this.next),t={startNode:n,startOffset:i.length}));return e.data=ri,t}update(e,t){e.forEach(n=>{if(n.type==="characterData"&&(n.target===this.leftGuard||n.target===this.rightGuard)){const i=this.restore(n.target);i&&(t.range=i)}})}}class Jy{constructor(e,t){Q(this,"isComposing",!1);this.scroll=e,this.emitter=t,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",e=>{this.isComposing||this.handleCompositionStart(e)}),this.scroll.domNode.addEventListener("compositionend",e=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(e)})})}handleCompositionStart(e){const t=e.target instanceof Node?this.scroll.find(e.target,!0):null;t&&!(t instanceof ml)&&(this.emitter.emit(re.events.COMPOSITION_BEFORE_START,e),this.scroll.batchStart(),this.emitter.emit(re.events.COMPOSITION_START,e),this.isComposing=!0)}handleCompositionEnd(e){this.emitter.emit(re.events.COMPOSITION_BEFORE_END,e),this.scroll.batchEnd(),this.emitter.emit(re.events.COMPOSITION_END,e),this.isComposing=!1}}const un=class un{constructor(e,t){Q(this,"modules",{});this.quill=e,this.options=t}init(){Object.keys(this.options.modules).forEach(e=>{this.modules[e]==null&&this.addModule(e)})}addModule(e){const t=this.quill.constructor.import(`modules/${e}`);return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}};Q(un,"DEFAULTS",{modules:{}}),Q(un,"themes",{default:un});let Ir=un;const Xy=r=>r.parentElement||r.getRootNode().host||null,Qy=r=>{const e=r.getBoundingClientRect(),t="offsetWidth"in r&&Math.abs(e.width)/r.offsetWidth||1,n="offsetHeight"in r&&Math.abs(e.height)/r.offsetHeight||1;return{top:e.top,right:e.left+r.clientWidth*t,bottom:e.top+r.clientHeight*n,left:e.left}},ni=r=>{const e=parseInt(r,10);return Number.isNaN(e)?0:e},wu=(r,e,t,n,i,s)=>r<t&&e>n?0:r<t?-(t-r+i):e>n?e-r>n-t?r+i-t:e-n+s:0,e1=(r,e)=>{var s,l,u,a,o;const t=r.ownerDocument;let n=e,i=r;for(;i;){const c=i===t.body,d=c?{top:0,right:(l=(s=window.visualViewport)==null?void 0:s.width)!=null?l:t.documentElement.clientWidth,bottom:(a=(u=window.visualViewport)==null?void 0:u.height)!=null?a:t.documentElement.clientHeight,left:0}:Qy(i),p=getComputedStyle(i),h=wu(n.left,n.right,d.left,d.right,ni(p.scrollPaddingLeft),ni(p.scrollPaddingRight)),v=wu(n.top,n.bottom,d.top,d.bottom,ni(p.scrollPaddingTop),ni(p.scrollPaddingBottom));if(h||v)if(c)(o=t.defaultView)==null||o.scrollBy(h,v);else{const{scrollLeft:_,scrollTop:E}=i;v&&(i.scrollTop+=v),h&&(i.scrollLeft+=h);const w=i.scrollLeft-_,R=i.scrollTop-E;n={left:n.left-w,top:n.top-R,right:n.right-w,bottom:n.bottom-R}}i=c||p.position==="fixed"?null:Xy(i)}},t1=100,r1=["block","break","cursor","inline","scroll","text"],n1=(r,e,t)=>{const n=new Nr;return r1.forEach(i=>{const s=e.query(i);s&&n.register(s)}),r.forEach(i=>{var u;let s=e.query(i);s||t.error(`Cannot register "${i}" specified in "formats" config. Are you sure it was registered?`);let l=0;for(;s;)if(n.register(s),s="blotName"in s&&(u=s.requiredContainer)!=null?u:null,l+=1,l>t1){t.error(`Cycle detected in registering blot requiredContainer: "${i}"`);break}}),n},Rr=Rt("quill"),ii=new Nr;Je.uiClass="ql-ui";const Ke=class Ke{static debug(e){e===!0&&(e="log"),Rt.level(e)}static find(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Ya.get(e)||ii.find(e,t)}static import(e){return this.imports[e]==null&&Rr.error(`Cannot import ${e}. Are you sure it was registered?`),this.imports[e]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const e=arguments.length<=0?void 0:arguments[0],t=!!(!(arguments.length<=1)&&arguments[1]),n="attrName"in e?e.attrName:e.blotName;typeof n=="string"?this.register(`formats/${n}`,e,t):Object.keys(e).forEach(i=>{this.register(i,e[i],t)})}else{const e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],n=!!(!(arguments.length<=2)&&arguments[2]);this.imports[e]!=null&&!n&&Rr.warn(`Overwriting ${e} with`,t),this.imports[e]=t,(e.startsWith("blots/")||e.startsWith("formats/"))&&t&&typeof t!="boolean"&&t.blotName!=="abstract"&&ii.register(t),typeof t.register=="function"&&t.register(ii)}}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=i1(e,t),this.container=this.options.container,this.container==null){Rr.error("Invalid Quill container",e);return}this.options.debug&&Ke.debug(this.options.debug);const n=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Ya.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new re;const i=gl.blotName,s=this.options.registry.query(i);if(!s||!("blotName"in s))throw new Error(`Cannot initialize Quill without "${i}" blot`);if(this.scroll=new s(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Ky(this.scroll),this.selection=new zy(this.scroll,this.emitter),this.composition=new Jy(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(re.events.EDITOR_CHANGE,l=>{l===re.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(re.events.SCROLL_UPDATE,(l,u)=>{const a=this.selection.lastRange,[o]=this.selection.getRange(),c=a&&o?{oldRange:a,newRange:o}:void 0;We.call(this,()=>this.editor.update(null,u,c),l)}),this.emitter.on(re.events.SCROLL_EMBED_UPDATE,(l,u)=>{const a=this.selection.lastRange,[o]=this.selection.getRange(),c=a&&o?{oldRange:a,newRange:o}:void 0;We.call(this,()=>{const d=new ne().retain(l.offset(this)).retain({[l.statics.blotName]:u});return this.editor.update(d,[],c)},Ke.sources.USER)}),n){const l=this.clipboard.convert({html:`${n}<p><br></p>`,text:`
`});this.setContents(l)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof e=="string"){const n=e;e=document.createElement("div"),e.classList.add(n)}return this.container.insertBefore(e,t),e}blur(){this.selection.setRange(null)}deleteText(e,t,n){return[e,t,,n]=Et(e,t,n),We.call(this,()=>this.editor.deleteText(e,t),n,e,-1*t)}disable(){this.enable(!1)}editReadOnly(e){this.allowReadOnlyEdits=!0;const t=e();return this.allowReadOnlyEdits=!1,t}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}focus(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),e.preventScroll||this.scrollSelectionIntoView()}format(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:re.sources.API;return We.call(this,()=>{const i=this.getSelection(!0);let s=new ne;if(i==null)return s;if(this.scroll.query(e,ie.BLOCK))s=this.editor.formatLine(i.index,i.length,{[e]:t});else{if(i.length===0)return this.selection.format(e,t),s;s=this.editor.formatText(i.index,i.length,{[e]:t})}return this.setSelection(i,re.sources.SILENT),s},n)}formatLine(e,t,n,i,s){let l;return[e,t,l,s]=Et(e,t,n,i,s),We.call(this,()=>this.editor.formatLine(e,t,l),s,e,0)}formatText(e,t,n,i,s){let l;return[e,t,l,s]=Et(e,t,n,i,s),We.call(this,()=>this.editor.formatText(e,t,l),s,e,0)}getBounds(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=null;if(typeof e=="number"?n=this.selection.getBounds(e,t):n=this.selection.getBounds(e.index,e.length),!n)return null;const i=this.container.getBoundingClientRect();return{bottom:n.bottom-i.top,height:n.height,left:n.left-i.left,right:n.right-i.left,top:n.top-i.top,width:n.width}}getContents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-e;return[e,t]=Et(e,t),this.editor.getContents(e,t)}getFormat(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof e=="number"?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}getIndex(e){return e.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(e){return this.scroll.leaf(e)}getLine(e){return this.scroll.line(e)}getLines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof e!="number"?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}getModule(e){return this.theme.modules[e]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(t=t!=null?t:this.getLength()-e),[e,t]=Et(e,t),this.editor.getHTML(e,t)}getText(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return typeof e=="number"&&(t=t!=null?t:this.getLength()-e),[e,t]=Et(e,t),this.editor.getText(e,t)}hasFocus(){return this.selection.hasFocus()}insertEmbed(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ke.sources.API;return We.call(this,()=>this.editor.insertEmbed(e,t,n),i,e)}insertText(e,t,n,i,s){let l;return[e,,l,s]=Et(e,0,n,i,s),We.call(this,()=>this.editor.insertText(e,t,l),s,e,t.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(e,t,n){return[e,t,,n]=Et(e,t,n),We.call(this,()=>this.editor.removeFormat(e,t),n,e)}scrollRectIntoView(e){e1(this.root,e)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const e=this.selection.lastRange,t=e&&this.selection.getBounds(e.index,e.length);t&&this.scrollRectIntoView(t)}setContents(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re.sources.API;return We.call(this,()=>{e=new ne(e);const n=this.getLength(),i=this.editor.deleteText(0,n),s=this.editor.insertContents(0,e),l=this.editor.deleteText(this.getLength()-1,1);return i.compose(s).compose(l)},t)}setSelection(e,t,n){e==null?this.selection.setRange(null,t||Ke.sources.API):([e,t,,n]=Et(e,t,n),this.selection.setRange(new Jt(Math.max(0,e),t),n),n!==re.sources.SILENT&&this.scrollSelectionIntoView())}setText(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re.sources.API;const n=new ne().insert(e);return this.setContents(n,t)}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:re.sources.USER;const t=this.scroll.update(e);return this.selection.update(e),t}updateContents(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re.sources.API;return We.call(this,()=>(e=new ne(e),this.editor.applyDelta(e)),t,!0)}};Q(Ke,"DEFAULTS",{bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:ii,theme:"default"}),Q(Ke,"events",re.events),Q(Ke,"sources",re.sources),Q(Ke,"version","2.0.3"),Q(Ke,"imports",{delta:ne,parchment:Dy,"core/module":rt,"core/theme":Ir});let B=Ke;function Ru(r){return typeof r=="string"?document.querySelector(r):r}function Qs(r){return Object.entries(r!=null?r:{}).reduce((e,t)=>{let[n,i]=t;return{...e,[n]:i===!0?{}:i}},{})}function Tu(r){return Object.fromEntries(Object.entries(r).filter(e=>e[1]!==void 0))}function i1(r,e){const t=Ru(r);if(!t)throw new Error("Invalid Quill container");const i=!e.theme||e.theme===B.DEFAULTS.theme?Ir:B.import(`themes/${e.theme}`);if(!i)throw new Error(`Invalid theme ${e.theme}. Did you register it?`);const{modules:s,...l}=B.DEFAULTS,{modules:u,...a}=i.DEFAULTS;let o=Qs(e.modules);o!=null&&o.toolbar&&o.toolbar.constructor!==Object&&(o={...o,toolbar:{container:o.toolbar}});const c=xt({},Qs(s),Qs(u),o),d={...l,...Tu(a),...Tu(e)};let p=e.registry;return p?e.formats&&Rr.warn('Ignoring "formats" option because "registry" is specified'):p=e.formats?n1(e.formats,d.registry,Rr):d.registry,{...d,registry:p,container:t,theme:i,modules:Object.entries(c).reduce((h,v)=>{let[_,E]=v;if(!E)return h;const w=B.import(`modules/${_}`);return w==null?(Rr.error(`Cannot load ${_} module. Are you sure you registered it?`),h):{...h,[_]:xt({},w.DEFAULTS||{},E)}},{}),bounds:Ru(d.bounds)}}function We(r,e,t,n){if(!this.isEnabled()&&e===re.sources.USER&&!this.allowReadOnlyEdits)return new ne;let i=t==null?null:this.getSelection();const s=this.editor.delta,l=r();if(i!=null&&(t===!0&&(t=i.index),n==null?i=Nu(i,l,e):n!==0&&(i=Nu(i,t,n,e)),this.setSelection(i,re.sources.SILENT)),l.length()>0){const u=[re.events.TEXT_CHANGE,l,s,e];this.emitter.emit(re.events.EDITOR_CHANGE,...u),e!==re.sources.SILENT&&this.emitter.emit(...u)}return l}function Et(r,e,t,n,i){let s={};return typeof r.index=="number"&&typeof r.length=="number"?typeof e!="number"?(i=n,n=t,t=e,e=r.length,r=r.index):(e=r.length,r=r.index):typeof e!="number"&&(i=n,n=t,t=e,e=0),typeof t=="object"?(s=t,i=n):typeof t=="string"&&(n!=null?s[t]=n:i=t),i=i||re.sources.API,[r,e,s,i]}function Nu(r,e,t,n){const i=typeof t=="number"?t:0;if(r==null)return null;let s,l;return e&&typeof e.transformPosition=="function"?[s,l]=[r.index,r.index+r.length].map(u=>e.transformPosition(u,n!==re.sources.USER)):[s,l]=[r.index,r.index+r.length].map(u=>u<e||u===e&&n===re.sources.USER?u:i>=0?u+i:Math.max(e,u+i)),new Jt(s,l-s)}class tr extends Fi{}function Lu(r){return r instanceof Ae||r instanceof Ue}function Iu(r){return typeof r.updateContent=="function"}class Or extends gl{constructor(e,t,n){let{emitter:i}=n;super(e,t),this.emitter=i,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",s=>this.handleDragStart(s))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const e=this.batch;this.batch=!1,this.update(e)}emitMount(e){this.emitter.emit(re.events.SCROLL_BLOT_MOUNT,e)}emitUnmount(e){this.emitter.emit(re.events.SCROLL_BLOT_UNMOUNT,e)}emitEmbedUpdate(e,t){this.emitter.emit(re.events.SCROLL_EMBED_UPDATE,e,t)}deleteAt(e,t){const[n,i]=this.line(e),[s]=this.line(e+t);if(super.deleteAt(e,t),s!=null&&n!==s&&i>0){if(n instanceof Ue||s instanceof Ue){this.optimize();return}const l=s.children.head instanceof tt?null:s.children.head;n.moveChildren(s,l),n.remove()}this.optimize()}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",e?"true":"false")}formatAt(e,t,n,i){super.formatAt(e,t,n,i),this.optimize()}insertAt(e,t,n){if(e>=this.length())if(n==null||this.scroll.query(t,ie.BLOCK)==null){const i=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(i),n==null&&t.endsWith(`
`)?i.insertAt(0,t.slice(0,-1),n):i.insertAt(0,t,n)}else{const i=this.scroll.create(t,n);this.appendChild(i)}else super.insertAt(e,t,n);this.optimize()}insertBefore(e,t){if(e.statics.scope===ie.INLINE_BLOT){const n=this.scroll.create(this.statics.defaultChild.blotName);n.appendChild(e),super.insertBefore(n,t)}else super.insertBefore(e,t)}insertContents(e,t){const n=this.deltaToRenderBlocks(t.concat(new ne().insert(`
`))),i=n.pop();if(i==null)return;this.batchStart();const s=n.shift();if(s){const a=s.type==="block"&&(s.delta.length()===0||!this.descendant(Ue,e)[0]&&e<this.length()),o=s.type==="block"?s.delta:new ne().insert({[s.key]:s.value});eo(this,e,o);const c=s.type==="block"?1:0,d=e+o.length()+c;a&&this.insertAt(d-1,`
`);const p=$e(this.line(e)[0]),h=He.AttributeMap.diff(p,s.attributes)||{};Object.keys(h).forEach(v=>{this.formatAt(d-1,1,v,h[v])}),e=d}let[l,u]=this.children.find(e);if(n.length&&(l&&(l=l.split(u),u=0),n.forEach(a=>{if(a.type==="block"){const o=this.createBlock(a.attributes,l||void 0);eo(o,0,a.delta)}else{const o=this.create(a.key,a.value);this.insertBefore(o,l||void 0),Object.keys(a.attributes).forEach(c=>{o.format(c,a.attributes[c])})}})),i.type==="block"&&i.delta.length()){const a=l?l.offset(l.scroll)+u:this.length();eo(this,a,i.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(e){const t=this.path(e).pop();if(!t)return[null,-1];const[n,i]=t;return n instanceof Te?[n,i]:[null,-1]}line(e){return e===this.length()?this.line(e-1):this.descendant(Lu,e)}lines(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const n=(i,s,l)=>{let u=[],a=l;return i.children.forEachAt(s,l,(o,c,d)=>{Lu(o)?u.push(o):o instanceof Fi&&(u=u.concat(n(o,c,a))),a-=d}),u};return n(this,e,t)}optimize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(e,t),e.length>0&&this.emitter.emit(re.events.SCROLL_OPTIMIZE,e,t))}path(e){return super.path(e).slice(1)}remove(){}update(e){if(this.batch){Array.isArray(e)&&(this.batch=this.batch.concat(e));return}let t=re.sources.USER;typeof e=="string"&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),e=e.filter(n=>{let{target:i}=n;const s=this.find(i,!0);return s&&!Iu(s)}),e.length>0&&this.emitter.emit(re.events.SCROLL_BEFORE_UPDATE,t,e),super.update(e.concat([])),e.length>0&&this.emitter.emit(re.events.SCROLL_UPDATE,t,e)}updateEmbedAt(e,t,n){const[i]=this.descendant(s=>s instanceof Ue,e);i&&i.statics.blotName===t&&Iu(i)&&i.updateContent(n)}handleDragStart(e){e.preventDefault()}deltaToRenderBlocks(e){const t=[];let n=new ne;return e.forEach(i=>{var l;const s=i==null?void 0:i.insert;if(s)if(typeof s=="string"){const u=s.split(`
`);u.slice(0,-1).forEach(o=>{var c;n.insert(o,i.attributes),t.push({type:"block",delta:n,attributes:(c=i.attributes)!=null?c:{}}),n=new ne});const a=u[u.length-1];a&&n.insert(a,i.attributes)}else{const u=Object.keys(s)[0];if(!u)return;this.query(u,ie.INLINE)?n.push(i):(n.length()&&t.push({type:"block",delta:n,attributes:{}}),n=new ne,t.push({type:"blockEmbed",key:u,value:s[u],attributes:(l=i.attributes)!=null?l:{}}))}}),n.length()&&t.push({type:"block",delta:n,attributes:{}}),t}createBlock(e,t){let n;const i={};Object.entries(e).forEach(u=>{let[a,o]=u;this.query(a,ie.BLOCK&ie.BLOT)!=null?n=a:i[a]=o});const s=this.create(n||this.statics.defaultChild.blotName,n?e[n]:void 0);this.insertBefore(s,t||void 0);const l=s.length();return Object.entries(i).forEach(u=>{let[a,o]=u;s.formatAt(0,l,a,o)}),s}}Q(Or,"blotName","scroll"),Q(Or,"className","ql-editor"),Q(Or,"tagName","DIV"),Q(Or,"defaultChild",Ae),Q(Or,"allowedChildren",[Ae,Ue,tr]);function eo(r,e,t){t.reduce((n,i)=>{const s=He.Op.length(i);let l=i.attributes||{};if(i.insert!=null){if(typeof i.insert=="string"){const u=i.insert;r.insertAt(n,u);const[a]=r.descendant(Te,n),o=$e(a);l=He.AttributeMap.diff(o,l)||{}}else if(typeof i.insert=="object"){const u=Object.keys(i.insert)[0];if(u==null)return n;if(r.insertAt(n,u,i.insert[u]),r.scroll.query(u,ie.INLINE)!=null){const[o]=r.descendant(Te,n),c=$e(o);l=He.AttributeMap.diff(c,l)||{}}}}return Object.keys(l).forEach(u=>{r.formatAt(n,s,u,l[u])}),n+s},e)}const vl={scope:ie.BLOCK,whitelist:["right","center","justify"]},s1=new ft("align","align",vl),gh=new et("align","ql-align",vl),mh=new Bt("align","text-align",vl);class vh extends Bt{value(e){let t=super.value(e);return t.startsWith("rgb(")?(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${t.split(",").map(i=>`00${parseInt(i,10).toString(16)}`.slice(-2)).join("")}`):t}}const o1=new et("color","ql-color",{scope:ie.INLINE}),yl=new vh("color","color",{scope:ie.INLINE}),a1=new et("background","ql-bg",{scope:ie.INLINE}),bl=new vh("background","background-color",{scope:ie.INLINE});class rr extends tr{static create(e){const t=super.create(e);return t.setAttribute("spellcheck","false"),t}code(e,t){return this.children.map(n=>n.length()<=1?"":n.domNode.innerText).join(`
`).slice(e,e+t)}html(e,t){return`<pre>
${Gi(this.code(e,t))}
</pre>`}}class Ne extends Ae{static register(){B.register(rr)}}Q(Ne,"TAB","  ");class _l extends ht{}_l.blotName="code";_l.tagName="CODE";Ne.blotName="code-block";Ne.className="ql-code-block";Ne.tagName="DIV";rr.blotName="code-block-container";rr.className="ql-code-block-container";rr.tagName="DIV";rr.allowedChildren=[Ne];Ne.allowedChildren=[Xe,tt,Lr];Ne.requiredContainer=rr;const El={scope:ie.BLOCK,whitelist:["rtl"]},yh=new ft("direction","dir",El),bh=new et("direction","ql-direction",El),_h=new Bt("direction","direction",El),Eh={scope:ie.INLINE,whitelist:["serif","monospace"]},Ah=new et("font","ql-font",Eh);class l1 extends Bt{value(e){return super.value(e).replace(/["']/g,"")}}const Oh=new l1("font","font-family",Eh),Sh=new et("size","ql-size",{scope:ie.INLINE,whitelist:["small","large","huge"]}),wh=new Bt("size","font-size",{scope:ie.INLINE,whitelist:["10px","18px","32px"]}),u1=Rt("quill:keyboard"),c1=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class zi extends rt{static match(e,t){return["altKey","ctrlKey","metaKey","shiftKey"].some(n=>!!t[n]!==e[n]&&t[n]!==null)?!1:t.key===e.key||t.key===e.which}constructor(e,t){super(e,t),this.bindings={},Object.keys(this.options.bindings).forEach(n=>{this.options.bindings[n]&&this.addBinding(this.options.bindings[n])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=h1(e);if(i==null){u1.warn("Attempted to add invalid keyboard binding",i);return}typeof t=="function"&&(t={handler:t}),typeof n=="function"&&(n={handler:n}),(Array.isArray(i.key)?i.key:[i.key]).forEach(l=>{const u={...i,key:l,...t,...n};this.bindings[u.key]=this.bindings[u.key]||[],this.bindings[u.key].push(u)})}listen(){this.quill.root.addEventListener("keydown",e=>{if(e.defaultPrevented||e.isComposing||e.keyCode===229&&(e.key==="Enter"||e.key==="Backspace"))return;const i=(this.bindings[e.key]||[]).concat(this.bindings[e.which]||[]).filter(w=>zi.match(e,w));if(i.length===0)return;const s=B.find(e.target,!0);if(s&&s.scroll!==this.quill.scroll)return;const l=this.quill.getSelection();if(l==null||!this.quill.hasFocus())return;const[u,a]=this.quill.getLine(l.index),[o,c]=this.quill.getLeaf(l.index),[d,p]=l.length===0?[o,c]:this.quill.getLeaf(l.index+l.length),h=o instanceof yi?o.value().slice(0,c):"",v=d instanceof yi?d.value().slice(p):"",_={collapsed:l.length===0,empty:l.length===0&&u.length()<=1,format:this.quill.getFormat(l),line:u,offset:a,prefix:h,suffix:v,event:e};i.some(w=>{if(w.collapsed!=null&&w.collapsed!==_.collapsed||w.empty!=null&&w.empty!==_.empty||w.offset!=null&&w.offset!==_.offset)return!1;if(Array.isArray(w.format)){if(w.format.every(R=>_.format[R]==null))return!1}else if(typeof w.format=="object"&&!Object.keys(w.format).every(R=>w.format[R]===!0?_.format[R]!=null:w.format[R]===!1?_.format[R]==null:dl(w.format[R],_.format[R])))return!1;return w.prefix!=null&&!w.prefix.test(_.prefix)||w.suffix!=null&&!w.suffix.test(_.suffix)?!1:w.handler.call(this,l,_,w)!==!0})&&e.preventDefault()})}handleBackspace(e,t){const n=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;if(e.index===0||this.quill.getLength()<=1)return;let i={};const[s]=this.quill.getLine(e.index);let l=new ne().retain(e.index-n).delete(n);if(t.offset===0){const[u]=this.quill.getLine(e.index-1);if(u&&!(u.statics.blotName==="block"&&u.length()<=1)){const o=s.formats(),c=this.quill.getFormat(e.index-1,1);if(i=He.AttributeMap.diff(o,c)||{},Object.keys(i).length>0){const d=new ne().retain(e.index+s.length()-2).retain(1,i);l=l.compose(d)}}}this.quill.updateContents(l,B.sources.USER),this.quill.focus()}handleDelete(e,t){const n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(e.index>=this.quill.getLength()-n)return;let i={};const[s]=this.quill.getLine(e.index);let l=new ne().retain(e.index).delete(n);if(t.offset>=s.length()-1){const[u]=this.quill.getLine(e.index+1);if(u){const a=s.formats(),o=this.quill.getFormat(e.index,1);i=He.AttributeMap.diff(a,o)||{},Object.keys(i).length>0&&(l=l.retain(u.length()-1).retain(1,i))}}this.quill.updateContents(l,B.sources.USER),this.quill.focus()}handleDeleteRange(e){Al({range:e,quill:this.quill}),this.quill.focus()}handleEnter(e,t){const n=Object.keys(t.format).reduce((s,l)=>(this.quill.scroll.query(l,ie.BLOCK)&&!Array.isArray(t.format[l])&&(s[l]=t.format[l]),s),{}),i=new ne().retain(e.index).delete(e.length).insert(`
`,n);this.quill.updateContents(i,B.sources.USER),this.quill.setSelection(e.index+1,B.sources.SILENT),this.quill.focus()}}const f1={bindings:{bold:to("bold"),italic:to("italic"),underline:to("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(r,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","+1",B.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(r,e){return e.collapsed&&e.offset!==0?!0:(this.quill.format("indent","-1",B.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(r,e){e.format.indent!=null?this.quill.format("indent","-1",B.sources.USER):e.format.list!=null&&this.quill.format("list",!1,B.sources.USER)}},"indent code-block":qu(!0),"outdent code-block":qu(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(r){this.quill.deleteText(r.index-1,1,B.sources.USER)}},tab:{key:"Tab",handler(r,e){if(e.format.table)return!0;this.quill.history.cutoff();const t=new ne().retain(r.index).delete(r.length).insert("	");return this.quill.updateContents(t,B.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(r.index+1,B.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,B.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(r,e){const t={list:!1};e.format.indent&&(t.indent=!1),this.quill.formatLine(r.index,r.length,t,B.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(r){const[e,t]=this.quill.getLine(r.index),n={...e.formats(),list:"checked"},i=new ne().retain(r.index).insert(`
`,n).retain(e.length()-t-1).retain(1,{list:"unchecked"});this.quill.updateContents(i,B.sources.USER),this.quill.setSelection(r.index+1,B.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(r,e){const[t,n]=this.quill.getLine(r.index),i=new ne().retain(r.index).insert(`
`,e.format).retain(t.length()-n-1).retain(1,{header:null});this.quill.updateContents(i,B.sources.USER),this.quill.setSelection(r.index+1,B.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(r){const e=this.quill.getModule("table");if(e){const[t,n,i,s]=e.getTable(r),l=d1(t,n,i,s);if(l==null)return;let u=t.offset();if(l<0){const a=new ne().retain(u).insert(`
`);this.quill.updateContents(a,B.sources.USER),this.quill.setSelection(r.index+1,r.length,B.sources.SILENT)}else if(l>0){u+=t.length();const a=new ne().retain(u).insert(`
`);this.quill.updateContents(a,B.sources.USER),this.quill.setSelection(u,B.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(r,e){const{event:t,line:n}=e,i=n.offset(this.quill.scroll);t.shiftKey?this.quill.setSelection(i-1,B.sources.USER):this.quill.setSelection(i+n.length(),B.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(r,e){if(this.quill.scroll.query("list")==null)return!0;const{length:t}=e.prefix,[n,i]=this.quill.getLine(r.index);if(i>t)return!0;let s;switch(e.prefix.trim()){case"[]":case"[ ]":s="unchecked";break;case"[x]":s="checked";break;case"-":case"*":s="bullet";break;default:s="ordered"}this.quill.insertText(r.index," ",B.sources.USER),this.quill.history.cutoff();const l=new ne().retain(r.index-i).delete(t+1).retain(n.length()-2-i).retain(1,{list:s});return this.quill.updateContents(l,B.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(r.index-t,B.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(r){const[e,t]=this.quill.getLine(r.index);let n=2,i=e;for(;i!=null&&i.length()<=1&&i.formats()["code-block"];)if(i=i.prev,n-=1,n<=0){const s=new ne().retain(r.index+e.length()-t-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(s,B.sources.USER),this.quill.setSelection(r.index-1,B.sources.SILENT),!1}return!0}},"embed left":si("ArrowLeft",!1),"embed left shift":si("ArrowLeft",!0),"embed right":si("ArrowRight",!1),"embed right shift":si("ArrowRight",!0),"table down":Pu(!1),"table up":Pu(!0)}};zi.DEFAULTS=f1;function qu(r){return{key:"Tab",shiftKey:!r,format:{"code-block":!0},handler(e,t){let{event:n}=t;const i=this.quill.scroll.query("code-block"),{TAB:s}=i;if(e.length===0&&!n.shiftKey){this.quill.insertText(e.index,s,B.sources.USER),this.quill.setSelection(e.index+s.length,B.sources.SILENT);return}const l=e.length===0?this.quill.getLines(e.index,1):this.quill.getLines(e);let{index:u,length:a}=e;l.forEach((o,c)=>{r?(o.insertAt(0,s),c===0?u+=s.length:a+=s.length):o.domNode.textContent.startsWith(s)&&(o.deleteAt(0,s.length),c===0?u-=s.length:a-=s.length)}),this.quill.update(B.sources.USER),this.quill.setSelection(u,a,B.sources.SILENT)}}}function si(r,e){return{key:r,shiftKey:e,altKey:null,[r==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(n){let{index:i}=n;r==="ArrowRight"&&(i+=n.length+1);const[s]=this.quill.getLeaf(i);return s instanceof ke?(r==="ArrowLeft"?e?this.quill.setSelection(n.index-1,n.length+1,B.sources.USER):this.quill.setSelection(n.index-1,B.sources.USER):e?this.quill.setSelection(n.index,n.length+1,B.sources.USER):this.quill.setSelection(n.index+n.length+1,B.sources.USER),!1):!0}}}function to(r){return{key:r[0],shortKey:!0,handler(e,t){this.quill.format(r,!t.format[r],B.sources.USER)}}}function Pu(r){return{key:r?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(e,t){const n=r?"prev":"next",i=t.line,s=i.parent[n];if(s!=null){if(s.statics.blotName==="table-row"){let l=s.children.head,u=i;for(;u.prev!=null;)u=u.prev,l=l.next;const a=l.offset(this.quill.scroll)+Math.min(t.offset,l.length()-1);this.quill.setSelection(a,0,B.sources.USER)}}else{const l=i.table()[n];l!=null&&(r?this.quill.setSelection(l.offset(this.quill.scroll)+l.length()-1,0,B.sources.USER):this.quill.setSelection(l.offset(this.quill.scroll),0,B.sources.USER))}return!1}}}function h1(r){if(typeof r=="string"||typeof r=="number")r={key:r};else if(typeof r=="object")r=Sr(r);else return null;return r.shortKey&&(r[c1]=r.shortKey,delete r.shortKey),r}function Al(r){let{quill:e,range:t}=r;const n=e.getLines(t);let i={};if(n.length>1){const s=n[0].formats(),l=n[n.length-1].formats();i=He.AttributeMap.diff(l,s)||{}}e.deleteText(t,B.sources.USER),Object.keys(i).length>0&&e.formatLine(t.index,1,i,B.sources.USER),e.setSelection(t.index,B.sources.SILENT)}function d1(r,e,t,n){return e.prev==null&&e.next==null?t.prev==null&&t.next==null?n===0?-1:1:t.prev==null?-1:1:e.prev==null?-1:e.next==null?1:null}const p1=/font-weight:\s*normal/,g1=["P","OL","UL"],Cu=r=>r&&g1.includes(r.tagName),m1=r=>{Array.from(r.querySelectorAll("br")).filter(e=>Cu(e.previousElementSibling)&&Cu(e.nextElementSibling)).forEach(e=>{var t;(t=e.parentNode)==null||t.removeChild(e)})},v1=r=>{Array.from(r.querySelectorAll('b[style*="font-weight"]')).filter(e=>{var t;return(t=e.getAttribute("style"))==null?void 0:t.match(p1)}).forEach(e=>{var n;const t=r.createDocumentFragment();t.append(...e.childNodes),(n=e.parentNode)==null||n.replaceChild(t,e)})};function y1(r){r.querySelector('[id^="docs-internal-guid-"]')&&(v1(r),m1(r))}const b1=/\bmso-list:[^;]*ignore/i,_1=/\bmso-list:[^;]*\bl(\d+)/i,E1=/\bmso-list:[^;]*\blevel(\d+)/i,A1=(r,e)=>{const t=r.getAttribute("style"),n=t==null?void 0:t.match(_1);if(!n)return null;const i=Number(n[1]),s=t==null?void 0:t.match(E1),l=s?Number(s[1]):1,u=new RegExp(`@list l${i}:level${l}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),a=e.match(u),o=a&&a[1]==="bullet"?"bullet":"ordered";return{id:i,indent:l,type:o,element:r}},O1=r=>{var l,u;const e=Array.from(r.querySelectorAll("[style*=mso-list]")),t=[],n=[];e.forEach(a=>{(a.getAttribute("style")||"").match(b1)?t.push(a):n.push(a)}),t.forEach(a=>{var o;return(o=a.parentNode)==null?void 0:o.removeChild(a)});const i=r.documentElement.innerHTML,s=n.map(a=>A1(a,i)).filter(a=>a);for(;s.length;){const a=[];let o=s.shift();for(;o;)a.push(o),o=s.length&&((l=s[0])==null?void 0:l.element)===o.element.nextElementSibling&&s[0].id===o.id?s.shift():null;const c=document.createElement("ul");a.forEach(h=>{const v=document.createElement("li");v.setAttribute("data-list",h.type),h.indent>1&&v.setAttribute("class",`ql-indent-${h.indent-1}`),v.innerHTML=h.element.innerHTML,c.appendChild(v)});const d=(u=a[0])==null?void 0:u.element,{parentNode:p}=d!=null?d:{};d&&(p==null||p.replaceChild(c,d)),a.slice(1).forEach(h=>{let{element:v}=h;p==null||p.removeChild(v)})}};function S1(r){r.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&O1(r)}const w1=[S1,y1],R1=r=>{r.documentElement&&w1.forEach(e=>{e(r)})},T1=Rt("quill:clipboard"),N1=[[Node.TEXT_NODE,$1],[Node.TEXT_NODE,Du],["br",C1],[Node.ELEMENT_NODE,Du],[Node.ELEMENT_NODE,P1],[Node.ELEMENT_NODE,q1],[Node.ELEMENT_NODE,j1],["li",M1],["ol, ul",k1],["pre",x1],["tr",B1],["b",ro("bold")],["i",ro("italic")],["strike",ro("strike")],["style",D1]],L1=[s1,yh].reduce((r,e)=>(r[e.keyName]=e,r),{}),xu=[mh,bl,yl,_h,Oh,wh].reduce((r,e)=>(r[e.keyName]=e,r),{});class Rh extends rt{constructor(e,t){var n;super(e,t),this.quill.root.addEventListener("copy",i=>this.onCaptureCopy(i,!1)),this.quill.root.addEventListener("cut",i=>this.onCaptureCopy(i,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],N1.concat((n=this.options.matchers)!=null?n:[]).forEach(i=>{let[s,l]=i;this.addMatcher(s,l)})}addMatcher(e,t){this.matchers.push([e,t])}convert(e){let{html:t,text:n}=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(i[Ne.blotName])return new ne().insert(n||"",{[Ne.blotName]:i[Ne.blotName]});if(!t)return new ne().insert(n||"",i);const s=this.convertHTML(t);return Sn(s,`
`)&&(s.ops[s.ops.length-1].attributes==null||i.table)?s.compose(new ne().retain(s.length()-1).delete(1)):s}normalizeHTML(e){R1(e)}convertHTML(e){const t=new DOMParser().parseFromString(e,"text/html");this.normalizeHTML(t);const n=t.body,i=new WeakMap,[s,l]=this.prepareMatching(n,i);return Ol(this.quill.scroll,n,s,l,i)}dangerouslyPasteHTML(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:B.sources.API;if(typeof e=="string"){const i=this.convert({html:e,text:""});this.quill.setContents(i,t),this.quill.setSelection(0,B.sources.SILENT)}else{const i=this.convert({html:t,text:""});this.quill.updateContents(new ne().retain(e).concat(i),n),this.quill.setSelection(e+i.length(),B.sources.SILENT)}}onCaptureCopy(e){var l,u;let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.defaultPrevented)return;e.preventDefault();const[n]=this.quill.selection.getRange();if(n==null)return;const{html:i,text:s}=this.onCopy(n,t);(l=e.clipboardData)==null||l.setData("text/plain",s),(u=e.clipboardData)==null||u.setData("text/html",i),t&&Al({range:n,quill:this.quill})}normalizeURIList(e){return e.split(/\r?\n/).filter(t=>t[0]!=="#").join(`
`)}onCapturePaste(e){var l,u,a,o,c;if(e.defaultPrevented||!this.quill.isEnabled())return;e.preventDefault();const t=this.quill.getSelection(!0);if(t==null)return;const n=(l=e.clipboardData)==null?void 0:l.getData("text/html");let i=(u=e.clipboardData)==null?void 0:u.getData("text/plain");if(!n&&!i){const d=(a=e.clipboardData)==null?void 0:a.getData("text/uri-list");d&&(i=this.normalizeURIList(d))}const s=Array.from(((o=e.clipboardData)==null?void 0:o.files)||[]);if(!n&&s.length>0){this.quill.uploader.upload(t,s);return}if(n&&s.length>0){const d=new DOMParser().parseFromString(n,"text/html");if(d.body.childElementCount===1&&((c=d.body.firstElementChild)==null?void 0:c.tagName)==="IMG"){this.quill.uploader.upload(t,s);return}}this.onPaste(t,{html:n,text:i})}onCopy(e){const t=this.quill.getText(e);return{html:this.quill.getSemanticHTML(e),text:t}}onPaste(e,t){let{text:n,html:i}=t;const s=this.quill.getFormat(e.index),l=this.convert({text:n,html:i},s);T1.log("onPaste",l,{text:n,html:i});const u=new ne().retain(e.index).delete(e.length).concat(l);this.quill.updateContents(u,B.sources.USER),this.quill.setSelection(u.length()-e.length,B.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(e,t){const n=[],i=[];return this.matchers.forEach(s=>{const[l,u]=s;switch(l){case Node.TEXT_NODE:i.push(u);break;case Node.ELEMENT_NODE:n.push(u);break;default:Array.from(e.querySelectorAll(l)).forEach(a=>{if(t.has(a)){const o=t.get(a);o==null||o.push(u)}else t.set(a,[u])});break}}),[n,i]}}Q(Rh,"DEFAULTS",{matchers:[]});function nr(r,e,t,n){return n.query(e)?r.reduce((i,s)=>{if(!s.insert)return i;if(s.attributes&&s.attributes[e])return i.push(s);const l=t?{[e]:t}:{};return i.insert(s.insert,{...l,...s.attributes})},new ne):r}function Sn(r,e){let t="";for(let n=r.ops.length-1;n>=0&&t.length<e.length;--n){const i=r.ops[n];if(typeof i.insert!="string")break;t=i.insert+t}return t.slice(-1*e.length)===e}function Pt(r,e){if(!(r instanceof Element))return!1;const t=e.query(r);return t&&t.prototype instanceof ke?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(r.tagName.toLowerCase())}function I1(r,e){return r.previousElementSibling&&r.nextElementSibling&&!Pt(r.previousElementSibling,e)&&!Pt(r.nextElementSibling,e)}const oi=new WeakMap;function Th(r){return r==null?!1:(oi.has(r)||(r.tagName==="PRE"?oi.set(r,!0):oi.set(r,Th(r.parentNode))),oi.get(r))}function Ol(r,e,t,n,i){return e.nodeType===e.TEXT_NODE?n.reduce((s,l)=>l(e,s,r),new ne):e.nodeType===e.ELEMENT_NODE?Array.from(e.childNodes||[]).reduce((s,l)=>{let u=Ol(r,l,t,n,i);return l.nodeType===e.ELEMENT_NODE&&(u=t.reduce((a,o)=>o(l,a,r),u),u=(i.get(l)||[]).reduce((a,o)=>o(l,a,r),u)),s.concat(u)},new ne):new ne}function ro(r){return(e,t,n)=>nr(t,r,!0,n)}function q1(r,e,t){const n=ft.keys(r),i=et.keys(r),s=Bt.keys(r),l={};return n.concat(i).concat(s).forEach(u=>{let a=t.query(u,ie.ATTRIBUTE);a!=null&&(l[a.attrName]=a.value(r),l[a.attrName])||(a=L1[u],a!=null&&(a.attrName===u||a.keyName===u)&&(l[a.attrName]=a.value(r)||void 0),a=xu[u],a!=null&&(a.attrName===u||a.keyName===u)&&(a=xu[u],l[a.attrName]=a.value(r)||void 0))}),Object.entries(l).reduce((u,a)=>{let[o,c]=a;return nr(u,o,c,t)},e)}function P1(r,e,t){const n=t.query(r);if(n==null)return e;if(n.prototype instanceof ke){const i={},s=n.value(r);if(s!=null)return i[n.blotName]=s,new ne().insert(i,n.formats(r,t))}else if(n.prototype instanceof pn&&!Sn(e,`
`)&&e.insert(`
`),"blotName"in n&&"formats"in n&&typeof n.formats=="function")return nr(e,n.blotName,n.formats(r,t),t);return e}function C1(r,e){return Sn(e,`
`)||e.insert(`
`),e}function x1(r,e,t){const n=t.query("code-block"),i=n&&"formats"in n&&typeof n.formats=="function"?n.formats(r,t):!0;return nr(e,"code-block",i,t)}function D1(){return new ne}function M1(r,e,t){const n=t.query(r);if(n==null||n.blotName!=="list"||!Sn(e,`
`))return e;let i=-1,s=r.parentNode;for(;s!=null;)["OL","UL"].includes(s.tagName)&&(i+=1),s=s.parentNode;return i<=0?e:e.reduce((l,u)=>u.insert?u.attributes&&typeof u.attributes.indent=="number"?l.push(u):l.insert(u.insert,{indent:i,...u.attributes||{}}):l,new ne)}function k1(r,e,t){const n=r;let i=n.tagName==="OL"?"ordered":"bullet";const s=n.getAttribute("data-checked");return s&&(i=s==="true"?"checked":"unchecked"),nr(e,"list",i,t)}function Du(r,e,t){if(!Sn(e,`
`)){if(Pt(r,t)&&(r.childNodes.length>0||r instanceof HTMLParagraphElement))return e.insert(`
`);if(e.length()>0&&r.nextSibling){let n=r.nextSibling;for(;n!=null;){if(Pt(n,t))return e.insert(`
`);const i=t.query(n);if(i&&i.prototype instanceof Ue)return e.insert(`
`);n=n.firstChild}}}return e}function j1(r,e,t){var s;const n={},i=r.style||{};return i.fontStyle==="italic"&&(n.italic=!0),i.textDecoration==="underline"&&(n.underline=!0),i.textDecoration==="line-through"&&(n.strike=!0),((s=i.fontWeight)!=null&&s.startsWith("bold")||parseInt(i.fontWeight,10)>=700)&&(n.bold=!0),e=Object.entries(n).reduce((l,u)=>{let[a,o]=u;return nr(l,a,o,t)},e),parseFloat(i.textIndent||0)>0?new ne().insert("	").concat(e):e}function B1(r,e,t){var i,s;const n=((i=r.parentElement)==null?void 0:i.tagName)==="TABLE"?r.parentElement:(s=r.parentElement)==null?void 0:s.parentElement;if(n!=null){const u=Array.from(n.querySelectorAll("tr")).indexOf(r)+1;return nr(e,"table",u,t)}return e}function $1(r,e,t){var i;let n=r.data;if(((i=r.parentElement)==null?void 0:i.tagName)==="O:P")return e.insert(n.trim());if(!Th(r)){if(n.trim().length===0&&n.includes(`
`)&&!I1(r,t))return e;n=n.replace(/[^\S\u00a0]/g," "),n=n.replace(/ {2,}/g," "),(r.previousSibling==null&&r.parentElement!=null&&Pt(r.parentElement,t)||r.previousSibling instanceof Element&&Pt(r.previousSibling,t))&&(n=n.replace(/^ /,"")),(r.nextSibling==null&&r.parentElement!=null&&Pt(r.parentElement,t)||r.nextSibling instanceof Element&&Pt(r.nextSibling,t))&&(n=n.replace(/ $/,"")),n=n.replaceAll(" "," ")}return e.insert(n)}class Nh extends rt{constructor(t,n){super(t,n);Q(this,"lastRecorded",0);Q(this,"ignoreChange",!1);Q(this,"stack",{undo:[],redo:[]});Q(this,"currentRange",null);this.quill.on(B.events.EDITOR_CHANGE,(i,s,l,u)=>{i===B.events.SELECTION_CHANGE?s&&u!==B.sources.SILENT&&(this.currentRange=s):i===B.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||u===B.sources.USER?this.record(s,l):this.transform(s)),this.currentRange=Xa(this.currentRange,s))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",i=>{i.inputType==="historyUndo"?(this.undo(),i.preventDefault()):i.inputType==="historyRedo"&&(this.redo(),i.preventDefault())})}change(t,n){if(this.stack[t].length===0)return;const i=this.stack[t].pop();if(!i)return;const s=this.quill.getContents(),l=i.delta.invert(s);this.stack[n].push({delta:l,range:Xa(i.range,l)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(i.delta,B.sources.USER),this.ignoreChange=!1,this.restoreSelection(i)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(t,n){if(t.ops.length===0)return;this.stack.redo=[];let i=t.invert(n),s=this.currentRange;const l=Date.now();if(this.lastRecorded+this.options.delay>l&&this.stack.undo.length>0){const u=this.stack.undo.pop();u&&(i=i.compose(u.delta),s=u.range)}else this.lastRecorded=l;i.length()!==0&&(this.stack.undo.push({delta:i,range:s}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(t){Mu(this.stack.undo,t),Mu(this.stack.redo,t)}undo(){this.change("undo","redo")}restoreSelection(t){if(t.range)this.quill.setSelection(t.range,B.sources.USER);else{const n=U1(this.quill.scroll,t.delta);this.quill.setSelection(n,B.sources.USER)}}}Q(Nh,"DEFAULTS",{delay:1e3,maxStack:100,userOnly:!1});function Mu(r,e){let t=e;for(let n=r.length-1;n>=0;n-=1){const i=r[n];r[n]={delta:t.transform(i.delta,!0),range:i.range&&Xa(i.range,t)},t=i.delta.transform(t),r[n].delta.length()===0&&r.splice(n,1)}}function F1(r,e){const t=e.ops[e.ops.length-1];return t==null?!1:t.insert!=null?typeof t.insert=="string"&&t.insert.endsWith(`
`):t.attributes!=null?Object.keys(t.attributes).some(n=>r.query(n,ie.BLOCK)!=null):!1}function U1(r,e){const t=e.reduce((i,s)=>i+(s.delete||0),0);let n=e.length()-t;return F1(r,e)&&(n-=1),n}function Xa(r,e){if(!r)return r;const t=e.transformPosition(r.index),n=e.transformPosition(r.index+r.length);return{index:t,length:n-t}}class Lh extends rt{constructor(e,t){super(e,t),e.root.addEventListener("drop",n=>{var l;n.preventDefault();let i=null;if(document.caretRangeFromPoint)i=document.caretRangeFromPoint(n.clientX,n.clientY);else if(document.caretPositionFromPoint){const u=document.caretPositionFromPoint(n.clientX,n.clientY);i=document.createRange(),i.setStart(u.offsetNode,u.offset),i.setEnd(u.offsetNode,u.offset)}const s=i&&e.selection.normalizeNative(i);if(s){const u=e.selection.normalizedToRange(s);(l=n.dataTransfer)!=null&&l.files&&this.upload(u,n.dataTransfer.files)}})}upload(e,t){const n=[];Array.from(t).forEach(i=>{var s;i&&((s=this.options.mimetypes)!=null&&s.includes(i.type))&&n.push(i)}),n.length>0&&this.options.handler.call(this,e,n)}}Lh.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(r,e){if(!this.quill.scroll.query("image"))return;const t=e.map(n=>new Promise(i=>{const s=new FileReader;s.onload=()=>{i(s.result)},s.readAsDataURL(n)}));Promise.all(t).then(n=>{const i=n.reduce((s,l)=>s.insert({image:l}),new ne().retain(r.index).delete(r.length));this.quill.updateContents(i,re.sources.USER),this.quill.setSelection(r.index+n.length,re.sources.SILENT)})}};const H1=["insertText","insertReplacementText"];class V1 extends rt{constructor(e,t){super(e,t),e.root.addEventListener("beforeinput",n=>{this.handleBeforeInput(n)}),/Android/i.test(navigator.userAgent)||e.on(B.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(e){Al({range:e,quill:this.quill})}replaceText(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e.length===0)return!1;if(t){const n=this.quill.getFormat(e.index,1);this.deleteRange(e),this.quill.updateContents(new ne().retain(e.index).insert(t,n),B.sources.USER)}else this.deleteRange(e);return this.quill.setSelection(e.index+t.length,0,B.sources.SILENT),!0}handleBeforeInput(e){if(this.quill.composition.isComposing||e.defaultPrevented||!H1.includes(e.inputType))return;const t=e.getTargetRanges?e.getTargetRanges()[0]:null;if(!t||t.collapsed===!0)return;const n=G1(e);if(n==null)return;const i=this.quill.selection.normalizeNative(t),s=i?this.quill.selection.normalizedToRange(i):null;s&&this.replaceText(s,n)&&e.preventDefault()}handleCompositionStart(){const e=this.quill.getSelection();e&&this.replaceText(e)}}function G1(r){var e;return typeof r.data=="string"?r.data:(e=r.dataTransfer)!=null&&e.types.includes("text/plain")?r.dataTransfer.getData("text/plain"):null}const z1=/Mac/i.test(navigator.platform),W1=100,K1=r=>!!(r.key==="ArrowLeft"||r.key==="ArrowRight"||r.key==="ArrowUp"||r.key==="ArrowDown"||r.key==="Home"||z1&&r.key==="a"&&r.ctrlKey===!0);class Y1 extends rt{constructor(t,n){super(t,n);Q(this,"isListening",!1);Q(this,"selectionChangeDeadline",0);this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(t,n){let{line:i,event:s}=n;if(!(i instanceof Je)||!i.uiNode)return!0;const l=getComputedStyle(i.domNode).direction==="rtl";return l&&s.key!=="ArrowRight"||!l&&s.key!=="ArrowLeft"?!0:(this.quill.setSelection(t.index-1,t.length+(s.shiftKey?1:0),B.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",t=>{!t.defaultPrevented&&K1(t)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+W1,this.isListening)return;this.isListening=!0;const t=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",t,{once:!0})}handleSelectionChange(){const t=document.getSelection();if(!t)return;const n=t.getRangeAt(0);if(n.collapsed!==!0||n.startOffset!==0)return;const i=this.quill.scroll.find(n.startContainer);if(!(i instanceof Je)||!i.uiNode)return;const s=document.createRange();s.setStartAfter(i.uiNode),s.setEndAfter(i.uiNode),t.removeAllRanges(),t.addRange(s)}}B.register({"blots/block":Ae,"blots/block/embed":Ue,"blots/break":tt,"blots/container":tr,"blots/cursor":Lr,"blots/embed":ml,"blots/inline":ht,"blots/scroll":Or,"blots/text":Xe,"modules/clipboard":Rh,"modules/history":Nh,"modules/keyboard":zi,"modules/uploader":Lh,"modules/input":V1,"modules/uiNode":Y1});class Z1 extends et{add(e,t){let n=0;if(t==="+1"||t==="-1"){const i=this.value(e)||0;n=t==="+1"?i+1:i-1}else typeof t=="number"&&(n=t);return n===0?(this.remove(e),!0):super.add(e,n.toString())}canAdd(e,t){return super.canAdd(e,t)||super.canAdd(e,parseInt(t,10))}value(e){return parseInt(super.value(e),10)||void 0}}const J1=new Z1("indent","ql-indent",{scope:ie.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class Qa extends Ae{}Q(Qa,"blotName","blockquote"),Q(Qa,"tagName","blockquote");class el extends Ae{static formats(e){return this.tagName.indexOf(e.tagName)+1}}Q(el,"blotName","header"),Q(el,"tagName",["H1","H2","H3","H4","H5","H6"]);class wn extends tr{}wn.blotName="list-container";wn.tagName="OL";class Rn extends Ae{static create(e){const t=super.create();return t.setAttribute("data-list",e),t}static formats(e){return e.getAttribute("data-list")||void 0}static register(){B.register(wn)}constructor(e,t){super(e,t);const n=t.ownerDocument.createElement("span"),i=s=>{if(!e.isEnabled())return;const l=this.statics.formats(t,e);l==="checked"?(this.format("list","unchecked"),s.preventDefault()):l==="unchecked"&&(this.format("list","checked"),s.preventDefault())};n.addEventListener("mousedown",i),n.addEventListener("touchstart",i),this.attachUI(n)}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-list",t):super.format(e,t)}}Rn.blotName="list";Rn.tagName="LI";wn.allowedChildren=[Rn];Rn.requiredContainer=wn;class mn extends ht{static create(){return super.create()}static formats(){return!0}optimize(e){super.optimize(e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}Q(mn,"blotName","bold"),Q(mn,"tagName",["STRONG","B"]);class tl extends mn{}Q(tl,"blotName","italic"),Q(tl,"tagName",["EM","I"]);class Ct extends ht{static create(e){const t=super.create(e);return t.setAttribute("href",this.sanitize(e)),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}static formats(e){return e.getAttribute("href")}static sanitize(e){return Ih(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}format(e,t){e!==this.statics.blotName||!t?super.format(e,t):this.domNode.setAttribute("href",this.constructor.sanitize(t))}}Q(Ct,"blotName","link"),Q(Ct,"tagName","A"),Q(Ct,"SANITIZED_URL","about:blank"),Q(Ct,"PROTOCOL_WHITELIST",["http","https","mailto","tel","sms"]);function Ih(r,e){const t=document.createElement("a");t.href=r;const n=t.href.slice(0,t.href.indexOf(":"));return e.indexOf(n)>-1}class rl extends ht{static create(e){return e==="super"?document.createElement("sup"):e==="sub"?document.createElement("sub"):super.create(e)}static formats(e){if(e.tagName==="SUB")return"sub";if(e.tagName==="SUP")return"super"}}Q(rl,"blotName","script"),Q(rl,"tagName",["SUB","SUP"]);class nl extends mn{}Q(nl,"blotName","strike"),Q(nl,"tagName",["S","STRIKE"]);class il extends ht{}Q(il,"blotName","underline"),Q(il,"tagName","U");class hi extends ml{static create(e){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const t=super.create(e);return typeof e=="string"&&(window.katex.render(e,t,{throwOnError:!1,errorColor:"#f00"}),t.setAttribute("data-value",e)),t}static value(e){return e.getAttribute("data-value")}html(){const{formula:e}=this.value();return`<span>${e}</span>`}}Q(hi,"blotName","formula"),Q(hi,"className","ql-formula"),Q(hi,"tagName","SPAN");const ku=["alt","height","width"];class sl extends ke{static create(e){const t=super.create(e);return typeof e=="string"&&t.setAttribute("src",this.sanitize(e)),t}static formats(e){return ku.reduce((t,n)=>(e.hasAttribute(n)&&(t[n]=e.getAttribute(n)),t),{})}static match(e){return/\.(jpe?g|gif|png)$/.test(e)||/^data:image\/.+;base64/.test(e)}static sanitize(e){return Ih(e,["http","https","data"])?e:"//:0"}static value(e){return e.getAttribute("src")}format(e,t){ku.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}}Q(sl,"blotName","image"),Q(sl,"tagName","IMG");const ju=["height","width"];class di extends Ue{static create(e){const t=super.create(e);return t.setAttribute("frameborder","0"),t.setAttribute("allowfullscreen","true"),t.setAttribute("src",this.sanitize(e)),t}static formats(e){return ju.reduce((t,n)=>(e.hasAttribute(n)&&(t[n]=e.getAttribute(n)),t),{})}static sanitize(e){return Ct.sanitize(e)}static value(e){return e.getAttribute("src")}format(e,t){ju.indexOf(e)>-1?t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e):super.format(e,t)}html(){const{video:e}=this.value();return`<a href="${e}">${e}</a>`}}Q(di,"blotName","video"),Q(di,"className","ql-video"),Q(di,"tagName","IFRAME");const sn=new et("code-token","hljs",{scope:ie.INLINE});class Ot extends ht{static formats(e,t){for(;e!=null&&e!==t.domNode;){if(e.classList&&e.classList.contains(Ne.className))return super.formats(e,t);e=e.parentNode}}constructor(e,t,n){super(e,t,n),sn.add(this.domNode,n)}format(e,t){e!==Ot.blotName?super.format(e,t):t?sn.add(this.domNode,t):(sn.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),sn.value(this.domNode)||this.unwrap()}}Ot.blotName="code-token";Ot.className="ql-token";class Fe extends Ne{static create(e){const t=super.create(e);return typeof e=="string"&&t.setAttribute("data-language",e),t}static formats(e){return e.getAttribute("data-language")||"plain"}static register(){}format(e,t){e===this.statics.blotName&&t?this.domNode.setAttribute("data-language",t):super.format(e,t)}replaceWith(e,t){return this.formatAt(0,this.length(),Ot.blotName,!1),super.replaceWith(e,t)}}class ln extends rr{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(e,t){e===Fe.blotName&&(this.forceNext=!0,this.children.forEach(n=>{n.format(e,t)}))}formatAt(e,t,n,i){n===Fe.blotName&&(this.forceNext=!0),super.formatAt(e,t,n,i)}highlight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const i=`${Array.from(this.domNode.childNodes).filter(l=>l!==this.uiNode).map(l=>l.textContent).join(`
`)}
`,s=Fe.formats(this.children.head.domNode);if(t||this.forceNext||this.cachedText!==i){if(i.trim().length>0||this.cachedText==null){const l=this.children.reduce((a,o)=>a.concat(dh(o,!1)),new ne),u=e(i,s);l.diff(u).reduce((a,o)=>{let{retain:c,attributes:d}=o;return c?(d&&Object.keys(d).forEach(p=>{[Fe.blotName,Ot.blotName].includes(p)&&this.formatAt(a,c,p,d[p])}),a+c):a},0)}this.cachedText=i,this.forceNext=!1}}html(e,t){const[n]=this.children.find(e);return`<pre data-language="${n?Fe.formats(n.domNode):"plain"}">
${Gi(this.code(e,t))}
</pre>`}optimize(e){if(super.optimize(e),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const t=Fe.formats(this.children.head.domNode);t!==this.uiNode.value&&(this.uiNode.value=t)}}}ln.allowedChildren=[Fe];Fe.requiredContainer=ln;Fe.allowedChildren=[Ot,Lr,Xe,tt];const X1=(r,e,t)=>{if(typeof r.versionString=="string"){const n=r.versionString.split(".")[0];if(parseInt(n,10)>=11)return r.highlight(t,{language:e}).value}return r.highlight(e,t).value};class qh extends rt{static register(){B.register(Ot,!0),B.register(Fe,!0),B.register(ln,!0)}constructor(e,t){if(super(e,t),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((n,i)=>{let{key:s}=i;return n[s]=!0,n},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(B.events.SCROLL_BLOT_MOUNT,e=>{if(!(e instanceof ln))return;const t=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(n=>{let{key:i,label:s}=n;const l=t.ownerDocument.createElement("option");l.textContent=s,l.setAttribute("value",i),t.appendChild(l)}),t.addEventListener("change",()=>{e.format(Fe.blotName,t.value),this.quill.root.focus(),this.highlight(e,!0)}),e.uiNode==null&&(e.attachUI(t),e.children.head&&(t.value=Fe.formats(e.children.head.domNode)))})}initTimer(){let e=null;this.quill.on(B.events.SCROLL_OPTIMIZE,()=>{e&&clearTimeout(e),e=setTimeout(()=>{this.highlight(),e=null},this.options.interval)})}highlight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(B.sources.USER);const n=this.quill.getSelection();(e==null?this.quill.scroll.descendants(ln):[e]).forEach(s=>{s.highlight(this.highlightBlot,t)}),this.quill.update(B.sources.SILENT),n!=null&&this.quill.setSelection(n,B.sources.SILENT)}highlightBlot(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(t=this.languages[t]?t:"plain",t==="plain")return Gi(e).split(`
`).reduce((i,s,l)=>(l!==0&&i.insert(`
`,{[Ne.blotName]:t}),i.insert(s)),new ne);const n=this.quill.root.ownerDocument.createElement("div");return n.classList.add(Ne.className),n.innerHTML=X1(this.options.hljs,t,e),Ol(this.quill.scroll,n,[(i,s)=>{const l=sn.value(i);return l?s.compose(new ne().retain(s.length(),{[Ot.blotName]:l})):s}],[(i,s)=>i.data.split(`
`).reduce((l,u,a)=>(a!==0&&l.insert(`
`,{[Ne.blotName]:t}),l.insert(u)),s)],new WeakMap)}}qh.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};const cn=class cn extends Ae{static create(e){const t=super.create();return e?t.setAttribute("data-row",e):t.setAttribute("data-row",Sl()),t}static formats(e){if(e.hasAttribute("data-row"))return e.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(e,t){e===cn.blotName&&t?this.domNode.setAttribute("data-row",t):super.format(e,t)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}};Q(cn,"blotName","table"),Q(cn,"tagName","TD");let Ze=cn;class St extends tr{checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const e=this.children.head.formats(),t=this.children.tail.formats(),n=this.next.children.head.formats(),i=this.next.children.tail.formats();return e.table===t.table&&e.table===n.table&&e.table===i.table}return!1}optimize(e){super.optimize(e),this.children.forEach(t=>{if(t.next==null)return;const n=t.formats(),i=t.next.formats();if(n.table!==i.table){const s=this.splitAfter(t);s&&s.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}Q(St,"blotName","table-row"),Q(St,"tagName","TR");class ct extends tr{}Q(ct,"blotName","table-body"),Q(ct,"tagName","TBODY");class qr extends tr{balanceCells(){const e=this.descendants(St),t=e.reduce((n,i)=>Math.max(i.children.length,n),0);e.forEach(n=>{new Array(t-n.children.length).fill(0).forEach(()=>{let i;n.children.head!=null&&(i=Ze.formats(n.children.head.domNode));const s=this.scroll.create(Ze.blotName,i);n.appendChild(s),s.optimize()})})}cells(e){return this.rows().map(t=>t.children.at(e))}deleteColumn(e){const[t]=this.descendant(ct);t==null||t.children.head==null||t.children.forEach(n=>{const i=n.children.at(e);i!=null&&i.remove()})}insertColumn(e){const[t]=this.descendant(ct);t==null||t.children.head==null||t.children.forEach(n=>{const i=n.children.at(e),s=Ze.formats(n.children.head.domNode),l=this.scroll.create(Ze.blotName,s);n.insertBefore(l,i)})}insertRow(e){const[t]=this.descendant(ct);if(t==null||t.children.head==null)return;const n=Sl(),i=this.scroll.create(St.blotName);t.children.head.children.forEach(()=>{const l=this.scroll.create(Ze.blotName,n);i.appendChild(l)});const s=t.children.at(e);t.insertBefore(i,s)}rows(){const e=this.children.head;return e==null?[]:e.children.map(t=>t)}}Q(qr,"blotName","table-container"),Q(qr,"tagName","TABLE");qr.allowedChildren=[ct];ct.requiredContainer=qr;ct.allowedChildren=[St];St.requiredContainer=ct;St.allowedChildren=[Ze];Ze.requiredContainer=St;function Sl(){return`row-${Math.random().toString(36).slice(2,6)}`}class Q1 extends rt{static register(){B.register(Ze),B.register(St),B.register(ct),B.register(qr)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(qr).forEach(e=>{e.balanceCells()})}deleteColumn(){const[e,,t]=this.getTable();t!=null&&(e.deleteColumn(t.cellOffset()),this.quill.update(B.sources.USER))}deleteRow(){const[,e]=this.getTable();e!=null&&(e.remove(),this.quill.update(B.sources.USER))}deleteTable(){const[e]=this.getTable();if(e==null)return;const t=e.offset();e.remove(),this.quill.update(B.sources.USER),this.quill.setSelection(t,B.sources.SILENT)}getTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(e==null)return[null,null,null,-1];const[t,n]=this.quill.getLine(e.index);if(t==null||t.statics.blotName!==Ze.blotName)return[null,null,null,-1];const i=t.parent;return[i.parent.parent,i,t,n]}insertColumn(e){const t=this.quill.getSelection();if(!t)return;const[n,i,s]=this.getTable(t);if(s==null)return;const l=s.cellOffset();n.insertColumn(l+e),this.quill.update(B.sources.USER);let u=i.rowOffset();e===0&&(u+=1),this.quill.setSelection(t.index+u,t.length,B.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(e){const t=this.quill.getSelection();if(!t)return;const[n,i,s]=this.getTable(t);if(s==null)return;const l=i.rowOffset();n.insertRow(l+e),this.quill.update(B.sources.USER),e>0?this.quill.setSelection(t,B.sources.SILENT):this.quill.setSelection(t.index+i.children.length,t.length,B.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(e,t){const n=this.quill.getSelection();if(n==null)return;const i=new Array(e).fill(0).reduce(s=>{const l=new Array(t).fill(`
`).join("");return s.insert(l,{table:Sl()})},new ne().retain(n.index));this.quill.updateContents(i,B.sources.USER),this.quill.setSelection(n.index,B.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(B.events.SCROLL_OPTIMIZE,e=>{e.some(t=>["TD","TR","TBODY","TABLE"].includes(t.target.tagName)?(this.quill.once(B.events.TEXT_CHANGE,(n,i,s)=>{s===B.sources.USER&&this.balanceTables()}),!0):!1)})}}const Bu=Rt("quill:toolbar");class wl extends rt{constructor(e,t){var n,i;if(super(e,t),Array.isArray(this.options.container)){const s=document.createElement("div");s.setAttribute("role","toolbar"),eb(s,this.options.container),(i=(n=e.container)==null?void 0:n.parentNode)==null||i.insertBefore(s,e.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){Bu.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{var u;const l=(u=this.options.handlers)==null?void 0:u[s];l&&this.addHandler(s,l)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(B.events.EDITOR_CHANGE,()=>{const[s]=this.quill.selection.getRange();this.update(s)})}addHandler(e,t){this.handlers[e]=t}attach(e){let t=Array.from(e.classList).find(i=>i.indexOf("ql-")===0);if(!t)return;if(t=t.slice(3),e.tagName==="BUTTON"&&e.setAttribute("type","button"),this.handlers[t]==null&&this.quill.scroll.query(t)==null){Bu.warn("ignoring attaching to nonexistent format",t,e);return}const n=e.tagName==="SELECT"?"change":"click";e.addEventListener(n,i=>{let s;if(e.tagName==="SELECT"){if(e.selectedIndex<0)return;const u=e.options[e.selectedIndex];u.hasAttribute("selected")?s=!1:s=u.value||!1}else e.classList.contains("ql-active")?s=!1:s=e.value||!e.hasAttribute("value"),i.preventDefault();this.quill.focus();const[l]=this.quill.selection.getRange();if(this.handlers[t]!=null)this.handlers[t].call(this,s);else if(this.quill.scroll.query(t).prototype instanceof ke){if(s=prompt(`Enter ${t}`),!s)return;this.quill.updateContents(new ne().retain(l.index).delete(l.length).insert({[t]:s}),B.sources.USER)}else this.quill.format(t,s,B.sources.USER);this.update(l)}),this.controls.push([t,e])}update(e){const t=e==null?{}:this.quill.getFormat(e);this.controls.forEach(n=>{const[i,s]=n;if(s.tagName==="SELECT"){let l=null;if(e==null)l=null;else if(t[i]==null)l=s.querySelector("option[selected]");else if(!Array.isArray(t[i])){let u=t[i];typeof u=="string"&&(u=u.replace(/"/g,'\\"')),l=s.querySelector(`option[value="${u}"]`)}l==null?(s.value="",s.selectedIndex=-1):l.selected=!0}else if(e==null)s.classList.remove("ql-active"),s.setAttribute("aria-pressed","false");else if(s.hasAttribute("value")){const l=t[i],u=l===s.getAttribute("value")||l!=null&&l.toString()===s.getAttribute("value")||l==null&&!s.getAttribute("value");s.classList.toggle("ql-active",u),s.setAttribute("aria-pressed",u.toString())}else{const l=t[i]!=null;s.classList.toggle("ql-active",l),s.setAttribute("aria-pressed",l.toString())}})}}wl.DEFAULTS={};function $u(r,e,t){const n=document.createElement("button");n.setAttribute("type","button"),n.classList.add(`ql-${e}`),n.setAttribute("aria-pressed","false"),t!=null?(n.value=t,n.setAttribute("aria-label",`${e}: ${t}`)):n.setAttribute("aria-label",e),r.appendChild(n)}function eb(r,e){Array.isArray(e[0])||(e=[e]),e.forEach(t=>{const n=document.createElement("span");n.classList.add("ql-formats"),t.forEach(i=>{if(typeof i=="string")$u(n,i);else{const s=Object.keys(i)[0],l=i[s];Array.isArray(l)?tb(n,s,l):$u(n,s,l)}}),r.appendChild(n)})}function tb(r,e,t){const n=document.createElement("select");n.classList.add(`ql-${e}`),t.forEach(i=>{const s=document.createElement("option");i!==!1?s.setAttribute("value",String(i)):s.setAttribute("selected","selected"),n.appendChild(s)}),r.appendChild(n)}wl.DEFAULTS={container:null,handlers:{clean(){const r=this.quill.getSelection();if(r!=null)if(r.length===0){const e=this.quill.getFormat();Object.keys(e).forEach(t=>{this.quill.scroll.query(t,ie.INLINE)!=null&&this.quill.format(t,!1,B.sources.USER)})}else this.quill.removeFormat(r.index,r.length,B.sources.USER)},direction(r){const{align:e}=this.quill.getFormat();r==="rtl"&&e==null?this.quill.format("align","right",B.sources.USER):!r&&e==="right"&&this.quill.format("align",!1,B.sources.USER),this.quill.format("direction",r,B.sources.USER)},indent(r){const e=this.quill.getSelection(),t=this.quill.getFormat(e),n=parseInt(t.indent||0,10);if(r==="+1"||r==="-1"){let i=r==="+1"?1:-1;t.direction==="rtl"&&(i*=-1),this.quill.format("indent",n+i,B.sources.USER)}},link(r){r===!0&&(r=prompt("Enter link URL:")),this.quill.format("link",r,B.sources.USER)},list(r){const e=this.quill.getSelection(),t=this.quill.getFormat(e);r==="check"?t.list==="checked"||t.list==="unchecked"?this.quill.format("list",!1,B.sources.USER):this.quill.format("list","unchecked",B.sources.USER):this.quill.format("list",r,B.sources.USER)}}};const rb='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',nb='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',ib='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',sb='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',ob='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',ab='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',lb='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',ub='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',Fu='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',cb='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',fb='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',hb='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',db='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',pb='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',gb='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',mb='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',vb='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',yb='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',bb='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',_b='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',Eb='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',Ab='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',Ob='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',Sb='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',wb='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',Rb='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',Tb='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',Nb='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',Lb='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',Ib='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',qb='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',Pb='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',Cb='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',vn={align:{"":rb,center:nb,right:ib,justify:sb},background:ob,blockquote:ab,bold:lb,clean:ub,code:Fu,"code-block":Fu,color:cb,direction:{"":fb,rtl:hb},formula:db,header:{1:pb,2:gb,3:mb,4:vb,5:yb,6:bb},italic:_b,image:Eb,indent:{"+1":Ab,"-1":Ob},link:Sb,list:{bullet:wb,check:Rb,ordered:Tb},script:{sub:Nb,super:Lb},strike:Ib,table:qb,underline:Pb,video:Cb},xb='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let Uu=0;function Hu(r,e){r.setAttribute(e,`${r.getAttribute(e)!=="true"}`)}class Wi{constructor(e){this.select=e,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",t=>{switch(t.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),t.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),Hu(this.label,"aria-expanded"),Hu(this.options,"aria-hidden")}buildItem(e){const t=document.createElement("span");t.tabIndex="0",t.setAttribute("role","button"),t.classList.add("ql-picker-item");const n=e.getAttribute("value");return n&&t.setAttribute("data-value",n),e.textContent&&t.setAttribute("data-label",e.textContent),t.addEventListener("click",()=>{this.selectItem(t,!0)}),t.addEventListener("keydown",i=>{switch(i.key){case"Enter":this.selectItem(t,!0),i.preventDefault();break;case"Escape":this.escape(),i.preventDefault();break}}),t}buildLabel(){const e=document.createElement("span");return e.classList.add("ql-picker-label"),e.innerHTML=xb,e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-expanded","false"),this.container.appendChild(e),e}buildOptions(){const e=document.createElement("span");e.classList.add("ql-picker-options"),e.setAttribute("aria-hidden","true"),e.tabIndex="-1",e.id=`ql-picker-options-${Uu}`,Uu+=1,this.label.setAttribute("aria-controls",e.id),this.options=e,Array.from(this.select.options).forEach(t=>{const n=this.buildItem(t);e.appendChild(n),t.selected===!0&&this.selectItem(n)}),this.container.appendChild(e)}buildPicker(){Array.from(this.select.attributes).forEach(e=>{this.container.setAttribute(e.name,e.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.container.querySelector(".ql-selected");e!==n&&(n!=null&&n.classList.remove("ql-selected"),e!=null&&(e.classList.add("ql-selected"),this.select.selectedIndex=Array.from(e.parentNode.children).indexOf(e),e.hasAttribute("data-value")?this.label.setAttribute("data-value",e.getAttribute("data-value")):this.label.removeAttribute("data-value"),e.hasAttribute("data-label")?this.label.setAttribute("data-label",e.getAttribute("data-label")):this.label.removeAttribute("data-label"),t&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let e;if(this.select.selectedIndex>-1){const n=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];e=this.select.options[this.select.selectedIndex],this.selectItem(n)}else this.selectItem(null);const t=e!=null&&e!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",t)}}class Ph extends Wi{constructor(e,t){super(e),this.label.innerHTML=t,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(n=>{n.classList.add("ql-primary")})}buildItem(e){const t=super.buildItem(e);return t.style.backgroundColor=e.getAttribute("value")||"",t}selectItem(e,t){super.selectItem(e,t);const n=this.label.querySelector(".ql-color-label"),i=e&&e.getAttribute("data-value")||"";n&&(n.tagName==="line"?n.style.stroke=i:n.style.fill=i)}}class Ch extends Wi{constructor(e,t){super(e),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(n=>{n.innerHTML=t[n.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(e,t){super.selectItem(e,t);const n=e||this.defaultItem;if(n!=null){if(this.label.innerHTML===n.innerHTML)return;this.label.innerHTML=n.innerHTML}}}const Db=r=>{const{overflowY:e}=getComputedStyle(r,null);return e!=="visible"&&e!=="clip"};class xh{constructor(e,t){this.quill=e,this.boundsContainer=t||document.body,this.root=e.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Db(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(e){const t=e.left+e.width/2-this.root.offsetWidth/2,n=e.bottom+this.quill.root.scrollTop;this.root.style.left=`${t}px`,this.root.style.top=`${n}px`,this.root.classList.remove("ql-flip");const i=this.boundsContainer.getBoundingClientRect(),s=this.root.getBoundingClientRect();let l=0;if(s.right>i.right&&(l=i.right-s.right,this.root.style.left=`${t+l}px`),s.left<i.left&&(l=i.left-s.left,this.root.style.left=`${t+l}px`),s.bottom>i.bottom){const u=s.bottom-s.top,a=e.bottom-e.top+u;this.root.style.top=`${n-a}px`,this.root.classList.add("ql-flip")}return l}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const Mb=[!1,"center","right","justify"],kb=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],jb=[!1,"serif","monospace"],Bb=["1","2","3",!1],$b=["small",!1,"large","huge"];class Tn extends Ir{constructor(e,t){super(e,t);const n=i=>{if(!document.body.contains(e.root)){document.body.removeEventListener("click",n);return}this.tooltip!=null&&!this.tooltip.root.contains(i.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(s=>{s.container.contains(i.target)||s.close()})};e.emitter.listenDOM("click",document.body,n)}addModule(e){const t=super.addModule(e);return e==="toolbar"&&this.extendToolbar(t),t}buildButtons(e,t){Array.from(e).forEach(n=>{(n.getAttribute("class")||"").split(/\s+/).forEach(s=>{if(s.startsWith("ql-")&&(s=s.slice(3),t[s]!=null))if(s==="direction")n.innerHTML=t[s][""]+t[s].rtl;else if(typeof t[s]=="string")n.innerHTML=t[s];else{const l=n.value||"";l!=null&&t[s][l]&&(n.innerHTML=t[s][l])}})})}buildPickers(e,t){this.pickers=Array.from(e).map(i=>{if(i.classList.contains("ql-align")&&(i.querySelector("option")==null&&en(i,Mb),typeof t.align=="object"))return new Ch(i,t.align);if(i.classList.contains("ql-background")||i.classList.contains("ql-color")){const s=i.classList.contains("ql-background")?"background":"color";return i.querySelector("option")==null&&en(i,kb,s==="background"?"#ffffff":"#000000"),new Ph(i,t[s])}return i.querySelector("option")==null&&(i.classList.contains("ql-font")?en(i,jb):i.classList.contains("ql-header")?en(i,Bb):i.classList.contains("ql-size")&&en(i,$b)),new Wi(i)});const n=()=>{this.pickers.forEach(i=>{i.update()})};this.quill.on(re.events.EDITOR_CHANGE,n)}}Tn.DEFAULTS=xt({},Ir.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let r=this.container.querySelector("input.ql-image[type=file]");r==null&&(r=document.createElement("input"),r.setAttribute("type","file"),r.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),r.classList.add("ql-image"),r.addEventListener("change",()=>{const e=this.quill.getSelection(!0);this.quill.uploader.upload(e,r.files),r.value=""}),this.container.appendChild(r)),r.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class Dh extends xh{constructor(e,t){super(e,t),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",e=>{e.key==="Enter"?(this.save(),e.preventDefault()):e.key==="Escape"&&(this.cancel(),e.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;t!=null?this.textbox.value=t:e!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const n=this.quill.getBounds(this.quill.selection.savedRange);n!=null&&this.position(n),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${e}`)||""),this.root.setAttribute("data-mode",e)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:e}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:t}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",e,re.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",e,re.sources.USER)),this.quill.root.scrollTop=t;break}case"video":e=Fb(e);case"formula":{if(!e)break;const t=this.quill.getSelection(!0);if(t!=null){const n=t.index+t.length;this.quill.insertEmbed(n,this.root.getAttribute("data-mode"),e,re.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(n+1," ",re.sources.USER),this.quill.setSelection(n+2,re.sources.USER)}break}}this.textbox.value="",this.hide()}}function Fb(r){let e=r.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||r.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return e?`${e[1]||"https"}://www.youtube.com/embed/${e[2]}?showinfo=0`:(e=r.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${e[1]||"https"}://player.vimeo.com/video/${e[2]}/`:r}function en(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;e.forEach(n=>{const i=document.createElement("option");n===t?i.setAttribute("selected","selected"):i.setAttribute("value",String(n)),r.appendChild(i)})}const Ub=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class Mh extends Dh{constructor(e,t){super(e,t),this.quill.on(re.events.EDITOR_CHANGE,(n,i,s,l)=>{if(n===re.events.SELECTION_CHANGE)if(i!=null&&i.length>0&&l===re.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const u=this.quill.getLines(i.index,i.length);if(u.length===1){const a=this.quill.getBounds(i);a!=null&&this.position(a)}else{const a=u[u.length-1],o=this.quill.getIndex(a),c=Math.min(a.length()-1,i.index+i.length-o),d=this.quill.getBounds(new Jt(o,c));d!=null&&this.position(d)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(re.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const e=this.quill.getSelection();if(e!=null){const t=this.quill.getBounds(e);t!=null&&this.position(t)}},1)})}cancel(){this.show()}position(e){const t=super.position(e),n=this.root.querySelector(".ql-tooltip-arrow");return n.style.marginLeft="",t!==0&&(n.style.marginLeft=`${-1*t-n.offsetWidth/2}px`),t}}Q(Mh,"TEMPLATE",['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""));class kh extends Tn{constructor(e,t){t.modules.toolbar!=null&&t.modules.toolbar.container==null&&(t.modules.toolbar.container=Ub),super(e,t),this.quill.container.classList.add("ql-bubble")}extendToolbar(e){this.tooltip=new Mh(this.quill,this.options.bounds),e.container!=null&&(this.tooltip.root.appendChild(e.container),this.buildButtons(e.container.querySelectorAll("button"),vn),this.buildPickers(e.container.querySelectorAll("select"),vn))}}kh.DEFAULTS=xt({},Tn.DEFAULTS,{modules:{toolbar:{handlers:{link(r){r?this.quill.theme.tooltip.edit():this.quill.format("link",!1,B.sources.USER)}}}}});const Hb=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class jh extends Dh{constructor(){super(...arguments);Q(this,"preview",this.root.querySelector("a.ql-preview"))}listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",t=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),t.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",t=>{if(this.linkRange!=null){const n=this.linkRange;this.restoreFocus(),this.quill.formatText(n,"link",!1,re.sources.USER),delete this.linkRange}t.preventDefault(),this.hide()}),this.quill.on(re.events.SELECTION_CHANGE,(t,n,i)=>{if(t!=null){if(t.length===0&&i===re.sources.USER){const[s,l]=this.quill.scroll.descendant(Ct,t.index);if(s!=null){this.linkRange=new Jt(t.index-l,s.length());const u=Ct.formats(s.domNode);this.preview.textContent=u,this.preview.setAttribute("href",u),this.show();const a=this.quill.getBounds(this.linkRange);a!=null&&this.position(a);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}Q(jh,"TEMPLATE",['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""));class Bh extends Tn{constructor(e,t){t.modules.toolbar!=null&&t.modules.toolbar.container==null&&(t.modules.toolbar.container=Hb),super(e,t),this.quill.container.classList.add("ql-snow")}extendToolbar(e){e.container!=null&&(e.container.classList.add("ql-snow"),this.buildButtons(e.container.querySelectorAll("button"),vn),this.buildPickers(e.container.querySelectorAll("select"),vn),this.tooltip=new jh(this.quill,this.options.bounds),e.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(t,n)=>{e.handlers.link.call(e,!n.format.link)}))}}Bh.DEFAULTS=xt({},Tn.DEFAULTS,{modules:{toolbar:{handlers:{link(r){if(r){const e=this.quill.getSelection();if(e==null||e.length===0)return;let t=this.quill.getText(e);/^\S+@\S+\.\S+$/.test(t)&&t.indexOf("mailto:")!==0&&(t=`mailto:${t}`);const{tooltip:n}=this.quill.theme;n.edit("link",t)}else this.quill.format("link",!1,B.sources.USER)}}}}});B.register({"attributors/attribute/direction":yh,"attributors/class/align":gh,"attributors/class/background":a1,"attributors/class/color":o1,"attributors/class/direction":bh,"attributors/class/font":Ah,"attributors/class/size":Sh,"attributors/style/align":mh,"attributors/style/background":bl,"attributors/style/color":yl,"attributors/style/direction":_h,"attributors/style/font":Oh,"attributors/style/size":wh},!0);B.register({"formats/align":gh,"formats/direction":bh,"formats/indent":J1,"formats/background":bl,"formats/color":yl,"formats/font":Ah,"formats/size":Sh,"formats/blockquote":Qa,"formats/code-block":Ne,"formats/header":el,"formats/list":Rn,"formats/bold":mn,"formats/code":_l,"formats/italic":tl,"formats/link":Ct,"formats/script":rl,"formats/strike":nl,"formats/underline":il,"formats/formula":hi,"formats/image":sl,"formats/video":di,"modules/syntax":qh,"modules/table":Q1,"modules/toolbar":wl,"themes/bubble":kh,"themes/snow":Bh,"ui/icons":vn,"ui/picker":Wi,"ui/icon-picker":Ch,"ui/color-picker":Ph,"ui/tooltip":xh},!0);var It={},ai={},li={exports:{}},Vu;function $h(){if(Vu)return li.exports;Vu=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(m,A,S){return Function.prototype.apply.call(m,A,S)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:t=function(m){return Object.getOwnPropertyNames(m)};function n(g){console&&console.warn&&console.warn(g)}var i=Number.isNaN||function(m){return m!==m};function s(){s.init.call(this)}li.exports=s,li.exports.once=w,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function u(g){if(typeof g!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof g)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(g){if(typeof g!="number"||g<0||i(g))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+g+".");l=g}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||i(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this};function a(g){return g._maxListeners===void 0?s.defaultMaxListeners:g._maxListeners}s.prototype.getMaxListeners=function(){return a(this)},s.prototype.emit=function(m){for(var A=[],S=1;S<arguments.length;S++)A.push(arguments[S]);var I=m==="error",C=this._events;if(C!==void 0)I=I&&C.error===void 0;else if(!I)return!1;if(I){var D;if(A.length>0&&(D=A[0]),D instanceof Error)throw D;var O=new Error("Unhandled error."+(D?" ("+D.message+")":""));throw O.context=D,O}var x=C[m];if(x===void 0)return!1;if(typeof x=="function")e(x,this,A);else for(var L=x.length,j=v(x,L),S=0;S<L;++S)e(j[S],this,A);return!0};function o(g,m,A,S){var I,C,D;if(u(A),C=g._events,C===void 0?(C=g._events=Object.create(null),g._eventsCount=0):(C.newListener!==void 0&&(g.emit("newListener",m,A.listener?A.listener:A),C=g._events),D=C[m]),D===void 0)D=C[m]=A,++g._eventsCount;else if(typeof D=="function"?D=C[m]=S?[A,D]:[D,A]:S?D.unshift(A):D.push(A),I=a(g),I>0&&D.length>I&&!D.warned){D.warned=!0;var O=new Error("Possible EventEmitter memory leak detected. "+D.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");O.name="MaxListenersExceededWarning",O.emitter=g,O.type=m,O.count=D.length,n(O)}return g}s.prototype.addListener=function(m,A){return o(this,m,A,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(m,A){return o(this,m,A,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(g,m,A){var S={fired:!1,wrapFn:void 0,target:g,type:m,listener:A},I=c.bind(S);return I.listener=A,S.wrapFn=I,I}s.prototype.once=function(m,A){return u(A),this.on(m,d(this,m,A)),this},s.prototype.prependOnceListener=function(m,A){return u(A),this.prependListener(m,d(this,m,A)),this},s.prototype.removeListener=function(m,A){var S,I,C,D,O;if(u(A),I=this._events,I===void 0)return this;if(S=I[m],S===void 0)return this;if(S===A||S.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete I[m],I.removeListener&&this.emit("removeListener",m,S.listener||A));else if(typeof S!="function"){for(C=-1,D=S.length-1;D>=0;D--)if(S[D]===A||S[D].listener===A){O=S[D].listener,C=D;break}if(C<0)return this;C===0?S.shift():_(S,C),S.length===1&&(I[m]=S[0]),I.removeListener!==void 0&&this.emit("removeListener",m,O||A)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(m){var A,S,I;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[m]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[m]),this;if(arguments.length===0){var C=Object.keys(S),D;for(I=0;I<C.length;++I)D=C[I],D!=="removeListener"&&this.removeAllListeners(D);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=S[m],typeof A=="function")this.removeListener(m,A);else if(A!==void 0)for(I=A.length-1;I>=0;I--)this.removeListener(m,A[I]);return this};function p(g,m,A){var S=g._events;if(S===void 0)return[];var I=S[m];return I===void 0?[]:typeof I=="function"?A?[I.listener||I]:[I]:A?E(I):v(I,I.length)}s.prototype.listeners=function(m){return p(this,m,!0)},s.prototype.rawListeners=function(m){return p(this,m,!1)},s.listenerCount=function(g,m){return typeof g.listenerCount=="function"?g.listenerCount(m):h.call(g,m)},s.prototype.listenerCount=h;function h(g){var m=this._events;if(m!==void 0){var A=m[g];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function v(g,m){for(var A=new Array(m),S=0;S<m;++S)A[S]=g[S];return A}function _(g,m){for(;m+1<g.length;m++)g[m]=g[m+1];g.pop()}function E(g){for(var m=new Array(g.length),A=0;A<m.length;++A)m[A]=g[A].listener||g[A];return m}function w(g,m){return new Promise(function(A,S){function I(D){g.removeListener(m,C),S(D)}function C(){typeof g.removeListener=="function"&&g.removeListener("error",I),A([].slice.call(arguments))}y(g,m,C,{once:!0}),m!=="error"&&R(g,I,{once:!0})})}function R(g,m,A){typeof g.on=="function"&&y(g,"error",m,A)}function y(g,m,A,S){if(typeof g.on=="function")S.once?g.once(m,A):g.on(m,A);else if(typeof g.addEventListener=="function")g.addEventListener(m,function I(C){S.once&&g.removeEventListener(m,I),A(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof g)}return li.exports}var Gu;function Mr(){if(Gu)return ai;Gu=1;var r=$h().EventEmitter;ai.EventEmitter=r,ai.mixin=e;function e(t){for(var n in r.prototype)t.prototype[n]=r.prototype[n]}return ai}var no,zu;function Vb(){if(zu)return no;zu=1;var r=["info","warn","error"];function e(){var t=Object.create(null);r.forEach(function(n){t[n]=console[n].bind(console)}),this.setMethods(t)}return no=e,e.prototype.setMethods=function(t){t=t||{};var n=this;r.forEach(function(i){typeof t[i]=="function"&&(n[i]=t[i])})},no}var io,Wu;function Rl(){if(Wu)return io;Wu=1;var r=Vb(),e=new r;return io=e,io}var so,Ku;function Nn(){if(Ku)return so;Ku=1;function r(e,t){this.code=e,this.message=t||"",Error.captureStackTrace?Error.captureStackTrace(this,r):this.stack=new Error().stack}return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.name="ShareDBError",r.CODES={ERR_APPLY_OP_VERSION_DOES_NOT_MATCH_SNAPSHOT:"ERR_APPLY_OP_VERSION_DOES_NOT_MATCH_SNAPSHOT",ERR_APPLY_SNAPSHOT_NOT_PROVIDED:"ERR_APPLY_SNAPSHOT_NOT_PROVIDED",ERR_FIXUP_IS_ONLY_VALID_ON_APPLY:"ERR_FIXUP_IS_ONLY_VALID_ON_APPLY",ERR_CANNOT_FIXUP_DELETION:"ERR_CANNOT_FIXUP_DELETION",ERR_CLIENT_ID_BADLY_FORMED:"ERR_CLIENT_ID_BADLY_FORMED",ERR_CANNOT_PING_OFFLINE:"ERR_CANNOT_PING_OFFLINE",ERR_CONNECTION_SEQ_INTEGER_OVERFLOW:"ERR_CONNECTION_SEQ_INTEGER_OVERFLOW",ERR_CONNECTION_STATE_TRANSITION_INVALID:"ERR_CONNECTION_STATE_TRANSITION_INVALID",ERR_DATABASE_ADAPTER_NOT_FOUND:"ERR_DATABASE_ADAPTER_NOT_FOUND",ERR_DATABASE_DOES_NOT_SUPPORT_SUBSCRIBE:"ERR_DATABASE_DOES_NOT_SUPPORT_SUBSCRIBE",ERR_DATABASE_METHOD_NOT_IMPLEMENTED:"ERR_DATABASE_METHOD_NOT_IMPLEMENTED",ERR_DEFAULT_TYPE_MISMATCH:"ERR_DEFAULT_TYPE_MISMATCH",ERR_DOC_MISSING_VERSION:"ERR_DOC_MISSING_VERSION",ERR_DOC_ALREADY_CREATED:"ERR_DOC_ALREADY_CREATED",ERR_DOC_DOES_NOT_EXIST:"ERR_DOC_DOES_NOT_EXIST",ERR_DOC_TYPE_NOT_RECOGNIZED:"ERR_DOC_TYPE_NOT_RECOGNIZED",ERR_DOC_WAS_DELETED:"ERR_DOC_WAS_DELETED",ERR_DOC_IN_HARD_ROLLBACK:"ERR_DOC_IN_HARD_ROLLBACK",ERR_INFLIGHT_OP_MISSING:"ERR_INFLIGHT_OP_MISSING",ERR_INGESTED_SNAPSHOT_HAS_NO_VERSION:"ERR_INGESTED_SNAPSHOT_HAS_NO_VERSION",ERR_MAX_SUBMIT_RETRIES_EXCEEDED:"ERR_MAX_SUBMIT_RETRIES_EXCEEDED",ERR_MESSAGE_BADLY_FORMED:"ERR_MESSAGE_BADLY_FORMED",ERR_MILESTONE_ARGUMENT_INVALID:"ERR_MILESTONE_ARGUMENT_INVALID",ERR_NO_OP:"ERR_NO_OP",ERR_OP_ALREADY_SUBMITTED:"ERR_OP_ALREADY_SUBMITTED",ERR_OP_NOT_ALLOWED_IN_PROJECTION:"ERR_OP_NOT_ALLOWED_IN_PROJECTION",ERR_OP_SUBMIT_REJECTED:"ERR_OP_SUBMIT_REJECTED",ERR_PENDING_OP_REMOVED_BY_OP_SUBMIT_REJECTED:"ERR_PENDING_OP_REMOVED_BY_OP_SUBMIT_REJECTED",ERR_HARD_ROLLBACK_FETCH_FAILED:"ERR_HARD_ROLLBACK_FETCH_FAILED",ERR_OP_VERSION_MISMATCH_AFTER_TRANSFORM:"ERR_OP_VERSION_MISMATCH_AFTER_TRANSFORM",ERR_OP_VERSION_MISMATCH_DURING_TRANSFORM:"ERR_OP_VERSION_MISMATCH_DURING_TRANSFORM",ERR_OP_VERSION_NEWER_THAN_CURRENT_SNAPSHOT:"ERR_OP_VERSION_NEWER_THAN_CURRENT_SNAPSHOT",ERR_OT_LEGACY_JSON0_OP_CANNOT_BE_NORMALIZED:"ERR_OT_LEGACY_JSON0_OP_CANNOT_BE_NORMALIZED",ERR_OT_OP_BADLY_FORMED:"ERR_OT_OP_BADLY_FORMED",ERR_OT_OP_NOT_APPLIED:"ERR_OT_OP_NOT_APPLIED",ERR_OT_OP_NOT_PROVIDED:"ERR_OT_OP_NOT_PROVIDED",ERR_PRESENCE_TRANSFORM_FAILED:"ERR_PRESENCE_TRANSFORM_FAILED",ERR_PROTOCOL_VERSION_NOT_SUPPORTED:"ERR_PROTOCOL_VERSION_NOT_SUPPORTED",ERR_QUERY_CHANNEL_MISSING:"ERR_QUERY_CHANNEL_MISSING",ERR_QUERY_EMITTER_LISTENER_NOT_ASSIGNED:"ERR_QUERY_EMITTER_LISTENER_NOT_ASSIGNED",ERR_SNAPSHOT_READ_SILENT_REJECTION:"ERR_SNAPSHOT_READ_SILENT_REJECTION",ERR_SNAPSHOT_READS_REJECTED:"ERR_SNAPSHOT_READS_REJECTED",ERR_SUBMIT_TRANSFORM_OPS_NOT_FOUND:"ERR_SUBMIT_TRANSFORM_OPS_NOT_FOUND",ERR_TYPE_CANNOT_BE_PROJECTED:"ERR_TYPE_CANNOT_BE_PROJECTED",ERR_TYPE_DOES_NOT_SUPPORT_COMPOSE:"ERR_TYPE_DOES_NOT_SUPPORT_COMPOSE",ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE:"ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE",ERR_UNKNOWN_ERROR:"ERR_UNKNOWN_ERROR"},so=r,so}var oo={},ao,Yu;function Fh(){if(Yu)return ao;Yu=1,ao=r;function r(e,t,n,i){var s=function(u,a,o,c){t(o,u,a,"left"),t(c,a,u,"right")},l=e.transformX=function(u,a){n(u),n(a);for(var o=[],c=0;c<a.length;c++){for(var d=a[c],p=[],h=0;h<u.length;){var v=[];if(s(u[h],d,p,v),h++,v.length===1)d=v[0];else if(v.length===0){for(var _=h;_<u.length;_++)i(p,u[_]);d=null;break}else{for(var E=l(u.slice(h),v),w=0;w<E[0].length;w++)i(p,E[0][w]);for(var R=0;R<E[1].length;R++)i(o,E[1][R]);d=null;break}}d!=null&&i(o,d),u=p}return[u,o]};e.transform=function(u,a,o){if(!(o==="left"||o==="right"))throw new Error("type must be 'left' or 'right'");return a.length===0?u:u.length===1&&a.length===1?t([],u[0],a[0],o):o==="left"?l(u,a)[0]:l(a,u)[1]}}return ao}var lo={exports:{}},Zu;function Gb(){if(Zu)return lo.exports;Zu=1;var r=lo.exports={name:"text0",uri:"http://sharejs.org/types/textv0",create:function(a){if(a!=null&&typeof a!="string")throw new Error("Initial data must be a string");return a||""}},e=function(a,o,c){return a.slice(0,o)+c+a.slice(o)},t=function(a){if(typeof a.p!="number")throw new Error("component missing position field");if(typeof a.i=="string"==(typeof a.d=="string"))throw new Error("component needs an i or d field");if(a.p<0)throw new Error("position cannot be negative")},n=function(a){for(var o=0;o<a.length;o++)t(a[o])};r.apply=function(a,o){var c;n(o);for(var d=0;d<o.length;d++){var p=o[d];if(p.i!=null)a=e(a,p.p,p.i);else{if(c=a.slice(p.p,p.p+p.d.length),p.d!==c)throw new Error("Delete component '"+p.d+"' does not match deleted text '"+c+"'");a=a.slice(0,p.p)+a.slice(p.p+p.d.length)}}return a};var i=r._append=function(a,o){if(!(o.i===""||o.d===""))if(a.length===0)a.push(o);else{var c=a[a.length-1];c.i!=null&&o.i!=null&&c.p<=o.p&&o.p<=c.p+c.i.length?a[a.length-1]={i:e(c.i,o.p-c.p,o.i),p:c.p}:c.d!=null&&o.d!=null&&o.p<=c.p&&c.p<=o.p+o.d.length?a[a.length-1]={d:e(o.d,c.p-o.p,c.d),p:o.p}:a.push(o)}};r.compose=function(a,o){n(a),n(o);for(var c=a.slice(),d=0;d<o.length;d++)i(c,o[d]);return c},r.normalize=function(a){var o=[];(a.i!=null||a.p!=null)&&(a=[a]);for(var c=0;c<a.length;c++){var d=a[c];d.p==null&&(d.p=0),i(o,d)}return o};var s=function(a,o,c){return o.i!=null?o.p<a||o.p===a&&c?a+o.i.length:a:a<=o.p?a:a<=o.p+o.d.length?o.p:a-o.d.length};r.transformCursor=function(a,o,c){for(var d=c==="right",p=0;p<o.length;p++)a=s(a,o[p],d);return a};var l=r._tc=function(a,o,c,d){if(t(o),t(c),o.i!=null)i(a,{i:o.i,p:s(o.p,c,d==="right")});else if(c.i!=null){var p=o.d;o.p<c.p&&(i(a,{d:p.slice(0,c.p-o.p),p:o.p}),p=p.slice(c.p-o.p)),p!==""&&i(a,{d:p,p:o.p+c.i.length})}else if(o.p>=c.p+c.d.length)i(a,{d:o.d,p:o.p-c.d.length});else if(o.p+o.d.length<=c.p)i(a,o);else{var h={d:"",p:o.p};o.p<c.p&&(h.d=o.d.slice(0,c.p-o.p)),o.p+o.d.length>c.p+c.d.length&&(h.d+=o.d.slice(c.p+c.d.length-o.p));var v=Math.max(o.p,c.p),_=Math.min(o.p+o.d.length,c.p+c.d.length),E=o.d.slice(v-o.p,_-o.p),w=c.d.slice(v-c.p,_-c.p);if(E!==w)throw new Error("Delete ops delete different text in the same region of the document");h.d!==""&&(h.p=s(h.p,c),i(a,h))}return a},u=function(a){return a.i!=null?{d:a.i,p:a.p}:{i:a.d,p:a.p}};return r.invert=function(a){a=a.slice().reverse();for(var o=0;o<a.length;o++)a[o]=u(a[o]);return a},Fh()(r,l,n,i),lo.exports}var uo,Ju;function zb(){if(Ju)return uo;Ju=1;var r=function(o){return Object.prototype.toString.call(o)=="[object Array]"},e=function(o){return!!o&&o.constructor===Object},t=function(o){return JSON.parse(JSON.stringify(o))},n={name:"json0",uri:"http://sharejs.org/types/JSONv0"},i={};n.registerSubtype=function(o){i[o.name]=o},n.create=function(o){return o===void 0?null:t(o)},n.invertComponent=function(o){var c={p:o.p};return o.t&&i[o.t]&&(c.t=o.t,c.o=i[o.t].invert(o.o)),o.si!==void 0&&(c.sd=o.si),o.sd!==void 0&&(c.si=o.sd),o.oi!==void 0&&(c.od=o.oi),o.od!==void 0&&(c.oi=o.od),o.li!==void 0&&(c.ld=o.li),o.ld!==void 0&&(c.li=o.ld),o.na!==void 0&&(c.na=-o.na),o.lm!==void 0&&(c.lm=o.p[o.p.length-1],c.p=o.p.slice(0,o.p.length-1).concat([o.lm])),c},n.invert=function(o){for(var c=o.slice().reverse(),d=[],p=0;p<c.length;p++)d.push(n.invertComponent(c[p]));return d},n.checkValidOp=function(o){for(var c=0;c<o.length;c++)if(!r(o[c].p))throw new Error("Missing path")},n.checkList=function(o){if(!r(o))throw new Error("Referenced element not a list")},n.checkObj=function(o){if(!e(o))throw new Error("Referenced element not an object (it was "+JSON.stringify(o)+")")};function s(o){o.t="text0";var c={p:o.p.pop()};o.si!=null&&(c.i=o.si),o.sd!=null&&(c.d=o.sd),o.o=[c]}function l(o){o.p.push(o.o[0].p),o.o[0].i!=null&&(o.si=o.o[0].i),o.o[0].d!=null&&(o.sd=o.o[0].d),delete o.t,delete o.o}n.apply=function(o,c){n.checkValidOp(c),c=t(c);for(var d={data:o},p=0;p<c.length;p++){var h=c[p];(h.si!=null||h.sd!=null)&&s(h);for(var v=null,_=d,E="data",w=0;w<h.p.length;w++){var R=h.p[w];if(v=_,_=_[E],E=R,v==null)throw new Error("Path invalid")}if(h.t&&h.o!==void 0&&i[h.t])_[E]=i[h.t].apply(_[E],h.o);else if(h.na!==void 0){if(typeof _[E]!="number")throw new Error("Referenced element not a number");_[E]+=h.na}else if(h.li!==void 0&&h.ld!==void 0)n.checkList(_),_[E]=h.li;else if(h.li!==void 0)n.checkList(_),_.splice(E,0,h.li);else if(h.ld!==void 0)n.checkList(_),_.splice(E,1);else if(h.lm!==void 0){if(n.checkList(_),h.lm!=E){var y=_[E];_.splice(E,1),_.splice(h.lm,0,y)}}else if(h.oi!==void 0)n.checkObj(_),_[E]=h.oi;else if(h.od!==void 0)n.checkObj(_),delete _[E];else throw new Error("invalid / missing instruction in op")}return d.data},n.shatter=function(o){for(var c=[],d=0;d<o.length;d++)c.push([o[d]]);return c},n.incrementalApply=function(o,c,d){for(var p=0;p<c.length;p++){var h=[c[p]];o=n.apply(o,h),d(h,o)}return o};var u=n.pathMatches=function(o,c,d){if(o.length!=c.length)return!1;for(var p=0;p<o.length;p++)if(o[p]!==c[p]&&(!d||p!==o.length-1))return!1;return!0};n.append=function(o,c){if(c=t(c),o.length===0){o.push(c);return}var d=o[o.length-1];if((c.si!=null||c.sd!=null)&&(d.si!=null||d.sd!=null)&&(s(c),s(d)),u(c.p,d.p))if(c.t&&d.t&&c.t===d.t&&i[c.t]){if(d.o=i[c.t].compose(d.o,c.o),c.si!=null||c.sd!=null){for(var p=c.p,h=0;h<d.o.length-1;h++)c.o=[d.o.pop()],c.p=p.slice(),l(c),o.push(c);l(d)}}else d.na!=null&&c.na!=null?o[o.length-1]={p:d.p,na:d.na+c.na}:d.li!==void 0&&c.li===void 0&&c.ld===d.li?d.ld!==void 0?delete d.li:o.pop():d.od!==void 0&&d.oi===void 0&&c.oi!==void 0&&c.od===void 0?d.oi=c.oi:d.oi!==void 0&&c.od!==void 0?c.oi!==void 0?d.oi=c.oi:d.od!==void 0?delete d.oi:o.pop():c.lm!==void 0&&c.p[c.p.length-1]===c.lm||o.push(c);else(c.si!=null||c.sd!=null)&&(d.si!=null||d.sd!=null)&&(l(c),l(d)),o.push(c)},n.compose=function(o,c){n.checkValidOp(o),n.checkValidOp(c);for(var d=t(o),p=0;p<c.length;p++)n.append(d,c[p]);return d},n.normalize=function(o){var c=[];o=r(o)?o:[o];for(var d=0;d<o.length;d++){var p=o[d];p.p==null&&(p.p=[]),n.append(c,p)}return c},n.commonLengthForOps=function(o,c){var d=o.p.length,p=c.p.length;if((o.na!=null||o.t)&&d++,(c.na!=null||c.t)&&p++,d===0)return-1;if(p===0)return null;d--,p--;for(var h=0;h<d;h++){var v=o.p[h];if(h>=p||v!==c.p[h])return null}return d},n.canOpAffectPath=function(o,c){return n.commonLengthForOps({p:c},o)!=null},n.transformComponent=function(o,c,d,p){c=t(c);var h=n.commonLengthForOps(d,c),v=n.commonLengthForOps(c,d),_=c.p.length,E=d.p.length;if((c.na!=null||c.t)&&_++,(d.na!=null||d.t)&&E++,v!=null&&E>_&&c.p[v]==d.p[v]){if(c.ld!==void 0){var w=t(d);w.p=w.p.slice(_),c.ld=n.apply(t(c.ld),[w])}else if(c.od!==void 0){var w=t(d);w.p=w.p.slice(_),c.od=n.apply(t(c.od),[w])}}if(h!=null){var R=_==E,w=d;if((c.si!=null||c.sd!=null)&&(d.si!=null||d.sd!=null)&&(s(c),w=t(d),s(w)),w.t&&i[w.t]){if(c.t&&c.t===w.t){var y=i[c.t].transform(c.o,w.o,p);if(c.si!=null||c.sd!=null)for(var g=c.p,m=0;m<y.length;m++)c.o=[y[m]],c.p=g.slice(),l(c),n.append(o,c);else(!r(y)||y.length>0)&&(c.o=y,n.append(o,c));return o}}else if(d.na===void 0){if(d.li!==void 0&&d.ld!==void 0){if(d.p[h]===c.p[h])if(R){if(c.ld!==void 0)if(c.li!==void 0&&p==="left")c.ld=t(d.li);else return o}else return o}else if(d.li!==void 0)c.li!==void 0&&c.ld===void 0&&R&&c.p[h]===d.p[h]?p==="right"&&c.p[h]++:d.p[h]<=c.p[h]&&c.p[h]++,c.lm!==void 0&&R&&d.p[h]<=c.lm&&c.lm++;else if(d.ld!==void 0){if(c.lm!==void 0&&R){if(d.p[h]===c.p[h])return o;var g=d.p[h],A=c.p[h],S=c.lm;(g<S||g===S&&A<S)&&c.lm--}if(d.p[h]<c.p[h])c.p[h]--;else if(d.p[h]===c.p[h]){if(E<_)return o;if(c.ld!==void 0)if(c.li!==void 0)delete c.ld;else return o}}else if(d.lm!==void 0)if(c.lm!==void 0&&_===E){var A=c.p[h],S=c.lm,I=d.p[h],C=d.lm;if(I!==C)if(A===I)if(p==="left")c.p[h]=C,A===S&&(c.lm=C);else return o;else A>I&&c.p[h]--,A>C?c.p[h]++:A===C&&I>C&&(c.p[h]++,A===S&&c.lm++),(S>I||S===I&&S>A)&&c.lm--,S>C?c.lm++:S===C&&(C>I&&S>A||C<I&&S<A?p==="right"&&c.lm++:S>A?c.lm++:S===I&&c.lm--)}else if(c.li!==void 0&&c.ld===void 0&&R){var A=d.p[h],S=d.lm;g=c.p[h],g>A&&c.p[h]--,g>S&&c.p[h]++}else{var A=d.p[h],S=d.lm;g=c.p[h],g===A?c.p[h]=S:(g>A&&c.p[h]--,(g>S||g===S&&A>S)&&c.p[h]++)}else if(d.oi!==void 0&&d.od!==void 0){if(c.p[h]===d.p[h])if(c.oi!==void 0&&R){if(p==="right")return o;c.od=d.oi}else return o}else if(d.oi!==void 0){if(c.oi!==void 0&&c.p[h]===d.p[h])if(p==="left")n.append(o,{p:c.p,od:d.oi});else return o}else if(d.od!==void 0&&c.p[h]==d.p[h]){if(!R)return o;if(c.oi!==void 0)delete c.od;else return o}}}return n.append(o,c),o},Fh()(n,n.transformComponent,n.checkValidOp,n.append);var a=Gb();return n.registerSubtype(a),uo=n,uo}var co,Xu;function Wb(){return Xu||(Xu=1,co={type:zb()}),co}var Qu;function Ki(){return Qu||(Qu=1,(function(r){r.defaultType=Wb().type,r.map=Object.create(null),r.register=function(e){e.name&&(r.map[e.name]=e),e.uri&&(r.map[e.uri]=e)},r.register(r.defaultType)})(oo)),oo}var fo={},ui={},ec;function Kb(){if(ec)return ui;ec=1,ui.messageChannel=function(){var e=r(arguments),t=new MessageChannel;t.port1.onmessage=function(){e(),t.port1.close()},t.port2.postMessage("")},ui.setTimeout=function(){var e=r(arguments);setTimeout(e)};function r(e){for(var t=e[0],n=[],i=1;i<e.length;i++)n[i-1]=e[i];return function(){t.apply(null,n)}}return ui}var ho={},po={},go,tc;function Uh(){return tc||(tc=1,go=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var l=Object.getOwnPropertySymbols(e);if(l.length!==1||l[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var u=Object.getOwnPropertyDescriptor(e,t);if(u.value!==i||u.enumerable!==!0)return!1}return!0}),go}var mo,rc;function Yi(){if(rc)return mo;rc=1;var r=Uh();return mo=function(){return r()&&!!Symbol.toStringTag},mo}var vo,nc;function Hh(){return nc||(nc=1,vo=Object),vo}var yo,ic;function Yb(){return ic||(ic=1,yo=Error),yo}var bo,sc;function Zb(){return sc||(sc=1,bo=EvalError),bo}var _o,oc;function Jb(){return oc||(oc=1,_o=RangeError),_o}var Eo,ac;function Xb(){return ac||(ac=1,Eo=ReferenceError),Eo}var Ao,lc;function Vh(){return lc||(lc=1,Ao=SyntaxError),Ao}var Oo,uc;function Ln(){return uc||(uc=1,Oo=TypeError),Oo}var So,cc;function Qb(){return cc||(cc=1,So=URIError),So}var wo,fc;function e0(){return fc||(fc=1,wo=Math.abs),wo}var Ro,hc;function t0(){return hc||(hc=1,Ro=Math.floor),Ro}var To,dc;function r0(){return dc||(dc=1,To=Math.max),To}var No,pc;function n0(){return pc||(pc=1,No=Math.min),No}var Lo,gc;function i0(){return gc||(gc=1,Lo=Math.pow),Lo}var Io,mc;function s0(){return mc||(mc=1,Io=Math.round),Io}var qo,vc;function o0(){return vc||(vc=1,qo=Number.isNaN||function(e){return e!==e}),qo}var Po,yc;function a0(){if(yc)return Po;yc=1;var r=o0();return Po=function(t){return r(t)||t===0?t:t<0?-1:1},Po}var Co,bc;function l0(){return bc||(bc=1,Co=Object.getOwnPropertyDescriptor),Co}var xo,_c;function kr(){if(_c)return xo;_c=1;var r=l0();if(r)try{r([],"length")}catch{r=null}return xo=r,xo}var Do,Ec;function Zi(){if(Ec)return Do;Ec=1;var r=Object.defineProperty||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}return Do=r,Do}var Mo,Ac;function u0(){if(Ac)return Mo;Ac=1;var r=typeof Symbol!="undefined"&&Symbol,e=Uh();return Mo=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Mo}var ko,Oc;function Gh(){return Oc||(Oc=1,ko=typeof Reflect!="undefined"&&Reflect.getPrototypeOf||null),ko}var jo,Sc;function zh(){if(Sc)return jo;Sc=1;var r=Hh();return jo=r.getPrototypeOf||null,jo}var Bo,wc;function c0(){if(wc)return Bo;wc=1;var r="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,n="[object Function]",i=function(a,o){for(var c=[],d=0;d<a.length;d+=1)c[d]=a[d];for(var p=0;p<o.length;p+=1)c[p+a.length]=o[p];return c},s=function(a,o){for(var c=[],d=o,p=0;d<a.length;d+=1,p+=1)c[p]=a[d];return c},l=function(u,a){for(var o="",c=0;c<u.length;c+=1)o+=u[c],c+1<u.length&&(o+=a);return o};return Bo=function(a){var o=this;if(typeof o!="function"||e.apply(o)!==n)throw new TypeError(r+o);for(var c=s(arguments,1),d,p=function(){if(this instanceof d){var w=o.apply(this,i(c,arguments));return Object(w)===w?w:this}return o.apply(a,i(c,arguments))},h=t(0,o.length-c.length),v=[],_=0;_<h;_++)v[_]="$"+_;if(d=Function("binder","return function ("+l(v,",")+"){ return binder.apply(this,arguments); }")(p),o.prototype){var E=function(){};E.prototype=o.prototype,d.prototype=new E,E.prototype=null}return d},Bo}var $o,Rc;function In(){if(Rc)return $o;Rc=1;var r=c0();return $o=Function.prototype.bind||r,$o}var Fo,Tc;function Tl(){return Tc||(Tc=1,Fo=Function.prototype.call),Fo}var Uo,Nc;function Nl(){return Nc||(Nc=1,Uo=Function.prototype.apply),Uo}var Ho,Lc;function f0(){return Lc||(Lc=1,Ho=typeof Reflect!="undefined"&&Reflect&&Reflect.apply),Ho}var Vo,Ic;function Wh(){if(Ic)return Vo;Ic=1;var r=In(),e=Nl(),t=Tl(),n=f0();return Vo=n||r.call(t,e),Vo}var Go,qc;function Ll(){if(qc)return Go;qc=1;var r=In(),e=Ln(),t=Tl(),n=Wh();return Go=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return n(r,t,s)},Go}var zo,Pc;function h0(){if(Pc)return zo;Pc=1;var r=Ll(),e=kr(),t;try{t=[].__proto__===Array.prototype}catch(l){if(!l||typeof l!="object"||!("code"in l)||l.code!=="ERR_PROTO_ACCESS")throw l}var n=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return zo=n&&typeof n.get=="function"?r([n.get]):typeof s=="function"?function(u){return s(u==null?u:i(u))}:!1,zo}var Wo,Cc;function Il(){if(Cc)return Wo;Cc=1;var r=Gh(),e=zh(),t=h0();return Wo=r?function(i){return r(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,Wo}var Ko,xc;function Kh(){if(xc)return Ko;xc=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=In();return Ko=t.call(r,e),Ko}var Yo,Dc;function Yh(){if(Dc)return Yo;Dc=1;var r,e=Hh(),t=Yb(),n=Zb(),i=Jb(),s=Xb(),l=Vh(),u=Ln(),a=Qb(),o=e0(),c=t0(),d=r0(),p=n0(),h=i0(),v=s0(),_=a0(),E=Function,w=function(K){try{return E('"use strict"; return ('+K+").constructor;")()}catch{}},R=kr(),y=Zi(),g=function(){throw new u},m=R?(function(){try{return arguments.callee,g}catch{try{return R(arguments,"callee").get}catch{return g}}})():g,A=u0()(),S=Il(),I=zh(),C=Gh(),D=Nl(),O=Tl(),x={},L=typeof Uint8Array=="undefined"||!S?r:S(Uint8Array),j={__proto__:null,"%AggregateError%":typeof AggregateError=="undefined"?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?r:ArrayBuffer,"%ArrayIteratorPrototype%":A&&S?S([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":x,"%AsyncGenerator%":x,"%AsyncGeneratorFunction%":x,"%AsyncIteratorPrototype%":x,"%Atomics%":typeof Atomics=="undefined"?r:Atomics,"%BigInt%":typeof BigInt=="undefined"?r:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?r:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":n,"%Float16Array%":typeof Float16Array=="undefined"?r:Float16Array,"%Float32Array%":typeof Float32Array=="undefined"?r:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?r:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?r:FinalizationRegistry,"%Function%":E,"%GeneratorFunction%":x,"%Int8Array%":typeof Int8Array=="undefined"?r:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?r:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":A&&S?S(S([][Symbol.iterator]())):r,"%JSON%":typeof JSON=="object"?JSON:r,"%Map%":typeof Map=="undefined"?r:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!A||!S?r:S(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":R,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?r:Promise,"%Proxy%":typeof Proxy=="undefined"?r:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect=="undefined"?r:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?r:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!A||!S?r:S(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":A&&S?S(""[Symbol.iterator]()):r,"%Symbol%":A?Symbol:r,"%SyntaxError%":l,"%ThrowTypeError%":m,"%TypedArray%":L,"%TypeError%":u,"%Uint8Array%":typeof Uint8Array=="undefined"?r:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?r:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?r:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?r:Uint32Array,"%URIError%":a,"%WeakMap%":typeof WeakMap=="undefined"?r:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?r:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?r:WeakSet,"%Function.prototype.call%":O,"%Function.prototype.apply%":D,"%Object.defineProperty%":y,"%Object.getPrototypeOf%":I,"%Math.abs%":o,"%Math.floor%":c,"%Math.max%":d,"%Math.min%":p,"%Math.pow%":h,"%Math.round%":v,"%Math.sign%":_,"%Reflect.getPrototypeOf%":C};if(S)try{null.error}catch(K){var H=S(S(K));j["%Error.prototype%"]=H}var M=function K(G){var Z;if(G==="%AsyncFunction%")Z=w("async function () {}");else if(G==="%GeneratorFunction%")Z=w("function* () {}");else if(G==="%AsyncGeneratorFunction%")Z=w("async function* () {}");else if(G==="%AsyncGenerator%"){var te=K("%AsyncGeneratorFunction%");te&&(Z=te.prototype)}else if(G==="%AsyncIteratorPrototype%"){var oe=K("%AsyncGenerator%");oe&&S&&(Z=S(oe.prototype))}return j[G]=Z,Z},U={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},V=In(),z=Kh(),F=V.call(O,Array.prototype.concat),X=V.call(D,Array.prototype.splice),Y=V.call(O,String.prototype.replace),N=V.call(O,String.prototype.slice),q=V.call(O,RegExp.prototype.exec),P=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,W=/\\(\\)?/g,ee=function(G){var Z=N(G,0,1),te=N(G,-1);if(Z==="%"&&te!=="%")throw new l("invalid intrinsic syntax, expected closing `%`");if(te==="%"&&Z!=="%")throw new l("invalid intrinsic syntax, expected opening `%`");var oe=[];return Y(G,P,function(ce,de,me,Ve){oe[oe.length]=me?Y(Ve,W,"$1"):de||ce}),oe},J=function(G,Z){var te=G,oe;if(z(U,te)&&(oe=U[te],te="%"+oe[0]+"%"),z(j,te)){var ce=j[te];if(ce===x&&(ce=M(te)),typeof ce=="undefined"&&!Z)throw new u("intrinsic "+G+" exists, but is not available. Please file an issue!");return{alias:oe,name:te,value:ce}}throw new l("intrinsic "+G+" does not exist!")};return Yo=function(G,Z){if(typeof G!="string"||G.length===0)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Z!="boolean")throw new u('"allowMissing" argument must be a boolean');if(q(/^%?[^%]*%?$/,G)===null)throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var te=ee(G),oe=te.length>0?te[0]:"",ce=J("%"+oe+"%",Z),de=ce.name,me=ce.value,Ve=!1,pt=ce.alias;pt&&(oe=pt[0],X(te,F([0,1],pt)));for(var $=1,qe=!0;$<te.length;$+=1){var Oe=te[$],gt=N(Oe,0,1),mt=N(Oe,-1);if((gt==='"'||gt==="'"||gt==="`"||mt==='"'||mt==="'"||mt==="`")&&gt!==mt)throw new l("property names with quotes must have matching quotes");if((Oe==="constructor"||!qe)&&(Ve=!0),oe+="."+Oe,de="%"+oe+"%",z(j,de))me=j[de];else if(me!=null){if(!(Oe in me)){if(!Z)throw new u("base intrinsic for "+G+" exists, but the property is not available.");return}if(R&&$+1>=te.length){var Le=R(me,Oe);qe=!!Le,qe&&"get"in Le&&!("originalValue"in Le.get)?me=Le.get:me=me[Oe]}else qe=z(me,Oe),me=me[Oe];qe&&!Ve&&(j[de]=me)}}return me},Yo}var Zo,Mc;function qn(){if(Mc)return Zo;Mc=1;var r=Yh(),e=Ll(),t=e([r("%String.prototype.indexOf%")]);return Zo=function(i,s){var l=r(i,!!s);return typeof l=="function"&&t(i,".prototype.")>-1?e([l]):l},Zo}var Jo,kc;function d0(){if(kc)return Jo;kc=1;var r=Yi()(),e=qn(),t=e("Object.prototype.toString"),n=function(u){return r&&u&&typeof u=="object"&&Symbol.toStringTag in u?!1:t(u)==="[object Arguments]"},i=function(u){return n(u)?!0:u!==null&&typeof u=="object"&&"length"in u&&typeof u.length=="number"&&u.length>=0&&t(u)!=="[object Array]"&&"callee"in u&&t(u.callee)==="[object Function]"},s=(function(){return n(arguments)})();return n.isLegacyArguments=i,Jo=s?n:i,Jo}var Xo,jc;function p0(){if(jc)return Xo;jc=1;var r=qn(),e=Yi()(),t=Kh(),n=kr(),i;if(e){var s=r("RegExp.prototype.exec"),l={},u=function(){throw l},a={toString:u,valueOf:u};typeof Symbol.toPrimitive=="symbol"&&(a[Symbol.toPrimitive]=u),i=function(p){if(!p||typeof p!="object")return!1;var h=n(p,"lastIndex"),v=h&&t(h,"value");if(!v)return!1;try{s(p,a)}catch(_){return _===l}}}else{var o=r("Object.prototype.toString"),c="[object RegExp]";i=function(p){return!p||typeof p!="object"&&typeof p!="function"?!1:o(p)===c}}return Xo=i,Xo}var Qo,Bc;function g0(){if(Bc)return Qo;Bc=1;var r=qn(),e=p0(),t=r("RegExp.prototype.exec"),n=Ln();return Qo=function(s){if(!e(s))throw new n("`regex` must be a RegExp");return function(u){return t(s,u)!==null}},Qo}var ea,$c;function m0(){if($c)return ea;$c=1;var r=qn(),e=g0(),t=e(/^\s*(?:function)?\*/),n=Yi()(),i=Il(),s=r("Object.prototype.toString"),l=r("Function.prototype.toString"),u=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},a;return ea=function(c){if(typeof c!="function")return!1;if(t(l(c)))return!0;if(!n){var d=s(c);return d==="[object GeneratorFunction]"}if(!i)return!1;if(typeof a=="undefined"){var p=u();a=p?i(p):!1}return i(c)===a},ea}var ta,Fc;function v0(){if(Fc)return ta;Fc=1;var r=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,t,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,t)}catch(R){R!==n&&(e=null)}else e=null;var i=/^\s*class\b/,s=function(y){try{var g=r.call(y);return i.test(g)}catch{return!1}},l=function(y){try{return s(y)?!1:(r.call(y),!0)}catch{return!1}},u=Object.prototype.toString,a="[object Object]",o="[object Function]",c="[object GeneratorFunction]",d="[object HTMLAllCollection]",p="[object HTML document.all class]",h="[object HTMLCollection]",v=typeof Symbol=="function"&&!!Symbol.toStringTag,_=!(0 in[,]),E=function(){return!1};if(typeof document=="object"){var w=document.all;u.call(w)===u.call(document.all)&&(E=function(y){if((_||!y)&&(typeof y=="undefined"||typeof y=="object"))try{var g=u.call(y);return(g===d||g===p||g===h||g===a)&&y("")==null}catch{}return!1})}return ta=e?function(y){if(E(y))return!0;if(!y||typeof y!="function"&&typeof y!="object")return!1;try{e(y,null,t)}catch(g){if(g!==n)return!1}return!s(y)&&l(y)}:function(y){if(E(y))return!0;if(!y||typeof y!="function"&&typeof y!="object")return!1;if(v)return l(y);if(s(y))return!1;var g=u.call(y);return g!==o&&g!==c&&!/^\[object HTML/.test(g)?!1:l(y)},ta}var ra,Uc;function y0(){if(Uc)return ra;Uc=1;var r=v0(),e=Object.prototype.toString,t=Object.prototype.hasOwnProperty,n=function(a,o,c){for(var d=0,p=a.length;d<p;d++)t.call(a,d)&&(c==null?o(a[d],d,a):o.call(c,a[d],d,a))},i=function(a,o,c){for(var d=0,p=a.length;d<p;d++)c==null?o(a.charAt(d),d,a):o.call(c,a.charAt(d),d,a)},s=function(a,o,c){for(var d in a)t.call(a,d)&&(c==null?o(a[d],d,a):o.call(c,a[d],d,a))};function l(u){return e.call(u)==="[object Array]"}return ra=function(a,o,c){if(!r(o))throw new TypeError("iterator must be a function");var d;arguments.length>=3&&(d=c),l(a)?n(a,o,d):typeof a=="string"?i(a,o,d):s(a,o,d)},ra}var na,Hc;function b0(){return Hc||(Hc=1,na=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),na}var ia,Vc;function _0(){if(Vc)return ia;Vc=1;var r=b0(),e=typeof globalThis=="undefined"?window:globalThis;return ia=function(){for(var n=[],i=0;i<r.length;i++)typeof e[r[i]]=="function"&&(n[n.length]=r[i]);return n},ia}var sa={exports:{}},oa,Gc;function E0(){if(Gc)return oa;Gc=1;var r=Zi(),e=Vh(),t=Ln(),n=kr();return oa=function(s,l,u){if(!s||typeof s!="object"&&typeof s!="function")throw new t("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new t("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new t("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new t("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new t("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new t("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,p=!!n&&n(s,l);if(r)r(s,l,{configurable:c===null&&p?p.configurable:!c,enumerable:a===null&&p?p.enumerable:!a,value:u,writable:o===null&&p?p.writable:!o});else if(d||!a&&!o&&!c)s[l]=u;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},oa}var aa,zc;function A0(){if(zc)return aa;zc=1;var r=Zi(),e=function(){return!!r};return e.hasArrayLengthDefineBug=function(){if(!r)return null;try{return r([],"length",{value:1}).length!==1}catch{return!0}},aa=e,aa}var la,Wc;function O0(){if(Wc)return la;Wc=1;var r=Yh(),e=E0(),t=A0()(),n=kr(),i=Ln(),s=r("%Math.floor%");return la=function(u,a){if(typeof u!="function")throw new i("`fn` is not a function");if(typeof a!="number"||a<0||a>4294967295||s(a)!==a)throw new i("`length` must be a positive 32-bit integer");var o=arguments.length>2&&!!arguments[2],c=!0,d=!0;if("length"in u&&n){var p=n(u,"length");p&&!p.configurable&&(c=!1),p&&!p.writable&&(d=!1)}return(c||d||!o)&&(t?e(u,"length",a,!0,!0):e(u,"length",a)),u},la}var ua,Kc;function S0(){if(Kc)return ua;Kc=1;var r=In(),e=Nl(),t=Wh();return ua=function(){return t(r,e,arguments)},ua}var Yc;function w0(){return Yc||(Yc=1,(function(r){var e=O0(),t=Zi(),n=Ll(),i=S0();r.exports=function(l){var u=n(arguments),a=l.length-(arguments.length-1);return e(u,1+(a>0?a:0),!0)},t?t(r.exports,"apply",{value:i}):r.exports.apply=i})(sa)),sa.exports}var ca,Zc;function Zh(){if(Zc)return ca;Zc=1;var r=y0(),e=_0(),t=w0(),n=qn(),i=kr(),s=Il(),l=n("Object.prototype.toString"),u=Yi()(),a=typeof globalThis=="undefined"?window:globalThis,o=e(),c=n("String.prototype.slice"),d=n("Array.prototype.indexOf",!0)||function(E,w){for(var R=0;R<E.length;R+=1)if(E[R]===w)return R;return-1},p={__proto__:null};u&&i&&s?r(o,function(_){var E=new a[_];if(Symbol.toStringTag in E&&s){var w=s(E),R=i(w,Symbol.toStringTag);if(!R&&w){var y=s(w);R=i(y,Symbol.toStringTag)}p["$"+_]=t(R.get)}}):r(o,function(_){var E=new a[_],w=E.slice||E.set;w&&(p["$"+_]=t(w))});var h=function(E){var w=!1;return r(p,function(R,y){if(!w)try{"$"+R(E)===y&&(w=c(y,1))}catch{}}),w},v=function(E){var w=!1;return r(p,function(R,y){if(!w)try{R(E),w=c(y,1)}catch{}}),w};return ca=function(E){if(!E||typeof E!="object")return!1;if(!u){var w=c(l(E),8,-1);return d(o,w)>-1?w:w!=="Object"?!1:v(E)}return i?h(E):null},ca}var fa,Jc;function R0(){if(Jc)return fa;Jc=1;var r=Zh();return fa=function(t){return!!r(t)},fa}var Xc;function T0(){return Xc||(Xc=1,(function(r){var e=d0(),t=m0(),n=Zh(),i=R0();function s($){return $.call.bind($)}var l=typeof BigInt!="undefined",u=typeof Symbol!="undefined",a=s(Object.prototype.toString),o=s(Number.prototype.valueOf),c=s(String.prototype.valueOf),d=s(Boolean.prototype.valueOf);if(l)var p=s(BigInt.prototype.valueOf);if(u)var h=s(Symbol.prototype.valueOf);function v($,qe){if(typeof $!="object")return!1;try{return qe($),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=i;function _($){return typeof Promise!="undefined"&&$ instanceof Promise||$!==null&&typeof $=="object"&&typeof $.then=="function"&&typeof $.catch=="function"}r.isPromise=_;function E($){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView($):i($)||N($)}r.isArrayBufferView=E;function w($){return n($)==="Uint8Array"}r.isUint8Array=w;function R($){return n($)==="Uint8ClampedArray"}r.isUint8ClampedArray=R;function y($){return n($)==="Uint16Array"}r.isUint16Array=y;function g($){return n($)==="Uint32Array"}r.isUint32Array=g;function m($){return n($)==="Int8Array"}r.isInt8Array=m;function A($){return n($)==="Int16Array"}r.isInt16Array=A;function S($){return n($)==="Int32Array"}r.isInt32Array=S;function I($){return n($)==="Float32Array"}r.isFloat32Array=I;function C($){return n($)==="Float64Array"}r.isFloat64Array=C;function D($){return n($)==="BigInt64Array"}r.isBigInt64Array=D;function O($){return n($)==="BigUint64Array"}r.isBigUint64Array=O;function x($){return a($)==="[object Map]"}x.working=typeof Map!="undefined"&&x(new Map);function L($){return typeof Map=="undefined"?!1:x.working?x($):$ instanceof Map}r.isMap=L;function j($){return a($)==="[object Set]"}j.working=typeof Set!="undefined"&&j(new Set);function H($){return typeof Set=="undefined"?!1:j.working?j($):$ instanceof Set}r.isSet=H;function M($){return a($)==="[object WeakMap]"}M.working=typeof WeakMap!="undefined"&&M(new WeakMap);function U($){return typeof WeakMap=="undefined"?!1:M.working?M($):$ instanceof WeakMap}r.isWeakMap=U;function V($){return a($)==="[object WeakSet]"}V.working=typeof WeakSet!="undefined"&&V(new WeakSet);function z($){return V($)}r.isWeakSet=z;function F($){return a($)==="[object ArrayBuffer]"}F.working=typeof ArrayBuffer!="undefined"&&F(new ArrayBuffer);function X($){return typeof ArrayBuffer=="undefined"?!1:F.working?F($):$ instanceof ArrayBuffer}r.isArrayBuffer=X;function Y($){return a($)==="[object DataView]"}Y.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&Y(new DataView(new ArrayBuffer(1),0,1));function N($){return typeof DataView=="undefined"?!1:Y.working?Y($):$ instanceof DataView}r.isDataView=N;var q=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function P($){return a($)==="[object SharedArrayBuffer]"}function W($){return typeof q=="undefined"?!1:(typeof P.working=="undefined"&&(P.working=P(new q)),P.working?P($):$ instanceof q)}r.isSharedArrayBuffer=W;function ee($){return a($)==="[object AsyncFunction]"}r.isAsyncFunction=ee;function J($){return a($)==="[object Map Iterator]"}r.isMapIterator=J;function K($){return a($)==="[object Set Iterator]"}r.isSetIterator=K;function G($){return a($)==="[object Generator]"}r.isGeneratorObject=G;function Z($){return a($)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=Z;function te($){return v($,o)}r.isNumberObject=te;function oe($){return v($,c)}r.isStringObject=oe;function ce($){return v($,d)}r.isBooleanObject=ce;function de($){return l&&v($,p)}r.isBigIntObject=de;function me($){return u&&v($,h)}r.isSymbolObject=me;function Ve($){return te($)||oe($)||ce($)||de($)||me($)}r.isBoxedPrimitive=Ve;function pt($){return typeof Uint8Array!="undefined"&&(X($)||W($))}r.isAnyArrayBuffer=pt,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function($){Object.defineProperty(r,$,{enumerable:!1,value:function(){throw new Error($+" is not supported in userland")}})})})(po)),po}var ha,Qc;function N0(){return Qc||(Qc=1,ha=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),ha}var ci={exports:{}},ef;function Jh(){return ef||(ef=1,typeof Object.create=="function"?ci.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ci.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),ci.exports}var tf;function L0(){return tf||(tf=1,(function(r){var e={},t=Object.getOwnPropertyDescriptors||function(q){for(var P=Object.keys(q),W={},ee=0;ee<P.length;ee++)W[P[ee]]=Object.getOwnPropertyDescriptor(q,P[ee]);return W},n=/%[sdj%]/g;r.format=function(N){if(!A(N)){for(var q=[],P=0;P<arguments.length;P++)q.push(u(arguments[P]));return q.join(" ")}for(var P=1,W=arguments,ee=W.length,J=String(N).replace(n,function(G){if(G==="%%")return"%";if(P>=ee)return G;switch(G){case"%s":return String(W[P++]);case"%d":return Number(W[P++]);case"%j":try{return JSON.stringify(W[P++])}catch{return"[Circular]"}default:return G}}),K=W[P];P<ee;K=W[++P])y(K)||!D(K)?J+=" "+K:J+=" "+u(K);return J},r.deprecate=function(N,q){if(typeof process!="undefined"&&process.noDeprecation===!0)return N;if(typeof process=="undefined")return function(){return r.deprecate(N,q).apply(this,arguments)};var P=!1;function W(){if(!P){if(process.throwDeprecation)throw new Error(q);process.traceDeprecation?console.trace(q):console.error(q),P=!0}return N.apply(this,arguments)}return W};var i={},s=/^$/;if(e.NODE_DEBUG){var l=e.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+l+"$","i")}r.debuglog=function(N){if(N=N.toUpperCase(),!i[N])if(s.test(N)){var q=process.pid;i[N]=function(){var P=r.format.apply(r,arguments);console.error("%s %d: %s",N,q,P)}}else i[N]=function(){};return i[N]};function u(N,q){var P={seen:[],stylize:o};return arguments.length>=3&&(P.depth=arguments[2]),arguments.length>=4&&(P.colors=arguments[3]),R(q)?P.showHidden=q:q&&r._extend(P,q),I(P.showHidden)&&(P.showHidden=!1),I(P.depth)&&(P.depth=2),I(P.colors)&&(P.colors=!1),I(P.customInspect)&&(P.customInspect=!0),P.colors&&(P.stylize=a),d(P,N,P.depth)}r.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function a(N,q){var P=u.styles[q];return P?"\x1B["+u.colors[P][0]+"m"+N+"\x1B["+u.colors[P][1]+"m":N}function o(N,q){return N}function c(N){var q={};return N.forEach(function(P,W){q[P]=!0}),q}function d(N,q,P){if(N.customInspect&&q&&L(q.inspect)&&q.inspect!==r.inspect&&!(q.constructor&&q.constructor.prototype===q)){var W=q.inspect(P,N);return A(W)||(W=d(N,W,P)),W}var ee=p(N,q);if(ee)return ee;var J=Object.keys(q),K=c(J);if(N.showHidden&&(J=Object.getOwnPropertyNames(q)),x(q)&&(J.indexOf("message")>=0||J.indexOf("description")>=0))return h(q);if(J.length===0){if(L(q)){var G=q.name?": "+q.name:"";return N.stylize("[Function"+G+"]","special")}if(C(q))return N.stylize(RegExp.prototype.toString.call(q),"regexp");if(O(q))return N.stylize(Date.prototype.toString.call(q),"date");if(x(q))return h(q)}var Z="",te=!1,oe=["{","}"];if(w(q)&&(te=!0,oe=["[","]"]),L(q)){var ce=q.name?": "+q.name:"";Z=" [Function"+ce+"]"}if(C(q)&&(Z=" "+RegExp.prototype.toString.call(q)),O(q)&&(Z=" "+Date.prototype.toUTCString.call(q)),x(q)&&(Z=" "+h(q)),J.length===0&&(!te||q.length==0))return oe[0]+Z+oe[1];if(P<0)return C(q)?N.stylize(RegExp.prototype.toString.call(q),"regexp"):N.stylize("[Object]","special");N.seen.push(q);var de;return te?de=v(N,q,P,K,J):de=J.map(function(me){return _(N,q,P,K,me,te)}),N.seen.pop(),E(de,Z,oe)}function p(N,q){if(I(q))return N.stylize("undefined","undefined");if(A(q)){var P="'"+JSON.stringify(q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return N.stylize(P,"string")}if(m(q))return N.stylize(""+q,"number");if(R(q))return N.stylize(""+q,"boolean");if(y(q))return N.stylize("null","null")}function h(N){return"["+Error.prototype.toString.call(N)+"]"}function v(N,q,P,W,ee){for(var J=[],K=0,G=q.length;K<G;++K)z(q,String(K))?J.push(_(N,q,P,W,String(K),!0)):J.push("");return ee.forEach(function(Z){Z.match(/^\d+$/)||J.push(_(N,q,P,W,Z,!0))}),J}function _(N,q,P,W,ee,J){var K,G,Z;if(Z=Object.getOwnPropertyDescriptor(q,ee)||{value:q[ee]},Z.get?Z.set?G=N.stylize("[Getter/Setter]","special"):G=N.stylize("[Getter]","special"):Z.set&&(G=N.stylize("[Setter]","special")),z(W,ee)||(K="["+ee+"]"),G||(N.seen.indexOf(Z.value)<0?(y(P)?G=d(N,Z.value,null):G=d(N,Z.value,P-1),G.indexOf(`
`)>-1&&(J?G=G.split(`
`).map(function(te){return"  "+te}).join(`
`).slice(2):G=`
`+G.split(`
`).map(function(te){return"   "+te}).join(`
`))):G=N.stylize("[Circular]","special")),I(K)){if(J&&ee.match(/^\d+$/))return G;K=JSON.stringify(""+ee),K.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(K=K.slice(1,-1),K=N.stylize(K,"name")):(K=K.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),K=N.stylize(K,"string"))}return K+": "+G}function E(N,q,P){var W=N.reduce(function(ee,J){return J.indexOf(`
`)>=0,ee+J.replace(/\u001b\[\d\d?m/g,"").length+1},0);return W>60?P[0]+(q===""?"":q+`
 `)+" "+N.join(`,
  `)+" "+P[1]:P[0]+q+" "+N.join(", ")+" "+P[1]}r.types=T0();function w(N){return Array.isArray(N)}r.isArray=w;function R(N){return typeof N=="boolean"}r.isBoolean=R;function y(N){return N===null}r.isNull=y;function g(N){return N==null}r.isNullOrUndefined=g;function m(N){return typeof N=="number"}r.isNumber=m;function A(N){return typeof N=="string"}r.isString=A;function S(N){return typeof N=="symbol"}r.isSymbol=S;function I(N){return N===void 0}r.isUndefined=I;function C(N){return D(N)&&H(N)==="[object RegExp]"}r.isRegExp=C,r.types.isRegExp=C;function D(N){return typeof N=="object"&&N!==null}r.isObject=D;function O(N){return D(N)&&H(N)==="[object Date]"}r.isDate=O,r.types.isDate=O;function x(N){return D(N)&&(H(N)==="[object Error]"||N instanceof Error)}r.isError=x,r.types.isNativeError=x;function L(N){return typeof N=="function"}r.isFunction=L;function j(N){return N===null||typeof N=="boolean"||typeof N=="number"||typeof N=="string"||typeof N=="symbol"||typeof N=="undefined"}r.isPrimitive=j,r.isBuffer=N0();function H(N){return Object.prototype.toString.call(N)}function M(N){return N<10?"0"+N.toString(10):N.toString(10)}var U=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function V(){var N=new Date,q=[M(N.getHours()),M(N.getMinutes()),M(N.getSeconds())].join(":");return[N.getDate(),U[N.getMonth()],q].join(" ")}r.log=function(){console.log("%s - %s",V(),r.format.apply(r,arguments))},r.inherits=Jh(),r._extend=function(N,q){if(!q||!D(q))return N;for(var P=Object.keys(q),W=P.length;W--;)N[P[W]]=q[P[W]];return N};function z(N,q){return Object.prototype.hasOwnProperty.call(N,q)}var F=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;r.promisify=function(q){if(typeof q!="function")throw new TypeError('The "original" argument must be of type Function');if(F&&q[F]){var P=q[F];if(typeof P!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(P,F,{value:P,enumerable:!1,writable:!1,configurable:!0}),P}function P(){for(var W,ee,J=new Promise(function(Z,te){W=Z,ee=te}),K=[],G=0;G<arguments.length;G++)K.push(arguments[G]);K.push(function(Z,te){Z?ee(Z):W(te)});try{q.apply(this,K)}catch(Z){ee(Z)}return J}return Object.setPrototypeOf(P,Object.getPrototypeOf(q)),F&&Object.defineProperty(P,F,{value:P,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(P,t(q))},r.promisify.custom=F;function X(N,q){if(!N){var P=new Error("Promise was rejected with a falsy value");P.reason=N,N=P}return q(N)}function Y(N){if(typeof N!="function")throw new TypeError('The "original" argument must be of type Function');function q(){for(var P=[],W=0;W<arguments.length;W++)P.push(arguments[W]);var ee=P.pop();if(typeof ee!="function")throw new TypeError("The last argument must be of type Function");var J=this,K=function(){return ee.apply(J,arguments)};N.apply(this,P).then(function(G){process.nextTick(K.bind(null,null,G))},function(G){process.nextTick(X.bind(null,G,K))})}return Object.setPrototypeOf(q,Object.getPrototypeOf(N)),Object.defineProperties(q,t(N)),q}r.callbackify=Y})(ho)),ho}var rf;function nt(){return rf||(rf=1,(function(r){var e=Kb();r.doNothing=t;function t(){}r.hasKeys=function(l){for(var u in l)return!0;return!1};var n;r.hasOwn=n=Object.hasOwn||function(l,u){return Object.prototype.hasOwnProperty.call(l,u)},r.isInteger=Number.isInteger||function(l){return typeof l=="number"&&isFinite(l)&&Math.floor(l)===l},r.isValidVersion=function(l){return l===null?!0:r.isInteger(l)&&l>=0},r.isValidTimestamp=function(l){return r.isValidVersion(l)},r.MAX_SAFE_INTEGER=9007199254740991,r.dig=function(){for(var l=arguments[0],u=1;u<arguments.length;u++){var a=arguments[u];l=n(l,a)?l[a]:u===arguments.length-1?void 0:Object.create(null)}return l},r.digOrCreate=function(){for(var l=arguments[0],u=arguments[arguments.length-1],a=1;a<arguments.length-1;a++){var o=arguments[a];l=n(l,o)?l[o]:l[o]=a===arguments.length-2?u():Object.create(null)}return l},r.digAndRemove=function(){for(var l=arguments[0],u=[l],a=1;a<arguments.length-1;a++){var o=arguments[a];if(!n(l,o))break;l=l[o],u.push(l)}for(var a=u.length-1;a>=0;a--){var c=u[a],o=arguments[a+1],d=c[o];(a===u.length-1||!r.hasKeys(d))&&delete c[o]}},r.supportsPresence=function(l){return l&&typeof l.transformPresence=="function"},r.callEach=function(l,u){var a=!1;return l.forEach(function(o){o&&(o(u),a=!0)}),a},r.truthy=function(l){return!!l},typeof process!="undefined"&&typeof process.nextTick=="function"?r.nextTick=process.nextTick:typeof MessageChannel!="undefined"?r.nextTick=e.messageChannel:r.nextTick=e.setTimeout,r.clone=function(l){return l===void 0?void 0:JSON.parse(JSON.stringify(l))};var i=Object.create(null);Object.getOwnPropertyNames(Object.prototype).forEach(function(l){l!=="__proto__"&&(i[l]=!0)}),r.isDangerousProperty=function(l){return l==="__proto__"||i[l]};try{var s=L0();if(typeof s.inherits!="function")throw new Error("Could not find util.inherits()");r.inherits=s.inherits}catch{try{r.inherits=Jh()}catch{throw new Error('If running sharedb in a browser, please install the "inherits" or "util" package')}}})(fo)),fo}var da,nf;function I0(){return nf||(nf=1,da=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,i,s;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!r(e[i],t[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[i]))return!1;for(i=n;i--!==0;){var l=s[i];if(!r(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}),da}var pa={},sf;function ir(){return sf||(sf=1,pa.ACTIONS={initLegacy:"init",handshake:"hs",queryFetch:"qf",querySubscribe:"qs",queryUnsubscribe:"qu",queryUpdate:"q",bulkFetch:"bf",bulkSubscribe:"bs",bulkUnsubscribe:"bu",fetch:"f",fixup:"fixup",subscribe:"s",unsubscribe:"u",op:"op",snapshotFetch:"nf",snapshotFetchByTimestamp:"nt",pingPong:"pp",presence:"p",presenceSubscribe:"ps",presenceUnsubscribe:"pu",presenceRequest:"pr"}),pa}var ga,of;function Xh(){if(of)return ga;of=1;var r=Mr(),e=Rl(),t=Nn(),n=Ki(),i=nt(),s=i.clone,l=I0(),u=ir().ACTIONS,a=t.CODES;ga=o;function o(h,v,_){r.EventEmitter.call(this),this.connection=h,this.collection=v,this.id=_,this.version=null,this.type=null,this.data=void 0,this.inflightFetch=[],this.inflightSubscribe=null,this.pendingFetch=[],this.pendingSubscribe=[],this._isInHardRollback=!1,this.subscribed=!1,this.wantSubscribe=!1,this._wantsDestroy=!1,this.inflightOp=null,this.pendingOps=[],this.applyStack=null,this.preventCompose=!1,this.submitSource=!1,this.paused=!1,this._dataStateVersion=0}r.mixin(o),o.prototype.destroy=function(h){this._wantsDestroy=!0;var v=this;v.whenNothingPending(function(){v.wantSubscribe?v.unsubscribe(function(_){if(_)return h?h(_):v.emit("error",_);v.connection._destroyDoc(v),h&&h()}):(v.connection._destroyDoc(v),h&&h())})},o.prototype._setType=function(h){if(typeof h=="string"&&(h=n.map[h]),h)this.type=h;else if(h===null)this.type=h,this._setData(void 0);else{var v=new t(a.ERR_DOC_TYPE_NOT_RECOGNIZED,"Missing type "+h);return this.emit("error",v)}},o.prototype._setData=function(h){this.data=h,this._dataStateVersion++},o.prototype.ingestSnapshot=function(h,v){if(!h)return v&&v();if(typeof h.v!="number"){var _=new t(a.ERR_INGESTED_SNAPSHOT_HAS_NO_VERSION,"Missing version in ingested snapshot. "+this.collection+"."+this.id);return v?v(_):this.emit("error",_)}if(this.type||this.hasWritePending()){if(this.version==null){if(this.hasWritePending())return v&&this.once("no write pending",v);var _=new t(a.ERR_DOC_MISSING_VERSION,"Cannot ingest snapshot in doc with null version. "+this.collection+"."+this.id);return v?v(_):this.emit("error",_)}return h.v>this.version?this.fetch(v):v&&v()}if(this.version>h.v)return v&&v();this.version=h.v;var E=h.type===void 0?n.defaultType:h.type;this._setType(E),this._setData(this.type&&this.type.deserialize?this.type.deserialize(h.data):h.data),this.emit("load"),v&&v()},o.prototype.whenNothingPending=function(h){var v=this;i.nextTick(function(){if(v.hasPending()){v.once("nothing pending",h);return}h()})},o.prototype.hasPending=function(){return!!(this.inflightOp||this.pendingOps.length||this.inflightFetch.length||this.inflightSubscribe||this.pendingFetch.length||this.pendingSubscribe.length)},o.prototype.hasWritePending=function(){return!!(this.inflightOp||this.pendingOps.length)},o.prototype._emitNothingPending=function(){this.hasWritePending()||(this.emit("no write pending"),!this.hasPending()&&this.emit("nothing pending"))},o.prototype._emitResponseError=function(h,v){if(h&&h.code===a.ERR_SNAPSHOT_READ_SILENT_REJECTION){this.wantSubscribe=!1,v&&v(),this._emitNothingPending();return}if(v){v(h),this._emitNothingPending();return}this._emitNothingPending(),this.emit("error",h)},o.prototype._handleFetch=function(h,v){var _=this.pendingFetch;this.pendingFetch=[];var E=this.inflightFetch.shift();if(E&&_.unshift(E),_.length&&(E=function(w){i.callEach(_,w)}),h)return this._emitResponseError(h,E);this.ingestSnapshot(v,E),this._emitNothingPending()},o.prototype._handleSubscribe=function(h,v){var _=this.inflightSubscribe;this.inflightSubscribe=null;var E=this.pendingFetch;this.pendingFetch=[],_.callback&&E.push(_.callback);var w;if(E.length&&(w=function(R){i.callEach(E,R)}),h)return this._emitResponseError(h,w);this.subscribed=_.wantSubscribe,this.subscribed?this.ingestSnapshot(v,w):w&&w(),this._emitNothingPending(),this._flushSubscribe()},o.prototype._handleOp=function(h,v){if(h)return h.code===a.ERR_NO_OP&&v.seq===this.inflightOp.seq?this.fetch(this._clearInflightOp.bind(this)):this.inflightOp?this._rollback(h):this.emit("error",h);if(this.inflightOp&&v.src===this.inflightOp.src&&v.seq===this.inflightOp.seq){this._opAcknowledged(v);return}if(this.version==null||v.v>this.version){this.fetch();return}if(!(v.v<this.version)){if(this.inflightOp){var _=p(this.inflightOp,v);if(_)return this._hardRollback(_)}for(var E=0;E<this.pendingOps.length;E++){var _=p(this.pendingOps[E],v);if(_)return this._hardRollback(_)}this.version++;try{this._otApply(v,!1)}catch(w){return this._hardRollback(w)}}},o.prototype._onConnectionStateChanged=function(){this.connection.canSend?(this.flush(),this._resubscribe()):(this.inflightOp&&(this.pendingOps.unshift(this.inflightOp),this.inflightOp=null),this.subscribed=!1,this.inflightSubscribe&&(this.inflightSubscribe.wantSubscribe?(this.pendingSubscribe.unshift(this.inflightSubscribe),this.inflightSubscribe=null):this._handleSubscribe()),this.inflightFetch.length&&(this.pendingFetch=this.pendingFetch.concat(this.inflightFetch),this.inflightFetch.length=0))},o.prototype._resubscribe=function(){if(!this.pendingSubscribe.length&&this.wantSubscribe)return this.subscribe();var h=this.pendingSubscribe.some(function(v){return v.wantSubscribe});!h&&this.pendingFetch.length&&this.fetch(),this._flushSubscribe()},o.prototype.fetch=function(h){this._fetch({},h)},o.prototype._fetch=function(h,v){this.pendingFetch.push(v);var _=this.connection.canSend&&(h.force||!this.inflightFetch.length);_&&(this.inflightFetch.push(this.pendingFetch.shift()),this.connection.sendFetch(this))},o.prototype.subscribe=function(h){var v=!0;this._queueSubscribe(v,h)},o.prototype.unsubscribe=function(h){var v=!1;this._queueSubscribe(v,h)},o.prototype._queueSubscribe=function(h,v){var _=this.pendingSubscribe[this.pendingSubscribe.length-1]||this.inflightSubscribe,E=_&&_.wantSubscribe===h;if(E){_.callback=c([_.callback,v]);return}this.pendingSubscribe.push({wantSubscribe:!!h,callback:v}),this._flushSubscribe()},o.prototype._flushSubscribe=function(){if(!(this.inflightSubscribe||!this.pendingSubscribe.length)){if(this.connection.canSend){this.inflightSubscribe=this.pendingSubscribe.shift(),this.wantSubscribe=this.inflightSubscribe.wantSubscribe,this.wantSubscribe?this.connection.sendSubscribe(this):(this.subscribed=!1,this.connection.sendUnsubscribe(this));return}if(!this.pendingSubscribe[0].wantSubscribe){this.inflightSubscribe=this.pendingSubscribe.shift();var h=this;i.nextTick(function(){h._handleSubscribe()})}}};function c(h){return h=h.filter(i.truthy),h.length?function(v){i.callEach(h,v)}:null}o.prototype.flush=function(){!this.connection.canSend||this.inflightOp||!this.paused&&this.pendingOps.length&&this._sendOp()};function d(h){delete h.op,delete h.create,delete h.del}function p(h,v){if(h.del)return d(v);if(v.del)return new t(a.ERR_DOC_WAS_DELETED,"Document was deleted");if(v.create)return new t(a.ERR_DOC_ALREADY_CREATED,"Document already created");if("op"in v){if(h.create)return new t(a.ERR_DOC_ALREADY_CREATED,"Document already created");if(h.type.transformX){var _=h.type.transformX(h.op,v.op);h.op=_[0],v.op=_[1]}else{var E=h.type.transform(h.op,v.op,"left"),w=h.type.transform(v.op,h.op,"right");h.op=E,v.op=w}}}return o.prototype._otApply=function(h,v){if("op"in h){if(!this.type)throw new t(a.ERR_DOC_DOES_NOT_EXIST,"Cannot apply op to uncreated document. "+this.collection+"."+this.id);if(this.emit("before op batch",h.op,v),!v&&this.type===n.defaultType&&h.op.length>1){this.applyStack||(this.applyStack=[]);for(var _=this.applyStack.length,E=0;E<h.op.length;E++){var w=h.op[E],R={op:[w]};this.emit("before op",R.op,v,h.src);for(var y=_;y<this.applyStack.length;y++){var g=p(this.applyStack[y],R);if(g)return this._hardRollback(g)}this._setData(this.type.apply(this.data,R.op)),this.emit("op",R.op,v,h.src)}this.emit("op batch",h.op,v),this._popApplyStack(_);return}this.emit("before op",h.op,v,h.src),this._setData(this.type.apply(this.data,h.op)),this.emit("op",h.op,v,h.src),this.emit("op batch",h.op,v);return}if(h.create){this._setType(h.create.type),this.type.deserialize?this.type.createDeserialized?this._setData(this.type.createDeserialized(h.create.data)):this._setData(this.type.deserialize(this.type.create(h.create.data))):this._setData(this.type.create(h.create.data)),this.emit("create",v);return}if(h.del){var m=this.data;this._setType(null),this.emit("del",m,v);return}},o.prototype._sendOp=function(){if(this.connection.canSend){var h=this.connection.id;this.inflightOp||(this.inflightOp=this.pendingOps.shift());var v=this.inflightOp;if(!v){var _=new t(a.ERR_INFLIGHT_OP_MISSING,"No op to send on call to _sendOp");return this.emit("error",_)}if(v.sentAt=Date.now(),v.retries=v.retries==null?0:v.retries+1,v.seq==null){if(this.connection.seq>=i.MAX_SAFE_INTEGER)return this.emit("error",new t(a.ERR_CONNECTION_SEQ_INTEGER_OVERFLOW,"Connection seq has exceeded the max safe integer, maybe from being open for too long"));v.seq=this.connection.seq++}this.connection.sendOp(this,v),v.src==null&&(v.src=h)}},o.prototype._submit=function(h,v,_){if(v||(v=!0),"op"in h){if(!this.type){if(this._isInHardRollback)var E=new t(a.ERR_DOC_IN_HARD_ROLLBACK,"Cannot submit op. Document is performing hard rollback. "+this.collection+"."+this.id);else var E=new t(a.ERR_DOC_DOES_NOT_EXIST,"Cannot submit op. Document has not been created. "+this.collection+"."+this.id);return _?_(E):this.emit("error",E)}this.type.normalize&&(h.op=this.type.normalize(h.op))}try{this._pushOp(h,v,_),this._otApply(h,v)}catch(R){return this._hardRollback(R)}var w=this;i.nextTick(function(){w.flush()})},o.prototype._pushOp=function(h,v,_){if(h.source=v,this.applyStack)this.applyStack.push(h);else{var E=this._tryCompose(h);if(E){E.callbacks.push(_);return}}h.type=this.type,h.callbacks=[_],this.pendingOps.push(h)},o.prototype._popApplyStack=function(h){if(h>0){this.applyStack.length=h;return}var v=this.applyStack[0];if(this.applyStack=null,!!v){var _=this.pendingOps.indexOf(v);if(_!==-1)for(var E=this.pendingOps.splice(_),_=0;_<E.length;_++){var v=E[_],w=this._tryCompose(v);w?w.callbacks=w.callbacks.concat(v.callbacks):this.pendingOps.push(v)}}},o.prototype._tryCompose=function(h){if(!this.preventCompose){var v=this.pendingOps[this.pendingOps.length-1];if(!(!v||v.sentAt)&&!(this.submitSource&&!l(h.source,v.source))){if(v.create&&"op"in h)return v.create.data=this.type.apply(v.create.data,h.op),v;if("op"in v&&"op"in h&&this.type.compose)return v.op=this.type.compose(v.op,h.op),v}}},o.prototype.submitOp=function(h,v,_){typeof v=="function"&&(_=v,v=null);var E={op:h},w=v&&v.source;this._submit(E,w,_)},o.prototype.create=function(h,v,_,E){if(typeof v=="function"?(E=v,_=null,v=null):typeof _=="function"&&(E=_,_=null),v||(v=n.defaultType.uri),this.type){var w=new t(a.ERR_DOC_ALREADY_CREATED,"Document already exists");return E?E(w):this.emit("error",w)}var R={create:{type:v,data:h}},y=_&&_.source;this._submit(R,y,E)},o.prototype.del=function(h,v){if(typeof h=="function"&&(v=h,h=null),!this.type){var _=new t(a.ERR_DOC_DOES_NOT_EXIST,"Document does not exist");return v?v(_):this.emit("error",_)}var E={del:!0},w=h&&h.source;this._submit(E,w,v)},o.prototype.pause=function(){this.paused=!0},o.prototype.resume=function(){this.paused=!1,this.flush()},o.prototype.toSnapshot=function(){return{v:this.version,data:s(this.data),type:this.type.uri}},o.prototype._opAcknowledged=function(h){if(this.inflightOp.create)this.version=h.v;else if(h.v!==this.version)return e.warn("Invalid version from server. Expected: "+this.version+" Received: "+h.v,h),this.fetch();if(h[u.fixup])for(var v=0;v<h[u.fixup].length;v++){for(var _=h[u.fixup][v],E=0;E<this.pendingOps.length;E++){var w=p(this.pendingOps[v],_);if(w)return this._hardRollback(w)}try{this._otApply(_,!1)}catch(R){return this._hardRollback(R)}}this.version++,this._clearInflightOp()},o.prototype._rollback=function(h){var v=this.inflightOp;if(!("op"in v&&v.type.invert))return this._hardRollback(h);try{v.op=v.type.invert(v.op)}catch{return this._hardRollback(h)}for(var _=0;_<this.pendingOps.length;_++){var E=p(this.pendingOps[_],v);if(E)return this._hardRollback(E)}try{this._otApply(v,!1)}catch(w){return this._hardRollback(w)}if(h.code===a.ERR_OP_SUBMIT_REJECTED)return this._clearInflightOp(null);this._clearInflightOp(h)},o.prototype._hardRollback=function(h){this._isInHardRollback=!0;var v=this.pendingOps,_=this.inflightOp;this._setType(null),this.version=null,this.inflightOp=null,this.pendingOps=[];var E=this;this._fetch({force:!0},function(w){if(E._isInHardRollback=!1,w&&(e.error("Hard rollback doc fetch failed.",w,_),E.emit("error",new t(a.ERR_HARD_ROLLBACK_FETCH_FAILED,"Hard rollback fetch failed: "+w.message))),h.code===a.ERR_OP_SUBMIT_REJECTED){if(_&&(i.callEach(_.callbacks),_=null),!v.length)return;h=new t(a.ERR_PENDING_OP_REMOVED_BY_OP_SUBMIT_REJECTED,"Discarding pending op because of hard rollback during ERR_OP_SUBMIT_REJECTED")}_&&v.unshift(_);for(var R=!!v.length,y=0;y<v.length;y++)R=i.callEach(v[y].callbacks,h)&&R;h&&!R&&E.emit("error",h)})},o.prototype._clearInflightOp=function(h){var v=this.inflightOp;this.inflightOp=null;var _=i.callEach(v.callbacks,h);if(this.flush(),this._emitNothingPending(),h&&!_)return this.emit("error",h)},ga}var ma,af;function Qh(){if(af)return ma;af=1;var r=Mr(),e=ir().ACTIONS,t=nt();ma=n;function n(i,s,l,u,a,o,c){r.EventEmitter.call(this),this.action=i,this.connection=s,this.id=l,this.collection=u,this.query=a,this.results=null,o&&o.results&&(this.results=o.results,delete o.results),this.extra=void 0,this.options=o,this.callback=c,this.ready=!1,this.sent=!1}return r.mixin(n),n.prototype.hasPending=function(){return!this.ready},n.prototype.send=function(){if(this.connection.canSend){var i={a:this.action,id:this.id,c:this.collection,q:this.query};if(this.options&&(i.o=this.options),this.results){for(var s=[],l=0;l<this.results.length;l++){var u=this.results[l];s.push([u.id,u.version])}i.r=s}this.connection.send(i),this.sent=!0}},n.prototype.destroy=function(i){this.connection.canSend&&this.action===e.querySubscribe&&this.connection.send({a:e.queryUnsubscribe,id:this.id}),this.connection._destroyQuery(this),i&&t.nextTick(i)},n.prototype._onConnectionStateChanged=function(){this.connection.canSend&&!this.sent?this.send():this.sent=!1},n.prototype._handleFetch=function(i,s,l){this.connection._destroyQuery(this),this._handleResponse(i,s,l)},n.prototype._handleSubscribe=function(i,s,l){this._handleResponse(i,s,l)},n.prototype._handleResponse=function(i,s,l){var u=this.callback;if(this.callback=null,i)return this._finishResponse(i,u);if(!s)return this._finishResponse(null,u);var a=this,o=1,c=function(v){if(v)return a._finishResponse(v,u);--o||a._finishResponse(null,u)};if(Array.isArray(s))o+=s.length,this.results=this._ingestSnapshots(s,c),this.extra=l;else for(var d in s){o++;var p=s[d],h=this.connection.get(p.c||this.collection,d);h.ingestSnapshot(p,c)}c()},n.prototype._ingestSnapshots=function(i,s){for(var l=[],u=0;u<i.length;u++){var a=i[u],o=this.connection.get(a.c||this.collection,a.d);o.ingestSnapshot(a,s),l.push(o)}return l},n.prototype._finishResponse=function(i,s){if(this.emit("ready"),this.ready=!0,i)return this.connection._destroyQuery(this),s?s(i):this.emit("error",i);s&&s(null,this.results,this.extra)},n.prototype._handleError=function(i){this.emit("error",i)},n.prototype._handleDiff=function(i){for(var s=0;s<i.length;s++){var l=i[s];l.type==="insert"&&(l.values=this._ingestSnapshots(l.values))}for(var s=0;s<i.length;s++){var l=i[s];switch(l.type){case"insert":var u=l.values;Array.prototype.splice.apply(this.results,[l.index,0].concat(u)),this.emit("insert",u,l.index);break;case"remove":var o=l.howMany||1,a=this.results.splice(l.index,o);this.emit("remove",a,l.index);break;case"move":var o=l.howMany||1,c=this.results.splice(l.from,o);Array.prototype.splice.apply(this.results,[l.to,0].concat(c)),this.emit("move",c,l.from,l.to);break}}this.emit("changed",this.results)},n.prototype._handleExtra=function(i){this.extra=i,this.emit("extra",i)},ma}var va,lf;function ed(){if(lf)return va;lf=1;var r=Mr(),e=ir().ACTIONS,t=nt();va=n;function n(i,s){if(r.EventEmitter.call(this),!s||typeof s!="string")throw new Error("LocalPresence presenceId must be a string");this.presence=i,this.presenceId=s,this.connection=i.connection,this.presenceVersion=0,this.value=null,this._pendingMessages=[],this._callbacksByPresenceVersion=Object.create(null)}return r.mixin(n),n.prototype.submit=function(i,s){this.value=i,this.send(s)},n.prototype.send=function(i){var s=this._message();this._pendingMessages.push(s),this._callbacksByPresenceVersion[s.pv]=i,this._sendPending()},n.prototype.destroy=function(i){var s=this;this.submit(null,function(l){if(l)return s._callbackOrEmit(l,i);delete s.presence.localPresences[s.presenceId],i&&i()})},n.prototype._sendPending=function(){if(this.connection.canSend){var i=this;this._pendingMessages.forEach(function(s){i.connection.send(s)}),this._pendingMessages=[]}},n.prototype._ack=function(i,s){var l=this._getCallback(s);this._callbackOrEmit(i,l)},n.prototype._message=function(){return{a:e.presence,ch:this.presence.channel,id:this.presenceId,p:this.value,pv:this.presenceVersion++}},n.prototype._getCallback=function(i){var s=this._callbacksByPresenceVersion[i];return delete this._callbacksByPresenceVersion[i],s},n.prototype._callbackOrEmit=function(i,s){if(s)return t.nextTick(s,i);i&&this.emit("error",i)},va}var ya,uf;function td(){if(uf)return ya;uf=1;var r=nt();ya=e;function e(t,n){this.presence=t,this.presenceId=n,this.connection=this.presence.connection,this.value=null,this.presenceVersion=0}return e.prototype.receiveUpdate=function(t){t.pv<this.presenceVersion||(this.value=t.p,this.presenceVersion=t.pv,this.presence._updateRemotePresence(this))},e.prototype.destroy=function(t){delete this.presence._remotePresenceInstances[this.presenceId],delete this.presence.remotePresences[this.presenceId],t&&r.nextTick(t)},ya}function rd(r,...e){return(...t)=>r(...e,...t)}function Pn(r){return function(...e){var t=e.pop();return r.call(this,e,t)}}var q0=typeof queueMicrotask=="function"&&queueMicrotask,nd=typeof setImmediate=="function"&&setImmediate,id=typeof process=="object"&&typeof process.nextTick=="function";function sd(r){setTimeout(r,0)}function od(r){return(e,...t)=>r(()=>e(...t))}var on;q0?on=queueMicrotask:nd?on=setImmediate:id?on=process.nextTick:on=sd;var Dt=od(on);function yn(r){return Cn(r)?function(...e){const t=e.pop(),n=r.apply(this,e);return cf(n,t)}:Pn(function(e,t){var n;try{n=r.apply(this,e)}catch(i){return t(i)}if(n&&typeof n.then=="function")return cf(n,t);t(null,n)})}function cf(r,e){return r.then(t=>{ff(e,null,t)},t=>{ff(e,t&&(t instanceof Error||t.message)?t:new Error(t))})}function ff(r,e,t){try{r(e,t)}catch(n){Dt(i=>{throw i},n)}}function Cn(r){return r[Symbol.toStringTag]==="AsyncFunction"}function P0(r){return r[Symbol.toStringTag]==="AsyncGenerator"}function C0(r){return typeof r[Symbol.asyncIterator]=="function"}function ue(r){if(typeof r!="function")throw new Error("expected a function");return Cn(r)?yn(r):r}function le(r,e){if(e||(e=r.length),!e)throw new Error("arity is undefined");function t(...n){return typeof n[e-1]=="function"?r.apply(this,n):new Promise((i,s)=>{n[e-1]=(l,...u)=>{if(l)return s(l);i(u.length>1?u:u[0])},r.apply(this,n)})}return t}function ad(r){return function(t,...n){return le(function(s){var l=this;return r(t,(u,a)=>{ue(u).apply(l,n.concat(a))},s)})}}function ql(r,e,t,n){e=e||[];var i=[],s=0,l=ue(t);return r(e,(u,a,o)=>{var c=s++;l(u,(d,p)=>{i[c]=p,o(d)})},u=>{n(u,i)})}function Ji(r){return r&&typeof r.length=="number"&&r.length>=0&&r.length%1===0}const Xi={};function $t(r){function e(...t){if(r!==null){var n=r;r=null,n.apply(this,t)}}return Object.assign(e,r),e}function x0(r){return r[Symbol.iterator]&&r[Symbol.iterator]()}function D0(r){var e=-1,t=r.length;return function(){return++e<t?{value:r[e],key:e}:null}}function M0(r){var e=-1;return function(){var n=r.next();return n.done?null:(e++,{value:n.value,key:e})}}function k0(r){var e=r?Object.keys(r):[],t=-1,n=e.length;return function i(){var s=e[++t];return s==="__proto__"?i():t<n?{value:r[s],key:s}:null}}function j0(r){if(Ji(r))return D0(r);var e=x0(r);return e?M0(e):k0(r)}function Ft(r){return function(...e){if(r===null)throw new Error("Callback was already called.");var t=r;r=null,t.apply(this,e)}}function hf(r,e,t,n){let i=!1,s=!1,l=!1,u=0,a=0;function o(){u>=e||l||i||(l=!0,r.next().then(({value:p,done:h})=>{if(!(s||i)){if(l=!1,h){i=!0,u<=0&&n(null);return}u++,t(p,a,c),a++,o()}}).catch(d))}function c(p,h){if(u-=1,!s){if(p)return d(p);if(p===!1){i=!0,s=!0;return}if(h===Xi||i&&u<=0)return i=!0,n(null);o()}}function d(p){s||(l=!1,i=!0,n(p))}o()}var it=r=>(e,t,n)=>{if(n=$t(n),r<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!e)return n(null);if(P0(e))return hf(e,r,t,n);if(C0(e))return hf(e[Symbol.asyncIterator](),r,t,n);var i=j0(e),s=!1,l=!1,u=0,a=!1;function o(d,p){if(!l)if(u-=1,d)s=!0,n(d);else if(d===!1)s=!0,l=!0;else{if(p===Xi||s&&u<=0)return s=!0,n(null);a||c()}}function c(){for(a=!0;u<r&&!s;){var d=i();if(d===null){s=!0,u<=0&&n(null);return}u+=1,t(d.value,d.key,Ft(o))}a=!1}c()};function B0(r,e,t,n){return it(e)(r,ue(t),n)}var Pr=le(B0,4);function $0(r,e,t){t=$t(t);var n=0,i=0,{length:s}=r,l=!1;s===0&&t(null);function u(a,o){a===!1&&(l=!0),l!==!0&&(a?t(a):(++i===s||o===Xi)&&t(null))}for(;n<s;n++)e(r[n],n,Ft(u))}function F0(r,e,t){return Pr(r,1/0,e,t)}function U0(r,e,t){var n=Ji(r)?$0:F0;return n(r,ue(e),t)}var Me=le(U0,3);function H0(r,e,t){return ql(Me,r,e,t)}var Qi=le(H0,3),ld=ad(Qi);function V0(r,e,t){return Pr(r,1,e,t)}var Qe=le(V0,3);function G0(r,e,t){return ql(Qe,r,e,t)}var Pl=le(G0,3),ud=ad(Pl);const jr=Symbol("promiseCallback");function Cr(){let r,e;function t(n,...i){if(n)return e(n);r(i.length>1?i:i[0])}return t[jr]=new Promise((n,i)=>{r=n,e=i}),t}function Cl(r,e,t){typeof e!="number"&&(t=e,e=null),t=$t(t||Cr());var n=Object.keys(r).length;if(!n)return t(null);e||(e=n);var i={},s=0,l=!1,u=!1,a=Object.create(null),o=[],c=[],d={};Object.keys(r).forEach(y=>{var g=r[y];if(!Array.isArray(g)){p(y,[g]),c.push(y);return}var m=g.slice(0,g.length-1),A=m.length;if(A===0){p(y,g),c.push(y);return}d[y]=A,m.forEach(S=>{if(!r[S])throw new Error("async.auto task `"+y+"` has a non-existent dependency `"+S+"` in "+m.join(", "));v(S,()=>{A--,A===0&&p(y,g)})})}),w(),h();function p(y,g){o.push(()=>E(y,g))}function h(){if(!l){if(o.length===0&&s===0)return t(null,i);for(;o.length&&s<e;){var y=o.shift();y()}}}function v(y,g){var m=a[y];m||(m=a[y]=[]),m.push(g)}function _(y){var g=a[y]||[];g.forEach(m=>m()),h()}function E(y,g){if(!u){var m=Ft((S,...I)=>{if(s--,S===!1){l=!0;return}if(I.length<2&&([I]=I),S){var C={};if(Object.keys(i).forEach(D=>{C[D]=i[D]}),C[y]=I,u=!0,a=Object.create(null),l)return;t(S,C)}else i[y]=I,_(y)});s++;var A=ue(g[g.length-1]);g.length>1?A(i,m):A(m)}}function w(){for(var y,g=0;c.length;)y=c.pop(),g++,R(y).forEach(m=>{--d[m]===0&&c.push(m)});if(g!==n)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function R(y){var g=[];return Object.keys(r).forEach(m=>{const A=r[m];Array.isArray(A)&&A.indexOf(y)>=0&&g.push(m)}),g}return t[jr]}var z0=/^(?:async\s)?(?:function)?\s*(?:\w+\s*)?\(([^)]+)\)(?:\s*{)/,W0=/^(?:async\s)?\s*(?:\(\s*)?((?:[^)=\s]\s*)*)(?:\)\s*)?=>/,K0=/,/,Y0=/(=.+)?(\s*)$/;function Z0(r){let e="",t=0,n=r.indexOf("*/");for(;t<r.length;)if(r[t]==="/"&&r[t+1]==="/"){let i=r.indexOf(`
`,t);t=i===-1?r.length:i}else if(n!==-1&&r[t]==="/"&&r[t+1]==="*"){let i=r.indexOf("*/",t);i!==-1?(t=i+2,n=r.indexOf("*/",t)):(e+=r[t],t++)}else e+=r[t],t++;return e}function J0(r){const e=Z0(r.toString());let t=e.match(z0);if(t||(t=e.match(W0)),!t)throw new Error(`could not parse args in autoInject
Source:
`+e);let[,n]=t;return n.replace(/\s/g,"").split(K0).map(i=>i.replace(Y0,"").trim())}function cd(r,e){var t={};return Object.keys(r).forEach(n=>{var i=r[n],s,l=Cn(i),u=!l&&i.length===1||l&&i.length===0;if(Array.isArray(i))s=[...i],i=s.pop(),t[n]=s.concat(s.length>0?a:i);else if(u)t[n]=i;else{if(s=J0(i),i.length===0&&!l&&s.length===0)throw new Error("autoInject task functions require explicit parameters.");l||s.pop(),t[n]=s.concat(a)}function a(o,c){var d=s.map(p=>o[p]);d.push(c),ue(i)(...d)}}),Cl(t,e)}class X0{constructor(){this.head=this.tail=null,this.length=0}removeLink(e){return e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev,e.prev=e.next=null,this.length-=1,e}empty(){for(;this.head;)this.shift();return this}insertAfter(e,t){t.prev=e,t.next=e.next,e.next?e.next.prev=t:this.tail=t,e.next=t,this.length+=1}insertBefore(e,t){t.prev=e.prev,t.next=e,e.prev?e.prev.next=t:this.head=t,e.prev=t,this.length+=1}unshift(e){this.head?this.insertBefore(this.head,e):df(this,e)}push(e){this.tail?this.insertAfter(this.tail,e):df(this,e)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var e=this.head;e;)yield e.data,e=e.next}remove(e){for(var t=this.head;t;){var{next:n}=t;e(t)&&this.removeLink(t),t=n}return this}}function df(r,e){r.length=1,r.head=r.tail=e}function xl(r,e,t){if(e==null)e=1;else if(e===0)throw new RangeError("Concurrency must not be zero");var n=ue(r),i=0,s=[];const l={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function u(R,y){l[R].push(y)}function a(R,y){const g=(...m)=>{o(R,g),y(...m)};l[R].push(g)}function o(R,y){if(!R)return Object.keys(l).forEach(g=>l[g]=[]);if(!y)return l[R]=[];l[R]=l[R].filter(g=>g!==y)}function c(R,...y){l[R].forEach(g=>g(...y))}var d=!1;function p(R,y,g,m){if(m!=null&&typeof m!="function")throw new Error("task callback must be a function");w.started=!0;var A,S;function I(D,...O){if(D)return g?S(D):A();if(O.length<=1)return A(O[0]);A(O)}var C=w._createTaskItem(R,g?I:m||I);if(y?w._tasks.unshift(C):w._tasks.push(C),d||(d=!0,Dt(()=>{d=!1,w.process()})),g||!m)return new Promise((D,O)=>{A=D,S=O})}function h(R){return function(y,...g){i-=1;for(var m=0,A=R.length;m<A;m++){var S=R[m],I=s.indexOf(S);I===0?s.shift():I>0&&s.splice(I,1),S.callback(y,...g),y!=null&&c("error",y,S.data)}i<=w.concurrency-w.buffer&&c("unsaturated"),w.idle()&&c("drain"),w.process()}}function v(R){return R.length===0&&w.idle()?(Dt(()=>c("drain")),!0):!1}const _=R=>y=>{if(!y)return new Promise((g,m)=>{a(R,(A,S)=>{if(A)return m(A);g(S)})});o(R),u(R,y)};var E=!1,w={_tasks:new X0,_createTaskItem(R,y){return{data:R,callback:y}},*[Symbol.iterator](){yield*w._tasks[Symbol.iterator]()},concurrency:e,payload:t,buffer:e/4,started:!1,paused:!1,push(R,y){return Array.isArray(R)?v(R)?void 0:R.map(g=>p(g,!1,!1,y)):p(R,!1,!1,y)},pushAsync(R,y){return Array.isArray(R)?v(R)?void 0:R.map(g=>p(g,!1,!0,y)):p(R,!1,!0,y)},kill(){o(),w._tasks.empty()},unshift(R,y){return Array.isArray(R)?v(R)?void 0:R.map(g=>p(g,!0,!1,y)):p(R,!0,!1,y)},unshiftAsync(R,y){return Array.isArray(R)?v(R)?void 0:R.map(g=>p(g,!0,!0,y)):p(R,!0,!0,y)},remove(R){w._tasks.remove(R)},process(){if(!E){for(E=!0;!w.paused&&i<w.concurrency&&w._tasks.length;){var R=[],y=[],g=w._tasks.length;w.payload&&(g=Math.min(g,w.payload));for(var m=0;m<g;m++){var A=w._tasks.shift();R.push(A),s.push(A),y.push(A.data)}i+=1,w._tasks.length===0&&c("empty"),i===w.concurrency&&c("saturated");var S=Ft(h(R));n(y,S)}E=!1}},length(){return w._tasks.length},running(){return i},workersList(){return s},idle(){return w._tasks.length+i===0},pause(){w.paused=!0},resume(){w.paused!==!1&&(w.paused=!1,Dt(w.process))}};return Object.defineProperties(w,{saturated:{writable:!1,value:_("saturated")},unsaturated:{writable:!1,value:_("unsaturated")},empty:{writable:!1,value:_("empty")},drain:{writable:!1,value:_("drain")},error:{writable:!1,value:_("error")}}),w}function fd(r,e){return xl(r,1,e)}function hd(r,e,t){return xl(r,e,t)}function Q0(r,e,t,n){n=$t(n);var i=ue(t);return Qe(r,(s,l,u)=>{i(e,s,(a,o)=>{e=o,u(a)})},s=>n(s,e))}var Mt=le(Q0,4);function Dl(...r){var e=r.map(ue);return function(...t){var n=this,i=t[t.length-1];return typeof i=="function"?t.pop():i=Cr(),Mt(e,t,(s,l,u)=>{l.apply(n,s.concat((a,...o)=>{u(a,o)}))},(s,l)=>i(s,...l)),i[jr]}}function dd(...r){return Dl(...r.reverse())}function e_(r,e,t,n){return ql(it(e),r,t,n)}var xn=le(e_,4);function t_(r,e,t,n){var i=ue(t);return xn(r,e,(s,l)=>{i(s,(u,...a)=>u?l(u):l(u,a))},(s,l)=>{for(var u=[],a=0;a<l.length;a++)l[a]&&(u=u.concat(...l[a]));return n(s,u)})}var xr=le(t_,4);function r_(r,e,t){return xr(r,1/0,e,t)}var bi=le(r_,3);function n_(r,e,t){return xr(r,1,e,t)}var _i=le(n_,3);function pd(...r){return function(...e){var t=e.pop();return t(null,...r)}}function Tt(r,e){return(t,n,i,s)=>{var l=!1,u;const a=ue(i);t(n,(o,c,d)=>{a(o,(p,h)=>{if(p||p===!1)return d(p);if(r(h)&&!u)return l=!0,u=e(!0,o),d(null,Xi);d()})},o=>{if(o)return s(o);s(null,l?u:e(!1))})}}function i_(r,e,t){return Tt(n=>n,(n,i)=>i)(Me,r,e,t)}var Ei=le(i_,3);function s_(r,e,t,n){return Tt(i=>i,(i,s)=>s)(it(e),r,t,n)}var Ai=le(s_,4);function o_(r,e,t){return Tt(n=>n,(n,i)=>i)(it(1),r,e,t)}var Oi=le(o_,3);function gd(r){return(e,...t)=>ue(e)(...t,(n,...i)=>{typeof console=="object"&&(n?console.error&&console.error(n):console[r]&&i.forEach(s=>console[r](s)))})}var md=gd("dir");function a_(r,e,t){t=Ft(t);var n=ue(r),i=ue(e),s;function l(a,...o){if(a)return t(a);a!==!1&&(s=o,i(...o,u))}function u(a,o){if(a)return t(a);if(a!==!1){if(!o)return t(null,...s);n(l)}}return u(null,!0)}var bn=le(a_,3);function vd(r,e,t){const n=ue(e);return bn(r,(...i)=>{const s=i.pop();n(...i,(l,u)=>s(l,!u))},t)}function yd(r){return(e,t,n)=>r(e,n)}function l_(r,e,t){return Me(r,yd(ue(e)),t)}var Si=le(l_,3);function u_(r,e,t,n){return it(e)(r,yd(ue(t)),n)}var _n=le(u_,4);function c_(r,e,t){return _n(r,1,e,t)}var En=le(c_,3);function Ml(r){return Cn(r)?r:function(...e){var t=e.pop(),n=!0;e.push((...i)=>{n?Dt(()=>t(...i)):t(...i)}),r.apply(this,e),n=!1}}function f_(r,e,t){return Tt(n=>!n,n=>!n)(Me,r,e,t)}var wi=le(f_,3);function h_(r,e,t,n){return Tt(i=>!i,i=>!i)(it(e),r,t,n)}var Ri=le(h_,4);function d_(r,e,t){return Tt(n=>!n,n=>!n)(Qe,r,e,t)}var Ti=le(d_,3);function p_(r,e,t,n){var i=new Array(e.length);r(e,(s,l,u)=>{t(s,(a,o)=>{i[l]=!!o,u(a)})},s=>{if(s)return n(s);for(var l=[],u=0;u<e.length;u++)i[u]&&l.push(e[u]);n(null,l)})}function g_(r,e,t,n){var i=[];r(e,(s,l,u)=>{t(s,(a,o)=>{if(a)return u(a);o&&i.push({index:l,value:s}),u(a)})},s=>{if(s)return n(s);n(null,i.sort((l,u)=>l.index-u.index).map(l=>l.value))})}function es(r,e,t,n){var i=Ji(e)?p_:g_;return i(r,e,ue(t),n)}function m_(r,e,t){return es(Me,r,e,t)}var Ni=le(m_,3);function v_(r,e,t,n){return es(it(e),r,t,n)}var Li=le(v_,4);function y_(r,e,t){return es(Qe,r,e,t)}var Ii=le(y_,3);function b_(r,e){var t=Ft(e),n=ue(Ml(r));function i(s){if(s)return t(s);s!==!1&&n(i)}return i()}var bd=le(b_,2);function __(r,e,t,n){var i=ue(t);return xn(r,e,(s,l)=>{i(s,(u,a)=>u?l(u):l(u,{key:a,val:s}))},(s,l)=>{for(var u={},{hasOwnProperty:a}=Object.prototype,o=0;o<l.length;o++)if(l[o]){var{key:c}=l[o],{val:d}=l[o];a.call(u,c)?u[c].push(d):u[c]=[d]}return n(s,u)})}var ts=le(__,4);function _d(r,e,t){return ts(r,1/0,e,t)}function Ed(r,e,t){return ts(r,1,e,t)}var Ad=gd("log");function E_(r,e,t,n){n=$t(n);var i={},s=ue(t);return it(e)(r,(l,u,a)=>{s(l,u,(o,c)=>{if(o)return a(o);i[u]=c,a(o)})},l=>n(l,i))}var rs=le(E_,4);function Od(r,e,t){return rs(r,1/0,e,t)}function Sd(r,e,t){return rs(r,1,e,t)}function wd(r,e=t=>t){var t=Object.create(null),n=Object.create(null),i=ue(r),s=Pn((l,u)=>{var a=e(...l);a in t?Dt(()=>u(null,...t[a])):a in n?n[a].push(u):(n[a]=[u],i(...l,(o,...c)=>{o||(t[a]=c);var d=n[a];delete n[a];for(var p=0,h=d.length;p<h;p++)d[p](o,...c)}))});return s.memo=t,s.unmemoized=r,s}var pi;id?pi=process.nextTick:nd?pi=setImmediate:pi=sd;var Rd=od(pi),kl=le((r,e,t)=>{var n=Ji(e)?[]:{};r(e,(i,s,l)=>{ue(i)((u,...a)=>{a.length<2&&([a]=a),n[s]=a,l(u)})},i=>t(i,n))},3);function Td(r,e){return kl(Me,r,e)}function Nd(r,e,t){return kl(it(e),r,t)}function jl(r,e){var t=ue(r);return xl((n,i)=>{t(n[0],i)},e,1)}class A_{constructor(){this.heap=[],this.pushCount=Number.MIN_SAFE_INTEGER}get length(){return this.heap.length}empty(){return this.heap=[],this}percUp(e){let t;for(;e>0&&ba(this.heap[e],this.heap[t=pf(e)]);){let n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,e=t}}percDown(e){let t;for(;(t=O_(e))<this.heap.length&&(t+1<this.heap.length&&ba(this.heap[t+1],this.heap[t])&&(t=t+1),!ba(this.heap[e],this.heap[t]));){let n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,e=t}}push(e){e.pushCount=++this.pushCount,this.heap.push(e),this.percUp(this.heap.length-1)}unshift(e){return this.heap.push(e)}shift(){let[e]=this.heap;return this.heap[0]=this.heap[this.heap.length-1],this.heap.pop(),this.percDown(0),e}toArray(){return[...this]}*[Symbol.iterator](){for(let e=0;e<this.heap.length;e++)yield this.heap[e].data}remove(e){let t=0;for(let n=0;n<this.heap.length;n++)e(this.heap[n])||(this.heap[t]=this.heap[n],t++);this.heap.splice(t);for(let n=pf(this.heap.length-1);n>=0;n--)this.percDown(n);return this}}function O_(r){return(r<<1)+1}function pf(r){return(r+1>>1)-1}function ba(r,e){return r.priority!==e.priority?r.priority<e.priority:r.pushCount<e.pushCount}function Ld(r,e){var t=jl(r,e),{push:n,pushAsync:i}=t;t._tasks=new A_,t._createTaskItem=({data:l,priority:u},a)=>({data:l,priority:u,callback:a});function s(l,u){return Array.isArray(l)?l.map(a=>({data:a,priority:u})):{data:l,priority:u}}return t.push=function(l,u=0,a){return n(s(l,u),a)},t.pushAsync=function(l,u=0,a){return i(s(l,u),a)},delete t.unshift,delete t.unshiftAsync,t}function S_(r,e){if(e=$t(e),!Array.isArray(r))return e(new TypeError("First argument to race must be an array of functions"));if(!r.length)return e();for(var t=0,n=r.length;t<n;t++)ue(r[t])(e)}var Id=le(S_,2);function qi(r,e,t,n){var i=[...r].reverse();return Mt(i,e,t,n)}function Pi(r){var e=ue(r);return Pn(function(n,i){return n.push((s,...l)=>{let u={};if(s&&(u.error=s),l.length>0){var a=l;l.length<=1&&([a]=l),u.value=a}i(null,u)}),e.apply(this,n)})}function qd(r){var e;return Array.isArray(r)?e=r.map(Pi):(e={},Object.keys(r).forEach(t=>{e[t]=Pi.call(this,r[t])})),e}function Bl(r,e,t,n){const i=ue(t);return es(r,e,(s,l)=>{i(s,(u,a)=>{l(u,!a)})},n)}function w_(r,e,t){return Bl(Me,r,e,t)}var Pd=le(w_,3);function R_(r,e,t,n){return Bl(it(e),r,t,n)}var Cd=le(R_,4);function T_(r,e,t){return Bl(Qe,r,e,t)}var xd=le(T_,3);function Dd(r){return function(){return r}}const ol=5,Md=0;function Ci(r,e,t){var n={times:ol,intervalFunc:Dd(Md)};if(arguments.length<3&&typeof r=="function"?(t=e||Cr(),e=r):(N_(n,r),t=t||Cr()),typeof e!="function")throw new Error("Invalid arguments for async.retry");var i=ue(e),s=1;function l(){i((u,...a)=>{u!==!1&&(u&&s++<n.times&&(typeof n.errorFilter!="function"||n.errorFilter(u))?setTimeout(l,n.intervalFunc(s-1)):t(u,...a))})}return l(),t[jr]}function N_(r,e){if(typeof e=="object")r.times=+e.times||ol,r.intervalFunc=typeof e.interval=="function"?e.interval:Dd(+e.interval||Md),r.errorFilter=e.errorFilter;else if(typeof e=="number"||typeof e=="string")r.times=+e||ol;else throw new Error("Invalid arguments for async.retry")}function kd(r,e){e||(e=r,r=null);let t=r&&r.arity||e.length;Cn(e)&&(t+=1);var n=ue(e);return Pn((i,s)=>{(i.length<t-1||s==null)&&(i.push(s),s=Cr());function l(u){n(...i,u)}return r?Ci(r,l,s):Ci(l,s),s[jr]})}function jd(r,e){return kl(Qe,r,e)}function L_(r,e,t){return Tt(Boolean,n=>n)(Me,r,e,t)}var xi=le(L_,3);function I_(r,e,t,n){return Tt(Boolean,i=>i)(it(e),r,t,n)}var Di=le(I_,4);function q_(r,e,t){return Tt(Boolean,n=>n)(Qe,r,e,t)}var Mi=le(q_,3);function P_(r,e,t){var n=ue(e);return Qi(r,(s,l)=>{n(s,(u,a)=>{if(u)return l(u);l(u,{value:s,criteria:a})})},(s,l)=>{if(s)return t(s);t(null,l.sort(i).map(u=>u.value))});function i(s,l){var u=s.criteria,a=l.criteria;return u<a?-1:u>a?1:0}}var Bd=le(P_,3);function $d(r,e,t){var n=ue(r);return Pn((i,s)=>{var l=!1,u;function a(){var o=r.name||"anonymous",c=new Error('Callback function "'+o+'" timed out.');c.code="ETIMEDOUT",t&&(c.info=t),l=!0,s(c)}i.push((...o)=>{l||(s(...o),clearTimeout(u))}),u=setTimeout(a,e),n(...i)})}function C_(r){for(var e=Array(r);r--;)e[r]=r;return e}function ns(r,e,t,n){var i=ue(t);return xn(C_(r),e,i,n)}function Fd(r,e,t){return ns(r,1/0,e,t)}function Ud(r,e,t){return ns(r,1,e,t)}function Hd(r,e,t,n){arguments.length<=3&&typeof e=="function"&&(n=t,t=e,e=Array.isArray(r)?[]:{}),n=$t(n||Cr());var i=ue(t);return Me(r,(s,l,u)=>{i(e,s,l,u)},s=>n(s,e)),n[jr]}function x_(r,e){var t=null,n;return En(r,(i,s)=>{ue(i)((l,...u)=>{if(l===!1)return s(l);u.length<2?[n]=u:n=u,t=l,s(l?null:{})})},()=>e(t,n))}var Vd=le(x_);function Gd(r){return(...e)=>(r.unmemoized||r)(...e)}function D_(r,e,t){t=Ft(t);var n=ue(e),i=ue(r),s=[];function l(a,...o){if(a)return t(a);s=o,a!==!1&&i(u)}function u(a,o){if(a)return t(a);if(a!==!1){if(!o)return t(null,...s);n(l)}}return i(u)}var An=le(D_,3);function zd(r,e,t){const n=ue(r);return An(i=>n((s,l)=>i(s,!l)),e,t)}function M_(r,e){if(e=$t(e),!Array.isArray(r))return e(new Error("First argument to waterfall must be an array of functions"));if(!r.length)return e();var t=0;function n(s){var l=ue(r[t++]);l(...s,Ft(i))}function i(s,...l){if(s!==!1){if(s||t===r.length)return e(s,...l);n(l)}}n([])}var Wd=le(M_),k_={apply:rd,applyEach:ld,applyEachSeries:ud,asyncify:yn,auto:Cl,autoInject:cd,cargo:fd,cargoQueue:hd,compose:dd,concat:bi,concatLimit:xr,concatSeries:_i,constant:pd,detect:Ei,detectLimit:Ai,detectSeries:Oi,dir:md,doUntil:vd,doWhilst:bn,each:Si,eachLimit:_n,eachOf:Me,eachOfLimit:Pr,eachOfSeries:Qe,eachSeries:En,ensureAsync:Ml,every:wi,everyLimit:Ri,everySeries:Ti,filter:Ni,filterLimit:Li,filterSeries:Ii,forever:bd,groupBy:_d,groupByLimit:ts,groupBySeries:Ed,log:Ad,map:Qi,mapLimit:xn,mapSeries:Pl,mapValues:Od,mapValuesLimit:rs,mapValuesSeries:Sd,memoize:wd,nextTick:Rd,parallel:Td,parallelLimit:Nd,priorityQueue:Ld,queue:jl,race:Id,reduce:Mt,reduceRight:qi,reflect:Pi,reflectAll:qd,reject:Pd,rejectLimit:Cd,rejectSeries:xd,retry:Ci,retryable:kd,seq:Dl,series:jd,setImmediate:Dt,some:xi,someLimit:Di,someSeries:Mi,sortBy:Bd,timeout:$d,times:Fd,timesLimit:ns,timesSeries:Ud,transform:Hd,tryEach:Vd,unmemoize:Gd,until:zd,waterfall:Wd,whilst:An,all:wi,allLimit:Ri,allSeries:Ti,any:xi,anyLimit:Di,anySeries:Mi,find:Ei,findLimit:Ai,findSeries:Oi,flatMap:bi,flatMapLimit:xr,flatMapSeries:_i,forEach:Si,forEachSeries:En,forEachLimit:_n,forEachOf:Me,forEachOfSeries:Qe,forEachOfLimit:Pr,inject:Mt,foldl:Mt,foldr:qi,select:Ni,selectLimit:Li,selectSeries:Ii,wrapSync:yn,during:An,doDuring:bn};const j_=Object.freeze(Object.defineProperty({__proto__:null,all:wi,allLimit:Ri,allSeries:Ti,any:xi,anyLimit:Di,anySeries:Mi,apply:rd,applyEach:ld,applyEachSeries:ud,asyncify:yn,auto:Cl,autoInject:cd,cargo:fd,cargoQueue:hd,compose:dd,concat:bi,concatLimit:xr,concatSeries:_i,constant:pd,default:k_,detect:Ei,detectLimit:Ai,detectSeries:Oi,dir:md,doDuring:bn,doUntil:vd,doWhilst:bn,during:An,each:Si,eachLimit:_n,eachOf:Me,eachOfLimit:Pr,eachOfSeries:Qe,eachSeries:En,ensureAsync:Ml,every:wi,everyLimit:Ri,everySeries:Ti,filter:Ni,filterLimit:Li,filterSeries:Ii,find:Ei,findLimit:Ai,findSeries:Oi,flatMap:bi,flatMapLimit:xr,flatMapSeries:_i,foldl:Mt,foldr:qi,forEach:Si,forEachLimit:_n,forEachOf:Me,forEachOfLimit:Pr,forEachOfSeries:Qe,forEachSeries:En,forever:bd,groupBy:_d,groupByLimit:ts,groupBySeries:Ed,inject:Mt,log:Ad,map:Qi,mapLimit:xn,mapSeries:Pl,mapValues:Od,mapValuesLimit:rs,mapValuesSeries:Sd,memoize:wd,nextTick:Rd,parallel:Td,parallelLimit:Nd,priorityQueue:Ld,queue:jl,race:Id,reduce:Mt,reduceRight:qi,reflect:Pi,reflectAll:qd,reject:Pd,rejectLimit:Cd,rejectSeries:xd,retry:Ci,retryable:kd,select:Ni,selectLimit:Li,selectSeries:Ii,seq:Dl,series:jd,setImmediate:Dt,some:xi,someLimit:Di,someSeries:Mi,sortBy:Bd,timeout:$d,times:Fd,timesLimit:ns,timesSeries:Ud,transform:Hd,tryEach:Vd,unmemoize:Gd,until:zd,waterfall:Wd,whilst:An,wrapSync:yn},Symbol.toStringTag,{value:"Module"})),B_=My(j_);var _a={exports:{}},gf;function $_(){if(gf)return _a.exports;gf=1;var r=_a.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var n=Math.log(Math.pow(2,e))/Math.log(t),i=2;n===1/0;i*=2)n=Math.log(Math.pow(2,e/i))/Math.log(t)*i;for(var s=n-Math.floor(n),l="",i=0;i<Math.floor(n);i++){var u=Math.floor(Math.random()*t).toString(t);l=u+l}if(s){var a=Math.pow(t,s),u=Math.floor(Math.random()*a).toString(t);l=u+l}var o=parseInt(l,t);return o!==1/0&&o>=Math.pow(2,e)?r(e,t):l};return r.rack=function(e,t,n){var i=function(l){var u=0;do{if(u++>10)if(n)e+=n;else throw new Error("too many ID collisions, use more bits");var a=r(e,t)}while(Object.hasOwnProperty.call(s,a));return s[a]=l,a},s=i.hats={};return i.get=function(l){return i.hats[l]},i.set=function(l,u){return i.hats[l]=u,i},i.bits=e||128,i.base=t||16,i},_a.exports}var Ea,mf;function Kd(){if(mf)return Ea;mf=1;var r=Mr(),e=ed(),t=td(),n=nt(),i=B_,s=$_(),l=ir().ACTIONS;Ea=u;function u(a,o){if(r.EventEmitter.call(this),!o||typeof o!="string")throw new Error("Presence channel must be provided");this.connection=a,this.channel=o,this.wantSubscribe=!1,this.subscribed=!1,this.remotePresences=Object.create(null),this.localPresences=Object.create(null),this._remotePresenceInstances=Object.create(null),this._subscriptionCallbacksBySeq=Object.create(null),this._wantsDestroy=!1}return r.mixin(u),u.prototype.subscribe=function(a){this._sendSubscriptionAction(!0,a)},u.prototype.unsubscribe=function(a){this._sendSubscriptionAction(!1,a)},u.prototype.create=function(a){if(this._wantsDestroy)throw new Error("Presence is being destroyed");a=a||s();var o=this._createLocalPresence(a);return this.localPresences[a]=o,o},u.prototype.destroy=function(a){this._wantsDestroy=!0;var o=this,c=Object.keys(o.localPresences);this.unsubscribe(function(d){if(d)return o._callbackOrEmit(d,a);var p=Object.keys(o._remotePresenceInstances);i.parallel([function(h){i.each(c,function(v,_){var E=o.localPresences[v];if(!E)return _();E.destroy(_)},h)},function(h){if(!o._wantsDestroy)return h();i.each(p,function(v,_){o._remotePresenceInstances[v].destroy(_)},h)}],function(h){o._wantsDestroy&&delete o.connection._presences[o.channel],o._callbackOrEmit(h,a)})})},u.prototype._sendSubscriptionAction=function(a,o){if(a=!!a,a===this.wantSubscribe){if(!o)return;if(a===this.subscribed)return n.nextTick(o);if(Object.keys(this._subscriptionCallbacksBySeq).length)return this._combineSubscribeCallbackWithLastAdded(o)}this.wantSubscribe=a;var c=this.wantSubscribe?l.presenceSubscribe:l.presenceUnsubscribe,d=this.connection._presenceSeq++;this._subscriptionCallbacksBySeq[d]=o,this.connection.canSend&&this.connection._sendPresenceAction(c,d,this)},u.prototype._requestRemotePresence=function(){this.connection._requestRemotePresence(this.channel)},u.prototype._handleSubscribe=function(a,o){this.wantSubscribe&&(this.subscribed=!0);var c=this._subscriptionCallback(o);this._callbackOrEmit(a,c)},u.prototype._handleUnsubscribe=function(a,o){this.subscribed=!1;var c=this._subscriptionCallback(o);this._callbackOrEmit(a,c)},u.prototype._receiveUpdate=function(a,o){var c=n.dig(this.localPresences,o.id);if(c)return c._ack(a,o.pv);if(a)return this.emit("error",a);var d=this,p=n.digOrCreate(this._remotePresenceInstances,o.id,function(){return d._createRemotePresence(o.id)});p.receiveUpdate(o)},u.prototype._updateRemotePresence=function(a){this.remotePresences[a.presenceId]=a.value,a.value===null&&this._removeRemotePresence(a.presenceId),this.emit("receive",a.presenceId,a.value)},u.prototype._broadcastAllLocalPresence=function(a){if(a)return this.emit("error",a);for(var o in this.localPresences){var c=this.localPresences[o];c.value!==null&&c.send()}},u.prototype._removeRemotePresence=function(a){this._remotePresenceInstances[a].destroy(),delete this._remotePresenceInstances[a],delete this.remotePresences[a]},u.prototype._onConnectionStateChanged=function(){if(!this.connection.canSend){this.subscribed=!1;return}this._resubscribe();for(var a in this.localPresences)this.localPresences[a]._sendPending()},u.prototype._resubscribe=function(){var a=[];for(var o in this._subscriptionCallbacksBySeq){var c=this._subscriptionCallback(o);a.push(c)}if(!this.wantSubscribe)return this._callEachOrEmit(a);var d=this;this.subscribe(function(p){d._callEachOrEmit(a,p)})},u.prototype._subscriptionCallback=function(a){var o=this._subscriptionCallbacksBySeq[a];return delete this._subscriptionCallbacksBySeq[a],o},u.prototype._callbackOrEmit=function(a,o){if(o)return n.nextTick(o,a);a&&this.emit("error",a)},u.prototype._createLocalPresence=function(a){return new e(this,a)},u.prototype._createRemotePresence=function(a){return new t(this,a)},u.prototype._callEachOrEmit=function(a,o){var c=n.callEach(a,o);!c&&o&&this.emit("error",o)},u.prototype._combineSubscribeCallbackWithLastAdded=function(a){var o=Object.keys(this._subscriptionCallbacksBySeq),c=o[o.length-1],d=this._subscriptionCallbacksBySeq[c];if(!d)return this._subscriptionCallbacksBySeq[c]=a;this._subscriptionCallbacksBySeq[c]=function(p){d(p),a(p)}},Ea}var Aa,vf;function F_(){if(vf)return Aa;vf=1;var r=ed(),e=Nn(),t=nt(),n=e.CODES;Aa=i;function i(s,l){r.call(this,s,l),this.collection=this.presence.collection,this.id=this.presence.id,this._doc=this.connection.get(this.collection,this.id),this._emitter=this.connection._docPresenceEmitter,this._isSending=!1,this._docDataVersionByPresenceVersion=Object.create(null),this._opHandler=this._transformAgainstOp.bind(this),this._createOrDelHandler=this._handleCreateOrDel.bind(this),this._loadHandler=this._handleLoad.bind(this),this._destroyHandler=this.destroy.bind(this),this._registerWithDoc()}return i.prototype=Object.create(r.prototype),i.prototype.submit=function(s,l){if(!this._doc.type){if(s===null)return this._callbackOrEmit(null,l);var u=null;return this._doc._isInHardRollback?u={code:n.ERR_DOC_IN_HARD_ROLLBACK,message:"Cannot submit presence. Document is processing hard rollback"}:u={code:n.ERR_DOC_DOES_NOT_EXIST,message:"Cannot submit presence. Document has not been created"},this._callbackOrEmit(u,l)}this._docDataVersionByPresenceVersion[this.presenceVersion]=this._doc._dataStateVersion,r.prototype.submit.call(this,s,l)},i.prototype.destroy=function(s){this._emitter.removeEventListener(this._doc,"op",this._opHandler),this._emitter.removeEventListener(this._doc,"create",this._createOrDelHandler),this._emitter.removeEventListener(this._doc,"del",this._createOrDelHandler),this._emitter.removeEventListener(this._doc,"load",this._loadHandler),this._emitter.removeEventListener(this._doc,"destroy",this._destroyHandler),r.prototype.destroy.call(this,s)},i.prototype._sendPending=function(){if(!this._isSending){this._isSending=!0;var s=this;this._doc.whenNothingPending(function(){s._isSending=!1,s.connection.canSend&&(s._pendingMessages.forEach(function(l){l.t=s._doc.type.uri,l.v=s._doc.version,s.connection.send(l)}),s._pendingMessages=[],s._docDataVersionByPresenceVersion=Object.create(null))})}},i.prototype._registerWithDoc=function(){this._emitter.addEventListener(this._doc,"op",this._opHandler),this._emitter.addEventListener(this._doc,"create",this._createOrDelHandler),this._emitter.addEventListener(this._doc,"del",this._createOrDelHandler),this._emitter.addEventListener(this._doc,"load",this._loadHandler),this._emitter.addEventListener(this._doc,"destroy",this._destroyHandler)},i.prototype._transformAgainstOp=function(s,l){var u=this,a=this._doc._dataStateVersion;this._pendingMessages.forEach(function(o){var c=u._docDataVersionByPresenceVersion[o.pv];if(!(c>=a))try{o.p=u._transformPresence(o.p,s,l),u._docDataVersionByPresenceVersion[o.pv]=a}catch(p){var d=u._getCallback(o.pv);u._callbackOrEmit(p,d)}});try{this.value=this._transformPresence(this.value,s,l)}catch(o){this.emit("error",o)}},i.prototype._handleCreateOrDel=function(){this._pendingMessages.forEach(function(s){s.p=null}),this.value=null},i.prototype._handleLoad=function(){this.value=null,this._pendingMessages=[],this._docDataVersionByPresenceVersion=Object.create(null)},i.prototype._message=function(){var s=r.prototype._message.call(this);return s.c=this.collection,s.d=this.id,s.v=null,s.t=null,s},i.prototype._transformPresence=function(s,l,u){var a=this._doc.type;if(!t.supportsPresence(a))throw new e(n.ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE,"Type does not support presence: "+a.name);return a.transformPresence(s,l,u)},Aa}var Oa={},yf;function U_(){return yf||(yf=1,(function(r){var e=Ki(),t=Nn(),n=nt(),i=t.CODES;r.checkOp=function(u){if(u==null||typeof u!="object")return new t(i.ERR_OT_OP_BADLY_FORMED,"Op must be an object");if(u.create!=null){if(typeof u.create!="object")return new t(i.ERR_OT_OP_BADLY_FORMED,"Create data must be an object");var a=u.create.type;if(typeof a!="string")return new t(i.ERR_OT_OP_BADLY_FORMED,"Missing create type");var o=e.map[a];if(o==null||typeof o!="object")return new t(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type")}else if(u.del!=null){if(u.del!==!0)return new t(i.ERR_OT_OP_BADLY_FORMED,"del value must be true")}else if(!("op"in u))return new t(i.ERR_OT_OP_BADLY_FORMED,"Missing op, create, or del");if(u.src!=null&&typeof u.src!="string")return new t(i.ERR_OT_OP_BADLY_FORMED,"src must be a string");if(u.seq!=null&&typeof u.seq!="number")return new t(i.ERR_OT_OP_BADLY_FORMED,"seq must be a number");if(u.src==null&&u.seq!=null||u.src!=null&&u.seq==null)return new t(i.ERR_OT_OP_BADLY_FORMED,"Both src and seq must be set together");if(u.m!=null&&typeof u.m!="object")return new t(i.ERR_OT_OP_BADLY_FORMED,"op.m must be an object or null")},r.normalizeType=function(u){return e.map[u]&&e.map[u].uri},r.apply=function(u,a){if(typeof u!="object")return new t(i.ERR_APPLY_SNAPSHOT_NOT_PROVIDED,"Missing snapshot");if(u.v!=null&&a.v!=null&&u.v!==a.v)return new t(i.ERR_APPLY_OP_VERSION_DOES_NOT_MATCH_SNAPSHOT,"Version mismatch");if(a.create){if(u.type)return new t(i.ERR_DOC_ALREADY_CREATED,"Document already exists");var o=a.create,c=e.map[o.type];if(!c)return new t(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type");try{u.data=c.create(o.data),u.type=c.uri,u.v++}catch(p){return p}}else if(a.del)u.data=void 0,u.type=null,u.v++;else if("op"in a){var d=s(u,a.op);if(d)return d;u.v++}else u.v++};function s(u,a){if(!u.type)return new t(i.ERR_DOC_DOES_NOT_EXIST,"Document does not exist");if(a===void 0)return new t(i.ERR_OT_OP_NOT_PROVIDED,"Missing op");var o=e.map[u.type];if(!o)return new t(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type");if(o.name==="json0"&&Array.isArray(a))for(var c=0;c<a.length;c++){var d=a[c];if(Array.isArray(d.p))for(var p=0;p<d.p.length;p++){var h=d.p[p];if(n.isDangerousProperty(h))return new t(i.ERR_OT_OP_NOT_APPLIED,"Invalid path segment")}}try{u.data=o.apply(u.data,a)}catch(v){return new t(i.ERR_OT_OP_NOT_APPLIED,v.message)}}r.transform=function(u,a,o){if(a.v!=null&&a.v!==o.v)return new t(i.ERR_OP_VERSION_MISMATCH_DURING_TRANSFORM,"Version mismatch");if(o.del){if(a.create||"op"in a)return new t(i.ERR_DOC_WAS_DELETED,"Document was deleted")}else{if(o.create&&("op"in a||a.create||a.del)||"op"in o&&a.create)return new t(i.ERR_DOC_ALREADY_CREATED,"Document was created remotely");if("op"in o&&"op"in a){if(!u)return new t(i.ERR_DOC_DOES_NOT_EXIST,"Document does not exist");if(typeof u=="string"&&(u=e.map[u],!u))return new t(i.ERR_DOC_TYPE_NOT_RECOGNIZED,"Unknown type");try{a.op=u.transform(a.op,o.op,"left")}catch(c){return c}}}a.v!=null&&a.v++},r.applyOps=function(u,a,o){o=o||{};for(var c=0;c<a.length;c++){var d=a[c];if(o._normalizeLegacyJson0Ops)try{l(u,d)}catch{return new t(i.ERR_OT_LEGACY_JSON0_OP_CANNOT_BE_NORMALIZED,"Cannot normalize legacy json0 op")}u.v=d.v;var p=r.apply(u,d);if(p)return p}},r.transformPresence=function(u,a,o){var c=this.checkOp(a);if(c)return c;var d=u.t;if(typeof d=="string"&&(d=e.map[d]),!d)return{code:i.ERR_DOC_TYPE_NOT_RECOGNIZED,message:"Unknown type"};if(!n.supportsPresence(d))return{code:i.ERR_TYPE_DOES_NOT_SUPPORT_PRESENCE,message:"Type does not support presence"};if(a.create||a.del){u.p=null,u.v++;return}try{u.p=u.p===null?null:d.transformPresence(u.p,a.op,o)}catch(p){return{code:i.ERR_PRESENCE_TRANSFORM_FAILED,message:p.message||p}}u.v++};function l(u,a){if(u.type===e.defaultType.uri){var o=a.op;if(o){var c=u.data;o.length>1&&(c=n.clone(c));for(var d=0;d<o.length;d++){var p=o[d];typeof p.lm=="string"&&(p.lm=+p.lm);for(var h=p.p,v=c,_=0;_<h.length;_++){var E=h[_];Object.prototype.toString.call(v)=="[object Array]"?h[_]=+E:v.constructor===Object&&(h[_]=E.toString()),v=v[E]}d<o.length-1&&(c=e.defaultType.apply(c,[p]))}}}}})(Oa)),Oa}var Sa,bf;function H_(){if(bf)return Sa;bf=1;var r=td(),e=U_();Sa=t;function t(n,i){r.call(this,n,i),this.collection=this.presence.collection,this.id=this.presence.id,this.src=null,this.presenceVersion=null,this._doc=this.connection.get(this.collection,this.id),this._emitter=this.connection._docPresenceEmitter,this._pending=null,this._opCache=null,this._pendingSetPending=!1,this._opHandler=this._handleOp.bind(this),this._createDelHandler=this._handleCreateDel.bind(this),this._loadHandler=this._handleLoad.bind(this),this._registerWithDoc()}return t.prototype=Object.create(r.prototype),t.prototype.receiveUpdate=function(n){this._pending&&n.pv<this._pending.pv||(this.src=n.src,this._pending=n,this._setPendingPresence())},t.prototype.destroy=function(n){this._emitter.removeEventListener(this._doc,"op",this._opHandler),this._emitter.removeEventListener(this._doc,"create",this._createDelHandler),this._emitter.removeEventListener(this._doc,"del",this._createDelHandler),this._emitter.removeEventListener(this._doc,"load",this._loadHandler),r.prototype.destroy.call(this,n)},t.prototype._registerWithDoc=function(){this._emitter.addEventListener(this._doc,"op",this._opHandler),this._emitter.addEventListener(this._doc,"create",this._createDelHandler),this._emitter.addEventListener(this._doc,"del",this._createDelHandler),this._emitter.addEventListener(this._doc,"load",this._loadHandler)},t.prototype._setPendingPresence=function(){if(!this._pendingSetPending){this._pendingSetPending=!0;var n=this;this._doc.whenNothingPending(function(){if(n._pendingSetPending=!1,!!n._pending){if(n._pending.pv<n.presenceVersion)return n._pending=null;if(n._pending.v>n._doc.version)return n._doc.fetch();n._catchUpStalePresence()&&(n.value=n._pending.p,n.presenceVersion=n._pending.pv,n._pending=null,n.presence._updateRemotePresence(n))}})}},t.prototype._handleOp=function(n,i,s){var l=s===this.src;this._transformAgainstOp(n,l),this._cacheOp(n,l),this._setPendingPresence()},r.prototype._handleCreateDel=function(){this._cacheOp(null),this._setPendingPresence()},r.prototype._handleLoad=function(){this.value=null,this._pending=null,this._opCache=null,this.presence._updateRemotePresence(this)},t.prototype._transformAgainstOp=function(n,i){if(this.value){try{this.value=this._doc.type.transformPresence(this.value,n,i)}catch(s){return this.presence.emit("error",s)}this.presence._updateRemotePresence(this)}},t.prototype._catchUpStalePresence=function(){if(this._pending.v>=this._doc.version)return!0;if(!this._opCache)return this._startCachingOps(),this._doc.fetch(),this.presence._requestRemotePresence(),!1;for(;this._opCache[this._pending.v];){var n=this._opCache[this._pending.v],i=n.op,s=n.isOwnOp;i===null?(this._pending.p=null,this._pending.v++):e.transformPresence(this._pending,i,s)}var l=this._pending.v>=this._doc.version;return l&&this._stopCachingOps(),l},t.prototype._startCachingOps=function(){this._opCache=[]},t.prototype._stopCachingOps=function(){this._opCache=null},t.prototype._cacheOp=function(n,i){this._opCache&&(n=n?{op:n}:null,this._opCache[this._doc.version-1]={op:n,isOwnOp:i})},Sa}var wa,_f;function V_(){if(_f)return wa;_f=1;var r=Kd(),e=F_(),t=H_();function n(i,s,l){var u=n.channel(s,l);r.call(this,i,u),this.collection=s,this.id=l}return wa=n,n.prototype=Object.create(r.prototype),n.channel=function(i,s){return i+"."+s},n.prototype._createLocalPresence=function(i){return new e(this,i)},n.prototype._createRemotePresence=function(i){return new t(this,i)},wa}var Ra,Ef;function G_(){if(Ef)return Ra;Ef=1,Ra=r;function r(e,t,n,i,s){this.id=e,this.v=t,this.type=n,this.data=i,this.m=s}return Ra}var Ta,Af;function Yd(){if(Af)return Ta;Af=1;var r=G_(),e=Mr();Ta=t;function t(n,i,s,l,u){if(e.EventEmitter.call(this),typeof u!="function")throw new Error("Callback is required for SnapshotRequest");this.requestId=i,this.connection=n,this.id=l,this.collection=s,this.callback=u,this.sent=!1}return e.mixin(t),t.prototype.send=function(){this.connection.canSend&&(this.connection.send(this._message()),this.sent=!0)},t.prototype._onConnectionStateChanged=function(){this.connection.canSend?this.sent||this.send():this.sent=!1},t.prototype._handleResponse=function(n,i){if(this.emit("ready"),n)return this.callback(n);var s=i.meta?i.meta:null,l=new r(this.id,i.v,i.type,i.data,s);this.callback(null,l)},Ta}var Na,Of;function z_(){if(Of)return Na;Of=1;var r=Yd(),e=nt(),t=ir().ACTIONS;Na=n;function n(i,s,l,u,a,o){if(r.call(this,i,s,l,u,o),!e.isValidVersion(a))throw new Error("Snapshot version must be a positive integer or null");this.version=a}return n.prototype=Object.create(r.prototype),n.prototype._message=function(){return{a:t.snapshotFetch,id:this.requestId,c:this.collection,d:this.id,v:this.version}},Na}var La,Sf;function W_(){if(Sf)return La;Sf=1;var r=Yd(),e=nt(),t=ir().ACTIONS;La=n;function n(i,s,l,u,a,o){if(r.call(this,i,s,l,u,o),!e.isValidTimestamp(a))throw new Error("Snapshot timestamp must be a positive integer or null");this.timestamp=a}return n.prototype=Object.create(r.prototype),n.prototype._message=function(){return{a:t.snapshotFetchByTimestamp,id:this.requestId,c:this.collection,d:this.id,ts:this.timestamp}},La}var Ia,wf;function K_(){if(wf)return Ia;wf=1;var r=nt(),e=$h().EventEmitter,t=["create","del","destroy","load","op"];Ia=n;function n(){this._docs=Object.create(null),this._forwarders=Object.create(null),this._emitters=Object.create(null)}return n.prototype.addEventListener=function(i,s,l){this._registerDoc(i);var u=r.dig(this._emitters,i.collection,i.id);u.on(s,l)},n.prototype.removeEventListener=function(i,s,l){var u=r.dig(this._emitters,i.collection,i.id);u&&(u.off(s,l),u._eventsCount===1&&this._unregisterDoc(i))},n.prototype._registerDoc=function(i){var s=!0;if(r.digOrCreate(this._docs,i.collection,i.id,function(){return s=!1,i}),!s){var l=r.digOrCreate(this._emitters,i.collection,i.id,function(){var a=new e;return a.setMaxListeners(1e3),a}),u=this;t.forEach(function(a){var o=r.digOrCreate(u._forwarders,i.collection,i.id,a,function(){return l.emit.bind(l,a)});i.on(a,o)}),this.addEventListener(i,"destroy",this._unregisterDoc.bind(this,i))}},n.prototype._unregisterDoc=function(i){var s=r.dig(this._forwarders,i.collection,i.id);for(var l in s)i.off(l,s[l]);var u=r.dig(this._emitters,i.collection,i.id);u.removeAllListeners(),r.digAndRemove(this._forwarders,i.collection,i.id),r.digAndRemove(this._emitters,i.collection,i.id),r.digAndRemove(this._docs,i.collection,i.id)},Ia}var qa,Rf;function Y_(){if(Rf)return qa;Rf=1,qa={major:1,minor:2,checkAtLeast:r};function r(t,n){return t=e(t),n=e(n),t.major>n.major?!0:t.major===n.major&&t.minor>=n.minor}function e(t){if(typeof t=="string"){var n=t.split(".");t={major:n[0],minor:n[1]}}return{major:+(t.protocol||t.major||0),minor:+(t.protocolMinor||t.minor||0)}}return qa}var Pa,Tf;function Z_(){if(Tf)return Pa;Tf=1;var r=Xh(),e=Qh(),t=Kd(),n=V_(),i=z_(),s=W_(),l=Mr(),u=Nn(),a=ir().ACTIONS,o=Ki(),c=nt(),d=Rl(),p=K_(),h=Y_(),v=u.CODES;function _(g){return g.readyState===0||g.readyState===1?"connecting":"disconnected"}Pa=E;function E(g){l.EventEmitter.call(this),this.collections=Object.create(null),this.nextQueryId=1,this.nextSnapshotRequestId=1,this.queries=Object.create(null),this._presences=Object.create(null),this._docPresenceEmitter=new p,this._snapshotRequests=Object.create(null),this.seq=1,this._presenceSeq=1,this.id=null,this.agent=null,this.debug=!1,this.state=_(g),this.bindToSocket(g)}l.mixin(E),E.prototype.bindToSocket=function(g){this.socket&&(this.socket.close(),this.socket.onmessage=null,this.socket.onopen=null,this.socket.onerror=null,this.socket.onclose=null),this.socket=g;var m=_(g);this._setState(m),this.canSend=!1;var A=this;g.onmessage=function(S){try{var I=typeof S.data=="string"?JSON.parse(S.data):S.data}catch{d.warn("Failed to parse message",S);return}A.debug&&d.info("RECV",JSON.stringify(I));var C={data:I};if(A.emit("receive",C),!!C.data)try{A.handleMessage(C.data)}catch(D){c.nextTick(function(){A.emit("error",D)})}},g.readyState===1&&A._initializeHandshake(),g.onopen=function(){A._setState("connecting"),A._initializeHandshake()},g.onerror=function(S){A.emit("connection error",S)},g.onclose=function(S){S==="closed"||S==="Closed"?A._setState("closed",S):S==="stopped"||S==="Stopped by server"?A._setState("stopped",S):A._setState("disconnected",S)}},E.prototype.handleMessage=function(g){var m=null;switch(g.error&&(m=w(g.error,g),delete g.error),g.a){case a.initLegacy:return this._handleLegacyInit(g);case a.handshake:return this._handleHandshake(m,g);case a.queryFetch:var A=this.queries[g.id];A&&A._handleFetch(m,g.data,g.extra);return;case a.querySubscribe:var A=this.queries[g.id];A&&A._handleSubscribe(m,g.data,g.extra);return;case a.queryUnsubscribe:return;case a.queryUpdate:var A=this.queries[g.id];if(!A)return;if(m)return A._handleError(m);g.diff&&A._handleDiff(g.diff),c.hasOwn(g,"extra")&&A._handleExtra(g.extra);return;case a.bulkFetch:return this._handleBulkMessage(m,g,"_handleFetch");case a.bulkSubscribe:case a.bulkUnsubscribe:return this._handleBulkMessage(m,g,"_handleSubscribe");case a.snapshotFetch:case a.snapshotFetchByTimestamp:return this._handleSnapshotFetch(m,g);case a.fetch:var S=this.getExisting(g.c,g.d);S&&S._handleFetch(m,g.data);return;case a.subscribe:case a.unsubscribe:var S=this.getExisting(g.c,g.d);S&&S._handleSubscribe(m,g.data);return;case a.op:var S=this.getExisting(g.c,g.d);S&&S._handleOp(m,g);return;case a.presence:return this._handlePresence(m,g);case a.presenceSubscribe:return this._handlePresenceSubscribe(m,g);case a.presenceUnsubscribe:return this._handlePresenceUnsubscribe(m,g);case a.presenceRequest:return this._handlePresenceRequest(m,g);case a.pingPong:return this._handlePingPong(m);default:d.warn("Ignoring unrecognized message",g)}};function w(g,m){var A=new Error(g.message);return A.code=g.code,m&&(A.data=m),A}E.prototype._handleBulkMessage=function(g,m,A){if(m.data)for(var S in m.data){var I=m.data[S],C=this.getExisting(m.c,S);C&&(g?C[A](g):I.error?C[A](w(I.error)):C[A](null,I))}else if(Array.isArray(m.b))for(var D=0;D<m.b.length;D++){var S=m.b[D],C=this.getExisting(m.c,S);C&&C[A](g)}else if(m.b)for(var S in m.b){var C=this.getExisting(m.c,S);C&&C[A](g)}else d.error("Invalid bulk message",m)},E.prototype._reset=function(){this.agent=null},E.prototype._setState=function(g,m){if(this.state!==g){if(g==="connecting"&&this.state!=="disconnected"&&this.state!=="stopped"&&this.state!=="closed"||g==="connected"&&this.state!=="connecting"){var A=new u(v.ERR_CONNECTION_STATE_TRANSITION_INVALID,"Cannot transition directly from "+this.state+" to "+g);return this.emit("error",A)}this.state=g,this.canSend=g==="connected",(g==="disconnected"||g==="stopped"||g==="closed")&&this._reset(),this.startBulk();for(var S in this.queries){var I=this.queries[S];I._onConnectionStateChanged()}for(var C in this.collections){var D=this.collections[C];for(var S in D)D[S]._onConnectionStateChanged()}for(var O in this._presences)this._presences[O]._onConnectionStateChanged();for(var S in this._snapshotRequests){var x=this._snapshotRequests[S];x._onConnectionStateChanged()}this.endBulk(),this.emit(g,m),this.emit("state",g,m)}},E.prototype.startBulk=function(){this.bulk||(this.bulk=Object.create(null))},E.prototype.endBulk=function(){if(this.bulk)for(var g in this.bulk){var m=this.bulk[g];this._sendBulk("f",g,m.f),this._sendBulk("s",g,m.s),this._sendBulk("u",g,m.u)}this.bulk=null},E.prototype._sendBulk=function(g,m,A){if(A){var S=[],I=Object.create(null),C=0,D;for(var O in A){var x=A[O];x==null?S.push(O):(I[O]=x,D=O,C++)}if(S.length===1){var O=S[0];this.send({a:g,c:m,d:O})}else S.length&&this.send({a:"b"+g,c:m,b:S});if(C===1){var L=I[D];this.send({a:g,c:m,d:D,v:L})}else C&&this.send({a:"b"+g,c:m,b:I})}},E.prototype._sendActions=function(g,m,A){if(this._addDoc(m),this.bulk){var S=this.bulk[m.collection]||(this.bulk[m.collection]=Object.create(null)),I=S[g]||(S[g]=Object.create(null)),C=c.hasOwn(I,m.id);return I[m.id]=A,C}else{var D={a:g,c:m.collection,d:m.id,v:A};this.send(D)}},E.prototype.sendFetch=function(g){return this._sendActions(a.fetch,g,g.version)},E.prototype.sendSubscribe=function(g){return this._sendActions(a.subscribe,g,g.version)},E.prototype.sendUnsubscribe=function(g){return this._sendActions(a.unsubscribe,g)},E.prototype.sendOp=function(g,m){this._addDoc(g);var A={a:a.op,c:g.collection,d:g.id,v:g.version,src:m.src,seq:m.seq,x:{}};"op"in m&&(A.op=m.op),m.create&&(A.create=m.create),m.del&&(A.del=m.del),g.submitSource&&(A.x.source=m.source),this.send(A)},E.prototype.send=function(g){this.debug&&d.info("SEND",JSON.stringify(g)),this.emit("send",g),this.socket.send(JSON.stringify(g))},E.prototype.ping=function(){if(!this.canSend)throw new u(v.ERR_CANNOT_PING_OFFLINE,"Socket must be CONNECTED to ping");var g={a:a.pingPong};this.send(g)},E.prototype.close=function(){this.socket.close()},E.prototype.getExisting=function(g,m){if(this.collections[g])return this.collections[g][m]},E.prototype.get=function(g,m){var A=this.collections[g]||(this.collections[g]=Object.create(null)),S=A[m];return S||(S=A[m]=new r(this,g,m),this.emit("doc",S)),S._wantsDestroy=!1,S},E.prototype._destroyDoc=function(g){g._wantsDestroy&&(c.digAndRemove(this.collections,g.collection,g.id),g.emit("destroy"))},E.prototype._addDoc=function(g){var m=this.collections[g.collection];m||(m=this.collections[g.collection]=Object.create(null)),m[g.id]!==g&&(m[g.id]=g)},E.prototype._createQuery=function(g,m,A,S,I){var C=this.nextQueryId++,D=new e(g,this,C,m,A,S,I);return this.queries[C]=D,D.send(),D},E.prototype._destroyQuery=function(g){delete this.queries[g.id]},E.prototype.createFetchQuery=function(g,m,A,S){return this._createQuery(a.queryFetch,g,m,A,S)},E.prototype.createSubscribeQuery=function(g,m,A,S){return this._createQuery(a.querySubscribe,g,m,A,S)},E.prototype.hasPending=function(){return!!(this._firstDoc(R)||this._firstQuery(R)||this._firstSnapshotRequest())};function R(g){return g.hasPending()}E.prototype.hasWritePending=function(){return!!this._firstDoc(y)};function y(g){return g.hasWritePending()}return E.prototype.whenNothingPending=function(g){var m=this._firstDoc(R);if(m){m.once("nothing pending",this._nothingPendingRetry(g));return}var A=this._firstQuery(R);if(A){A.once("ready",this._nothingPendingRetry(g));return}var S=this._firstSnapshotRequest();if(S){S.once("ready",this._nothingPendingRetry(g));return}c.nextTick(g)},E.prototype._nothingPendingRetry=function(g){var m=this;return function(){c.nextTick(function(){m.whenNothingPending(g)})}},E.prototype._firstDoc=function(g){for(var m in this.collections){var A=this.collections[m];for(var S in A){var I=A[S];if(g(I))return I}}},E.prototype._firstQuery=function(g){for(var m in this.queries){var A=this.queries[m];if(g(A))return A}},E.prototype._firstSnapshotRequest=function(){for(var g in this._snapshotRequests)return this._snapshotRequests[g]},E.prototype.fetchSnapshot=function(g,m,A,S){typeof A=="function"&&(S=A,A=null);var I=this.nextSnapshotRequestId++,C=new i(this,I,g,m,A,S);this._snapshotRequests[C.requestId]=C,C.send()},E.prototype.fetchSnapshotByTimestamp=function(g,m,A,S){typeof A=="function"&&(S=A,A=null);var I=this.nextSnapshotRequestId++,C=new s(this,I,g,m,A,S);this._snapshotRequests[C.requestId]=C,C.send()},E.prototype._handleSnapshotFetch=function(g,m){var A=this._snapshotRequests[m.id];A&&(delete this._snapshotRequests[m.id],A._handleResponse(g,m))},E.prototype._handleLegacyInit=function(g){if(h.checkAtLeast(g,"1.1"))return this._initializeHandshake();this._initialize(g)},E.prototype._initializeHandshake=function(){this.send({a:a.handshake,id:this.id,protocol:h.major,protocolMinor:h.minor})},E.prototype._handleHandshake=function(g,m){if(g)return this.emit("error",g);this._initialize(m)},E.prototype._handlePingPong=function(g){if(g)return this.emit("error",g);this.emit("pong")},E.prototype._initialize=function(g){if(this.state==="connecting"){if(g.protocol!==h.major)return this.emit("error",new u(v.ERR_PROTOCOL_VERSION_NOT_SUPPORTED,"Unsupported protocol version: "+g.protocol));if(o.map[g.type]!==o.defaultType)return this.emit("error",new u(v.ERR_DEFAULT_TYPE_MISMATCH,g.type+" does not match the server default type"));if(typeof g.id!="string")return this.emit("error",new u(v.ERR_CLIENT_ID_BADLY_FORMED,"Client id must be a string"));this.id=g.id,this._setState("connected")}},E.prototype.getPresence=function(g){var m=this,A=c.digOrCreate(this._presences,g,function(){return new t(m,g)});return A._wantsDestroy=!1,A},E.prototype.getDocPresence=function(g,m){var A=n.channel(g,m),S=this,I=c.digOrCreate(this._presences,A,function(){return new n(S,g,m)});return I._wantsDestroy=!1,I},E.prototype._sendPresenceAction=function(g,m,A){this._addPresence(A);var S={a:g,ch:A.channel,seq:m};return this.send(S),S.seq},E.prototype._addPresence=function(g){c.digOrCreate(this._presences,g.channel,function(){return g})},E.prototype._requestRemotePresence=function(g){this.send({a:a.presenceRequest,ch:g})},E.prototype._handlePresenceSubscribe=function(g,m){var A=c.dig(this._presences,m.ch);A&&A._handleSubscribe(g,m.seq)},E.prototype._handlePresenceUnsubscribe=function(g,m){var A=c.dig(this._presences,m.ch);A&&A._handleUnsubscribe(g,m.seq)},E.prototype._handlePresence=function(g,m){var A=c.dig(this._presences,m.ch);A&&A._receiveUpdate(g,m)},E.prototype._handlePresenceRequest=function(g,m){var A=c.dig(this._presences,m.ch);A&&A._broadcastAllLocalPresence(g,m)},Pa}var Nf;function J_(){return Nf||(Nf=1,It.Connection=Z_(),It.Doc=Xh(),It.Error=Nn(),It.Query=Qh(),It.types=Ki(),It.logger=Rl()),It}var X_=J_();const Zd=Ui(X_);var Ca,Lf;function Q_(){if(Lf)return Ca;Lf=1;var r=-1,e=1,t=0;function n(y,g,m,A){if(y===g)return y?[[t,y]]:[];if(m!=null){var S=w(y,g,m);if(S)return S}var I=u(y,g),C=y.substring(0,I);y=y.substring(I),g=g.substring(I),I=a(y,g);var D=y.substring(y.length-I);y=y.substring(0,y.length-I),g=g.substring(0,g.length-I);var O=i(y,g);return C&&O.unshift([t,C]),D&&O.push([t,D]),c(O,A),O}function i(y,g){var m;if(!y)return[[e,g]];if(!g)return[[r,y]];var A=y.length>g.length?y:g,S=y.length>g.length?g:y,I=A.indexOf(S);if(I!==-1)return m=[[e,A.substring(0,I)],[t,S],[e,A.substring(I+S.length)]],y.length>g.length&&(m[0][0]=m[2][0]=r),m;if(S.length===1)return[[r,y],[e,g]];var C=o(y,g);if(C){var D=C[0],O=C[1],x=C[2],L=C[3],j=C[4],H=n(D,x),M=n(O,L);return H.concat([[t,j]],M)}return s(y,g)}function s(y,g){for(var m=y.length,A=g.length,S=Math.ceil((m+A)/2),I=S,C=2*S,D=new Array(C),O=new Array(C),x=0;x<C;x++)D[x]=-1,O[x]=-1;D[I+1]=0,O[I+1]=0;for(var L=m-A,j=L%2!==0,H=0,M=0,U=0,V=0,z=0;z<S;z++){for(var F=-z+H;F<=z-M;F+=2){var X=I+F,Y;F===-z||F!==z&&D[X-1]<D[X+1]?Y=D[X+1]:Y=D[X-1]+1;for(var N=Y-F;Y<m&&N<A&&y.charAt(Y)===g.charAt(N);)Y++,N++;if(D[X]=Y,Y>m)M+=2;else if(N>A)H+=2;else if(j){var q=I+L-F;if(q>=0&&q<C&&O[q]!==-1){var P=m-O[q];if(Y>=P)return l(y,g,Y,N)}}}for(var W=-z+U;W<=z-V;W+=2){var q=I+W,P;W===-z||W!==z&&O[q-1]<O[q+1]?P=O[q+1]:P=O[q-1]+1;for(var ee=P-W;P<m&&ee<A&&y.charAt(m-P-1)===g.charAt(A-ee-1);)P++,ee++;if(O[q]=P,P>m)V+=2;else if(ee>A)U+=2;else if(!j){var X=I+L-W;if(X>=0&&X<C&&D[X]!==-1){var Y=D[X],N=I+Y-X;if(P=m-P,Y>=P)return l(y,g,Y,N)}}}}return[[r,y],[e,g]]}function l(y,g,m,A){var S=y.substring(0,m),I=g.substring(0,A),C=y.substring(m),D=g.substring(A),O=n(S,I),x=n(C,D);return O.concat(x)}function u(y,g){if(!y||!g||y.charAt(0)!==g.charAt(0))return 0;for(var m=0,A=Math.min(y.length,g.length),S=A,I=0;m<S;)y.substring(I,S)==g.substring(I,S)?(m=S,I=m):A=S,S=Math.floor((A-m)/2+m);return d(y.charCodeAt(S-1))&&S--,S}function a(y,g){if(!y||!g||y.slice(-1)!==g.slice(-1))return 0;for(var m=0,A=Math.min(y.length,g.length),S=A,I=0;m<S;)y.substring(y.length-S,y.length-I)==g.substring(g.length-S,g.length-I)?(m=S,I=m):A=S,S=Math.floor((A-m)/2+m);return p(y.charCodeAt(y.length-S))&&S--,S}function o(y,g){var m=y.length>g.length?y:g,A=y.length>g.length?g:y;if(m.length<4||A.length*2<m.length)return null;function S(M,U,V){for(var z=M.substring(V,V+Math.floor(M.length/4)),F=-1,X="",Y,N,q,P;(F=U.indexOf(z,F+1))!==-1;){var W=u(M.substring(V),U.substring(F)),ee=a(M.substring(0,V),U.substring(0,F));X.length<ee+W&&(X=U.substring(F-ee,F)+U.substring(F,F+W),Y=M.substring(0,V-ee),N=M.substring(V+W),q=U.substring(0,F-ee),P=U.substring(F+W))}return X.length*2>=M.length?[Y,N,q,P,X]:null}var I=S(m,A,Math.ceil(m.length/4)),C=S(m,A,Math.ceil(m.length/2)),D;if(!I&&!C)return null;C?I?D=I[4].length>C[4].length?I:C:D=C:D=I;var O,x,L,j;y.length>g.length?(O=D[0],x=D[1],L=D[2],j=D[3]):(L=D[0],j=D[1],O=D[2],x=D[3]);var H=D[4];return[O,x,L,j,H]}function c(y,g){y.push([t,""]);for(var m=0,A=0,S=0,I="",C="",D;m<y.length;){if(m<y.length-1&&!y[m][1]){y.splice(m,1);continue}switch(y[m][0]){case e:S++,C+=y[m][1],m++;break;case r:A++,I+=y[m][1],m++;break;case t:var O=m-S-A-1;if(g){if(O>=0&&v(y[O][1])){var x=y[O][1].slice(-1);if(y[O][1]=y[O][1].slice(0,-1),I=x+I,C=x+C,!y[O][1]){y.splice(O,1),m--;var L=O-1;y[L]&&y[L][0]===e&&(S++,C=y[L][1]+C,L--),y[L]&&y[L][0]===r&&(A++,I=y[L][1]+I,L--),O=L}}if(h(y[m][1])){var x=y[m][1].charAt(0);y[m][1]=y[m][1].slice(1),I+=x,C+=x}}if(m<y.length-1&&!y[m][1]){y.splice(m,1);break}if(I.length>0||C.length>0){I.length>0&&C.length>0&&(D=u(C,I),D!==0&&(O>=0?y[O][1]+=C.substring(0,D):(y.splice(0,0,[t,C.substring(0,D)]),m++),C=C.substring(D),I=I.substring(D)),D=a(C,I),D!==0&&(y[m][1]=C.substring(C.length-D)+y[m][1],C=C.substring(0,C.length-D),I=I.substring(0,I.length-D)));var j=S+A;I.length===0&&C.length===0?(y.splice(m-j,j),m=m-j):I.length===0?(y.splice(m-j,j,[e,C]),m=m-j+1):C.length===0?(y.splice(m-j,j,[r,I]),m=m-j+1):(y.splice(m-j,j,[r,I],[e,C]),m=m-j+2)}m!==0&&y[m-1][0]===t?(y[m-1][1]+=y[m][1],y.splice(m,1)):m++,S=0,A=0,I="",C="";break}}y[y.length-1][1]===""&&y.pop();var H=!1;for(m=1;m<y.length-1;)y[m-1][0]===t&&y[m+1][0]===t&&(y[m][1].substring(y[m][1].length-y[m-1][1].length)===y[m-1][1]?(y[m][1]=y[m-1][1]+y[m][1].substring(0,y[m][1].length-y[m-1][1].length),y[m+1][1]=y[m-1][1]+y[m+1][1],y.splice(m-1,1),H=!0):y[m][1].substring(0,y[m+1][1].length)==y[m+1][1]&&(y[m-1][1]+=y[m+1][1],y[m][1]=y[m][1].substring(y[m+1][1].length)+y[m+1][1],y.splice(m+1,1),H=!0)),m++;H&&c(y,g)}function d(y){return y>=55296&&y<=56319}function p(y){return y>=56320&&y<=57343}function h(y){return p(y.charCodeAt(0))}function v(y){return d(y.charCodeAt(y.length-1))}function _(y){for(var g=[],m=0;m<y.length;m++)y[m][1].length>0&&g.push(y[m]);return g}function E(y,g,m,A){return v(y)||h(A)?null:_([[t,y],[r,g],[e,m],[t,A]])}function w(y,g,m){var A=typeof m=="number"?{index:m,length:0}:m.oldRange,S=typeof m=="number"?null:m.newRange,I=y.length,C=g.length;if(A.length===0&&(S===null||S.length===0)){var D=A.index,O=y.slice(0,D),x=y.slice(D),L=S?S.index:null;e:{var j=D+C-I;if(L!==null&&L!==j||j<0||j>C)break e;var H=g.slice(0,j),M=g.slice(j);if(M!==x)break e;var U=Math.min(D,j),V=O.slice(0,U),z=H.slice(0,U);if(V!==z)break e;var F=O.slice(U),X=H.slice(U);return E(V,F,X,x)}e:{if(L!==null&&L!==D)break e;var Y=D,H=g.slice(0,Y),M=g.slice(Y);if(H!==O)break e;var N=Math.min(I-Y,C-Y),q=x.slice(x.length-N),P=M.slice(M.length-N);if(q!==P)break e;var F=x.slice(0,x.length-N),X=M.slice(0,M.length-N);return E(O,F,X,q)}}if(A.length>0&&S&&S.length===0)e:{var V=y.slice(0,A.index),q=y.slice(A.index+A.length),U=V.length,N=q.length;if(C<U+N)break e;var z=g.slice(0,U),P=g.slice(C-N);if(V!==z||q!==P)break e;var F=y.slice(U,I-N),X=g.slice(U,C-N);return E(V,F,X,q)}return null}function R(y,g,m){return n(y,g,m,!0)}return R.INSERT=e,R.DELETE=r,R.EQUAL=t,Ca=R,Ca}var gr={},If;function eE(){if(If)return gr;If=1;var r=gr&&gr.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(gr,"__esModule",{value:!0});var e=r(Hi()),t=r(Vi()),n;return(function(i){function s(o,c,d){o===void 0&&(o={}),c===void 0&&(c={}),typeof o!="object"&&(o={}),typeof c!="object"&&(c={});var p=e.default(c);d||(p=Object.keys(p).reduce(function(v,_){return p[_]!=null&&(v[_]=p[_]),v},{}));for(var h in o)o[h]!==void 0&&c[h]===void 0&&(p[h]=o[h]);return Object.keys(p).length>0?p:void 0}i.compose=s;function l(o,c){o===void 0&&(o={}),c===void 0&&(c={}),typeof o!="object"&&(o={}),typeof c!="object"&&(c={});var d=Object.keys(o).concat(Object.keys(c)).reduce(function(p,h){return t.default(o[h],c[h])||(p[h]=c[h]===void 0?null:c[h]),p},{});return Object.keys(d).length>0?d:void 0}i.diff=l;function u(o,c){o===void 0&&(o={}),c===void 0&&(c={}),o=o||{};var d=Object.keys(c).reduce(function(p,h){return c[h]!==o[h]&&o[h]!==void 0&&(p[h]=c[h]),p},{});return Object.keys(o).reduce(function(p,h){return o[h]!==c[h]&&c[h]===void 0&&(p[h]=null),p},d)}i.invert=u;function a(o,c,d){if(d===void 0&&(d=!1),typeof o!="object")return c;if(typeof c=="object"){if(!d)return c;var p=Object.keys(c).reduce(function(h,v){return o[v]===void 0&&(h[v]=c[v]),h},{});return Object.keys(p).length>0?p:void 0}}i.transform=a})(n||(n={})),gr.default=n,gr}var mr={},vr={},qf;function tE(){if(qf)return vr;qf=1;var r=vr&&vr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(vr,"__esModule",{value:!0});var e=r(Jd()),t=(function(){function n(i){this.ops=i,this.index=0,this.offset=0}return n.prototype.hasNext=function(){return this.peekLength()<1/0},n.prototype.next=function(i){i||(i=1/0);var s=this.ops[this.index];if(s){var l=this.offset,u=e.default.length(s);if(i>=u-l?(i=u-l,this.index+=1,this.offset=0):this.offset+=i,typeof s.delete=="number")return{delete:i};var a={};return s.attributes&&(a.attributes=s.attributes),typeof s.retain=="number"?a.retain=i:typeof s.insert=="string"?a.insert=s.insert.substr(l,i):a.insert=s.insert,a}else return{retain:1/0}},n.prototype.peek=function(){return this.ops[this.index]},n.prototype.peekLength=function(){return this.ops[this.index]?e.default.length(this.ops[this.index])-this.offset:1/0},n.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},n.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var i=this.offset,s=this.index,l=this.next(),u=this.ops.slice(this.index);return this.offset=i,this.index=s,[l].concat(u)}else return[]},n})();return vr.default=t,vr}var Pf;function Jd(){if(Pf)return mr;Pf=1;var r=mr&&mr.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(mr,"__esModule",{value:!0});var e=r(tE()),t;return(function(n){function i(l){return new e.default(l)}n.iterator=i;function s(l){return typeof l.delete=="number"?l.delete:typeof l.retain=="number"?l.retain:typeof l.insert=="string"?l.insert.length:1}n.length=s})(t||(t={})),mr.default=t,mr}var tn,Cf;function rE(){if(Cf)return tn;Cf=1;var r=tn&&tn.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},e=r(Q_()),t=r(Hi()),n=r(Vi()),i=r(eE()),s=r(Jd()),l="\0",u=(function(){function a(o){Array.isArray(o)?this.ops=o:o!=null&&Array.isArray(o.ops)?this.ops=o.ops:this.ops=[]}return a.prototype.insert=function(o,c){var d={};return typeof o=="string"&&o.length===0?this:(d.insert=o,c!=null&&typeof c=="object"&&Object.keys(c).length>0&&(d.attributes=c),this.push(d))},a.prototype.delete=function(o){return o<=0?this:this.push({delete:o})},a.prototype.retain=function(o,c){if(o<=0)return this;var d={retain:o};return c!=null&&typeof c=="object"&&Object.keys(c).length>0&&(d.attributes=c),this.push(d)},a.prototype.push=function(o){var c=this.ops.length,d=this.ops[c-1];if(o=t.default(o),typeof d=="object"){if(typeof o.delete=="number"&&typeof d.delete=="number")return this.ops[c-1]={delete:d.delete+o.delete},this;if(typeof d.delete=="number"&&o.insert!=null&&(c-=1,d=this.ops[c-1],typeof d!="object"))return this.ops.unshift(o),this;if(n.default(o.attributes,d.attributes)){if(typeof o.insert=="string"&&typeof d.insert=="string")return this.ops[c-1]={insert:d.insert+o.insert},typeof o.attributes=="object"&&(this.ops[c-1].attributes=o.attributes),this;if(typeof o.retain=="number"&&typeof d.retain=="number")return this.ops[c-1]={retain:d.retain+o.retain},typeof o.attributes=="object"&&(this.ops[c-1].attributes=o.attributes),this}}return c===this.ops.length?this.ops.push(o):this.ops.splice(c,0,o),this},a.prototype.chop=function(){var o=this.ops[this.ops.length-1];return o&&o.retain&&!o.attributes&&this.ops.pop(),this},a.prototype.filter=function(o){return this.ops.filter(o)},a.prototype.forEach=function(o){this.ops.forEach(o)},a.prototype.map=function(o){return this.ops.map(o)},a.prototype.partition=function(o){var c=[],d=[];return this.forEach(function(p){var h=o(p)?c:d;h.push(p)}),[c,d]},a.prototype.reduce=function(o,c){return this.ops.reduce(o,c)},a.prototype.changeLength=function(){return this.reduce(function(o,c){return c.insert?o+s.default.length(c):c.delete?o-c.delete:o},0)},a.prototype.length=function(){return this.reduce(function(o,c){return o+s.default.length(c)},0)},a.prototype.slice=function(o,c){o===void 0&&(o=0),c===void 0&&(c=1/0);for(var d=[],p=s.default.iterator(this.ops),h=0;h<c&&p.hasNext();){var v=void 0;h<o?v=p.next(o-h):(v=p.next(c-h),d.push(v)),h+=s.default.length(v)}return new a(d)},a.prototype.compose=function(o){var c=s.default.iterator(this.ops),d=s.default.iterator(o.ops),p=[],h=d.peek();if(h!=null&&typeof h.retain=="number"&&h.attributes==null){for(var v=h.retain;c.peekType()==="insert"&&c.peekLength()<=v;)v-=c.peekLength(),p.push(c.next());h.retain-v>0&&d.next(h.retain-v)}for(var _=new a(p);c.hasNext()||d.hasNext();)if(d.peekType()==="insert")_.push(d.next());else if(c.peekType()==="delete")_.push(c.next());else{var E=Math.min(c.peekLength(),d.peekLength()),w=c.next(E),R=d.next(E);if(typeof R.retain=="number"){var y={};typeof w.retain=="number"?y.retain=E:y.insert=w.insert;var g=i.default.compose(w.attributes,R.attributes,typeof w.retain=="number");if(g&&(y.attributes=g),_.push(y),!d.hasNext()&&n.default(_.ops[_.ops.length-1],y)){var m=new a(c.rest());return _.concat(m).chop()}}else typeof R.delete=="number"&&typeof w.retain=="number"&&_.push(R)}return _.chop()},a.prototype.concat=function(o){var c=new a(this.ops.slice());return o.ops.length>0&&(c.push(o.ops[0]),c.ops=c.ops.concat(o.ops.slice(1))),c},a.prototype.diff=function(o,c){if(this.ops===o.ops)return new a;var d=[this,o].map(function(E){return E.map(function(w){if(w.insert!=null)return typeof w.insert=="string"?w.insert:l;var R=E===o?"on":"with";throw new Error("diff() called "+R+" non-document")}).join("")}),p=new a,h=e.default(d[0],d[1],c),v=s.default.iterator(this.ops),_=s.default.iterator(o.ops);return h.forEach(function(E){for(var w=E[1].length;w>0;){var R=0;switch(E[0]){case e.default.INSERT:R=Math.min(_.peekLength(),w),p.push(_.next(R));break;case e.default.DELETE:R=Math.min(w,v.peekLength()),v.next(R),p.delete(R);break;case e.default.EQUAL:R=Math.min(v.peekLength(),_.peekLength(),w);var y=v.next(R),g=_.next(R);n.default(y.insert,g.insert)?p.retain(R,i.default.diff(y.attributes,g.attributes)):p.push(g).delete(R);break}w-=R}}),p.chop()},a.prototype.eachLine=function(o,c){c===void 0&&(c=`
`);for(var d=s.default.iterator(this.ops),p=new a,h=0;d.hasNext();){if(d.peekType()!=="insert")return;var v=d.peek(),_=s.default.length(v)-d.peekLength(),E=typeof v.insert=="string"?v.insert.indexOf(c,_)-_:-1;if(E<0)p.push(d.next());else if(E>0)p.push(d.next(E));else{if(o(p,d.next(1).attributes||{},h)===!1)return;h+=1,p=new a}}p.length()>0&&o(p,{},h)},a.prototype.invert=function(o){var c=new a;return this.reduce(function(d,p){if(p.insert)c.delete(s.default.length(p));else{if(p.retain&&p.attributes==null)return c.retain(p.retain),d+p.retain;if(p.delete||p.retain&&p.attributes){var h=p.delete||p.retain,v=o.slice(d,d+h);return v.forEach(function(_){p.delete?c.push(_):p.retain&&p.attributes&&c.retain(s.default.length(_),i.default.invert(p.attributes,_.attributes))}),d+h}}return d},0),c.chop()},a.prototype.transform=function(o,c){if(c===void 0&&(c=!1),c=!!c,typeof o=="number")return this.transformPosition(o,c);for(var d=o,p=s.default.iterator(this.ops),h=s.default.iterator(d.ops),v=new a;p.hasNext()||h.hasNext();)if(p.peekType()==="insert"&&(c||h.peekType()!=="insert"))v.retain(s.default.length(p.next()));else if(h.peekType()==="insert")v.push(h.next());else{var _=Math.min(p.peekLength(),h.peekLength()),E=p.next(_),w=h.next(_);if(E.delete)continue;w.delete?v.push(w):v.retain(_,i.default.transform(E.attributes,w.attributes,c))}return v.chop()},a.prototype.transformPosition=function(o,c){c===void 0&&(c=!1),c=!!c;for(var d=s.default.iterator(this.ops),p=0;d.hasNext()&&p<=o;){var h=d.peekLength(),v=d.peekType();if(d.next(),v==="delete"){o-=Math.min(h,o-p);continue}else v==="insert"&&(p<o||!c)&&(o+=h);p+=h}return o},a.Op=s.default,a.AttributeMap=i.default,a})();return tn=u,tn}var xa,xf;function nE(){if(xf)return xa;xf=1;var r=rE();return xa={Delta:r,type:{name:"rich-text",uri:"http://sharejs.org/types/rich-text/v1",create:function(e){return new r(e)},apply:function(e,t){return e=new r(e),t=new r(t),e.compose(t)},compose:function(e,t){return e=new r(e),t=new r(t),e.compose(t)},diff:function(e,t){return e=new r(e),t=new r(t),e.diff(t)},transform:function(e,t,n){return e=new r(e),t=new r(t),t.transform(e,n==="left")},transformCursor:function(e,t,n){return t.transformPosition(e,!n)},normalize:function(e){return e},serialize:function(e){return e.ops},deserialize:function(e){return new r(e)},transformPresence:function(e,t,n){if(!e)return null;const i=new r(t),s=this.transformCursor(e.index,i,n),l=this.transformCursor(e.index+e.length,i,n);return Object.assign({},e,{index:s,length:l-s})}}},xa}var Da,Df;function iE(){return Df||(Df=1,Da=nE()),Da}var sE=iE();const oE=Ui(sE),Ma={};Zd.types.register(oE.type);if(window.__OT_V2_INIT__)console.warn("[OT] déjà initialisé, on ignore.");else{window.__OT_V2_INIT__=!0;const r=window.ROOM_ID;if(!r)console.warn("[OT] Pas de ROOM_ID");else{const e=location.protocol==="https:"?"wss":"ws",t=location.hostname,n=Number(Ma==null?void 0:Ma.VITE_OT_PORT)||3001,i=Math.random().toString(36).slice(2,8),s=new WebSocket(`${e}://${t}:${n}/?cid=${i}`);console.log("[OT] socket cid=",i,"→",`${e}://${t}:${n}/`);const u=new Zd.Connection(s).get("docs",r),a=new B("#editor",{theme:"snow",placeholder:"Écris ici… (collab en direct)",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link","code-block","blockquote"],["clean"]]}});let o=!1;u.subscribe(c=>{if(c){console.error("[OT] subscribe error:",c);return}try{a.setContents(u.data||[{insert:`
`}],"silent")}catch{a.setContents([{insert:`
`}],"silent")}o||(o=!0,a.on("text-change",(d,p,h)=>{h==="user"&&u.submitOp(d,{source:a},v=>{v&&console.warn("[OT] submitOp warn:",v)})}),u.on("op",(d,p)=>{p!==a&&a.updateContents(d,"silent")}),console.log("[OT] prêt pour",r,"cid=",i))})}}});export default aE();
//# sourceMappingURL=ot-main.js.map
